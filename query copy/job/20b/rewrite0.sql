create or replace view aggView6746319467064116435 as select id as v23 from keyword as k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggJoin2760212749369872420 as select movie_id as v40 from movie_keyword as mk, aggView6746319467064116435 where mk.keyword_id=aggView6746319467064116435.v23;
create or replace view aggView3903807322710056362 as select v40 from aggJoin2760212749369872420 group by v40;
create or replace view aggJoin2744444851887148189 as select id as v40, title as v41, kind_id as v26, production_year as v44 from title as t, aggView3903807322710056362 where t.id=aggView3903807322710056362.v40 and production_year>2000;
create or replace view aggView2688477686786071816 as select id as v26 from kind_type as kt where kind= 'movie';
create or replace view aggJoin6479883816027670814 as select v40, v41, v44 from aggJoin2744444851887148189 join aggView2688477686786071816 using(v26);
create or replace view aggView2522465552462808095 as select v40, MIN(v41) as v52 from aggJoin6479883816027670814 group by v40;
create or replace view aggJoin9087251660077958719 as select movie_id as v40, subject_id as v5, status_id as v7, v52 from complete_cast as cc, aggView2522465552462808095 where cc.movie_id=aggView2522465552462808095.v40;
create or replace view aggView2776200705589170917 as select id as v5 from comp_cast_type as cct1 where kind= 'cast';
create or replace view aggJoin7058122385622285762 as select v40, v7, v52 from aggJoin9087251660077958719 join aggView2776200705589170917 using(v5);
create or replace view aggView9007544797465114501 as select v7, v40, MIN(v52) as v52 from aggJoin7058122385622285762 group by v7,v40;
create or replace view aggJoin1656342312247787396 as select kind as v8, v40, v52 from comp_cast_type as cct2, aggView9007544797465114501 where cct2.id=aggView9007544797465114501.v7 and kind LIKE '%complete%';
create or replace view aggView1960407642962740508 as select v40, MIN(v52) as v52 from aggJoin1656342312247787396 group by v40;
create or replace view aggJoin3855152023557869789 as select person_id as v31, movie_id as v40, person_role_id as v9, v52 from cast_info as ci, aggView1960407642962740508 where ci.movie_id=aggView1960407642962740508.v40;
create or replace view aggView7805053718593671908 as select id as v31 from name as n where name LIKE '%Downey%Robert%';
create or replace view aggJoin8903049314872451687 as select v40, v9, v52 from aggJoin3855152023557869789 join aggView7805053718593671908 using(v31);
create or replace view aggView2706378442355878972 as select v9, MIN(v52) as v52 from aggJoin8903049314872451687 group by v9;
create or replace view aggJoin3854825610185607834 as select name as v10, v52 from char_name as chn, aggView2706378442355878972 where chn.id=aggView2706378442355878972.v9 and ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
select MIN(v52) as v52 from aggJoin3854825610185607834;
