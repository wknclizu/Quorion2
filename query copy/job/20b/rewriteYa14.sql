create or replace view semiUp7118281969641022285 as select movie_id as v40, subject_id as v5, status_id as v7 from complete_cast AS cc where (subject_id) in (select id from comp_cast_type AS cct1 where kind= 'cast');
create or replace view semiUp6283792975544248133 as select id as v40, title as v41, kind_id as v26 from title AS t where (kind_id) in (select id from kind_type AS kt where kind= 'movie') and production_year>2000;
create or replace view semiUp2172002892265139563 as select person_id as v31, movie_id as v40, person_role_id as v9 from cast_info AS ci where (person_role_id) in (select id from char_name AS chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%');
create or replace view semiUp7786881118376729623 as select movie_id as v40, keyword_id as v23 from movie_keyword AS mk where (keyword_id) in (select id from keyword AS k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence'));
create or replace view semiUp7401987661533831112 as select v31, v40, v9 from semiUp2172002892265139563 where (v31) in (select id from name AS n where name LIKE '%Downey%Robert%');
create or replace view semiUp2664214751573887242 as select v40, v5, v7 from semiUp7118281969641022285 where (v7) in (select id from comp_cast_type AS cct2 where kind LIKE '%complete%');
create or replace view semiUp340322628794972 as select v40, v23 from semiUp7786881118376729623 where (v40) in (select v40 from semiUp2664214751573887242);
create or replace view semiUp5331850572307726978 as select v40, v41, v26 from semiUp6283792975544248133 where (v40) in (select v40 from semiUp340322628794972);
create or replace view semiUp5122033871087939324 as select v31, v40, v9 from semiUp7401987661533831112 where (v40) in (select v40 from semiUp5331850572307726978);
create or replace view semiDown4889821943135407303 as select id as v31 from name AS n where (id) in (select v31 from semiUp5122033871087939324) and name LIKE '%Downey%Robert%';
create or replace view semiDown710869370512223517 as select id as v9 from char_name AS chn where (id) in (select v9 from semiUp5122033871087939324) and ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view semiDown7831696073469013192 as select v40, v41, v26 from semiUp5331850572307726978 where (v40) in (select v40 from semiUp5122033871087939324);
create or replace view semiDown8387765785592217949 as select id as v26 from kind_type AS kt where (id) in (select v26 from semiDown7831696073469013192) and kind= 'movie';
create or replace view semiDown4428083679978847312 as select v40, v23 from semiUp340322628794972 where (v40) in (select v40 from semiDown7831696073469013192);
create or replace view semiDown5363009930266133209 as select id as v23 from keyword AS k where (id) in (select v23 from semiDown4428083679978847312) and keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view semiDown1404861739124833841 as select v40, v5, v7 from semiUp2664214751573887242 where (v40) in (select v40 from semiDown4428083679978847312);
create or replace view semiDown6325979630633758663 as select id as v7 from comp_cast_type AS cct2 where (id) in (select v7 from semiDown1404861739124833841) and kind LIKE '%complete%';
create or replace view semiDown4196236411795937869 as select id as v5 from comp_cast_type AS cct1 where (id) in (select v5 from semiDown1404861739124833841) and kind= 'cast';
create or replace view aggView3413004990463725271 as select v7 from semiDown6325979630633758663;
create or replace view aggJoin4096850144830419797 as select v40, v5 from semiDown1404861739124833841 join aggView3413004990463725271 using(v7);
create or replace view aggView6721671139090642792 as select v5 from semiDown4196236411795937869;
create or replace view aggJoin4102404984220956603 as select v40 from aggJoin4096850144830419797 join aggView6721671139090642792 using(v5);
create or replace view aggView2057296415337345252 as select v23 from semiDown5363009930266133209;
create or replace view aggJoin7844767798067993250 as select v40 from semiDown4428083679978847312 join aggView2057296415337345252 using(v23);
create or replace view aggView591752951808698716 as select v40 from aggJoin4102404984220956603 group by v40;
create or replace view aggJoin3864248000631184456 as select v40 from aggJoin7844767798067993250 join aggView591752951808698716 using(v40);
create or replace view aggView41451833532824886 as select v26 from semiDown8387765785592217949;
create or replace view aggJoin3279921961721295058 as select v40, v41 from semiDown7831696073469013192 join aggView41451833532824886 using(v26);
create or replace view aggView7129050273887945866 as select v40 from aggJoin3864248000631184456 group by v40;
create or replace view aggJoin7841121562383885169 as select v40, v41 from aggJoin3279921961721295058 join aggView7129050273887945866 using(v40);
create or replace view aggView5121449147259607933 as select v9 from semiDown710869370512223517;
create or replace view aggJoin4741767669915263508 as select v31, v40 from semiUp5122033871087939324 join aggView5121449147259607933 using(v9);
create or replace view aggView4727546468017836565 as select v31 from semiDown4889821943135407303;
create or replace view aggJoin8909859854724671863 as select v40 from aggJoin4741767669915263508 join aggView4727546468017836565 using(v31);
create or replace view aggView7374890786808453905 as select v40, MIN(v41) as v52 from aggJoin7841121562383885169 group by v40;
create or replace view aggJoin8852493228712927653 as select v52 from aggJoin8909859854724671863 join aggView7374890786808453905 using(v40);
select MIN(v52) as v52 from aggJoin8852493228712927653;

