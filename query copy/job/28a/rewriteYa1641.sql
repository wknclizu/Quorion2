create or replace view cnAux73 as select id as v9, name as v10 from company_name where country_code<> '[us]';
create or replace view semiUp4500818578947412846 as select movie_id as v45, info_type_id as v20, info as v40 from movie_info_idx AS mi_idx where (info_type_id) in (select id from info_type AS it2 where info= 'rating') and info<'8.5';
create or replace view semiUp4172273695837321854 as select id as v45, title as v46, kind_id as v25 from title AS t where (kind_id) in (select id from kind_type AS kt where kind IN ('movie','episode')) and production_year>2000;
create or replace view semiUp4913029716516465839 as select movie_id as v45, keyword_id as v22 from movie_keyword AS mk where (keyword_id) in (select id from keyword AS k where keyword IN ('murder','murder-in-title','blood','violence'));
create or replace view semiUp2512979199760455821 as select v45, v20, v40 from semiUp4500818578947412846 where (v45) in (select v45 from semiUp4913029716516465839);
create or replace view mi_idxAux58 as select v45, v40 from semiUp2512979199760455821;
create or replace view semiUp5969555437848604116 as select movie_id as v45, subject_id as v5, status_id as v7 from complete_cast AS cc where (subject_id) in (select id from comp_cast_type AS cct1 where kind= 'crew');
create or replace view semiUp8987014860894851079 as select v45, v5, v7 from semiUp5969555437848604116 where (v7) in (select id from comp_cast_type AS cct2 where kind<> 'complete+verified');
create or replace view semiUp6095720505561485179 as select v45, v46, v25 from semiUp4172273695837321854 where (v45) in (select v45 from semiUp8987014860894851079);
create or replace view tAux76 as select v45, v46 from semiUp6095720505561485179;
create or replace view semiUp2365779888378387494 as select movie_id as v45, company_id as v9, company_type_id as v16 from movie_companies AS mc where (movie_id) in (select v45 from tAux76) and note NOT LIKE '%(USA)%' and note LIKE '%(200%)%';
create or replace view semiUp4684521394399506123 as select v45, v9, v16 from semiUp2365779888378387494 where (v45) in (select v45 from mi_idxAux58);
create or replace view semiUp2589365011731021879 as select v45, v9, v16 from semiUp4684521394399506123 where (v16) in (select id from company_type AS ct);
create or replace view semiUp5242407173508006780 as select movie_id as v45, info_type_id as v18 from movie_info AS mi where (info_type_id) in (select id from info_type AS it1 where info= 'countries') and info IN ('Sweden','Norway','Germany','Denmark','Swedish','Danish','Norwegian','German','USA','American');
create or replace view semiUp4846678399471815501 as select v45, v9, v16 from semiUp2589365011731021879 where (v45) in (select v45 from semiUp5242407173508006780);
create or replace view semiUp2603788797178614167 as select v9, v10 from cnAux73 where (v9) in (select v9 from semiUp4846678399471815501);
create or replace view semiDown8488854442196432422 as select id as v9, name as v10 from company_name AS cn where (id, name) in (select v9, v10 from semiUp2603788797178614167) and country_code<> '[us]';
create or replace view semiDown608135675722075381 as select v45, v9, v16 from semiUp4846678399471815501 where (v9) in (select v9 from semiUp2603788797178614167);
create or replace view semiDown955138176571745499 as select id as v16 from company_type AS ct where (id) in (select v16 from semiDown608135675722075381);
create or replace view semiDown6167977351369915123 as select v45, v18 from semiUp5242407173508006780 where (v45) in (select v45 from semiDown608135675722075381);
create or replace view semiDown3537721442445061368 as select v45, v40 from mi_idxAux58 where (v45) in (select v45 from semiDown608135675722075381);
create or replace view semiDown875702063091664991 as select v45, v46 from tAux76 where (v45) in (select v45 from semiDown608135675722075381);
create or replace view semiDown3522103241559747590 as select id as v18 from info_type AS it1 where (id) in (select v18 from semiDown6167977351369915123) and info= 'countries';
create or replace view semiDown8142679591496011962 as select v45, v20, v40 from semiUp2512979199760455821 where (v45, v40) in (select v45, v40 from semiDown3537721442445061368);
create or replace view semiDown8361955545090691476 as select v45, v46, v25 from semiUp6095720505561485179 where (v45, v46) in (select v45, v46 from semiDown875702063091664991);
create or replace view semiDown5307653100369351888 as select id as v20 from info_type AS it2 where (id) in (select v20 from semiDown8142679591496011962) and info= 'rating';
create or replace view semiDown5417560527476011654 as select v45, v22 from semiUp4913029716516465839 where (v45) in (select v45 from semiDown8142679591496011962);
create or replace view semiDown2133394302802118569 as select id as v25 from kind_type AS kt where (id) in (select v25 from semiDown8361955545090691476) and kind IN ('movie','episode');
create or replace view semiDown8685813629639650457 as select v45, v5, v7 from semiUp8987014860894851079 where (v45) in (select v45 from semiDown8361955545090691476);
create or replace view semiDown5661641079879697297 as select id as v22 from keyword AS k where (id) in (select v22 from semiDown5417560527476011654) and keyword IN ('murder','murder-in-title','blood','violence');
create or replace view semiDown277073922410273667 as select id as v7 from comp_cast_type AS cct2 where (id) in (select v7 from semiDown8685813629639650457) and kind<> 'complete+verified';
create or replace view semiDown8988443998980913961 as select id as v5 from comp_cast_type AS cct1 where (id) in (select v5 from semiDown8685813629639650457) and kind= 'crew';
create or replace view aggView7815925756734809164 as select v9, v10, v10 as v57 from semiDown8488854442196432422;
create or replace view aggView4446179327843512580 as select v22 from semiDown5661641079879697297;
create or replace view aggJoin9102782562330685129 as select v45 from semiDown5417560527476011654 join aggView4446179327843512580 using(v22);
create or replace view aggView2822933425946990912 as select v7 from semiDown277073922410273667;
create or replace view aggJoin2583693055040468785 as select v45, v5 from semiDown8685813629639650457 join aggView2822933425946990912 using(v7);
create or replace view aggView1947778005281473719 as select v5 from semiDown8988443998980913961;
create or replace view aggJoin1186524748084788209 as select v45 from aggJoin2583693055040468785 join aggView1947778005281473719 using(v5);
create or replace view aggView4451888876944049463 as select v45 from aggJoin9102782562330685129 group by v45;
create or replace view aggJoin7597637716610700943 as select v45, v20, v40 from semiDown8142679591496011962 join aggView4451888876944049463 using(v45);
create or replace view aggView7608247041304933513 as select v20 from semiDown5307653100369351888;
create or replace view aggJoin635276320368958566 as select v45, v40 from aggJoin7597637716610700943 join aggView7608247041304933513 using(v20);
create or replace view aggView7664923039976617747 as select v45, v40, MIN(v40) as v58 from aggJoin635276320368958566 group by v45,v40;
create or replace view aggView782416313930854435 as select v25 from semiDown2133394302802118569;
create or replace view aggJoin5509391624191659707 as select v45, v46 from semiDown8361955545090691476 join aggView782416313930854435 using(v25);
create or replace view aggView508039278387181019 as select v45 from aggJoin1186524748084788209 group by v45;
create or replace view aggJoin6100240081706351195 as select v45, v46 from aggJoin5509391624191659707 join aggView508039278387181019 using(v45);
create or replace view aggView5608328442983020240 as select v46, v45, MIN(v46) as v59 from aggJoin6100240081706351195 group by v46,v45;
create or replace view aggView2028936895058936226 as select v18 from semiDown3522103241559747590;
create or replace view aggJoin7008280684540999863 as select v45 from semiDown6167977351369915123 join aggView2028936895058936226 using(v18);
create or replace view aggView5668627322378390925 as select v45, MIN(v58) as v58 from aggView7664923039976617747 group by v45,v58;
create or replace view aggJoin7577332528307319185 as select v45, v9, v16, v58 from semiDown608135675722075381 join aggView5668627322378390925 using(v45);
create or replace view aggView2811306145581025154 as select v45 from aggJoin7008280684540999863 group by v45;
create or replace view aggJoin6214428914163170191 as select v45, v9, v16, v58 as v58 from aggJoin7577332528307319185 join aggView2811306145581025154 using(v45);
create or replace view aggView3776562555632421401 as select v45, MIN(v59) as v59 from aggView5608328442983020240 group by v45,v59;
create or replace view aggJoin6704826591316207510 as select v9, v16, v58 as v58, v59 from aggJoin6214428914163170191 join aggView3776562555632421401 using(v45);
create or replace view aggView4963307901635607545 as select v16 from semiDown955138176571745499;
create or replace view aggJoin8821385474704157755 as select v9, v58, v59 from aggJoin6704826591316207510 join aggView4963307901635607545 using(v16);
create or replace view aggView2567017016160504855 as select v9, MIN(v58) as v58, MIN(v59) as v59 from aggJoin8821385474704157755 group by v9,v59,v58;
create or replace view aggJoin8993150578402178050 as select v57 as v57, v58, v59 from aggView7815925756734809164 join aggView2567017016160504855 using(v9);
select MIN(v57) as v57, MIN(v58) as v58, MIN(v59) as v59 from aggJoin8993150578402178050;

