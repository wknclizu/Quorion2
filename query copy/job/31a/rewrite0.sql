create or replace view aggView7885527598190191882 as select id as v19 from keyword as k where keyword IN ('murder','violence','blood','gore','death','female-nudity','hospital');
create or replace view aggJoin8333228772366395158 as select movie_id as v49 from movie_keyword as mk, aggView7885527598190191882 where mk.keyword_id=aggView7885527598190191882.v19;
create or replace view aggView5182162197018461079 as select v49 from aggJoin8333228772366395158 group by v49;
create or replace view aggJoin1267984215747542194 as select movie_id as v49, info_type_id as v17, info as v35 from movie_info_idx as mi_idx, aggView5182162197018461079 where mi_idx.movie_id=aggView5182162197018461079.v49;
create or replace view aggView3573771488038048103 as select id as v17 from info_type as it2 where info= 'votes';
create or replace view aggJoin9202385490036362378 as select v49, v35 from aggJoin1267984215747542194 join aggView3573771488038048103 using(v17);
create or replace view aggView2492644384611358019 as select v49, MIN(v35) as v62 from aggJoin9202385490036362378 group by v49;
create or replace view aggJoin942883016908008547 as select id as v49, title as v50, v62 from title as t, aggView2492644384611358019 where t.id=aggView2492644384611358019.v49;
create or replace view aggView1644574734443990903 as select v49, MIN(v62) as v62, MIN(v50) as v64 from aggJoin942883016908008547 group by v49;
create or replace view aggJoin3089947695569343271 as select movie_id as v49, company_id as v8, v62, v64 from movie_companies as mc, aggView1644574734443990903 where mc.movie_id=aggView1644574734443990903.v49;
create or replace view aggView4790563648222686740 as select id as v8 from company_name as cn where name LIKE 'Lionsgate%';
create or replace view aggJoin8289761245807560300 as select v49, v62, v64 from aggJoin3089947695569343271 join aggView4790563648222686740 using(v8);
create or replace view aggView7641847966409825876 as select v49, MIN(v62) as v62, MIN(v64) as v64 from aggJoin8289761245807560300 group by v49;
create or replace view aggJoin1314312900853378346 as select person_id as v40, movie_id as v49, note as v5, v62, v64 from cast_info as ci, aggView7641847966409825876 where ci.movie_id=aggView7641847966409825876.v49 and note IN ('(writer)','(head writer)','(written by)','(story)','(story editor)');
create or replace view aggView5093793404680011417 as select v49, v40, MIN(v62) as v62, MIN(v64) as v64 from aggJoin1314312900853378346 group by v49,v40;
create or replace view aggJoin33222521995005562 as select info_type_id as v15, info as v30, v40, v62, v64 from movie_info as mi, aggView5093793404680011417 where mi.movie_id=aggView5093793404680011417.v49 and info IN ('Horror','Thriller');
create or replace view aggView3444575675749614731 as select id as v15 from info_type as it1 where info= 'genres';
create or replace view aggJoin5773762397299083430 as select v30, v40, v62, v64 from aggJoin33222521995005562 join aggView3444575675749614731 using(v15);
create or replace view aggView7551738170096596149 as select v40, MIN(v62) as v62, MIN(v64) as v64, MIN(v30) as v61 from aggJoin5773762397299083430 group by v40;
create or replace view aggJoin4042689491211735706 as select id as v40, name as v41, gender as v44, v62, v64, v61 from name as n, aggView7551738170096596149 where n.id=aggView7551738170096596149.v40 and gender= 'm';
select MIN(v61) as v61,MIN(v62) as v62,MIN(v41) as v63,MIN(v64) as v64 from aggJoin4042689491211735706;
