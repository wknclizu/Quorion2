create or replace view semiUp2770360052767614415 as select person_id as v31, movie_id as v40, person_role_id as v9 from cast_info AS ci where (person_role_id) in (select id from char_name AS chn where ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%');
create or replace view semiUp3018006366821650013 as select movie_id as v40, subject_id as v5, status_id as v7 from complete_cast AS cc where (subject_id) in (select id from comp_cast_type AS cct1 where kind= 'cast');
create or replace view semiUp904283530253347293 as select v31, v40, v9 from semiUp2770360052767614415 where (v31) in (select id from name AS n);
create or replace view semiUp2665052097377699564 as select movie_id as v40, keyword_id as v23 from movie_keyword AS mk where (keyword_id) in (select id from keyword AS k where keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence'));
create or replace view semiUp8108173164994584812 as select id as v40, title as v41, kind_id as v26 from title AS t where (id) in (select v40 from semiUp2665052097377699564) and production_year>1950;
create or replace view semiUp7810070572645458969 as select v40, v41, v26 from semiUp8108173164994584812 where (v26) in (select id from kind_type AS kt where kind= 'movie');
create or replace view semiUp8377240709940129732 as select v40, v5, v7 from semiUp3018006366821650013 where (v40) in (select v40 from semiUp7810070572645458969);
create or replace view semiUp5014453922213706366 as select v40, v5, v7 from semiUp8377240709940129732 where (v7) in (select id from comp_cast_type AS cct2 where kind LIKE '%complete%');
create or replace view semiUp1086217067021961492 as select v31, v40, v9 from semiUp904283530253347293 where (v40) in (select v40 from semiUp5014453922213706366);
create or replace view semiDown1853560526548969842 as select id as v9 from char_name AS chn where (id) in (select v9 from semiUp1086217067021961492) and ((name LIKE '%Tony%Stark%') OR (name LIKE '%Iron%Man%')) and name NOT LIKE '%Sherlock%';
create or replace view semiDown5691961330642962229 as select v40, v5, v7 from semiUp5014453922213706366 where (v40) in (select v40 from semiUp1086217067021961492);
create or replace view semiDown6852351560838457894 as select id as v31 from name AS n where (id) in (select v31 from semiUp1086217067021961492);
create or replace view semiDown9048067973127005142 as select id as v5 from comp_cast_type AS cct1 where (id) in (select v5 from semiDown5691961330642962229) and kind= 'cast';
create or replace view semiDown7021262440564221731 as select id as v7 from comp_cast_type AS cct2 where (id) in (select v7 from semiDown5691961330642962229) and kind LIKE '%complete%';
create or replace view semiDown8874298354590475807 as select v40, v41, v26 from semiUp7810070572645458969 where (v40) in (select v40 from semiDown5691961330642962229);
create or replace view semiDown742501047957827983 as select id as v26 from kind_type AS kt where (id) in (select v26 from semiDown8874298354590475807) and kind= 'movie';
create or replace view semiDown3715745962961092406 as select v40, v23 from semiUp2665052097377699564 where (v40) in (select v40 from semiDown8874298354590475807);
create or replace view semiDown8977080278701630824 as select id as v23 from keyword AS k where (id) in (select v23 from semiDown3715745962961092406) and keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence');
create or replace view aggView1153800593482309507 as select v23 from semiDown8977080278701630824;
create or replace view aggJoin64351698976745366 as select v40 from semiDown3715745962961092406 join aggView1153800593482309507 using(v23);
create or replace view aggView5535233754265808808 as select v40 from aggJoin64351698976745366 group by v40;
create or replace view aggJoin5922109405214686267 as select v40, v41, v26 from semiDown8874298354590475807 join aggView5535233754265808808 using(v40);
create or replace view aggView5316605756014342386 as select v26 from semiDown742501047957827983;
create or replace view aggJoin7908621355980370702 as select v40, v41 from aggJoin5922109405214686267 join aggView5316605756014342386 using(v26);
create or replace view aggView5428778755840076871 as select v5 from semiDown9048067973127005142;
create or replace view aggJoin805357267545528414 as select v40, v7 from semiDown5691961330642962229 join aggView5428778755840076871 using(v5);
create or replace view aggView3021643824187332093 as select v40, MIN(v41) as v52 from aggJoin7908621355980370702 group by v40;
create or replace view aggJoin1234322418727106442 as select v40, v7, v52 from aggJoin805357267545528414 join aggView3021643824187332093 using(v40);
create or replace view aggView5842802636061432085 as select v7 from semiDown7021262440564221731;
create or replace view aggJoin6267279431454607005 as select v40, v52 from aggJoin1234322418727106442 join aggView5842802636061432085 using(v7);
create or replace view aggView4130834780647657331 as select v9 from semiDown1853560526548969842;
create or replace view aggJoin5232173095012316579 as select v31, v40 from semiUp1086217067021961492 join aggView4130834780647657331 using(v9);
create or replace view aggView6448990263830204862 as select v40, MIN(v52) as v52 from aggJoin6267279431454607005 group by v40,v52;
create or replace view aggJoin3277434445767338021 as select v31, v52 from aggJoin5232173095012316579 join aggView6448990263830204862 using(v40);
create or replace view aggView5706968928115015537 as select v31 from semiDown6852351560838457894;
create or replace view aggJoin1183518545607900238 as select v52 from aggJoin3277434445767338021 join aggView5706968928115015537 using(v31);
select MIN(v52) as v52 from aggJoin1183518545607900238;

