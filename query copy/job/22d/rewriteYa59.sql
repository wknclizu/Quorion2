create or replace view semiUp1036612510511196839 as select movie_id as v37, info_type_id as v12, info as v32 from movie_info_idx AS mi_idx where (info_type_id) in (select id from info_type AS it2 where info= 'rating') and info<'8.5';
create or replace view semiUp8228406592192129758 as select movie_id as v37, info_type_id as v10 from movie_info AS mi where (info_type_id) in (select id from info_type AS it1 where info= 'countries') and info IN ('Sweden','Norway','Germany','Denmark','Swedish','Danish','Norwegian','German','USA','American');
create or replace view cnAux47 as select id as v1, name as v2 from company_name where country_code<> '[us]';
create or replace view semiUp1212730603594667419 as select id as v37, title as v38, kind_id as v17 from title AS t where (kind_id) in (select id from kind_type AS kt where kind IN ('movie','episode')) and production_year>2005;
create or replace view semiUp2188885312671703488 as select v37, v38, v17 from semiUp1212730603594667419 where (v37) in (select v37 from semiUp8228406592192129758);
create or replace view tAux15 as select v37, v38 from semiUp2188885312671703488;
create or replace view semiUp4612605085102732736 as select movie_id as v37, keyword_id as v14 from movie_keyword AS mk where (keyword_id) in (select id from keyword AS k where keyword IN ('murder','murder-in-title','blood','violence'));
create or replace view semiUp3975204490956891225 as select v37, v12, v32 from semiUp1036612510511196839 where (v37) in (select v37 from semiUp4612605085102732736);
create or replace view mi_idxAux38 as select v37, v32 from semiUp3975204490956891225;
create or replace view semiUp3461765523908074662 as select movie_id as v37, company_id as v1, company_type_id as v8 from movie_companies AS mc where (movie_id) in (select v37 from mi_idxAux38);
create or replace view semiUp3157005173499312137 as select v37, v1, v8 from semiUp3461765523908074662 where (v8) in (select id from company_type AS ct);
create or replace view semiUp7269415749533853849 as select v37, v1, v8 from semiUp3157005173499312137 where (v37) in (select v37 from tAux15);
create or replace view semiUp7925853322203039898 as select v1, v2 from cnAux47 where (v1) in (select v1 from semiUp7269415749533853849);
create or replace view semiDown6373378005237539071 as select id as v1, name as v2 from company_name AS cn where (id, name) in (select v1, v2 from semiUp7925853322203039898) and country_code<> '[us]';
create or replace view semiDown9051685376229238116 as select v37, v1, v8 from semiUp7269415749533853849 where (v1) in (select v1 from semiUp7925853322203039898);
create or replace view semiDown3448074984815410067 as select id as v8 from company_type AS ct where (id) in (select v8 from semiDown9051685376229238116);
create or replace view semiDown7751374875310481789 as select v37, v38 from tAux15 where (v37) in (select v37 from semiDown9051685376229238116);
create or replace view semiDown7555950828601806520 as select v37, v32 from mi_idxAux38 where (v37) in (select v37 from semiDown9051685376229238116);
create or replace view semiDown5609946121077708520 as select v37, v38, v17 from semiUp2188885312671703488 where (v37, v38) in (select v37, v38 from semiDown7751374875310481789);
create or replace view semiDown3931764643406902598 as select v37, v12, v32 from semiUp3975204490956891225 where (v32, v37) in (select v32, v37 from semiDown7555950828601806520);
create or replace view semiDown5992939139898898168 as select id as v17 from kind_type AS kt where (id) in (select v17 from semiDown5609946121077708520) and kind IN ('movie','episode');
create or replace view semiDown8452060629353387084 as select v37, v10 from semiUp8228406592192129758 where (v37) in (select v37 from semiDown5609946121077708520);
create or replace view semiDown1494536289437990907 as select id as v12 from info_type AS it2 where (id) in (select v12 from semiDown3931764643406902598) and info= 'rating';
create or replace view semiDown8148522254823140161 as select v37, v14 from semiUp4612605085102732736 where (v37) in (select v37 from semiDown3931764643406902598);
create or replace view semiDown2053852019733146603 as select id as v10 from info_type AS it1 where (id) in (select v10 from semiDown8452060629353387084) and info= 'countries';
create or replace view semiDown3607386574748614695 as select id as v14 from keyword AS k where (id) in (select v14 from semiDown8148522254823140161) and keyword IN ('murder','murder-in-title','blood','violence');
create or replace view aggView2035472420356423519 as select v1, v2, v2 as v49 from semiDown6373378005237539071;
create or replace view aggView2126353898722898620 as select v14 from semiDown3607386574748614695;
create or replace view aggJoin6066040957147724074 as select v37 from semiDown8148522254823140161 join aggView2126353898722898620 using(v14);
create or replace view aggView7436099528367625964 as select v10 from semiDown2053852019733146603;
create or replace view aggJoin8391456207848149628 as select v37 from semiDown8452060629353387084 join aggView7436099528367625964 using(v10);
create or replace view aggView3502532704172195637 as select v37 from aggJoin8391456207848149628 group by v37;
create or replace view aggJoin637183004173762491 as select v37, v38, v17 from semiDown5609946121077708520 join aggView3502532704172195637 using(v37);
create or replace view aggView6572624368479143724 as select v37 from aggJoin6066040957147724074 group by v37;
create or replace view aggJoin5563112929889709768 as select v37, v12, v32 from semiDown3931764643406902598 join aggView6572624368479143724 using(v37);
create or replace view aggView1794049313685681877 as select v12 from semiDown1494536289437990907;
create or replace view aggJoin390659615443491876 as select v37, v32 from aggJoin5563112929889709768 join aggView1794049313685681877 using(v12);
create or replace view aggView4580228520779010751 as select v32, v37, MIN(v32) as v50 from aggJoin390659615443491876 group by v32,v37;
create or replace view aggView427339383604740958 as select v17 from semiDown5992939139898898168;
create or replace view aggJoin4526213080316882262 as select v37, v38 from aggJoin637183004173762491 join aggView427339383604740958 using(v17);
create or replace view aggView4568204437437923244 as select v37, v38, MIN(v38) as v51 from aggJoin4526213080316882262 group by v37,v38;
create or replace view aggView8376431119741881566 as select v37, MIN(v51) as v51 from aggView4568204437437923244 group by v37,v51;
create or replace view aggJoin6689088673224404713 as select v37, v1, v8, v51 from semiDown9051685376229238116 join aggView8376431119741881566 using(v37);
create or replace view aggView4836387721054801373 as select v37, MIN(v50) as v50 from aggView4580228520779010751 group by v37,v50;
create or replace view aggJoin3028041316273987833 as select v1, v8, v51 as v51, v50 from aggJoin6689088673224404713 join aggView4836387721054801373 using(v37);
create or replace view aggView4107515867117894961 as select v8 from semiDown3448074984815410067;
create or replace view aggJoin3831364660461591611 as select v1, v51, v50 from aggJoin3028041316273987833 join aggView4107515867117894961 using(v8);
create or replace view aggView3968905623178715778 as select v1, MIN(v51) as v51, MIN(v50) as v50 from aggJoin3831364660461591611 group by v1,v50,v51;
create or replace view aggJoin7151598102845350051 as select v49 as v49, v51, v50 from aggView2035472420356423519 join aggView3968905623178715778 using(v1);
select MIN(v49) as v49, MIN(v50) as v50, MIN(v51) as v51 from aggJoin7151598102845350051;

