create or replace TEMP view orderswithyearAux36 as select o_orderkey as v38, o_year as v39 from orderswithyear;
create or replace TEMP view nationAux64 as select n_nationkey as v13, n_name as v49 from nation;
create or replace TEMP view semiUp5099028300366640168 as select s_suppkey as v10, s_nationkey as v13 from supplier AS supplier where (s_nationkey) in (select v13 from nationAux64);
create or replace TEMP view semiUp4156886867225794560 as select l_orderkey as v38, l_partkey as v33, l_suppkey as v10, l_quantity as v21, l_extendedprice as v22, l_discount as v23 from lineitem AS lineitem where (l_suppkey) in (select v10 from semiUp5099028300366640168);
create or replace TEMP view semiUp8686703033728429645 as select v38, v33, v10, v21, v22, v23 from semiUp4156886867225794560 where (v33, v10) in (select ps_partkey, ps_suppkey from partsupp AS partsupp);
create or replace TEMP view semiUp5531188621981004500 as select v38, v33, v10, v21, v22, v23 from semiUp8686703033728429645 where (v33) in (select p_partkey from part AS part where (p_name LIKE '%green%'));
create or replace TEMP view semiUp3297968447605318874 as select v38, v39 from orderswithyearAux36 where (v38) in (select v38 from semiUp5531188621981004500);
create or replace TEMP view semiDown3657911142363759523 as select o_orderkey as v38, o_year as v39 from orderswithyear AS orderswithyear where (o_orderkey, o_year) in (select v38, v39 from semiUp3297968447605318874);
create or replace TEMP view semiDown5751343532990556761 as select v38, v33, v10, v21, v22, v23 from semiUp5531188621981004500 where (v38) in (select v38 from semiUp3297968447605318874);
create or replace TEMP view semiDown1523081580986233116 as select v10, v13 from semiUp5099028300366640168 where (v10) in (select v10 from semiDown5751343532990556761);
create or replace TEMP view semiDown2442773701362036750 as select p_partkey as v33 from part AS part where (p_partkey) in (select v33 from semiDown5751343532990556761) and (p_name LIKE '%green%');
create or replace TEMP view semiDown368087965963393829 as select ps_partkey as v33, ps_suppkey as v10, ps_supplycost as v36 from partsupp AS partsupp where (ps_partkey, ps_suppkey) in (select v33, v10 from semiDown5751343532990556761);
create or replace TEMP view semiDown753171775532185644 as select v13, v49 from nationAux64 where (v13) in (select v13 from semiDown1523081580986233116);
create or replace TEMP view semiDown2085989572279569364 as select n_nationkey as v13, n_name as v49 from nation AS nation where (n_nationkey, n_name) in (select v13, v49 from semiDown753171775532185644);
create or replace TEMP view aggView3348143274921295969 as select v13, v49 from semiDown2085989572279569364;
create or replace TEMP view aggView6012057184593884923 as select v38, v39 from semiDown3657911142363759523;
create or replace TEMP view aggView302319592465549860 as select v13, v49, COUNT(*) as annot from aggView3348143274921295969 group by v13,v49;
create or replace TEMP view aggJoin8883890536690871393 as select v10, v49, annot from semiDown1523081580986233116 join aggView302319592465549860 using(v13);
create or replace TEMP view aggView4390894877030897126 as select v10, v49, SUM(annot) as annot from aggJoin8883890536690871393 group by v10,v49;
create or replace TEMP view aggJoin2079633621694854903 as select v38, v33, v10, v21, v22, v23, v49, annot from semiDown5751343532990556761 join aggView4390894877030897126 using(v10);
create or replace TEMP view aggView4753999676401780635 as select v33 from semiDown2442773701362036750;
create or replace TEMP view aggJoin3369101935593927885 as select v38, v33, v10, v21, v22, v23, v49, annot from aggJoin2079633621694854903 join aggView4753999676401780635 using(v33);
create or replace TEMP view aggView381901770880641891 as select v33, v10, v36 from semiDown368087965963393829;
create or replace TEMP view aggJoin1773610815584839967 as select v38, v21, v22, v23, v49, annot, v36 from aggJoin3369101935593927885 join aggView381901770880641891 using(v33,v10);
create or replace TEMP view aggView362423290508414252 as select v38, SUM((v22 * (1 - v23)) * annot) as v54, SUM((v36 * v21) * annot) as v55, v49, SUM(annot) as annot from aggJoin1773610815584839967 group by v38,v49;
create or replace TEMP view aggJoin8073110773546249876 as select v39, v54, v55, v49 from aggView6012057184593884923 join aggView362423290508414252 using(v38);
create or replace TEMP view res as select v49, v39, SUM(v54) as v54, SUM(v55) as v55 from aggJoin8073110773546249876 group by v49, v39;
select sum(v49+v39+v54+v55) from res;
