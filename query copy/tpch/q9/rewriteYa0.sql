create or replace TEMP view orderswithyearAux63 as select o_orderkey as v38, o_year as v39 from orderswithyear;
create or replace TEMP view nationAux92 as select n_nationkey as v13, n_name as v49 from nation;
create or replace TEMP view semiUp9197439458579662442 as select ps_partkey as v33, ps_suppkey as v10, ps_supplycost as v36 from partsupp AS partsupp where (ps_partkey) in (select p_partkey from part AS part where (p_name LIKE '%green%'));
create or replace TEMP view semiUp8432953615182632533 as select s_suppkey as v10, s_nationkey as v13 from supplier AS supplier where (s_nationkey) in (select v13 from nationAux92);
create or replace TEMP view semiUp2178948265909346620 as select l_orderkey as v38, l_partkey as v33, l_suppkey as v10, l_quantity as v21, l_extendedprice as v22, l_discount as v23 from lineitem AS lineitem where (l_partkey, l_suppkey) in (select v33, v10 from semiUp9197439458579662442);
create or replace TEMP view semiUp5551799675189975257 as select v38, v33, v10, v21, v22, v23 from semiUp2178948265909346620 where (v10) in (select v10 from semiUp8432953615182632533);
create or replace TEMP view semiUp6726773829163457014 as select v38, v39 from orderswithyearAux63 where (v38) in (select v38 from semiUp5551799675189975257);
create or replace TEMP view semiDown3271616745954232924 as select o_orderkey as v38, o_year as v39 from orderswithyear AS orderswithyear where (o_orderkey, o_year) in (select v38, v39 from semiUp6726773829163457014);
create or replace TEMP view semiDown8827273097901548239 as select v38, v33, v10, v21, v22, v23 from semiUp5551799675189975257 where (v38) in (select v38 from semiUp6726773829163457014);
create or replace TEMP view semiDown5957311696261334742 as select v10, v13 from semiUp8432953615182632533 where (v10) in (select v10 from semiDown8827273097901548239);
create or replace TEMP view semiDown7853101487534186522 as select v33, v10, v36 from semiUp9197439458579662442 where (v33, v10) in (select v33, v10 from semiDown8827273097901548239);
create or replace TEMP view semiDown4943509647513104395 as select v13, v49 from nationAux92 where (v13) in (select v13 from semiDown5957311696261334742);
create or replace TEMP view semiDown5216325373791502551 as select p_partkey as v33 from part AS part where (p_partkey) in (select v33 from semiDown7853101487534186522) and (p_name LIKE '%green%');
create or replace TEMP view semiDown5177860460142346515 as select n_nationkey as v13, n_name as v49 from nation AS nation where (n_nationkey, n_name) in (select v13, v49 from semiDown4943509647513104395);
create or replace TEMP view aggView1336681170803856846 as select v13, v49 from semiDown5177860460142346515;
create or replace TEMP view aggView505358068150514381 as select v38, v39 from semiDown3271616745954232924;
create or replace TEMP view aggView8363604474099323746 as select v13, v49, COUNT(*) as annot from aggView1336681170803856846 group by v13,v49;
create or replace TEMP view aggJoin3404287852948204374 as select v10, v49, annot from semiDown5957311696261334742 join aggView8363604474099323746 using(v13);
create or replace TEMP view aggView5239109539975000723 as select v33 from semiDown5216325373791502551;
create or replace TEMP view aggJoin2015879521072167517 as select v33, v10, v36 from semiDown7853101487534186522 join aggView5239109539975000723 using(v33);
create or replace TEMP view aggView5995693749014423552 as select v10, v49, SUM(annot) as annot from aggJoin3404287852948204374 group by v10,v49;
create or replace TEMP view aggJoin1682781720348509660 as select v38, v33, v10, v21, v22, v23, v49, annot from semiDown8827273097901548239 join aggView5995693749014423552 using(v10);
create or replace TEMP view aggView2401972226389987492 as select v33, v10, SUM(v36)/COUNT(*) as v36, COUNT(*) as annot from aggJoin2015879521072167517 group by v33,v10;
create or replace TEMP view aggJoin392562346385205369 as select v38, v21, v22, v23, v49, aggJoin1682781720348509660.annot * aggView2401972226389987492.annot as annot, v36 from aggJoin1682781720348509660 join aggView2401972226389987492 using(v33,v10);
create or replace TEMP view aggView3753228245273372715 as select v38, SUM((v22 * (1 - v23)) * annot) as v54, SUM((v36 * v21) * annot) as v55, v49, SUM(annot) as annot from aggJoin392562346385205369 group by v38,v49;
create or replace TEMP view aggJoin1657727634316567474 as select v39, v54, v55, v49 from aggView505358068150514381 join aggView3753228245273372715 using(v38);
create or replace TEMP view res as select v49, v39, SUM(v54) as v54, SUM(v55) as v55 from aggJoin1657727634316567474 group by v49, v39;
select sum(v49+v39+v54+v55) from res;
