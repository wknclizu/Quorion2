create or replace TEMP view semiUp4022769873333651759 as select c_custkey as v34, c_nationkey as v37 from customer AS customer where (c_nationkey) in (select n_nationkey from nation AS n2 where (n_name = 'GERMANY'));
create or replace TEMP view semiUp6161454393059180081 as select o_orderkey as v25, o_custkey as v34 from orders AS orders where (o_custkey) in (select v34 from semiUp4022769873333651759);
create or replace TEMP view semiUp2363517647139397528 as select s_suppkey as v1, s_nationkey as v4 from supplier AS supplier where (s_nationkey) in (select n_nationkey from nation AS n1 where (n_name = 'FRANCE'));
create or replace TEMP view semiUp2994704437667739547 as select l_orderkey as v25, l_year as v9, l_suppkey as v1, l_extendedprice as v14, l_discount as v15 from lineitemwithyear AS lineitemwithyear where (l_orderkey) in (select v25 from semiUp6161454393059180081) and (l_shipdate >= DATE '1994-12-31') and (l_shipdate <= DATE '1996-12-30');
create or replace TEMP view semiUp5802344415252381868 as select v25, v9, v1, v14, v15 from semiUp2994704437667739547 where (v1) in (select v1 from semiUp2363517647139397528);
create or replace TEMP view semiDown4898226002691817737 as select v1, v4 from semiUp2363517647139397528 where (v1) in (select v1 from semiUp5802344415252381868);
create or replace TEMP view semiDown6050625900894416932 as select v25, v34 from semiUp6161454393059180081 where (v25) in (select v25 from semiUp5802344415252381868);
create or replace TEMP view semiDown8172157421696610632 as select n_nationkey as v4, n_name as v43 from nation AS n1 where (n_nationkey) in (select v4 from semiDown4898226002691817737) and (n_name = 'FRANCE');
create or replace TEMP view semiDown5464669860856956007 as select v34, v37 from semiUp4022769873333651759 where (v34) in (select v34 from semiDown6050625900894416932);
create or replace TEMP view semiDown6954878166321875832 as select n_nationkey as v37, n_name as v47 from nation AS n2 where (n_nationkey) in (select v37 from semiDown5464669860856956007) and (n_name = 'GERMANY');
create or replace TEMP view aggView9185788841138157481 as select v37, v47 from semiDown6954878166321875832;
create or replace TEMP view aggJoin2321615882669772444 as select v34, v47 from semiDown5464669860856956007 join aggView9185788841138157481 using(v37);
create or replace TEMP view aggView6911540865090622907 as select v34, v47, COUNT(*) as annot from aggJoin2321615882669772444 group by v34,v47;
create or replace TEMP view aggJoin7461564161494518276 as select v25, v47, annot from semiDown6050625900894416932 join aggView6911540865090622907 using(v34);
create or replace TEMP view aggView5638839056670569995 as select v4, v43 from semiDown8172157421696610632;
create or replace TEMP view aggJoin9027314746932856829 as select v1, v43 from semiDown4898226002691817737 join aggView5638839056670569995 using(v4);
create or replace TEMP view aggView81082532564373280 as select v25, v47, SUM(annot) as annot from aggJoin7461564161494518276 group by v25,v47;
create or replace TEMP view aggJoin2533621642991786004 as select v9, v1, v14, v15, v47, annot from semiUp5802344415252381868 join aggView81082532564373280 using(v25);
create or replace TEMP view aggView4353960639885096251 as select v1, v43, COUNT(*) as annot from aggJoin9027314746932856829 group by v1,v43;
create or replace TEMP view aggJoin3983599409622544 as select v9, v14, v15, v47, aggJoin2533621642991786004.annot * aggView4353960639885096251.annot as annot, v43 from aggJoin2533621642991786004 join aggView4353960639885096251 using(v1);
create or replace TEMP view res as select v43, v47, v9, SUM((v14 * (1 - v15))*annot) as v51 from aggJoin3983599409622544 group by v43, v47, v9;
select sum(v43+v47+v9+v51) from res;
