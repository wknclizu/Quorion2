create or replace TEMP view customerAux72 as select c_custkey as v1, c_name as v2, c_address as v3, c_nationkey as v4, c_phone as v5, c_acctbal as v6, c_comment as v8 from customer;
create or replace TEMP view nationAux13 as select n_nationkey as v4, n_name as v35 from nation;
create or replace TEMP view semiUp4221622316701862806 as select o_orderkey as v18, o_custkey as v1 from orders AS orders where (o_orderkey) in (select l_orderkey from lineitem AS lineitem where l_returnflag= 'R') and o_orderdate>=DATE '1993-10-01' and o_orderdate<DATE '1994-01-01';
create or replace TEMP view semiUp3820084718237346989 as select v1, v2, v3, v4, v5, v6, v8 from customerAux72 where (v4) in (select v4 from nationAux13);
create or replace TEMP view semiUp1619698041557987010 as select v1, v2, v3, v4, v5, v6, v8 from semiUp3820084718237346989 where (v1) in (select v1 from semiUp4221622316701862806);
create or replace TEMP view semiDown1563067248365804677 as select v4, v35 from nationAux13 where (v4) in (select v4 from semiUp1619698041557987010);
create or replace TEMP view semiDown5091391070958160113 as select v18, v1 from semiUp4221622316701862806 where (v1) in (select v1 from semiUp1619698041557987010);
create or replace TEMP view semiDown36658206975000427 as select c_custkey as v1, c_name as v2, c_address as v3, c_nationkey as v4, c_phone as v5, c_acctbal as v6, c_comment as v8 from customer AS customer where (c_address, c_phone, c_nationkey, c_custkey, c_comment, c_acctbal, c_name) in (select v3, v5, v4, v1, v8, v6, v2 from semiUp1619698041557987010);
create or replace TEMP view semiDown3526055475000297372 as select n_nationkey as v4, n_name as v35 from nation AS nation where (n_nationkey, n_name) in (select v4, v35 from semiDown1563067248365804677);
create or replace TEMP view semiDown6905893252069005653 as select l_orderkey as v18, l_extendedprice as v23, l_discount as v24 from lineitem AS lineitem where (l_orderkey) in (select v18 from semiDown5091391070958160113) and l_returnflag= 'R';
create or replace TEMP view aggView875677947264121258 as select v4, v35 from semiDown3526055475000297372;
create or replace TEMP view aggView962000204598852286 as select v3, v5, v4, v1, v8, v6, v2 from semiDown36658206975000427;
create or replace TEMP view aggView3814781133300841727 as select v18, SUM(v23 * (1 - v24)) as v39, COUNT(*) as annot from semiDown6905893252069005653 group by v18;
create or replace TEMP view aggJoin583804020196256779 as select v1, v39, annot from semiDown5091391070958160113 join aggView3814781133300841727 using(v18);
create or replace TEMP view aggView4598313124694492413 as select v1, SUM(v39) as v39, SUM(annot) as annot from aggJoin583804020196256779 group by v1,v39;
create or replace TEMP view aggJoin6624388155545541403 as select v3, v5, v4, v1, v8, v6, v2, v39, annot from aggView962000204598852286 join aggView4598313124694492413 using(v1);
create or replace TEMP view aggView3134194082523884390 as select v4, v35, COUNT(*) as annot from aggView875677947264121258 group by v4,v35;
create or replace TEMP view aggJoin6849638824761008202 as select v3, v5, v1, v8, v6, v2, v39*aggView3134194082523884390.annot as v39, v35 from aggJoin6624388155545541403 join aggView3134194082523884390 using(v4);
select v1,v2,SUM(v39) as v39,v6,v35,v3,v5,v8 from aggJoin6849638824761008202 group by v1, v2, v6, v5, v35, v3, v8;
