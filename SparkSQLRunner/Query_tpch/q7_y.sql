create or replace TEMP view slineitemwithyearB as select lineitem.*, year(l_shipdate) as l_year from lineitem;
create or replace TEMP view n2Aux52 as select n_nationkey as v37, n_name as v47 from nation;
create or replace TEMP view n1Aux69 as select n_nationkey as v4, n_name as v43 from nation where n_name= 'FRANCE';
create or replace TEMP view lineitemwithyearAux66 as select l_orderkey as v25, l_year as v9, l_suppkey as v1 from slineitemwithyearB where l_shipdate>=DATE '1995-01-01' and l_shipdate<=DATE '1996-12-31';
create or replace TEMP view semiUp240653594287581597 as select c_custkey as v34, c_nationkey as v37 from customer AS customer where (c_nationkey) in (select v37 from n2Aux52);
create or replace TEMP view semiUp3065544149035115481 as select o_orderkey as v25, o_custkey as v34 from orders AS orders where (o_custkey) in (select v34 from semiUp240653594287581597);
create or replace TEMP view semiUp2981713595493662179 as select s_suppkey as v1, s_nationkey as v4 from supplier AS supplier where (s_nationkey) in (select v4 from n1Aux69);
create or replace TEMP view semiUp5939173314949130911 as select v25, v9, v1 from lineitemwithyearAux66 where (v1) in (select v1 from semiUp2981713595493662179);
create or replace TEMP view semiUp3461038044848588459 as select v25, v9, v1 from semiUp5939173314949130911 where (v25) in (select v25 from semiUp3065544149035115481);
create or replace TEMP view semiDown6499818523507505018 as select v1, v4 from semiUp2981713595493662179 where (v1) in (select v1 from semiUp3461038044848588459);
create or replace TEMP view semiDown2186088752510330453 as select v25, v34 from semiUp3065544149035115481 where (v25) in (select v25 from semiUp3461038044848588459);
create or replace TEMP view semiDown305559988867089484 as select l_orderkey as v25, l_year as v9, l_suppkey as v1, l_extendedprice as v14, l_discount as v15 from slineitemwithyearB AS slineitemwithyearB where (l_orderkey, l_year, l_suppkey) in (select v25, v9, v1 from semiUp3461038044848588459) and l_shipdate>=DATE '1995-01-01' and l_shipdate<=DATE '1996-12-31';
create or replace TEMP view semiDown5424653868686219296 as select v4, v43 from n1Aux69 where (v4) in (select v4 from semiDown6499818523507505018);
create or replace TEMP view semiDown4611564970626666460 as select v34, v37 from semiUp240653594287581597 where (v34) in (select v34 from semiDown2186088752510330453);
create or replace TEMP view semiDown2686513123726335888 as select n_nationkey as v4, n_name as v43 from nation AS n1 where (n_name, n_nationkey) in (select v43, v4 from semiDown5424653868686219296) and n_name= 'FRANCE';
create or replace TEMP view semiDown216721732704784379 as select v37, v47 from n2Aux52 where (v37) in (select v37 from semiDown4611564970626666460);
create or replace TEMP view semiDown2985325236271150260 as select n_nationkey as v37, n_name as v47 from nation AS n2 where (n_name, n_nationkey) in (select v47, v37 from semiDown216721732704784379);
create or replace TEMP view aggView1559797629960222105 as select v47, v37 from semiDown2985325236271150260;
create or replace TEMP view aggView2630946320163822453 as select v43, v4 from semiDown2686513123726335888;
create or replace TEMP view aggView3714400310144796061 as select v25, v9, v1, SUM(v14 * (1 - v15)) as v51, COUNT(*) as annot from semiDown305559988867089484 group by v25,v9,v1;
create or replace TEMP view aggView6979508871475344197 as select v37, v47, COUNT(*) as annot from aggView1559797629960222105 group by v37,v47;
create or replace TEMP view aggJoin8539392418099409866 as select v34, v47, annot from semiDown4611564970626666460 join aggView6979508871475344197 using(v37);
create or replace TEMP view aggView8469663059266261639 as select v34, v47, SUM(annot) as annot from aggJoin8539392418099409866 group by v34,v47;
create or replace TEMP view aggJoin4809504701092828752 as select v25, v47, annot from semiDown2186088752510330453 join aggView8469663059266261639 using(v34);
create or replace TEMP view aggView6030692489880376855 as select v4, v43, COUNT(*) as annot from aggView2630946320163822453 group by v4,v43;
create or replace TEMP view aggJoin6425617575185560917 as select v1, v43, annot from semiDown6499818523507505018 join aggView6030692489880376855 using(v4);
create or replace TEMP view aggView7226207446649648075 as select v1, v43, SUM(annot) as annot from aggJoin6425617575185560917 group by v1,v43;
create or replace TEMP view aggJoin6289842352016130369 as select v25, v9, v51*aggView7226207446649648075.annot as v51, aggView3714400310144796061.annot * aggView7226207446649648075.annot as annot, v43 from aggView3714400310144796061 join aggView7226207446649648075 using(v1);
create or replace TEMP view aggView69230856145111306 as select v25, v47, SUM(annot) as annot from aggJoin4809504701092828752 group by v25,v47;
create or replace TEMP view aggJoin9025050855398227763 as select v9, v51*aggView69230856145111306.annot as v51, v43, v47 from aggJoin6289842352016130369 join aggView69230856145111306 using(v25);
select v43,v47,v9,SUM(v51) as v51 from aggJoin9025050855398227763 group by v43, v47, v9;
