create or replace TEMP view sorderswithyearT as select orders.*, year(o_orderdate) AS o_year from orders;
create or replace TEMP view aggView3737828779835793622 as select r_regionkey as v53 from region as region where r_name= 'AMERICA';
create or replace TEMP view aggJoin4620466143696971223 as select n_nationkey as v46 from nation as n1, aggView3737828779835793622 where n1.n_regionkey=aggView3737828779835793622.v53;
create or replace TEMP view aggView2886360200790113541 as select n_nationkey as v13, CASE WHEN n_name = 'BRAZIL' THEN 1 ELSE 0 END as caseCond from nation as n2;
create or replace TEMP view aggJoin8358608488843201002 as select s_suppkey as v10, caseCond from supplier as supplier, aggView2886360200790113541 where supplier.s_nationkey=aggView2886360200790113541.v13;
create or replace TEMP view aggView4945353073090408546 as select v46, COUNT(*) as annot from aggJoin4620466143696971223 group by v46;
create or replace TEMP view aggJoin2907873710369692037 as select c_custkey as v35, annot from customer as customer, aggView4945353073090408546 where customer.c_nationkey=aggView4945353073090408546.v46;
create or replace TEMP view aggView5605682994118203562 as select v10, caseCond, COUNT(*) as annot from aggJoin8358608488843201002 group by v10,caseCond;
create or replace TEMP view aggJoin5193205550425335854 as select l_orderkey as v17, l_partkey as v1, l_extendedprice as v22, l_discount as v23, caseCond, annot from lineitem as lineitem, aggView5605682994118203562 where lineitem.l_suppkey=aggView5605682994118203562.v10;
create or replace TEMP view aggView5156645487235845193 as select p_partkey as v1 from part as part where p_type= 'ECONOMY ANODIZED STEEL';
create or replace TEMP view aggJoin3007599949837797922 as select v17, v22, v23, caseCond, annot from aggJoin5193205550425335854 join aggView5156645487235845193 using(v1);
create or replace TEMP view aggView6876003907413059692 as select v17, SUM( CASE WHEN caseCond = 1 THEN v22 * (1 - v23)*annot ELSE 0.0 END) as v64, SUM((v22 * (1 - v23)) * annot) as v65, SUM(annot) as annot from aggJoin3007599949837797922 group by v17;
create or replace TEMP view aggJoin916109096862898072 as select o_year as v34, o_custkey as v35, o_orderdate as v38, v64, v65, annot from sorderswithyearT as sorderswithyearT, aggView6876003907413059692 where sorderswithyearT.o_orderkey=aggView6876003907413059692.v17 and o_orderdate>=DATE '1995-01-01' and o_orderdate<=DATE '1996-12-31';
create or replace TEMP view aggView440273058679111870 as select v35, SUM(annot) as annot from aggJoin2907873710369692037 group by v35;
create or replace TEMP view aggJoin24779522854233527 as select v34, v38, v64*aggView440273058679111870.annot as v64, v65*aggView440273058679111870.annot as v65, aggJoin916109096862898072.annot * aggView440273058679111870.annot as annot from aggJoin916109096862898072 join aggView440273058679111870 using(v35);
create or replace TEMP view aggView4935664575958983835 as select v34, SUM(v64) as v64, SUM(v65) as v65 from aggJoin24779522854233527 group by v34;
select v34,(v64 / v65) as v66 from aggView4935664575958983835;
