create or replace TEMP view sorderswithyearT as select orders.*, year(o_orderdate) AS o_year from orders;
create or replace TEMP view semiUp7294159692613651831 as select l_orderkey as v38, l_partkey as v33, l_suppkey as v10, l_quantity as v21, l_extendedprice as v22, l_discount as v23 from lineitem AS lineitem where (l_suppkey, l_partkey) in (select ps_suppkey, ps_partkey from spartsuppT AS spartsuppT);
create or replace TEMP view semiUp553834438237324084 as select v38, v33, v10, v21, v22, v23 from semiUp7294159692613651831 where (v33) in (select p_partkey from part AS part where p_name LIKE '%green%');
create or replace TEMP view semiUp6748793859913953049 as select v38, v33, v10, v21, v22, v23 from semiUp553834438237324084 where (v38) in (select o_orderkey from sorderswithyearT AS sorderswithyearT);
create or replace TEMP view semiUp8088901043515154840 as select s_suppkey as v10, s_nationkey as v13 from supplier AS supplier where (s_nationkey) in (select n_nationkey from nation AS nation);
create or replace TEMP view semiUp8063162069839986102 as select v38, v33, v10, v21, v22, v23 from semiUp6748793859913953049 where (v10) in (select v10 from semiUp8088901043515154840);
create or replace TEMP view semiDown3387103989827079174 as select v10, v13 from semiUp8088901043515154840 where (v10) in (select v10 from semiUp8063162069839986102);
create or replace TEMP view semiDown1465041634542997480 as select p_partkey as v33 from part AS part where (p_partkey) in (select v33 from semiUp8063162069839986102) and p_name LIKE '%green%';
create or replace TEMP view semiDown1927597099891900796 as select ps_partkey as v33, ps_suppkey as v10, ps_supplycost as v36 from spartsuppT AS spartsuppT where (ps_suppkey, ps_partkey) in (select v10, v33 from semiUp8063162069839986102);
create or replace TEMP view semiDown4839774304138829781 as select o_orderkey as v38, o_year as v39 from sorderswithyearT AS sorderswithyearT where (o_orderkey) in (select v38 from semiUp8063162069839986102);
create or replace TEMP view semiDown5824173447940081845 as select n_nationkey as v13, n_name as v49 from nation AS nation where (n_nationkey) in (select v13 from semiDown3387103989827079174);
create or replace TEMP view aggView2083931764340302341 as select v13, v49 from semiDown5824173447940081845;
create or replace TEMP view aggJoin3664867699762459009 as select v10, v49 from semiDown3387103989827079174 join aggView2083931764340302341 using(v13);
create or replace TEMP view aggView9193988534774136803 as select v10, v33, v36 from semiDown1927597099891900796;
create or replace TEMP view aggJoin160690074034778444 as select v38, v33, v10, v21, v22, v23, v36 from semiUp8063162069839986102 join aggView9193988534774136803 using(v10,v33);
create or replace TEMP view aggView5697848524887435793 as select v38, v39 from semiDown4839774304138829781;
create or replace TEMP view aggJoin9211618843784206417 as select v33, v10, v21, v22, v23, v36, v39 from aggJoin160690074034778444 join aggView5697848524887435793 using(v38);
create or replace TEMP view aggView2285398337343073391 as select v33 from semiDown1465041634542997480;
create or replace TEMP view aggJoin7122535167088256338 as select v10, v21, v22, v23, v36, v39 from aggJoin9211618843784206417 join aggView2285398337343073391 using(v33);
create or replace TEMP view aggView2338117301648112615 as select v10, v49, COUNT(*) as annot from aggJoin3664867699762459009 group by v10,v49;
create or replace TEMP view aggJoin8168763859765620983 as select v21, v22, v23, v36, v39, v49, annot from aggJoin7122535167088256338 join aggView2338117301648112615 using(v10);
select v49,v39,SUM((v22 * (1 - v23))*annot) as v54,SUM((v36 * v21)*annot) as v55 from aggJoin8168763859765620983 group by v49, v39;
