create or replace TEMP view g1 as select Graph.src as v7, Graph.dst as v2, v8 from Graph, (SELECT src, COUNT(*) AS v8 FROM Graph GROUP BY src) AS c1 where Graph.src = c1.src;
create or replace TEMP view orderView7938832639229368850 as select v7, v2, v8, row_number() over (partition by v2 order by v8) as rn from g1;
create or replace TEMP view minView4497886138806397719 as select v2, v8 as mfL4651326926415449229 from orderView7938832639229368850 where rn = 1;
create or replace TEMP view joinView7223075805207106747 as select src as v2, dst as v4, mfL4651326926415449229 from Graph AS g2, minView4497886138806397719 where g2.src=minView4497886138806397719.v2;
create or replace TEMP view g3 as select Graph.src as v4, Graph.dst as v6, v10 from Graph, (SELECT src, COUNT(*) AS v10 FROM Graph GROUP BY src) AS c2 where Graph.dst = c2.src;
create or replace TEMP view orderView8726405684811052686 as select v2, v4, mfL4651326926415449229, row_number() over (partition by v4 order by mfL4651326926415449229) as rn from joinView7223075805207106747;
create or replace TEMP view minView5786534749831677901 as select v4, mfL4651326926415449229 as mfL7929801842919196971 from orderView8726405684811052686 where rn = 1;
create or replace TEMP view joinView7472472702766577246 as select distinct v4, v6, v10, mfL7929801842919196971 from g3 join minView5786534749831677901 using(v4) where mfL7929801842919196971<v10;
create or replace TEMP view sample8299869782033150163 as select * from orderView8726405684811052686 where rn % 5 = 1;
create or replace TEMP view maxRn4507671891897562846 as select v4, max(rn) as mrn from joinView7472472702766577246 join sample8299869782033150163 using(v4) where mfL4651326926415449229<v10 group by v4;
create or replace TEMP view target8261391410146308566 as select v2, v4, mfL4651326926415449229 from orderView8726405684811052686 join maxRn4507671891897562846 using(v4) where rn < mrn + 5;
create or replace TEMP view end353415874630053319 as select distinct v2, v10, v6, mfL4651326926415449229 from joinView7472472702766577246 join target8261391410146308566 using(v4) where mfL4651326926415449229<v10;
create or replace TEMP view sample3626687389819251703 as select * from orderView7938832639229368850 where rn % 5 = 1;
create or replace TEMP view maxRn8835538810088061221 as select v2, max(rn) as mrn from end353415874630053319 join sample3626687389819251703 using(v2) where v8<v10 group by v2;
create or replace TEMP view target7598304377496299981 as select v7, v2, v8 from orderView7938832639229368850 join maxRn8835538810088061221 using(v2) where rn < mrn + 5;
create or replace TEMP view end7329686493270895745 as select v8, v10, v7, v6 from end353415874630053319 join target7598304377496299981 using(v2) where v8<v10;
select distinct v7, v6, v8, v10 from end7329686493270895745;
