create or replace TEMP view semiUp5399569893385684362 as select s_suppkey as v1, s_nationkey as v4 from supplier AS supplier where (s_nationkey) in (select n_nationkey from nation AS n1 where (n_name = 'FRANCE'));
create or replace TEMP view semiUp6012654613283168422 as select l_orderkey as v25, l_year as v9, l_suppkey as v1, l_extendedprice as v14, l_discount as v15 from lineitemwithyear AS lineitemwithyear where (l_suppkey) in (select v1 from semiUp5399569893385684362) and (l_shipdate >= DATE '1994-12-31') and (l_shipdate <= DATE '1996-12-30');
create or replace TEMP view semiUp1391310553116651649 as select o_orderkey as v25, o_custkey as v34 from orders AS orders where (o_orderkey) in (select v25 from semiUp6012654613283168422);
create or replace TEMP view semiUp7757803877586812238 as select c_custkey as v34, c_nationkey as v37 from customer AS customer where (c_custkey) in (select v34 from semiUp1391310553116651649);
create or replace TEMP view semiUp6808801485782067493 as select n_nationkey as v37, n_name as v47 from nation AS n2 where (n_nationkey) in (select v37 from semiUp7757803877586812238) and (n_name = 'GERMANY');
create or replace TEMP view semiDown6627111116567213669 as select v34, v37 from semiUp7757803877586812238 where (v37) in (select v37 from semiUp6808801485782067493);
create or replace TEMP view semiDown7944245352905802273 as select v25, v34 from semiUp1391310553116651649 where (v34) in (select v34 from semiDown6627111116567213669);
create or replace TEMP view semiDown5873479256565464350 as select v25, v9, v1, v14, v15 from semiUp6012654613283168422 where (v25) in (select v25 from semiDown7944245352905802273);
create or replace TEMP view semiDown942459733436122038 as select v1, v4 from semiUp5399569893385684362 where (v1) in (select v1 from semiDown5873479256565464350);
create or replace TEMP view semiDown3528071036526101168 as select n_nationkey as v4, n_name as v43 from nation AS n1 where (n_nationkey) in (select v4 from semiDown942459733436122038) and (n_name = 'FRANCE');
create or replace TEMP view aggView3886417766197869756 as select v4, v43 from semiDown3528071036526101168;
create or replace TEMP view aggJoin1921663549671604992 as select v1, v43 from semiDown942459733436122038 join aggView3886417766197869756 using(v4);
create or replace TEMP view aggView3917059066714585798 as select v1, v43, COUNT(*) as annot from aggJoin1921663549671604992 group by v1,v43;
create or replace TEMP view aggJoin2175256370930065453 as select v25, v9, v14, v15, v43, annot from semiDown5873479256565464350 join aggView3917059066714585798 using(v1);
create or replace TEMP view aggView1607548757918921382 as select v25, SUM((v14 * (1 - v15)) * annot) as v51, v9, v43, SUM(annot) as annot from aggJoin2175256370930065453 group by v25,v9,v43;
create or replace TEMP view aggJoin4679665275118787207 as select v34, v51, v9, v43, annot from semiDown7944245352905802273 join aggView1607548757918921382 using(v25);
create or replace TEMP view aggView1495328870005652599 as select v34, SUM(v51) as v51, v9, v43, SUM(annot) as annot from aggJoin4679665275118787207 group by v34,v9,v43,v51;
create or replace TEMP view aggJoin6194827498148421641 as select v37, v51, v9, v43, annot from semiDown6627111116567213669 join aggView1495328870005652599 using(v34);
create or replace TEMP view aggView8862566572079983504 as select v37, SUM(v51) as v51, v9, v43, SUM(annot) as annot from aggJoin6194827498148421641 group by v37,v9,v43,v51;
create or replace TEMP view aggJoin5660626536651029479 as select v47, v51, v9, v43 from semiUp6808801485782067493 join aggView8862566572079983504 using(v37);
create or replace TEMP view res as select v43, v47, v9, SUM(v51) as v51 from aggJoin5660626536651029479 group by v43, v47, v9;
select sum(v43+v47+v9+v51) from res;
