create or replace TEMP view semiUp1894809539420866109 as select c_custkey as v34, c_nationkey as v37 from customer AS customer where (c_nationkey) in (select n_nationkey from nation AS n2 where (n_name = 'GERMANY'));
create or replace TEMP view semiUp5172694631456745753 as select s_suppkey as v1, s_nationkey as v4 from supplier AS supplier where (s_nationkey) in (select n_nationkey from nation AS n1 where (n_name = 'FRANCE'));
create or replace TEMP view semiUp1482704419843908918 as select l_orderkey as v25, l_year as v9, l_suppkey as v1, l_extendedprice as v14, l_discount as v15 from lineitemwithyear AS lineitemwithyear where (l_suppkey) in (select v1 from semiUp5172694631456745753) and (l_shipdate >= DATE '1994-12-31') and (l_shipdate <= DATE '1996-12-30');
create or replace TEMP view semiUp7965651626083040577 as select o_orderkey as v25, o_custkey as v34 from orders AS orders where (o_custkey) in (select v34 from semiUp1894809539420866109);
create or replace TEMP view semiUp4696503267954429665 as select v25, v9, v1, v14, v15 from semiUp1482704419843908918 where (v25) in (select v25 from semiUp7965651626083040577);
create or replace TEMP view semiDown7751705931765556779 as select v1, v4 from semiUp5172694631456745753 where (v1) in (select v1 from semiUp4696503267954429665);
create or replace TEMP view semiDown1618926035390454097 as select v25, v34 from semiUp7965651626083040577 where (v25) in (select v25 from semiUp4696503267954429665);
create or replace TEMP view semiDown4901236278514628132 as select n_nationkey as v4, n_name as v43 from nation AS n1 where (n_nationkey) in (select v4 from semiDown7751705931765556779) and (n_name = 'FRANCE');
create or replace TEMP view semiDown5874797874506812265 as select v34, v37 from semiUp1894809539420866109 where (v34) in (select v34 from semiDown1618926035390454097);
create or replace TEMP view semiDown536239897740111662 as select n_nationkey as v37, n_name as v47 from nation AS n2 where (n_nationkey) in (select v37 from semiDown5874797874506812265) and (n_name = 'GERMANY');
create or replace TEMP view aggView2392914218029046009 as select v37, v47 from semiDown536239897740111662;
create or replace TEMP view aggJoin9014856228044863452 as select v34, v47 from semiDown5874797874506812265 join aggView2392914218029046009 using(v37);
create or replace TEMP view aggView1487374218540499028 as select v4, v43 from semiDown4901236278514628132;
create or replace TEMP view aggJoin7776154156499250181 as select v1, v43 from semiDown7751705931765556779 join aggView1487374218540499028 using(v4);
create or replace TEMP view aggView7669384391070510752 as select v34, v47, COUNT(*) as annot from aggJoin9014856228044863452 group by v34,v47;
create or replace TEMP view aggJoin4172376286219562568 as select v25, v47, annot from semiDown1618926035390454097 join aggView7669384391070510752 using(v34);
create or replace TEMP view aggView2185851592673943476 as select v1, v43, COUNT(*) as annot from aggJoin7776154156499250181 group by v1,v43;
create or replace TEMP view aggJoin5526722895081433297 as select v25, v9, v14, v15, v43, annot from semiUp4696503267954429665 join aggView2185851592673943476 using(v1);
create or replace TEMP view aggView2296293144382003403 as select v25, v47, SUM(annot) as annot from aggJoin4172376286219562568 group by v25,v47;
create or replace TEMP view aggJoin5975327036550747871 as select v9, v14, v15, v43, aggJoin5526722895081433297.annot * aggView2296293144382003403.annot as annot, v47 from aggJoin5526722895081433297 join aggView2296293144382003403 using(v25);
create or replace TEMP view res as select v43, v47, v9, SUM((v14 * (1 - v15))*annot) as v51 from aggJoin5975327036550747871 group by v43, v47, v9;
select sum(v43+v47+v9+v51) from res;
