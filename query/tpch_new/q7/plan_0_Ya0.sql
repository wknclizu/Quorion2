create or replace TEMP view semiUp7834104769488915986 as select c_custkey as v34, c_nationkey as v37 from customer AS customer where (c_nationkey) in (select n_nationkey from nation AS n2 where (n_name = 'GERMANY'));
create or replace TEMP view semiUp1119776983522185605 as select s_suppkey as v1, s_nationkey as v4 from supplier AS supplier where (s_nationkey) in (select n_nationkey from nation AS n1 where (n_name = 'FRANCE'));
create or replace TEMP view semiUp2634243514880610680 as select l_orderkey as v25, l_year as v9, l_suppkey as v1, l_extendedprice as v14, l_discount as v15 from lineitemwithyear AS lineitemwithyear where (l_suppkey) in (select v1 from semiUp1119776983522185605) and (l_shipdate >= DATE '1994-12-31') and (l_shipdate <= DATE '1996-12-30');
create or replace TEMP view semiUp3700149074395434293 as select o_orderkey as v25, o_custkey as v34 from orders AS orders where (o_orderkey) in (select v25 from semiUp2634243514880610680);
create or replace TEMP view semiUp7249551264646357802 as select v34, v37 from semiUp7834104769488915986 where (v34) in (select v34 from semiUp3700149074395434293);
create or replace TEMP view semiDown5028201267883837538 as select n_nationkey as v37, n_name as v47 from nation AS n2 where (n_nationkey) in (select v37 from semiUp7249551264646357802) and (n_name = 'GERMANY');
create or replace TEMP view semiDown3753219228313448122 as select v25, v34 from semiUp3700149074395434293 where (v34) in (select v34 from semiUp7249551264646357802);
create or replace TEMP view semiDown4822814406364171753 as select v25, v9, v1, v14, v15 from semiUp2634243514880610680 where (v25) in (select v25 from semiDown3753219228313448122);
create or replace TEMP view semiDown321984287652245048 as select v1, v4 from semiUp1119776983522185605 where (v1) in (select v1 from semiDown4822814406364171753);
create or replace TEMP view semiDown5734202181223921163 as select n_nationkey as v4, n_name as v43 from nation AS n1 where (n_nationkey) in (select v4 from semiDown321984287652245048) and (n_name = 'FRANCE');
create or replace TEMP view aggView7225420015714586598 as select v4, v43 from semiDown5734202181223921163;
create or replace TEMP view aggJoin3395399444129666328 as select v1, v43 from semiDown321984287652245048 join aggView7225420015714586598 using(v4);
create or replace TEMP view aggView2624114687756104885 as select v1, v43, COUNT(*) as annot from aggJoin3395399444129666328 group by v1,v43;
create or replace TEMP view aggJoin3469010524890647893 as select v25, v9, v14, v15, v43, annot from semiDown4822814406364171753 join aggView2624114687756104885 using(v1);
create or replace TEMP view aggView4624807310275449322 as select v25, SUM((v14 * (1 - v15)) * annot) as v51, v43, v9, SUM(annot) as annot from aggJoin3469010524890647893 group by v25,v43,v9;
create or replace TEMP view aggJoin1059777881397917216 as select v34, v51, v43, v9, annot from semiDown3753219228313448122 join aggView4624807310275449322 using(v25);
create or replace TEMP view aggView2427463838663309489 as select v34, SUM(v51) as v51, v43, v9, SUM(annot) as annot from aggJoin1059777881397917216 group by v34,v43,v51,v9;
create or replace TEMP view aggJoin2524707786787204812 as select v37, v51, v43, v9, annot from semiUp7249551264646357802 join aggView2427463838663309489 using(v34);
create or replace TEMP view aggView6254684487874179963 as select v37, v47 from semiDown5028201267883837538;
create or replace TEMP view aggJoin763203469153659792 as select v51, v43, v9, v47 from aggJoin2524707786787204812 join aggView6254684487874179963 using(v37);
create or replace TEMP view res as select v43, v47, v9, SUM(v51) as v51 from aggJoin763203469153659792 group by v43, v47, v9;
select sum(v43+v47+v9+v51) from res;
