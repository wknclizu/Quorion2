create or replace TEMP view semiUp5804690256898295458 as select s_suppkey as v1, s_nationkey as v4 from supplier AS supplier where (s_nationkey) in (select n_nationkey from nation AS n1 where (n_name = 'FRANCE'));
create or replace TEMP view semiUp392104391916045621 as select c_custkey as v34, c_nationkey as v37 from customer AS customer where (c_nationkey) in (select n_nationkey from nation AS n2 where (n_name = 'GERMANY'));
create or replace TEMP view semiUp7176591414738202783 as select o_orderkey as v25, o_custkey as v34 from orders AS orders where (o_custkey) in (select v34 from semiUp392104391916045621);
create or replace TEMP view semiUp5906384227246032143 as select l_orderkey as v25, l_year as v9, l_suppkey as v1, l_extendedprice as v14, l_discount as v15 from lineitemwithyear AS lineitemwithyear where (l_orderkey) in (select v25 from semiUp7176591414738202783) and (l_shipdate >= DATE '1994-12-31') and (l_shipdate <= DATE '1996-12-30');
create or replace TEMP view semiUp4021679453284823125 as select v1, v4 from semiUp5804690256898295458 where (v1) in (select v1 from semiUp5906384227246032143);
create or replace TEMP view semiDown7186643797964239153 as select n_nationkey as v4, n_name as v43 from nation AS n1 where (n_nationkey) in (select v4 from semiUp4021679453284823125) and (n_name = 'FRANCE');
create or replace TEMP view semiDown6003783349942859916 as select v25, v9, v1, v14, v15 from semiUp5906384227246032143 where (v1) in (select v1 from semiUp4021679453284823125);
create or replace TEMP view semiDown5544298196073174325 as select v25, v34 from semiUp7176591414738202783 where (v25) in (select v25 from semiDown6003783349942859916);
create or replace TEMP view semiDown7216097581395676506 as select v34, v37 from semiUp392104391916045621 where (v34) in (select v34 from semiDown5544298196073174325);
create or replace TEMP view semiDown1485655203234926454 as select n_nationkey as v37, n_name as v47 from nation AS n2 where (n_nationkey) in (select v37 from semiDown7216097581395676506) and (n_name = 'GERMANY');
create or replace TEMP view aggView375359669284305431 as select v37, v47 from semiDown1485655203234926454;
create or replace TEMP view aggJoin1189059301036801933 as select v34, v47 from semiDown7216097581395676506 join aggView375359669284305431 using(v37);
create or replace TEMP view aggView7153797914789869040 as select v34, v47, COUNT(*) as annot from aggJoin1189059301036801933 group by v34,v47;
create or replace TEMP view aggJoin2712851706350947311 as select v25, v47, annot from semiDown5544298196073174325 join aggView7153797914789869040 using(v34);
create or replace TEMP view aggView7043636021054054402 as select v25, v47, SUM(annot) as annot from aggJoin2712851706350947311 group by v25,v47;
create or replace TEMP view aggJoin7530938975807209206 as select v9, v1, v14, v15, v47, annot from semiDown6003783349942859916 join aggView7043636021054054402 using(v25);
create or replace TEMP view aggView6956997380424631562 as select v4, v43 from semiDown7186643797964239153;
create or replace TEMP view aggJoin3579592113169051261 as select v1, v43 from semiUp4021679453284823125 join aggView6956997380424631562 using(v4);
create or replace TEMP view aggView2414065537396913458 as select v1, SUM((v14 * (1 - v15)) * annot) as v51, v9, v47, SUM(annot) as annot from aggJoin7530938975807209206 group by v1,v9,v47;
create or replace TEMP view aggJoin7508340248002420554 as select v43, v51, v9, v47 from aggJoin3579592113169051261 join aggView2414065537396913458 using(v1);
create or replace TEMP view res as select v43, v47, v9, SUM(v51) as v51 from aggJoin7508340248002420554 group by v43, v47, v9;
select sum(v43+v47+v9+v51) from res;
