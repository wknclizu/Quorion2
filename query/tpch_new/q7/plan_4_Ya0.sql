create or replace TEMP view semiUp1794865211956168835 as select s_suppkey as v1, s_nationkey as v4 from supplier AS supplier where (s_nationkey) in (select n_nationkey from nation AS n1 where (n_name = 'FRANCE'));
create or replace TEMP view semiUp4728558978902659581 as select c_custkey as v34, c_nationkey as v37 from customer AS customer where (c_nationkey) in (select n_nationkey from nation AS n2 where (n_name = 'GERMANY'));
create or replace TEMP view semiUp2490068015404132260 as select o_orderkey as v25, o_custkey as v34 from orders AS orders where (o_custkey) in (select v34 from semiUp4728558978902659581);
create or replace TEMP view semiUp2413467864014478401 as select l_orderkey as v25, l_year as v9, l_suppkey as v1, l_extendedprice as v14, l_discount as v15 from lineitemwithyear AS lineitemwithyear where (l_suppkey) in (select v1 from semiUp1794865211956168835) and (l_shipdate >= DATE '1994-12-31') and (l_shipdate <= DATE '1996-12-30');
create or replace TEMP view semiUp3537416803564984609 as select v25, v34 from semiUp2490068015404132260 where (v25) in (select v25 from semiUp2413467864014478401);
create or replace TEMP view semiDown5784595967951634385 as select v34, v37 from semiUp4728558978902659581 where (v34) in (select v34 from semiUp3537416803564984609);
create or replace TEMP view semiDown4505109622339672143 as select v25, v9, v1, v14, v15 from semiUp2413467864014478401 where (v25) in (select v25 from semiUp3537416803564984609);
create or replace TEMP view semiDown4466997928662496828 as select n_nationkey as v37, n_name as v47 from nation AS n2 where (n_nationkey) in (select v37 from semiDown5784595967951634385) and (n_name = 'GERMANY');
create or replace TEMP view semiDown8713061387008161119 as select v1, v4 from semiUp1794865211956168835 where (v1) in (select v1 from semiDown4505109622339672143);
create or replace TEMP view semiDown2489663793094167735 as select n_nationkey as v4, n_name as v43 from nation AS n1 where (n_nationkey) in (select v4 from semiDown8713061387008161119) and (n_name = 'FRANCE');
create or replace TEMP view aggView6514653023671227385 as select v4, v43 from semiDown2489663793094167735;
create or replace TEMP view aggJoin5000215291910547854 as select v1, v43 from semiDown8713061387008161119 join aggView6514653023671227385 using(v4);
create or replace TEMP view aggView8868016671931539176 as select v37, v47 from semiDown4466997928662496828;
create or replace TEMP view aggJoin5862348726015830558 as select v34, v47 from semiDown5784595967951634385 join aggView8868016671931539176 using(v37);
create or replace TEMP view aggView3345906156667048801 as select v1, v43, COUNT(*) as annot from aggJoin5000215291910547854 group by v1,v43;
create or replace TEMP view aggJoin2209984084539862585 as select v25, v9, v14, v15, v43, annot from semiDown4505109622339672143 join aggView3345906156667048801 using(v1);
create or replace TEMP view aggView3051361334878707638 as select v25, SUM((v14 * (1 - v15)) * annot) as v51, v43, v9, SUM(annot) as annot from aggJoin2209984084539862585 group by v25,v43,v9;
create or replace TEMP view aggJoin3881342736715019762 as select v34, v51, v43, v9, annot from semiUp3537416803564984609 join aggView3051361334878707638 using(v25);
create or replace TEMP view aggView4911498415079009 as select v34, v47, COUNT(*) as annot from aggJoin5862348726015830558 group by v34,v47;
create or replace TEMP view aggJoin9071589294508654229 as select v51*aggView4911498415079009.annot as v51, v43, v9, v47 from aggJoin3881342736715019762 join aggView4911498415079009 using(v34);
create or replace TEMP view res as select v43, v47, v9, SUM(v51) as v51 from aggJoin9071589294508654229 group by v43, v47, v9;
select sum(v43+v47+v9+v51) from res;
