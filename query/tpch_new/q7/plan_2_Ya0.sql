create or replace TEMP view semiUp6361364508285028454 as select c_custkey as v34, c_nationkey as v37 from customer AS customer where (c_nationkey) in (select n_nationkey from nation AS n2 where (n_name = 'GERMANY'));
create or replace TEMP view semiUp8965917488056399469 as select o_orderkey as v25, o_custkey as v34 from orders AS orders where (o_custkey) in (select v34 from semiUp6361364508285028454);
create or replace TEMP view semiUp1007248600085385775 as select l_orderkey as v25, l_year as v9, l_suppkey as v1, l_extendedprice as v14, l_discount as v15 from lineitemwithyear AS lineitemwithyear where (l_orderkey) in (select v25 from semiUp8965917488056399469) and (l_shipdate >= DATE '1994-12-31') and (l_shipdate <= DATE '1996-12-30');
create or replace TEMP view semiUp8288679169645657288 as select s_suppkey as v1, s_nationkey as v4 from supplier AS supplier where (s_suppkey) in (select v1 from semiUp1007248600085385775);
create or replace TEMP view semiUp4573261944481231534 as select n_nationkey as v4, n_name as v43 from nation AS n1 where (n_nationkey) in (select v4 from semiUp8288679169645657288) and (n_name = 'FRANCE');
create or replace TEMP view semiDown8798119849021863611 as select v1, v4 from semiUp8288679169645657288 where (v4) in (select v4 from semiUp4573261944481231534);
create or replace TEMP view semiDown1820502767429338298 as select v25, v9, v1, v14, v15 from semiUp1007248600085385775 where (v1) in (select v1 from semiDown8798119849021863611);
create or replace TEMP view semiDown8436219918658595113 as select v25, v34 from semiUp8965917488056399469 where (v25) in (select v25 from semiDown1820502767429338298);
create or replace TEMP view semiDown6787783638289149381 as select v34, v37 from semiUp6361364508285028454 where (v34) in (select v34 from semiDown8436219918658595113);
create or replace TEMP view semiDown6974171669435455486 as select n_nationkey as v37, n_name as v47 from nation AS n2 where (n_nationkey) in (select v37 from semiDown6787783638289149381) and (n_name = 'GERMANY');
create or replace TEMP view aggView8995049831433361959 as select v37, v47 from semiDown6974171669435455486;
create or replace TEMP view aggJoin6937941499617260893 as select v34, v47 from semiDown6787783638289149381 join aggView8995049831433361959 using(v37);
create or replace TEMP view aggView2114888832758489173 as select v34, v47, COUNT(*) as annot from aggJoin6937941499617260893 group by v34,v47;
create or replace TEMP view aggJoin2432949520124770869 as select v25, v47, annot from semiDown8436219918658595113 join aggView2114888832758489173 using(v34);
create or replace TEMP view aggView380052090661571981 as select v25, v47, SUM(annot) as annot from aggJoin2432949520124770869 group by v25,v47;
create or replace TEMP view aggJoin1774615671639130420 as select v9, v1, v14, v15, v47, annot from semiDown1820502767429338298 join aggView380052090661571981 using(v25);
create or replace TEMP view aggView7184205734685307601 as select v1, SUM((v14 * (1 - v15)) * annot) as v51, v47, v9, SUM(annot) as annot from aggJoin1774615671639130420 group by v1,v47,v9;
create or replace TEMP view aggJoin7514267414096203194 as select v4, v51, v47, v9, annot from semiDown8798119849021863611 join aggView7184205734685307601 using(v1);
create or replace TEMP view aggView2208520667606101035 as select v4, SUM(v51) as v51, v47, v9, SUM(annot) as annot from aggJoin7514267414096203194 group by v4,v47,v51,v9;
create or replace TEMP view aggJoin730876582581867412 as select v43, v51, v47, v9 from semiUp4573261944481231534 join aggView2208520667606101035 using(v4);
create or replace TEMP view res as select v43, v47, v9, SUM(v51) as v51 from aggJoin730876582581867412 group by v43, v47, v9;
select sum(v43+v47+v9+v51) from res;
