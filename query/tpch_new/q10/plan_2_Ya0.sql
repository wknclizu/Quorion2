create or replace TEMP view semiUp1456095199850820080 as select o_orderkey as v18, o_custkey as v1 from orders AS orders where (o_orderkey) in (select l_orderkey from lineitem AS lineitem where (l_returnflag = 'R')) and (o_orderdate >= DATE '1993-09-30') and (o_orderdate < DATE '1993-12-31');
create or replace TEMP view semiUp3327895169795693167 as select c_custkey as v1, c_name as v2, c_address as v3, c_nationkey as v4, c_phone as v5, c_acctbal as v6, c_comment as v8 from customer AS customer where (c_custkey) in (select v1 from semiUp1456095199850820080);
create or replace TEMP view semiUp3784323144789851841 as select n_nationkey as v4, n_name as v35 from nation AS nation where (n_nationkey) in (select v4 from semiUp3327895169795693167);
create or replace TEMP view semiDown2834391443875041174 as select v1, v2, v3, v4, v5, v6, v8 from semiUp3327895169795693167 where (v4) in (select v4 from semiUp3784323144789851841);
create or replace TEMP view semiDown1795338482193827274 as select v18, v1 from semiUp1456095199850820080 where (v1) in (select v1 from semiDown2834391443875041174);
create or replace TEMP view semiDown3789572858422841281 as select l_orderkey as v18, l_extendedprice as v23, l_discount as v24 from lineitem AS lineitem where (l_orderkey) in (select v18 from semiDown1795338482193827274) and (l_returnflag = 'R');
create or replace TEMP view aggView5042586860423225581 as select v18, SUM(v23 * (1 - v24)) as v39, COUNT(*) as annot from semiDown3789572858422841281 group by v18;
create or replace TEMP view aggJoin3969961186363356491 as select v1, v39, annot from semiDown1795338482193827274 join aggView5042586860423225581 using(v18);
create or replace TEMP view aggView7427124735262436445 as select v1, SUM(v39) as v39, SUM(annot) as annot from aggJoin3969961186363356491 group by v1,v39;
create or replace TEMP view aggJoin1725381699426260633 as select v1, v2, v3, v4, v5, v6, v8, v39, annot from semiDown2834391443875041174 join aggView7427124735262436445 using(v1);
create or replace TEMP view aggView7695512740004354646 as select v4, SUM(v39) as v39, v8, v1, v5, v6, v3, v2, SUM(annot) as annot from aggJoin1725381699426260633 group by v4,v8,v1,v5,v6,v3,v39,v2;
create or replace TEMP view aggJoin8051133646166114085 as select v35, v39, v8, v1, v5, v6, v3, v2 from semiUp3784323144789851841 join aggView7695512740004354646 using(v4);
create or replace TEMP view res as select v1, v2, SUM(v39) as v39, v6, v35, v3, v5, v8 from aggJoin8051133646166114085 group by v1, v2, v6, v5, v35, v3, v8;
select sum(v1+v2+v39+v6+v35+v3+v5+v8) from res;
