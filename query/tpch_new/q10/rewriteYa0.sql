create or replace TEMP view nationAux65 as select n_nationkey as v4, n_name as v35 from nation;
create or replace TEMP view customerAux61 as select c_custkey as v1, c_name as v2, c_address as v3, c_nationkey as v4, c_phone as v5, c_acctbal as v6, c_comment as v8 from customer;
create or replace TEMP view semiUp7979151973287516524 as select o_orderkey as v18, o_custkey as v1 from orders AS orders where (o_orderkey) in (select l_orderkey from lineitem AS lineitem where (l_returnflag = 'R')) and (o_orderdate >= DATE '1993-09-30') and (o_orderdate < DATE '1993-12-31');
create or replace TEMP view semiUp515440008247692715 as select v1, v2, v3, v4, v5, v6, v8 from customerAux61 where (v4) in (select v4 from nationAux65);
create or replace TEMP view semiUp1085358954233346739 as select v1, v2, v3, v4, v5, v6, v8 from semiUp515440008247692715 where (v1) in (select v1 from semiUp7979151973287516524);
create or replace TEMP view semiDown3641476249893941446 as select v4, v35 from nationAux65 where (v4) in (select v4 from semiUp1085358954233346739);
create or replace TEMP view semiDown496728990966734335 as select v18, v1 from semiUp7979151973287516524 where (v1) in (select v1 from semiUp1085358954233346739);
create or replace TEMP view semiDown6451914251609191655 as select c_custkey as v1, c_name as v2, c_address as v3, c_nationkey as v4, c_phone as v5, c_acctbal as v6, c_comment as v8 from customer AS customer where (c_comment, c_nationkey, c_name, c_phone, c_address, c_acctbal, c_custkey) in (select v8, v4, v2, v5, v3, v6, v1 from semiUp1085358954233346739);
create or replace TEMP view semiDown2266222210177552810 as select n_nationkey as v4, n_name as v35 from nation AS nation where (n_name, n_nationkey) in (select v35, v4 from semiDown3641476249893941446);
create or replace TEMP view semiDown267244971886950157 as select l_orderkey as v18, l_extendedprice as v23, l_discount as v24 from lineitem AS lineitem where (l_orderkey) in (select v18 from semiDown496728990966734335) and (l_returnflag = 'R');
create or replace TEMP view aggView3611159246583829079 as select v35, v4 from semiDown2266222210177552810;
create or replace TEMP view aggView3778282604142317741 as select v8, v4, v2, v5, v3, v6, v1 from semiDown6451914251609191655;
create or replace TEMP view aggView6215452578239266975 as select v18, SUM(v23 * (1 - v24)) as v39, COUNT(*) as annot from semiDown267244971886950157 group by v18;
create or replace TEMP view aggJoin7306197534836866273 as select v1, v39, annot from semiDown496728990966734335 join aggView6215452578239266975 using(v18);
create or replace TEMP view aggView7894447835544363077 as select v4, v35, COUNT(*) as annot from aggView3611159246583829079 group by v4,v35;
create or replace TEMP view aggJoin4341672899145483845 as select v8, v2, v5, v3, v6, v1, v35, annot from aggView3778282604142317741 join aggView7894447835544363077 using(v4);
create or replace TEMP view aggView6046833514209278716 as select v1, SUM(v39) as v39, SUM(annot) as annot from aggJoin7306197534836866273 group by v1,v39;
create or replace TEMP view aggJoin955822476800485172 as select v8, v2, v5, v3, v6, v1, v35, v39 * aggJoin4341672899145483845.annot as v39 from aggJoin4341672899145483845 join aggView6046833514209278716 using(v1);
create or replace TEMP view res as select v1, v2, SUM(v39) as v39, v6, v35, v3, v5, v8 from aggJoin955822476800485172 group by v1, v2, v6, v5, v35, v3, v8;
select sum(v1+v2+v39+v6+v35+v3+v5+v8) from res;
