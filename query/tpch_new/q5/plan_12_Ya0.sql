create or replace TEMP view semiUp4932282144025278112 as select n_nationkey as v4, n_name as v42, n_regionkey as v43 from nation AS nation where (n_regionkey) in (select r_regionkey from region AS region where (r_name = 'ASIA'));
create or replace TEMP view semiUp872599431650434173 as select s_suppkey as v20, s_nationkey as v4 from supplier AS supplier where (s_nationkey) in (select v4 from semiUp4932282144025278112);
create or replace TEMP view semiUp6524817044541523064 as select l_orderkey as v18, l_suppkey as v20, l_extendedprice as v23, l_discount as v24 from lineitem AS lineitem where (l_orderkey) in (select o_orderkey from orders AS orders where (o_orderdate >= DATE '1993-12-31') and (o_orderdate < DATE '1994-12-31'));
create or replace TEMP view semiUp66945759874053143 as select v20, v4 from semiUp872599431650434173 where (v20) in (select v20 from semiUp6524817044541523064);
create or replace TEMP view semiUp2000890858990463701 as select c_custkey as v1, c_nationkey as v4 from customer AS customer where (c_nationkey) in (select v4 from semiUp66945759874053143);
create or replace TEMP view semiDown4463962962985030433 as select v20, v4 from semiUp66945759874053143 where (v4) in (select v4 from semiUp2000890858990463701);
create or replace TEMP view semiDown1928251413456059056 as select v4, v42, v43 from semiUp4932282144025278112 where (v4) in (select v4 from semiDown4463962962985030433);
create or replace TEMP view semiDown3443221630466614739 as select v18, v20, v23, v24 from semiUp6524817044541523064 where (v20) in (select v20 from semiDown4463962962985030433);
create or replace TEMP view semiDown4839037667633419375 as select r_regionkey as v43 from region AS region where (r_regionkey) in (select v43 from semiDown1928251413456059056) and (r_name = 'ASIA');
create or replace TEMP view semiDown1857647737054034590 as select o_orderkey as v18, o_custkey as v1 from orders AS orders where (o_orderkey) in (select v18 from semiDown3443221630466614739) and (o_orderdate >= DATE '1993-12-31') and (o_orderdate < DATE '1994-12-31');
create or replace TEMP view aggView497358341156517109 as select v43 from semiDown4839037667633419375;
create or replace TEMP view aggJoin262333821279327653 as select v4, v42 from semiDown1928251413456059056 join aggView497358341156517109 using(v43);
create or replace TEMP view aggView8438051184459549726 as select v18, v1 from semiDown1857647737054034590;
create or replace TEMP view aggJoin8518808913461949282 as select v20, v23, v24, v1 from semiDown3443221630466614739 join aggView8438051184459549726 using(v18);
create or replace TEMP view aggView5904383596658431563 as select v4, v42, COUNT(*) as annot from aggJoin262333821279327653 group by v4,v42;
create or replace TEMP view aggJoin9080472767403348677 as select v20, v4, v42, annot from semiDown4463962962985030433 join aggView5904383596658431563 using(v4);
create or replace TEMP view aggView6607239262477183196 as select v20, v1, SUM(v23 * (1 - v24)) as v49, COUNT(*) as annot from aggJoin8518808913461949282 group by v20,v1;
create or replace TEMP view aggJoin8832042142088485517 as select v4, v42, aggJoin9080472767403348677.annot * aggView6607239262477183196.annot as annot, v1, v49 * aggJoin9080472767403348677.annot as v49 from aggJoin9080472767403348677 join aggView6607239262477183196 using(v20);
create or replace TEMP view aggView3330994093986762023 as select v4, v1, SUM(v49) as v49, v42, SUM(annot) as annot from aggJoin8832042142088485517 group by v4,v1,v49,v42;
create or replace TEMP view aggJoin4202711689466060290 as select v1, v49, v42 from semiUp2000890858990463701 join aggView3330994093986762023 using(v4,v1);
create or replace TEMP view res as select v42, SUM(v49) as v49 from aggJoin4202711689466060290 group by v42;
select sum(v42+v49) from res;
