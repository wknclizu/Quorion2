create or replace TEMP view semiUp363599689646337133 as select o_orderkey as v18, o_custkey as v1 from orders AS orders where (o_custkey) in (select c_custkey from customer AS customer) and (o_orderdate >= DATE '1993-12-31') and (o_orderdate < DATE '1994-12-31');
create or replace TEMP view semiUp1580751020498778874 as select l_orderkey as v18, l_suppkey as v20, l_extendedprice as v23, l_discount as v24 from lineitem AS lineitem where (l_orderkey) in (select v18 from semiUp363599689646337133);
create or replace TEMP view semiUp3677431363088401934 as select s_suppkey as v20, s_nationkey as v4 from supplier AS supplier where (s_suppkey) in (select v20 from semiUp1580751020498778874);
create or replace TEMP view semiUp5152097536568464240 as select n_nationkey as v4, n_name as v42, n_regionkey as v43 from nation AS nation where (n_nationkey) in (select v4 from semiUp3677431363088401934);
create or replace TEMP view semiUp2809273502467184688 as select r_regionkey as v43 from region AS region where (r_regionkey) in (select v43 from semiUp5152097536568464240) and (r_name = 'ASIA');
create or replace TEMP view semiDown5275043582271962279 as select v4, v42, v43 from semiUp5152097536568464240 where (v43) in (select v43 from semiUp2809273502467184688);
create or replace TEMP view semiDown2545685683867635003 as select v20, v4 from semiUp3677431363088401934 where (v4) in (select v4 from semiDown5275043582271962279);
create or replace TEMP view semiDown5161141106521215586 as select v18, v20, v23, v24 from semiUp1580751020498778874 where (v20) in (select v20 from semiDown2545685683867635003);
create or replace TEMP view semiDown6974189572016787943 as select v18, v1 from semiUp363599689646337133 where (v18) in (select v18 from semiDown5161141106521215586);
create or replace TEMP view semiDown7444567651144872471 as select c_custkey as v1, c_nationkey as v4 from customer AS customer where (c_custkey) in (select v1 from semiDown6974189572016787943);
create or replace TEMP view aggView7031564029318801653 as select v1, v4 from semiDown7444567651144872471;
create or replace TEMP view aggJoin8122205059993843387 as select v18, v4 from semiDown6974189572016787943 join aggView7031564029318801653 using(v1);
create or replace TEMP view aggView551454873916267452 as select v18, v4, COUNT(*) as annot from aggJoin8122205059993843387 group by v18,v4;
create or replace TEMP view aggJoin7306918480881893477 as select v20, v23, v24, v4, annot from semiDown5161141106521215586 join aggView551454873916267452 using(v18);
create or replace TEMP view aggView5917158854310182560 as select v20, v4, SUM((v23 * (1 - v24)) * annot) as v49, SUM(annot) as annot from aggJoin7306918480881893477 group by v20,v4;
create or replace TEMP view aggJoin6378847157022786289 as select v4, v49, annot from semiDown2545685683867635003 join aggView5917158854310182560 using(v20,v4);
create or replace TEMP view aggView4252326841523780709 as select v4, SUM(v49) as v49, SUM(annot) as annot from aggJoin6378847157022786289 group by v4,v49;
create or replace TEMP view aggJoin2635443765410692749 as select v4, v42, v43, v49, annot from semiDown5275043582271962279 join aggView4252326841523780709 using(v4);
create or replace TEMP view aggView2940578610611366205 as select v43, SUM(v49) as v49, v42, SUM(annot) as annot from aggJoin2635443765410692749 group by v43,v49,v42;
create or replace TEMP view aggJoin2612296831464605345 as select v49, v42 from semiUp2809273502467184688 join aggView2940578610611366205 using(v43);
create or replace TEMP view res as select v42, SUM(v49) as v49 from aggJoin2612296831464605345 group by v42;
select sum(v42+v49) from res;
