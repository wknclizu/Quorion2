create or replace TEMP view semiUp4389444816886685662 as select c_custkey as v1, c_nationkey as v4 from customer AS customer where (c_custkey) in (select o_custkey from orders AS orders where (o_orderdate >= DATE '1993-12-31') and (o_orderdate < DATE '1994-12-31'));
create or replace TEMP view semiUp8902805525699277626 as select n_nationkey as v4, n_name as v42, n_regionkey as v43 from nation AS nation where (n_regionkey) in (select r_regionkey from region AS region where (r_name = 'ASIA'));
create or replace TEMP view semiUp7388220687824533648 as select s_suppkey as v20, s_nationkey as v4 from supplier AS supplier where (s_nationkey) in (select v4 from semiUp4389444816886685662);
create or replace TEMP view semiUp7667213958627213385 as select v20, v4 from semiUp7388220687824533648 where (v4) in (select v4 from semiUp8902805525699277626);
create or replace TEMP view semiUp3675028095015918745 as select l_orderkey as v18, l_suppkey as v20, l_extendedprice as v23, l_discount as v24 from lineitem AS lineitem where (l_suppkey) in (select v20 from semiUp7667213958627213385);
create or replace TEMP view semiDown3425889074833870543 as select v20, v4 from semiUp7667213958627213385 where (v20) in (select v20 from semiUp3675028095015918745);
create or replace TEMP view semiDown2873190442057662895 as select v4, v42, v43 from semiUp8902805525699277626 where (v4) in (select v4 from semiDown3425889074833870543);
create or replace TEMP view semiDown3378262196642937066 as select v1, v4 from semiUp4389444816886685662 where (v4) in (select v4 from semiDown3425889074833870543);
create or replace TEMP view semiDown8143128732946928591 as select r_regionkey as v43 from region AS region where (r_regionkey) in (select v43 from semiDown2873190442057662895) and (r_name = 'ASIA');
create or replace TEMP view semiDown1178474645245203152 as select o_orderkey as v18, o_custkey as v1 from orders AS orders where (o_custkey) in (select v1 from semiDown3378262196642937066) and (o_orderdate >= DATE '1993-12-31') and (o_orderdate < DATE '1994-12-31');
create or replace TEMP view aggView7844553145215215823 as select v1, v18, COUNT(*) as annot from semiDown1178474645245203152 group by v1,v18;
create or replace TEMP view aggJoin7024327186938340346 as select v4, v18, annot from semiDown3378262196642937066 join aggView7844553145215215823 using(v1);
create or replace TEMP view aggView2315322882869349977 as select v43 from semiDown8143128732946928591;
create or replace TEMP view aggJoin6903783226028966114 as select v4, v42 from semiDown2873190442057662895 join aggView2315322882869349977 using(v43);
create or replace TEMP view aggView2301591898652505297 as select v4, v42, COUNT(*) as annot from aggJoin6903783226028966114 group by v4,v42;
create or replace TEMP view aggJoin2365088996076331592 as select v20, v4, v42, annot from semiDown3425889074833870543 join aggView2301591898652505297 using(v4);
create or replace TEMP view aggView5470818714542737305 as select v4, v18, SUM(annot) as annot from aggJoin7024327186938340346 group by v4,v18;
create or replace TEMP view aggJoin8871328696525875932 as select v20, v42, aggJoin2365088996076331592.annot * aggView5470818714542737305.annot as annot, v18 from aggJoin2365088996076331592 join aggView5470818714542737305 using(v4);
create or replace TEMP view aggView8368867947288609235 as select v20, v18, v42, SUM(annot) as annot from aggJoin8871328696525875932 group by v20,v18,v42;
create or replace TEMP view aggJoin2396647316882767713 as select v18, v23, v24, v42, annot from semiUp3675028095015918745 join aggView8368867947288609235 using(v20,v18);
create or replace TEMP view res as select v42, SUM((v23 * (1 - v24))*annot) as v49 from aggJoin2396647316882767713 group by v42;
select sum(v42+v49) from res;
