create or replace TEMP view semiUp2031847041004283973 as select n_nationkey as v4, n_name as v42, n_regionkey as v43 from nation AS nation where (n_regionkey) in (select r_regionkey from region AS region where (r_name = 'ASIA'));
create or replace TEMP view semiUp8917785682525035565 as select s_suppkey as v20, s_nationkey as v4 from supplier AS supplier where (s_nationkey) in (select v4 from semiUp2031847041004283973);
create or replace TEMP view semiUp473609767643015783 as select o_orderkey as v18, o_custkey as v1 from orders AS orders where (o_custkey) in (select c_custkey from customer AS customer) and (o_orderdate >= DATE '1993-12-31') and (o_orderdate < DATE '1994-12-31');
create or replace TEMP view semiUp3589590644369454802 as select l_orderkey as v18, l_suppkey as v20, l_extendedprice as v23, l_discount as v24 from lineitem AS lineitem where (l_orderkey) in (select v18 from semiUp473609767643015783);
create or replace TEMP view semiUp7856929459097810161 as select v20, v4 from semiUp8917785682525035565 where (v20) in (select v20 from semiUp3589590644369454802);
create or replace TEMP view semiDown8227219700200074310 as select v4, v42, v43 from semiUp2031847041004283973 where (v4) in (select v4 from semiUp7856929459097810161);
create or replace TEMP view semiDown8743180238320145446 as select v18, v20, v23, v24 from semiUp3589590644369454802 where (v20) in (select v20 from semiUp7856929459097810161);
create or replace TEMP view semiDown2047615139343492592 as select r_regionkey as v43 from region AS region where (r_regionkey) in (select v43 from semiDown8227219700200074310) and (r_name = 'ASIA');
create or replace TEMP view semiDown2317452111957889494 as select v18, v1 from semiUp473609767643015783 where (v18) in (select v18 from semiDown8743180238320145446);
create or replace TEMP view semiDown7562045191898745924 as select c_custkey as v1, c_nationkey as v4 from customer AS customer where (c_custkey) in (select v1 from semiDown2317452111957889494);
create or replace TEMP view aggView648369978980609154 as select v1, v4 from semiDown7562045191898745924;
create or replace TEMP view aggJoin6323553278319979208 as select v18, v4 from semiDown2317452111957889494 join aggView648369978980609154 using(v1);
create or replace TEMP view aggView6020911466985977407 as select v43 from semiDown2047615139343492592;
create or replace TEMP view aggJoin5047468218515278363 as select v4, v42 from semiDown8227219700200074310 join aggView6020911466985977407 using(v43);
create or replace TEMP view aggView910288176287480501 as select v18, v4, COUNT(*) as annot from aggJoin6323553278319979208 group by v18,v4;
create or replace TEMP view aggJoin303337923490351776 as select v20, v23, v24, v4, annot from semiDown8743180238320145446 join aggView910288176287480501 using(v18);
create or replace TEMP view aggView7323126476421939781 as select v4, v42, COUNT(*) as annot from aggJoin5047468218515278363 group by v4,v42;
create or replace TEMP view aggJoin8363244055553039313 as select v20, v4, v42, annot from semiUp7856929459097810161 join aggView7323126476421939781 using(v4);
create or replace TEMP view aggView4807979163869453423 as select v4, v20, SUM((v23 * (1 - v24)) * annot) as v49, SUM(annot) as annot from aggJoin303337923490351776 group by v4,v20;
create or replace TEMP view aggJoin185002005772936650 as select v4, v42, v49 * aggJoin8363244055553039313.annot as v49 from aggJoin8363244055553039313 join aggView4807979163869453423 using(v4,v20);
create or replace TEMP view res as select v42, SUM(v49) as v49 from aggJoin185002005772936650 group by v42;
select sum(v42+v49) from res;
