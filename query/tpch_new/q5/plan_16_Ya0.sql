create or replace TEMP view semiUp4013731189845998097 as select s_suppkey as v20, s_nationkey as v4 from supplier AS supplier where (s_nationkey) in (select c_nationkey from customer AS customer);
create or replace TEMP view semiUp2620829740881404308 as select l_orderkey as v18, l_suppkey as v20, l_extendedprice as v23, l_discount as v24 from lineitem AS lineitem where (l_orderkey) in (select o_orderkey from orders AS orders where (o_orderdate >= DATE '1993-12-31') and (o_orderdate < DATE '1994-12-31'));
create or replace TEMP view semiUp5508516153635472915 as select v20, v4 from semiUp4013731189845998097 where (v20) in (select v20 from semiUp2620829740881404308);
create or replace TEMP view semiUp1914448705138950281 as select n_nationkey as v4, n_name as v42, n_regionkey as v43 from nation AS nation where (n_nationkey) in (select v4 from semiUp5508516153635472915);
create or replace TEMP view semiUp8335151879585560700 as select r_regionkey as v43 from region AS region where (r_regionkey) in (select v43 from semiUp1914448705138950281) and (r_name = 'ASIA');
create or replace TEMP view semiDown6748815554075284452 as select v4, v42, v43 from semiUp1914448705138950281 where (v43) in (select v43 from semiUp8335151879585560700);
create or replace TEMP view semiDown9085478340202970678 as select v20, v4 from semiUp5508516153635472915 where (v4) in (select v4 from semiDown6748815554075284452);
create or replace TEMP view semiDown2211552497385026539 as select c_custkey as v1, c_nationkey as v4 from customer AS customer where (c_nationkey) in (select v4 from semiDown9085478340202970678);
create or replace TEMP view semiDown1427357682756121154 as select v18, v20, v23, v24 from semiUp2620829740881404308 where (v20) in (select v20 from semiDown9085478340202970678);
create or replace TEMP view semiDown5982511380054603208 as select o_orderkey as v18, o_custkey as v1 from orders AS orders where (o_orderkey) in (select v18 from semiDown1427357682756121154) and (o_orderdate >= DATE '1993-12-31') and (o_orderdate < DATE '1994-12-31');
create or replace TEMP view aggView7346569623857408200 as select v18, v1 from semiDown5982511380054603208;
create or replace TEMP view aggJoin3892285051800031488 as select v20, v23, v24, v1 from semiDown1427357682756121154 join aggView7346569623857408200 using(v18);
create or replace TEMP view aggView8663734842824449093 as select v20, v1, SUM(v23 * (1 - v24)) as v49, COUNT(*) as annot from aggJoin3892285051800031488 group by v20,v1;
create or replace TEMP view aggJoin2309196300102979701 as select v4, v1, v49, annot from semiDown9085478340202970678 join aggView8663734842824449093 using(v20);
create or replace TEMP view aggView3873965663887385408 as select v4, v1, COUNT(*) as annot from semiDown2211552497385026539 group by v4,v1;
create or replace TEMP view aggJoin3210291834514648108 as select v4, v1, v49*aggView3873965663887385408.annot as v49, aggJoin2309196300102979701.annot * aggView3873965663887385408.annot as annot from aggJoin2309196300102979701 join aggView3873965663887385408 using(v4,v1);
create or replace TEMP view aggView3023369258395734545 as select v4, SUM(v49) as v49, SUM(annot) as annot from aggJoin3210291834514648108 group by v4,v49;
create or replace TEMP view aggJoin6942395038006399069 as select v42, v43, v49, annot from semiDown6748815554075284452 join aggView3023369258395734545 using(v4);
create or replace TEMP view aggView3204109922689484202 as select v43, SUM(v49) as v49, v42, SUM(annot) as annot from aggJoin6942395038006399069 group by v43,v42,v49;
create or replace TEMP view aggJoin8880125367370806812 as select v49, v42 from semiUp8335151879585560700 join aggView3204109922689484202 using(v43);
create or replace TEMP view res as select v42, SUM(v49) as v49 from aggJoin8880125367370806812 group by v42;
select sum(v42+v49) from res;
