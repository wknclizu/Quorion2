create or replace TEMP view semiUp1775258224605116752 as select s_suppkey as v10, s_nationkey as v13 from supplier AS supplier where (s_nationkey) in (select n_nationkey from nation AS nation);
create or replace TEMP view semiUp3093385740652692807 as select l_orderkey as v38, l_partkey as v33, l_suppkey as v10, l_quantity as v21, l_extendedprice as v22, l_discount as v23 from lineitem AS lineitem where (l_orderkey) in (select o_orderkey from orderswithyear AS orderswithyear);
create or replace TEMP view semiUp3123014960462483120 as select ps_partkey as v33, ps_suppkey as v10, ps_supplycost as v36 from partsupp AS partsupp where (ps_suppkey) in (select v10 from semiUp1775258224605116752);
create or replace TEMP view semiUp5154514391866047835 as select v33, v10, v36 from semiUp3123014960462483120 where (v33) in (select p_partkey from part AS part where (p_name LIKE '%green%'));
create or replace TEMP view semiUp4176992226079960502 as select v38, v33, v10, v21, v22, v23 from semiUp3093385740652692807 where (v10, v33) in (select v10, v33 from semiUp5154514391866047835);
create or replace TEMP view semiDown5030078449870048772 as select v33, v10, v36 from semiUp5154514391866047835 where (v10, v33) in (select v10, v33 from semiUp4176992226079960502);
create or replace TEMP view semiDown5064294040560770120 as select o_orderkey as v38, o_year as v39 from orderswithyear AS orderswithyear where (o_orderkey) in (select v38 from semiUp4176992226079960502);
create or replace TEMP view semiDown1680169418682770999 as select v10, v13 from semiUp1775258224605116752 where (v10) in (select v10 from semiDown5030078449870048772);
create or replace TEMP view semiDown8514963353001463306 as select p_partkey as v33 from part AS part where (p_partkey) in (select v33 from semiDown5030078449870048772) and (p_name LIKE '%green%');
create or replace TEMP view semiDown8813107986292385457 as select n_nationkey as v13, n_name as v49 from nation AS nation where (n_nationkey) in (select v13 from semiDown1680169418682770999);
create or replace TEMP view aggView6560148016673767479 as select v13, v49 from semiDown8813107986292385457;
create or replace TEMP view aggJoin3126554321587626716 as select v10, v49 from semiDown1680169418682770999 join aggView6560148016673767479 using(v13);
create or replace TEMP view aggView8411499491258023077 as select v10, v49, COUNT(*) as annot from aggJoin3126554321587626716 group by v10,v49;
create or replace TEMP view aggJoin2084144584135360280 as select v33, v10, v36, v49, annot from semiDown5030078449870048772 join aggView8411499491258023077 using(v10);
create or replace TEMP view aggView3928108062070804624 as select v33 from semiDown8514963353001463306;
create or replace TEMP view aggJoin7940583515898033951 as select v33, v10, v36, v49, annot from aggJoin2084144584135360280 join aggView3928108062070804624 using(v33);
create or replace TEMP view aggView505409845485149266 as select v38, v39 from semiDown5064294040560770120;
create or replace TEMP view aggJoin7449508117751906832 as select v33, v10, v21, v22, v23, v39 from semiUp4176992226079960502 join aggView505409845485149266 using(v38);
create or replace TEMP view aggView8990007212810307480 as select v10, v33, SUM(v36)/COUNT(*) as v36, v49, SUM(annot) as annot from aggJoin7940583515898033951 group by v10,v33,v49;
create or replace TEMP view aggJoin441588511790147358 as select v21, v22, v23, v39, v36, v49, annot from aggJoin7449508117751906832 join aggView8990007212810307480 using(v10,v33);
create or replace TEMP view res as select v49, v39, SUM((v22 * (1 - v23))*annot) as v54, SUM((v36 * v21)*annot) as v55 from aggJoin441588511790147358 group by v49, v39;
select sum(v49+v39+v54+v55) from res;
