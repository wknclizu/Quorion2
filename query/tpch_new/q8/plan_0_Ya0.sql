create or replace TEMP view semiUp7611034010533517232 as select l_orderkey as v17, l_partkey as v1, l_suppkey as v10, l_extendedprice as v22, l_discount as v23 from lineitem AS lineitem where (l_partkey) in (select p_partkey from part AS part where (p_type = 'ECONOMY ANODIZED STEEL'));
create or replace TEMP view semiUp7763522112529067681 as select s_suppkey as v10, s_nationkey as v13 from supplier AS supplier where (s_nationkey) in (select n_nationkey from nation AS n2);
create or replace TEMP view semiUp5708633467748133642 as select v17, v1, v10, v22, v23 from semiUp7611034010533517232 where (v10) in (select v10 from semiUp7763522112529067681);
create or replace TEMP view semiUp8773247903798114192 as select n_nationkey as v46, n_regionkey as v53 from nation AS n1 where (n_regionkey) in (select r_regionkey from region AS region where (r_name = 'AMERICA'));
create or replace TEMP view semiUp352520162628187038 as select o_orderkey as v17, o_year as v34, o_custkey as v35 from orderswithyear AS orderswithyear where (o_orderkey) in (select v17 from semiUp5708633467748133642) and (o_orderdate >= DATE '1994-12-31') and (o_orderdate <= DATE '1996-12-30');
create or replace TEMP view semiUp509173056189412709 as select c_custkey as v35, c_nationkey as v46 from customer AS customer where (c_custkey) in (select v35 from semiUp352520162628187038);
create or replace TEMP view semiUp4623031703509819562 as select v35, v46 from semiUp509173056189412709 where (v46) in (select v46 from semiUp8773247903798114192);
create or replace TEMP view semiDown5870494772908014662 as select v46, v53 from semiUp8773247903798114192 where (v46) in (select v46 from semiUp4623031703509819562);
create or replace TEMP view semiDown8572960264169517907 as select v17, v34, v35 from semiUp352520162628187038 where (v35) in (select v35 from semiUp4623031703509819562);
create or replace TEMP view semiDown7336337071001834904 as select r_regionkey as v53 from region AS region where (r_regionkey) in (select v53 from semiDown5870494772908014662) and (r_name = 'AMERICA');
create or replace TEMP view semiDown2589405584361855533 as select v17, v1, v10, v22, v23 from semiUp5708633467748133642 where (v17) in (select v17 from semiDown8572960264169517907);
create or replace TEMP view semiDown4602961192769033351 as select p_partkey as v1 from part AS part where (p_partkey) in (select v1 from semiDown2589405584361855533) and (p_type = 'ECONOMY ANODIZED STEEL');
create or replace TEMP view semiDown1079617476980994501 as select v10, v13 from semiUp7763522112529067681 where (v10) in (select v10 from semiDown2589405584361855533);
create or replace TEMP view semiDown8286486890980324968 as select n_nationkey as v13, n_name as v56 from nation AS n2 where (n_nationkey) in (select v13 from semiDown1079617476980994501);
create or replace TEMP view aggView2362834620266258539 as select v13, CASE WHEN v56 = 'BRAZIL' THEN 1 ELSE 0 END as caseCond from semiDown8286486890980324968;
create or replace TEMP view aggJoin5142748655747741903 as select v10, caseCond from semiDown1079617476980994501 join aggView2362834620266258539 using(v13);
create or replace TEMP view aggView7335437271738240527 as select v10, caseCond, COUNT(*) as annot from aggJoin5142748655747741903 group by v10,caseCond;
create or replace TEMP view aggJoin4650099639727407658 as select v17, v1, v22, v23, caseCond, annot from semiDown2589405584361855533 join aggView7335437271738240527 using(v10);
create or replace TEMP view aggView4195254953484338833 as select v53 from semiDown7336337071001834904;
create or replace TEMP view aggJoin2997351440282631453 as select v46 from semiDown5870494772908014662 join aggView4195254953484338833 using(v53);
create or replace TEMP view aggView8233219527366527623 as select v1 from semiDown4602961192769033351;
create or replace TEMP view aggJoin6651358419173007837 as select v17, v22, v23, caseCond, annot from aggJoin4650099639727407658 join aggView8233219527366527623 using(v1);
create or replace TEMP view aggView4742853487248875949 as select v17, SUM( CASE WHEN caseCond = 1 THEN v22 * (1 - v23)*annot ELSE 0.0 END) as v64, SUM((v22 * (1 - v23)) * annot) as v65, SUM(annot) as annot from aggJoin6651358419173007837 group by v17;
create or replace TEMP view aggJoin6461597199339192852 as select v34, v35, v64, v65, annot from semiDown8572960264169517907 join aggView4742853487248875949 using(v17);
create or replace TEMP view aggView7868859198897743577 as select v35, SUM(v64) as v64, SUM(v65) as v65, v34, SUM(annot) as annot from aggJoin6461597199339192852 group by v35,v34;
create or replace TEMP view aggJoin5821151369450948576 as select v46, v64, v65, v34, annot from semiUp4623031703509819562 join aggView7868859198897743577 using(v35);
create or replace TEMP view aggView3713283620790147911 as select v46, COUNT(*) as annot from aggJoin2997351440282631453 group by v46;
create or replace TEMP view aggJoin1746480496970738424 as select v64*aggView3713283620790147911.annot as v64, v65*aggView3713283620790147911.annot as v65, v34 from aggJoin5821151369450948576 join aggView3713283620790147911 using(v46);
create or replace TEMP view res as select v34, (SUM(v66) as  / SUM(v66) as ) as v66 from aggJoin1746480496970738424 group by v34;
select sum(v34+ / SUM(v66)) from res;
