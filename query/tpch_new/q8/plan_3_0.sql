create or replace TEMP view aggView4405781064967178616 as select r_regionkey as v53 from region as region where (r_name = 'AMERICA');
create or replace TEMP view aggJoin828603745208807765 as select n_nationkey as v46 from nation as n1, aggView4405781064967178616 where n1.n_regionkey=aggView4405781064967178616.v53;
create or replace TEMP view aggView3767124539022884671 as select v46, COUNT(*) as annot from aggJoin828603745208807765 group by v46;
create or replace TEMP view aggJoin3288890626035172647 as select c_custkey as v35, annot from customer as customer, aggView3767124539022884671 where customer.c_nationkey=aggView3767124539022884671.v46;
create or replace TEMP view aggView4546028815255238897 as select v35, SUM(annot) as annot from aggJoin3288890626035172647 group by v35;
create or replace TEMP view aggJoin8597214895154625431 as select o_orderkey as v17, o_year as v34, o_orderdate as v38, annot from orderswithyear as orderswithyear, aggView4546028815255238897 where orderswithyear.o_custkey=aggView4546028815255238897.v35 and (o_orderdate >= DATE '1994-12-31') and (o_orderdate <= DATE '1996-12-30');
create or replace TEMP view aggView212126649193026401 as select p_partkey as v1 from part as part where (p_type = 'ECONOMY ANODIZED STEEL');
create or replace TEMP view aggJoin3661950660606513231 as select l_orderkey as v17, l_suppkey as v10, l_extendedprice as v22, l_discount as v23 from lineitem as lineitem, aggView212126649193026401 where lineitem.l_partkey=aggView212126649193026401.v1;
create or replace TEMP view semiJoinView7604974207250571399 as select v17, v10, v22, v23, (v22 * (1 - v23)) as v65 from aggJoin3661950660606513231 where (v17) in (select v17 from aggJoin8597214895154625431);
create or replace TEMP view semiJoinView3476410373523893487 as select s_suppkey as v10, s_nationkey as v13 from supplier AS supplier where (s_suppkey) in (select v10 from semiJoinView7604974207250571399);
create or replace TEMP view semiJoinView5486825073719007572 as select distinct n_nationkey as v13, n_name as v56 from nation AS n2 where (n_nationkey) in (select v13 from semiJoinView3476410373523893487);
create or replace TEMP view semiEnum6828109448089012267 as select distinct v10, v56 from semiJoinView5486825073719007572 join semiJoinView3476410373523893487 using(v13);
create or replace TEMP view semiEnum6231439726591328781 as select distinct v22, v23, v56, v17, v65 from semiEnum6828109448089012267 join semiJoinView7604974207250571399 using(v10);
create or replace TEMP view semiEnum3574491949275965157 as select v22, v34, v23, v56, annot, v65*aggJoin8597214895154625431.annot as v65 from semiEnum6231439726591328781 join aggJoin8597214895154625431 using(v17);
create or replace TEMP view res as select v34, (SUM(CASE WHEN (v56 = 'BRAZIL') THEN (v22 * (1 - v23)) ELSE 0.0 END* annot) / SUM(v66)) as v66 from semiEnum3574491949275965157 group by v34;
select sum(v34+v66) from res;
