create or replace TEMP view semiUp2264578002814663329 as select s_suppkey as v10, s_nationkey as v13 from supplier AS supplier where (s_nationkey) in (select n_nationkey from nation AS n2);
create or replace TEMP view semiUp5669091565717045866 as select l_orderkey as v17, l_partkey as v1, l_suppkey as v10, l_extendedprice as v22, l_discount as v23 from lineitem AS lineitem where (l_partkey) in (select p_partkey from part AS part where (p_type = 'ECONOMY ANODIZED STEEL'));
create or replace TEMP view semiUp7242361253579912254 as select n_nationkey as v46, n_regionkey as v53 from nation AS n1 where (n_regionkey) in (select r_regionkey from region AS region where (r_name = 'AMERICA'));
create or replace TEMP view semiUp6495099131856711900 as select c_custkey as v35, c_nationkey as v46 from customer AS customer where (c_nationkey) in (select v46 from semiUp7242361253579912254);
create or replace TEMP view semiUp6289080114459300972 as select o_orderkey as v17, o_year as v34, o_custkey as v35 from orderswithyear AS orderswithyear where (o_custkey) in (select v35 from semiUp6495099131856711900) and (o_orderdate >= DATE '1994-12-31') and (o_orderdate <= DATE '1996-12-30');
create or replace TEMP view semiUp8976643126504979107 as select v17, v1, v10, v22, v23 from semiUp5669091565717045866 where (v17) in (select v17 from semiUp6289080114459300972);
create or replace TEMP view semiUp5583754748205211032 as select v10, v13 from semiUp2264578002814663329 where (v10) in (select v10 from semiUp8976643126504979107);
create or replace TEMP view semiDown8153170678637700119 as select n_nationkey as v13, n_name as v56 from nation AS n2 where (n_nationkey) in (select v13 from semiUp5583754748205211032);
create or replace TEMP view semiDown7463294419162657954 as select v17, v1, v10, v22, v23 from semiUp8976643126504979107 where (v10) in (select v10 from semiUp5583754748205211032);
create or replace TEMP view semiDown1965134011099198034 as select p_partkey as v1 from part AS part where (p_partkey) in (select v1 from semiDown7463294419162657954) and (p_type = 'ECONOMY ANODIZED STEEL');
create or replace TEMP view semiDown5139360279980586863 as select v17, v34, v35 from semiUp6289080114459300972 where (v17) in (select v17 from semiDown7463294419162657954);
create or replace TEMP view semiDown7638221773172192359 as select v35, v46 from semiUp6495099131856711900 where (v35) in (select v35 from semiDown5139360279980586863);
create or replace TEMP view semiDown2279189840930948953 as select v46, v53 from semiUp7242361253579912254 where (v46) in (select v46 from semiDown7638221773172192359);
create or replace TEMP view semiDown5909376723015375569 as select r_regionkey as v53 from region AS region where (r_regionkey) in (select v53 from semiDown2279189840930948953) and (r_name = 'AMERICA');
create or replace TEMP view aggView5575059688742723088 as select v53 from semiDown5909376723015375569;
create or replace TEMP view aggJoin979734800935245410 as select v46 from semiDown2279189840930948953 join aggView5575059688742723088 using(v53);
create or replace TEMP view aggView7740594255067941494 as select v46, COUNT(*) as annot from aggJoin979734800935245410 group by v46;
create or replace TEMP view aggJoin9211863123691204106 as select v35, annot from semiDown7638221773172192359 join aggView7740594255067941494 using(v46);
create or replace TEMP view aggView5077112642553443076 as select v35, SUM(annot) as annot from aggJoin9211863123691204106 group by v35;
create or replace TEMP view aggJoin5058483721116802948 as select v17, v34, annot from semiDown5139360279980586863 join aggView5077112642553443076 using(v35);
create or replace TEMP view aggView1453896713423660952 as select v1 from semiDown1965134011099198034;
create or replace TEMP view aggJoin7114669919444934078 as select v17, v10, v22, v23 from semiDown7463294419162657954 join aggView1453896713423660952 using(v1);
create or replace TEMP view aggView4703107781285659763 as select v13, CASE WHEN v56 = 'BRAZIL' THEN 1 ELSE 0 END as caseCond from semiDown8153170678637700119;
create or replace TEMP view aggJoin4788885593135599486 as select v10, caseCond from semiUp5583754748205211032 join aggView4703107781285659763 using(v13);
create or replace TEMP view aggView304064986986266303 as select v17, v34, SUM(annot) as annot from aggJoin5058483721116802948 group by v17,v34;
create or replace TEMP view aggJoin5510172545101940630 as select v10, v22, v23, v34, annot from aggJoin7114669919444934078 join aggView304064986986266303 using(v17);
create or replace TEMP view aggView5403632455452688389 as select v10, v22 * (1 - v23)*annot as caseRes, SUM((v22 * (1 - v23)) * annot) as v65, v34, SUM(annot) as annot from aggJoin5510172545101940630 group by v10,v34,caseRes;
create or replace TEMP view aggJoin4030564265713873584 as select caseCond, caseRes, v65, v34, annot from aggJoin4788885593135599486 join aggView5403632455452688389 using(v10);
create or replace TEMP view res as select v34, (SUM(CASE WHEN (v56 = 'BRAZIL') THEN (v22 * (1 - v23)) ELSE 0.0 END*annot) as v66 / SUM(v66) as ) as v66 from aggJoin4030564265713873584 group by v34;
select sum(v34+v66 / SUM(v66)) from res;
