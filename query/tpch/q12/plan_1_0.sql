create or replace TEMP view aggView821477116638265701 as select l_orderkey as v1, l_shipmode as v24, COUNT(*) as annot from lineitem as lineitem where (l_shipmode IN ('MAIL','SHIP')) and (l_receiptdate >= DATE '1993-12-31') and (l_shipdate < l_commitdate) and (l_receiptdate < DATE '1994-12-31') and (l_commitdate < l_receiptdate) group by l_orderkey,v24;
create or replace TEMP view aggJoin2005852303026106889 as select o_orderpriority as v6, v24, annot from orders as orders, aggView821477116638265701 where orders.o_orderkey=aggView821477116638265701.v1;
create or replace TEMP view res as select v24, SUM(CASE WHEN (v6 IN ('1-URGENT','2-HIGH')) THEN 1 ELSE 0 END*annot) as v28, SUM(CASE WHEN (v6 NOT IN ('1-URGENT','2-HIGH')) THEN 1 ELSE 0 END*annot) as v29 from aggJoin2005852303026106889 group by v24;
select sum(v24+v28+v29) from res;