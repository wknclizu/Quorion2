create or replace TEMP view semiUp5994075857106984840 as select o_orderkey as v18, o_custkey as v1, o_orderdate as v13, o_shippriority as v16 from orders AS orders where (o_custkey) in (select c_custkey from customer AS customer where (c_mktsegment = 'BUILDING')) and (o_orderdate < DATE '1995-03-14');
create or replace TEMP view semiUp6093592030810111133 as select l_orderkey as v18, l_extendedprice as v23, l_discount as v24 from lineitem AS lineitem where (l_orderkey) in (select v18 from semiUp5994075857106984840) and (l_shipdate > DATE '1995-03-14');
create or replace TEMP view semiDown682137777788782891 as select v18, v1, v13, v16 from semiUp5994075857106984840 where (v18) in (select v18 from semiUp6093592030810111133);
create or replace TEMP view semiDown5459953556249523768 as select c_custkey as v1 from customer AS customer where (c_custkey) in (select v1 from semiDown682137777788782891) and (c_mktsegment = 'BUILDING');
create or replace TEMP view aggView1432858674820432397 as select v1 from semiDown5459953556249523768;
create or replace TEMP view aggJoin1413948461630160701 as select v18, v13, v16 from semiDown682137777788782891 join aggView1432858674820432397 using(v1);
create or replace TEMP view aggView6336541571155981512 as select v18, v13, v16, COUNT(*) as annot from aggJoin1413948461630160701 group by v18,v13,v16;
create or replace TEMP view aggJoin242424326044156677 as select v18, v23, v24, v13, v16, annot from semiUp6093592030810111133 join aggView6336541571155981512 using(v18);
create or replace TEMP view res as select v18, SUM((v23 * (1 - v24))*annot) as v35, v13, v16 from aggJoin242424326044156677 group by v18, v13, v16;
select sum(v18+v35+v13+v16) from res;
