create or replace TEMP view semiUp2985813919752216182 as select n_nationkey as v4, n_name as v42, n_regionkey as v43 from nation AS nation where (n_regionkey) in (select r_regionkey from region AS region where (r_name = 'ASIA'));
create or replace TEMP view semiUp1466743675760480262 as select c_custkey as v1, c_nationkey as v4 from customer AS customer where (c_nationkey) in (select v4 from semiUp2985813919752216182);
create or replace TEMP view semiUp1835781651446416693 as select l_orderkey as v18, l_suppkey as v20, l_extendedprice as v23, l_discount as v24 from lineitem AS lineitem where (l_suppkey) in (select s_suppkey from supplier AS supplier);
create or replace TEMP view semiUp3514647786548166645 as select o_orderkey as v18, o_custkey as v1 from orders AS orders where (o_custkey) in (select v1 from semiUp1466743675760480262) and (o_orderdate >= DATE '1993-12-31') and (o_orderdate < DATE '1994-12-31');
create or replace TEMP view semiUp4912735586684783056 as select v18, v20, v23, v24 from semiUp1835781651446416693 where (v18) in (select v18 from semiUp3514647786548166645);
create or replace TEMP view semiDown8283550664649654920 as select s_suppkey as v20, s_nationkey as v51 from supplier AS supplier where (s_suppkey) in (select v20 from semiUp4912735586684783056);
create or replace TEMP view semiDown5957470502013590690 as select v18, v1 from semiUp3514647786548166645 where (v18) in (select v18 from semiUp4912735586684783056);
create or replace TEMP view semiDown8044059455070156028 as select v1, v4 from semiUp1466743675760480262 where (v1) in (select v1 from semiDown5957470502013590690);
create or replace TEMP view semiDown5308288470988932970 as select v4, v42, v43 from semiUp2985813919752216182 where (v4) in (select v4 from semiDown8044059455070156028);
create or replace TEMP view semiDown587057048320328530 as select r_regionkey as v43 from region AS region where (r_regionkey) in (select v43 from semiDown5308288470988932970) and (r_name = 'ASIA');
create or replace TEMP view aggView8892705928070524159 as select v43 from semiDown587057048320328530;
create or replace TEMP view aggJoin2260201190722116167 as select v4, v42 from semiDown5308288470988932970 join aggView8892705928070524159 using(v43);
create or replace TEMP view aggView5116668431996384153 as select v4, v42, COUNT(*) as annot from aggJoin2260201190722116167 group by v4,v42;
create or replace TEMP view aggJoin4086900303180330899 as select v1, v4, v42, annot from semiDown8044059455070156028 join aggView5116668431996384153 using(v4);
create or replace TEMP view aggView683737540966697969 as select v1, v4, v42, SUM(annot) as annot from aggJoin4086900303180330899 group by v1,v4,v42;
create or replace TEMP view aggJoin2859970176537123485 as select v18, v4, v42, annot from semiDown5957470502013590690 join aggView683737540966697969 using(v1);
create or replace TEMP view aggView76642229788299168 as select v20, v51 from semiDown8283550664649654920;
create or replace TEMP view aggJoin6179347931953696006 as select v18, v23, v24, v51 from semiUp4912735586684783056 join aggView76642229788299168 using(v20);
create or replace TEMP view aggView5613271228957796383 as select v18, v4, v42, SUM(annot) as annot from aggJoin2859970176537123485 group by v18,v4,v42;
create or replace TEMP view aggJoin3325797075744472931 as select v23, v24, v42, annot from aggJoin6179347931953696006 join aggView5613271228957796383 using(v18) where v4 = v51;
create or replace TEMP view res as select v42, SUM((v23 * (1 - v24))*annot) as v49 from aggJoin3325797075744472931 group by v42;
select sum(v42+v49) from res;
