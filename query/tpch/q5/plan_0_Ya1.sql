create or replace TEMP view semiUp4206064612750439424 as select n_nationkey as v4, n_name as v42, n_regionkey as v43 from nation AS nation where (n_regionkey) in (select r_regionkey from region AS region where (r_name = 'ASIA'));
create or replace TEMP view semiUp8270679494332043634 as select c_custkey as v1, c_nationkey as v4 from customer AS customer where (c_nationkey) in (select v4 from semiUp4206064612750439424);
create or replace TEMP view semiUp4090051317059948254 as select l_orderkey as v18, l_suppkey as v20, l_extendedprice as v23, l_discount as v24 from lineitem AS lineitem where (l_suppkey) in (select s_suppkey from supplier AS supplier);
create or replace TEMP view semiUp1333789682712028055 as select o_orderkey as v18, o_custkey as v1 from orders AS orders where (o_custkey) in (select v1 from semiUp8270679494332043634) and (o_orderdate >= DATE '1993-12-31') and (o_orderdate < DATE '1994-12-31');
create or replace TEMP view semiUp1379261092491303819 as select v18, v20, v23, v24 from semiUp4090051317059948254 where (v18) in (select v18 from semiUp1333789682712028055);
create or replace TEMP view semiDown6708780779627134881 as select s_suppkey as v20, s_nationkey as v51 from supplier AS supplier where (s_suppkey) in (select v20 from semiUp1379261092491303819);
create or replace TEMP view semiDown148370511591021691 as select v18, v1 from semiUp1333789682712028055 where (v18) in (select v18 from semiUp1379261092491303819);
create or replace TEMP view semiDown6459184188808507447 as select v1, v4 from semiUp8270679494332043634 where (v1) in (select v1 from semiDown148370511591021691);
create or replace TEMP view semiDown6964692775036308356 as select v4, v42, v43 from semiUp4206064612750439424 where (v4) in (select v4 from semiDown6459184188808507447);
create or replace TEMP view semiDown5976457487893958799 as select r_regionkey as v43 from region AS region where (r_regionkey) in (select v43 from semiDown6964692775036308356) and (r_name = 'ASIA');
create or replace TEMP view aggView1230365113832136637 as select v43 from semiDown5976457487893958799;
create or replace TEMP view aggJoin5688416474825220821 as select v4, v42 from semiDown6964692775036308356 join aggView1230365113832136637 using(v43);
create or replace TEMP view aggView7157009969508022936 as select v4, v42, COUNT(*) as annot from aggJoin5688416474825220821 group by v4,v42;
create or replace TEMP view aggJoin7548861217593505138 as select v1, v4, v42, annot from semiDown6459184188808507447 join aggView7157009969508022936 using(v4);
create or replace TEMP view aggView8036908066318487596 as select v1, v4, v42, SUM(annot) as annot from aggJoin7548861217593505138 group by v1,v4,v42;
create or replace TEMP view aggJoin4288201231870446354 as select v18, v4, v42, annot from semiDown148370511591021691 join aggView8036908066318487596 using(v1);
create or replace TEMP view aggView5453420171070876740 as select v18, v4, v42, SUM(annot) as annot from aggJoin4288201231870446354 group by v18,v4,v42;
create or replace TEMP view aggJoin8887514546124047428 as select v20, v23, v24, v4, v42, annot from semiUp1379261092491303819 join aggView5453420171070876740 using(v18);
create or replace TEMP view aggView1415217627832445539 as select v20, v51 from semiDown6708780779627134881;
create or replace TEMP view aggJoin6907238017202933628 as select v23, v24, v42, annot from aggJoin8887514546124047428 join aggView1415217627832445539 using(v20) where v4 = v51;
create or replace TEMP view res as select v42, SUM((v23 * (1 - v24))*annot) as v49 from aggJoin6907238017202933628 group by v42;
select sum(v42+v49) from res;
