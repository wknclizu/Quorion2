create or replace TEMP view semiUp1507144414171157801 as select o_orderkey as v18, o_custkey as v1 from orders AS orders where (o_custkey) in (select c_custkey from customer AS customer) and (o_orderdate >= DATE '1993-12-31') and (o_orderdate < DATE '1994-12-31');
create or replace TEMP view semiUp1451160230378405134 as select l_orderkey as v18, l_suppkey as v20, l_extendedprice as v23, l_discount as v24 from lineitem AS lineitem where (l_orderkey) in (select v18 from semiUp1507144414171157801);
create or replace TEMP view semiUp2820420271338400791 as select n_nationkey as v4, n_name as v42, n_regionkey as v43 from nation AS nation where (n_regionkey) in (select r_regionkey from region AS region where (r_name = 'ASIA'));
create or replace TEMP view semiUp201857439237225463 as select s_suppkey as v20, s_nationkey as v4 from supplier AS supplier where (s_nationkey) in (select v4 from semiUp2820420271338400791);
create or replace TEMP view semiUp2845004745137521371 as select v18, v20, v23, v24 from semiUp1451160230378405134 where (v20) in (select v20 from semiUp201857439237225463);
create or replace TEMP view semiDown4972126794732183659 as select v20, v4 from semiUp201857439237225463 where (v20) in (select v20 from semiUp2845004745137521371);
create or replace TEMP view semiDown3769070875559715731 as select v18, v1 from semiUp1507144414171157801 where (v18) in (select v18 from semiUp2845004745137521371);
create or replace TEMP view semiDown8125090373736421913 as select v4, v42, v43 from semiUp2820420271338400791 where (v4) in (select v4 from semiDown4972126794732183659);
create or replace TEMP view semiDown189441483045611900 as select c_custkey as v1, c_nationkey as v51 from customer AS customer where (c_custkey) in (select v1 from semiDown3769070875559715731);
create or replace TEMP view semiDown8554619497880879383 as select r_regionkey as v43 from region AS region where (r_regionkey) in (select v43 from semiDown8125090373736421913) and (r_name = 'ASIA');
create or replace TEMP view aggView691464256924688231 as select v43 from semiDown8554619497880879383;
create or replace TEMP view aggJoin2108028291193417120 as select v4, v42 from semiDown8125090373736421913 join aggView691464256924688231 using(v43);
create or replace TEMP view aggView1377062656496020119 as select v4, v42, COUNT(*) as annot from aggJoin2108028291193417120 group by v4,v42;
create or replace TEMP view aggJoin8459221077526031817 as select v20, v4, v42, annot from semiDown4972126794732183659 join aggView1377062656496020119 using(v4);
create or replace TEMP view aggView4845416443432454310 as select v20, v4, v42, SUM(annot) as annot from aggJoin8459221077526031817 group by v20,v4,v42;
create or replace TEMP view aggJoin6837617767876517304 as select v18, v23, v24, v4, v42, annot from semiUp2845004745137521371 join aggView4845416443432454310 using(v20);
create or replace TEMP view aggView8855100049511705359 as select v1, v51 from semiDown189441483045611900;
create or replace TEMP view aggJoin5673961190020973456 as select v18, v51 from semiDown3769070875559715731 join aggView8855100049511705359 using(v1);
create or replace TEMP view aggView6378206516011392557 as select v18, v51, COUNT(*) as annot from aggJoin5673961190020973456 group by v18,v51;
create or replace TEMP view aggJoin3020558221160611996 as select v23, v24, v42, aggJoin6837617767876517304.annot * aggView6378206516011392557.annot as annot from aggJoin6837617767876517304 join aggView6378206516011392557 using(v18) where v4 = v51;
create or replace TEMP view res as select v42, SUM((v23 * (1 - v24))*annot) as v49 from aggJoin3020558221160611996 group by v42;
select sum(v42+v49) from res;
