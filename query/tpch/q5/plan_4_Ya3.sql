create or replace TEMP view semiUp8685387316805567789 as select o_orderkey as v18, o_custkey as v1 from orders AS orders where (o_custkey) in (select c_custkey from customer AS customer) and (o_orderdate >= DATE '1993-12-31') and (o_orderdate < DATE '1994-12-31');
create or replace TEMP view semiUp6671388451460504266 as select l_orderkey as v18, l_suppkey as v20, l_extendedprice as v23, l_discount as v24 from lineitem AS lineitem where (l_orderkey) in (select v18 from semiUp8685387316805567789);
create or replace TEMP view semiUp7731486228669374037 as select n_nationkey as v4, n_name as v42, n_regionkey as v43 from nation AS nation where (n_regionkey) in (select r_regionkey from region AS region where (r_name = 'ASIA'));
create or replace TEMP view semiUp3648550585027134488 as select s_suppkey as v20, s_nationkey as v4 from supplier AS supplier where (s_nationkey) in (select v4 from semiUp7731486228669374037);
create or replace TEMP view semiUp1794839985149805290 as select v18, v20, v23, v24 from semiUp6671388451460504266 where (v20) in (select v20 from semiUp3648550585027134488);
create or replace TEMP view semiDown1707611659433100696 as select v20, v4 from semiUp3648550585027134488 where (v20) in (select v20 from semiUp1794839985149805290);
create or replace TEMP view semiDown8576469784082074809 as select v18, v1 from semiUp8685387316805567789 where (v18) in (select v18 from semiUp1794839985149805290);
create or replace TEMP view semiDown6257456681683926254 as select v4, v42, v43 from semiUp7731486228669374037 where (v4) in (select v4 from semiDown1707611659433100696);
create or replace TEMP view semiDown5935318120456110480 as select c_custkey as v1, c_nationkey as v50 from customer AS customer where (c_custkey) in (select v1 from semiDown8576469784082074809);
create or replace TEMP view semiDown3660011140281329161 as select r_regionkey as v43 from region AS region where (r_regionkey) in (select v43 from semiDown6257456681683926254) and (r_name = 'ASIA');
create or replace TEMP view aggView3432845240571870247 as select v43 from semiDown3660011140281329161;
create or replace TEMP view aggJoin4834750256261367005 as select v4, v42 from semiDown6257456681683926254 join aggView3432845240571870247 using(v43);
create or replace TEMP view aggView8751816582647302758 as select v4, v42, COUNT(*) as annot from aggJoin4834750256261367005 group by v4,v42;
create or replace TEMP view aggJoin4325914370558410027 as select v20, v4, v42, annot from semiDown1707611659433100696 join aggView8751816582647302758 using(v4);
create or replace TEMP view aggView1891355230989922762 as select v1, v50 from semiDown5935318120456110480;
create or replace TEMP view aggJoin3597925972345206104 as select v18, v50 from semiDown8576469784082074809 join aggView1891355230989922762 using(v1);
create or replace TEMP view aggView889356637823125277 as select v18, v50, COUNT(*) as annot from aggJoin3597925972345206104 group by v18,v50;
create or replace TEMP view aggJoin6633778999022778736 as select v20, v23, v24, v50, annot from semiUp1794839985149805290 join aggView889356637823125277 using(v18);
create or replace TEMP view aggView2332559733217635217 as select v20, v4, v42, SUM(annot) as annot from aggJoin4325914370558410027 group by v20,v4,v42;
create or replace TEMP view aggJoin4298800856784285184 as select v23, v24, aggJoin6633778999022778736.annot * aggView2332559733217635217.annot as annot, v42 from aggJoin6633778999022778736 join aggView2332559733217635217 using(v20) where v4 = v50;
create or replace TEMP view res as select v42, SUM((v23 * (1 - v24))*annot) as v49 from aggJoin4298800856784285184 group by v42;
select sum(v42+v49) from res;
