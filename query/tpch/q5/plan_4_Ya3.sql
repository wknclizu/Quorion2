create or replace TEMP view semiUp6330921272940815218 as select o_orderkey as v18, o_custkey as v1 from orders AS orders where (o_custkey) in (select c_custkey from customer AS customer) and (o_orderdate >= DATE '1993-12-31') and (o_orderdate < DATE '1994-12-31');
create or replace TEMP view semiUp782379325168724989 as select n_nationkey as v4, n_name as v42, n_regionkey as v43 from nation AS nation where (n_regionkey) in (select r_regionkey from region AS region where (r_name = 'ASIA'));
create or replace TEMP view semiUp1942424149296914392 as select l_orderkey as v18, l_suppkey as v20, l_extendedprice as v23, l_discount as v24 from lineitem AS lineitem where (l_orderkey) in (select v18 from semiUp6330921272940815218);
create or replace TEMP view semiUp1505387669549554228 as select s_suppkey as v20, s_nationkey as v4 from supplier AS supplier where (s_nationkey) in (select v4 from semiUp782379325168724989);
create or replace TEMP view semiUp6556405205035217752 as select v18, v20, v23, v24 from semiUp1942424149296914392 where (v20) in (select v20 from semiUp1505387669549554228);
create or replace TEMP view semiDown1172463105629637973 as select v20, v4 from semiUp1505387669549554228 where (v20) in (select v20 from semiUp6556405205035217752);
create or replace TEMP view semiDown19363920061303260 as select v18, v1 from semiUp6330921272940815218 where (v18) in (select v18 from semiUp6556405205035217752);
create or replace TEMP view semiDown1249856670709005212 as select v4, v42, v43 from semiUp782379325168724989 where (v4) in (select v4 from semiDown1172463105629637973);
create or replace TEMP view semiDown1007438611678695192 as select c_custkey as v1, c_nationkey as v51 from customer AS customer where (c_custkey) in (select v1 from semiDown19363920061303260);
create or replace TEMP view semiDown2594599150083847413 as select r_regionkey as v43 from region AS region where (r_regionkey) in (select v43 from semiDown1249856670709005212) and (r_name = 'ASIA');
create or replace TEMP view aggView6191777672387118516 as select v43 from semiDown2594599150083847413;
create or replace TEMP view aggJoin1712180172267051932 as select v4, v42 from semiDown1249856670709005212 join aggView6191777672387118516 using(v43);
create or replace TEMP view aggView3568623434314492937 as select v4, v42, COUNT(*) as annot from aggJoin1712180172267051932 group by v4,v42;
create or replace TEMP view aggJoin8736091101198132420 as select v20, v4, v42, annot from semiDown1172463105629637973 join aggView3568623434314492937 using(v4);
create or replace TEMP view aggView1648438851345974361 as select v1, v51 from semiDown1007438611678695192;
create or replace TEMP view aggJoin5038439103321663146 as select v18, v51 from semiDown19363920061303260 join aggView1648438851345974361 using(v1);
create or replace TEMP view aggView2949553774427519355 as select v18, v51, COUNT(*) as annot from aggJoin5038439103321663146 group by v18,v51;
create or replace TEMP view aggJoin2440660258722980757 as select v20, v23, v24, v51, annot from semiUp6556405205035217752 join aggView2949553774427519355 using(v18);
create or replace TEMP view aggView1802414378634077785 as select v20, v4, v42, SUM(annot) as annot from aggJoin8736091101198132420 group by v20,v4,v42;
create or replace TEMP view aggJoin4953024930781985305 as select v23, v24, aggJoin2440660258722980757.annot * aggView1802414378634077785.annot as annot, v42 from aggJoin2440660258722980757 join aggView1802414378634077785 using(v20) where v4 = v51;
create or replace TEMP view res as select v42, SUM((v23 * (1 - v24))*annot) as v49 from aggJoin4953024930781985305 group by v42;
select sum(v42+v49) from res;
