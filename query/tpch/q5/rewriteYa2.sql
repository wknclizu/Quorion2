create or replace TEMP view semiUp9118639877444981389 as select n_nationkey as v4, n_name as v42, n_regionkey as v43 from nation AS nation where (n_regionkey) in (select r_regionkey from region AS region where (r_name = 'ASIA'));
create or replace TEMP view semiUp6476791196371321949 as select l_orderkey as v18, l_suppkey as v20, l_extendedprice as v23, l_discount as v24 from lineitem AS lineitem where (l_suppkey) in (select s_suppkey from supplier AS supplier);
create or replace TEMP view semiUp5006570485735041536 as select o_orderkey as v18, o_custkey as v1 from orders AS orders where (o_orderkey) in (select v18 from semiUp6476791196371321949) and (o_orderdate >= DATE '1993-12-31') and (o_orderdate < DATE '1994-12-31');
create or replace TEMP view semiUp5893022276323510846 as select c_custkey as v1, c_nationkey as v4 from customer AS customer where (c_custkey) in (select v1 from semiUp5006570485735041536);
create or replace TEMP view semiUp797152266258939670 as select v4, v42, v43 from semiUp9118639877444981389 where (v4) in (select v4 from semiUp5893022276323510846);
create or replace TEMP view nationAux24 as select v42 from semiUp797152266258939670;
create or replace TEMP view semiDown8727760694944896786 as select v4, v42, v43 from semiUp797152266258939670 where (v42) in (select v42 from nationAux24);
create or replace TEMP view semiDown695662855327671006 as select r_regionkey as v43 from region AS region where (r_regionkey) in (select v43 from semiDown8727760694944896786) and (r_name = 'ASIA');
create or replace TEMP view semiDown8238201171167596242 as select v1, v4 from semiUp5893022276323510846 where (v4) in (select v4 from semiDown8727760694944896786);
create or replace TEMP view semiDown4885004878701113798 as select v18, v1 from semiUp5006570485735041536 where (v1) in (select v1 from semiDown8238201171167596242);
create or replace TEMP view semiDown4585363691267918865 as select v18, v20, v23, v24 from semiUp6476791196371321949 where (v18) in (select v18 from semiDown4885004878701113798);
create or replace TEMP view semiDown6484232069881182611 as select s_suppkey as v20, s_nationkey as v51 from supplier AS supplier where (s_suppkey) in (select v20 from semiDown4585363691267918865);
create or replace TEMP view aggView4533722769678152343 as select v20, v51 from semiDown6484232069881182611;
create or replace TEMP view aggJoin5905862011236065794 as select v18, v23, v24, v51 from semiDown4585363691267918865 join aggView4533722769678152343 using(v20);
create or replace TEMP view aggView9147018867771805238 as select v18, SUM(v23 * (1 - v24)) as v49, v51, COUNT(*) as annot from aggJoin5905862011236065794 group by v18,v51;
create or replace TEMP view aggJoin3072676082375397772 as select v1, v49, v51, annot from semiDown4885004878701113798 join aggView9147018867771805238 using(v18);
create or replace TEMP view aggView6136461301329341887 as select v1, SUM(v49) as v49, v51, SUM(annot) as annot from aggJoin3072676082375397772 group by v1,v51,v49;
create or replace TEMP view aggJoin7741122272208278618 as select v4, v49, v51, annot from semiDown8238201171167596242 join aggView6136461301329341887 using(v1);
create or replace TEMP view aggView7070806061628840437 as select v43 from semiDown695662855327671006;
create or replace TEMP view aggJoin1154765374278963320 as select v4, v42 from semiDown8727760694944896786 join aggView7070806061628840437 using(v43);
create or replace TEMP view aggView8353834306767340860 as select v4, SUM(v49) as v49, v51, SUM(annot) as annot from aggJoin7741122272208278618 group by v4,v51,v49;
create or replace TEMP view aggJoin5317936692430127089 as select v4, v42, v49, v51, annot from aggJoin1154765374278963320 join aggView8353834306767340860 using(v4);
create or replace TEMP view aggView5207306904371943733 as select v42, SUM(v49) as v49, v51, v4, SUM(annot) as annot from aggJoin5317936692430127089 group by v42,v51,v4,v49;
create or replace TEMP view aggJoin2256943664995011852 as select v42 from aggView5207306904371943733 where v4 = v51;
create or replace TEMP view res as select v42, SUM(v49) as v49 from aggJoin2256943664995011852 group by v42;
select sum(v42+v49) from res;
