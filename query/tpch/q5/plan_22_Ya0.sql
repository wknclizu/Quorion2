create or replace TEMP view semiUp2656031512328826830 as select c_custkey as v1, c_nationkey as v4 from customer AS customer where (c_custkey) in (select o_custkey from orders AS orders where (o_orderdate >= DATE '1993-12-31') and (o_orderdate < DATE '1994-12-31'));
create or replace TEMP view semiUp6351020344564497006 as select s_suppkey as v20, s_nationkey as v4 from supplier AS supplier where (s_nationkey) in (select v4 from semiUp2656031512328826830);
create or replace TEMP view semiUp1062732706802964815 as select v20, v4 from semiUp6351020344564497006 where (v20) in (select l_suppkey from lineitem AS lineitem);
create or replace TEMP view semiUp867305542348476592 as select n_nationkey as v4, n_name as v42, n_regionkey as v43 from nation AS nation where (n_nationkey) in (select v4 from semiUp1062732706802964815);
create or replace TEMP view semiUp4629628768967810611 as select r_regionkey as v43 from region AS region where (r_regionkey) in (select v43 from semiUp867305542348476592) and (r_name = 'ASIA');
create or replace TEMP view semiDown6739682177864861456 as select v4, v42, v43 from semiUp867305542348476592 where (v43) in (select v43 from semiUp4629628768967810611);
create or replace TEMP view semiDown6367788015211450626 as select v20, v4 from semiUp1062732706802964815 where (v4) in (select v4 from semiDown6739682177864861456);
create or replace TEMP view semiDown8829467512115661507 as select v1, v4 from semiUp2656031512328826830 where (v4) in (select v4 from semiDown6367788015211450626);
create or replace TEMP view semiDown5524934216655655199 as select l_orderkey as v18, l_suppkey as v20, l_extendedprice as v23, l_discount as v24 from lineitem AS lineitem where (l_suppkey) in (select v20 from semiDown6367788015211450626);
create or replace TEMP view semiDown5152121920149365847 as select o_orderkey as v18, o_custkey as v1 from orders AS orders where (o_custkey) in (select v1 from semiDown8829467512115661507) and (o_orderdate >= DATE '1993-12-31') and (o_orderdate < DATE '1994-12-31');
create or replace TEMP view aggView6391449188243714418 as select v1, v18, COUNT(*) as annot from semiDown5152121920149365847 group by v1,v18;
create or replace TEMP view aggJoin3129392815751474794 as select v4, v18, annot from semiDown8829467512115661507 join aggView6391449188243714418 using(v1);
create or replace TEMP view aggView4918634985640871144 as select v20, v18, SUM(v23 * (1 - v24)) as v49, COUNT(*) as annot from semiDown5524934216655655199 group by v20,v18;
create or replace TEMP view aggJoin4011954099655721088 as select v4, v18, v49, annot from semiDown6367788015211450626 join aggView4918634985640871144 using(v20);
create or replace TEMP view aggView4441505886413754039 as select v18, v4, SUM(annot) as annot from aggJoin3129392815751474794 group by v18,v4;
create or replace TEMP view aggJoin3140518121608308656 as select v4, v18, v49*aggView4441505886413754039.annot as v49, aggJoin4011954099655721088.annot * aggView4441505886413754039.annot as annot from aggJoin4011954099655721088 join aggView4441505886413754039 using(v18,v4);
create or replace TEMP view aggView4538417300947903925 as select v4, SUM(v49) as v49, SUM(annot) as annot from aggJoin3140518121608308656 group by v4,v49;
create or replace TEMP view aggJoin910347669923667723 as select v42, v43, v49, annot from semiDown6739682177864861456 join aggView4538417300947903925 using(v4);
create or replace TEMP view aggView7966525472486956928 as select v43, SUM(v49) as v49, v42, SUM(annot) as annot from aggJoin910347669923667723 group by v43,v42,v49;
create or replace TEMP view aggJoin1244276812600802436 as select v49, v42 from semiUp4629628768967810611 join aggView7966525472486956928 using(v43);
create or replace TEMP view res as select v42, SUM(v49) as v49 from aggJoin1244276812600802436 group by v42;
select sum(v42+v49) from res;
