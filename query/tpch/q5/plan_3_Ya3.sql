create or replace TEMP view semiUp1567000856806570006 as select n_nationkey as v4, n_name as v42, n_regionkey as v43 from nation AS nation where (n_regionkey) in (select r_regionkey from region AS region where (r_name = 'ASIA'));
create or replace TEMP view semiUp6417565146812025993 as select l_orderkey as v18, l_suppkey as v20, l_extendedprice as v23, l_discount as v24 from lineitem AS lineitem where (l_suppkey) in (select s_suppkey from supplier AS supplier);
create or replace TEMP view semiUp1760077078217005139 as select c_custkey as v1, c_nationkey as v4 from customer AS customer where (c_nationkey) in (select v4 from semiUp1567000856806570006);
create or replace TEMP view semiUp6907454531705213825 as select o_orderkey as v18, o_custkey as v1 from orders AS orders where (o_custkey) in (select v1 from semiUp1760077078217005139) and (o_orderdate >= DATE '1993-12-31') and (o_orderdate < DATE '1994-12-31');
create or replace TEMP view semiUp4580462475711910773 as select v18, v20, v23, v24 from semiUp6417565146812025993 where (v18) in (select v18 from semiUp6907454531705213825);
create or replace TEMP view semiDown7560032359911592458 as select s_suppkey as v20, s_nationkey as v51 from supplier AS supplier where (s_suppkey) in (select v20 from semiUp4580462475711910773);
create or replace TEMP view semiDown6691878342745181553 as select v18, v1 from semiUp6907454531705213825 where (v18) in (select v18 from semiUp4580462475711910773);
create or replace TEMP view semiDown2503665153928302632 as select v1, v4 from semiUp1760077078217005139 where (v1) in (select v1 from semiDown6691878342745181553);
create or replace TEMP view semiDown2373383647411817308 as select v4, v42, v43 from semiUp1567000856806570006 where (v4) in (select v4 from semiDown2503665153928302632);
create or replace TEMP view semiDown7344541950298787317 as select r_regionkey as v43 from region AS region where (r_regionkey) in (select v43 from semiDown2373383647411817308) and (r_name = 'ASIA');
create or replace TEMP view aggView7013854371014016036 as select v43 from semiDown7344541950298787317;
create or replace TEMP view aggJoin5609511002409960335 as select v4, v42 from semiDown2373383647411817308 join aggView7013854371014016036 using(v43);
create or replace TEMP view aggView4579229322226480025 as select v20, v51 from semiDown7560032359911592458;
create or replace TEMP view aggJoin6039069052929284174 as select v18, v23, v24, v51 from semiUp4580462475711910773 join aggView4579229322226480025 using(v20);
create or replace TEMP view aggView7654282356355543845 as select v4, v42, COUNT(*) as annot from aggJoin5609511002409960335 group by v4,v42;
create or replace TEMP view aggJoin4758436674848694042 as select v1, v4, v42, annot from semiDown2503665153928302632 join aggView7654282356355543845 using(v4);
create or replace TEMP view aggView8705614686503646712 as select v1, v4, v42, SUM(annot) as annot from aggJoin4758436674848694042 group by v1,v4,v42;
create or replace TEMP view aggJoin733831236016166436 as select v18, v4, v42, annot from semiDown6691878342745181553 join aggView8705614686503646712 using(v1);
create or replace TEMP view aggView5438284554404595328 as select v18, v4, v42, SUM(annot) as annot from aggJoin733831236016166436 group by v18,v4,v42;
create or replace TEMP view aggJoin4984036213227271104 as select v23, v24, v42, annot from aggJoin6039069052929284174 join aggView5438284554404595328 using(v18) where v4 = v51;
create or replace TEMP view res as select v42, SUM((v23 * (1 - v24))*annot) as v49 from aggJoin4984036213227271104 group by v42;
select sum(v42+v49) from res;
