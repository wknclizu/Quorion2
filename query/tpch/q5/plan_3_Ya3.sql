create or replace TEMP view semiUp2359663148611051689 as select n_nationkey as v4, n_name as v42, n_regionkey as v43 from nation AS nation where (n_regionkey) in (select r_regionkey from region AS region where (r_name = 'ASIA'));
create or replace TEMP view semiUp9028214613581672404 as select s_suppkey as v20, s_nationkey as v4 from supplier AS supplier where (s_nationkey) in (select v4 from semiUp2359663148611051689);
create or replace TEMP view semiUp711016323429704805 as select l_orderkey as v18, l_suppkey as v20, l_extendedprice as v23, l_discount as v24 from lineitem AS lineitem where (l_suppkey) in (select v20 from semiUp9028214613581672404);
create or replace TEMP view semiUp432460882102146104 as select o_orderkey as v18, o_custkey as v1 from orders AS orders where (o_custkey) in (select c_custkey from customer AS customer) and (o_orderdate >= DATE '1993-12-31') and (o_orderdate < DATE '1994-12-31');
create or replace TEMP view semiUp4930661886148443479 as select v18, v20, v23, v24 from semiUp711016323429704805 where (v18) in (select v18 from semiUp432460882102146104);
create or replace TEMP view semiDown7664517387445764074 as select v20, v4 from semiUp9028214613581672404 where (v20) in (select v20 from semiUp4930661886148443479);
create or replace TEMP view semiDown7062265540021248406 as select v18, v1 from semiUp432460882102146104 where (v18) in (select v18 from semiUp4930661886148443479);
create or replace TEMP view semiDown2130608437354772221 as select v4, v42, v43 from semiUp2359663148611051689 where (v4) in (select v4 from semiDown7664517387445764074);
create or replace TEMP view semiDown2198183669240544960 as select c_custkey as v1, c_nationkey as v51 from customer AS customer where (c_custkey) in (select v1 from semiDown7062265540021248406);
create or replace TEMP view semiDown9037663163046139883 as select r_regionkey as v43 from region AS region where (r_regionkey) in (select v43 from semiDown2130608437354772221) and (r_name = 'ASIA');
create or replace TEMP view aggView1651415764509472620 as select v43 from semiDown9037663163046139883;
create or replace TEMP view aggJoin7946761082763510764 as select v4, v42 from semiDown2130608437354772221 join aggView1651415764509472620 using(v43);
create or replace TEMP view aggView5277771715330161307 as select v4, v42, COUNT(*) as annot from aggJoin7946761082763510764 group by v4,v42;
create or replace TEMP view aggJoin3942313129727022981 as select v20, v4, v42, annot from semiDown7664517387445764074 join aggView5277771715330161307 using(v4);
create or replace TEMP view aggView2099050682195851677 as select v20, v4, v42, SUM(annot) as annot from aggJoin3942313129727022981 group by v20,v4,v42;
create or replace TEMP view aggJoin6055797159552440215 as select v18, v23, v24, v4, v42, annot from semiUp4930661886148443479 join aggView2099050682195851677 using(v20);
create or replace TEMP view aggView7519379651766676826 as select v1, v51 from semiDown2198183669240544960;
create or replace TEMP view aggJoin3270995682812333865 as select v18, v51 from semiDown7062265540021248406 join aggView7519379651766676826 using(v1);
create or replace TEMP view aggView2403222580696480910 as select v18, v51, COUNT(*) as annot from aggJoin3270995682812333865 group by v18,v51;
create or replace TEMP view aggJoin7509498842173328929 as select v23, v24, v42, aggJoin6055797159552440215.annot * aggView2403222580696480910.annot as annot from aggJoin6055797159552440215 join aggView2403222580696480910 using(v18) where v4 = v51;
create or replace TEMP view res as select v42, SUM((v23 * (1 - v24))*annot) as v49 from aggJoin7509498842173328929 group by v42;
select sum(v42+v49) from res;
