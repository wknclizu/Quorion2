create or replace TEMP view semiUp5618885080143209707 as select o_orderkey as v18, o_custkey as v1 from orders AS orders where (o_custkey) in (select c_custkey from customer AS customer) and (o_orderdate >= DATE '1993-12-31') and (o_orderdate < DATE '1994-12-31');
create or replace TEMP view semiUp8730027147372606716 as select l_orderkey as v18, l_suppkey as v20, l_extendedprice as v23, l_discount as v24 from lineitem AS lineitem where (l_orderkey) in (select v18 from semiUp5618885080143209707);
create or replace TEMP view semiUp3101055767571646191 as select s_suppkey as v20, s_nationkey as v4 from supplier AS supplier where (s_suppkey) in (select v20 from semiUp8730027147372606716);
create or replace TEMP view semiUp6206381493492404393 as select n_nationkey as v4, n_name as v42, n_regionkey as v43 from nation AS nation where (n_regionkey) in (select r_regionkey from region AS region where (r_name = 'ASIA'));
create or replace TEMP view semiUp6847819918341174810 as select v4, v42, v43 from semiUp6206381493492404393 where (v4) in (select v4 from semiUp3101055767571646191);
create or replace TEMP view nationAux96 as select v42 from semiUp6847819918341174810;
create or replace TEMP view semiDown6538306008843653818 as select v4, v42, v43 from semiUp6847819918341174810 where (v42) in (select v42 from nationAux96);
create or replace TEMP view semiDown6499649600439296490 as select r_regionkey as v43 from region AS region where (r_regionkey) in (select v43 from semiDown6538306008843653818) and (r_name = 'ASIA');
create or replace TEMP view semiDown6824177029407272495 as select v20, v4 from semiUp3101055767571646191 where (v4) in (select v4 from semiDown6538306008843653818);
create or replace TEMP view semiDown1831727512786221377 as select v18, v20, v23, v24 from semiUp8730027147372606716 where (v20) in (select v20 from semiDown6824177029407272495);
create or replace TEMP view semiDown8030273415046521945 as select v18, v1 from semiUp5618885080143209707 where (v18) in (select v18 from semiDown1831727512786221377);
create or replace TEMP view semiDown1459922372391746385 as select c_custkey as v1, c_nationkey as v50 from customer AS customer where (c_custkey) in (select v1 from semiDown8030273415046521945);
create or replace TEMP view aggView3199697699696686474 as select v1, v50 from semiDown1459922372391746385;
create or replace TEMP view aggJoin5833596916408550886 as select v18, v50 from semiDown8030273415046521945 join aggView3199697699696686474 using(v1);
create or replace TEMP view aggView1168246738610858155 as select v18, v50, COUNT(*) as annot from aggJoin5833596916408550886 group by v18,v50;
create or replace TEMP view aggJoin9023824065316150663 as select v20, v23, v24, v50, annot from semiDown1831727512786221377 join aggView1168246738610858155 using(v18);
create or replace TEMP view aggView8400499304035158518 as select v20, SUM((v23 * (1 - v24)) * annot) as v49, v50, SUM(annot) as annot from aggJoin9023824065316150663 group by v20,v50;
create or replace TEMP view aggJoin6330249180346456558 as select v4, v49, v50, annot from semiDown6824177029407272495 join aggView8400499304035158518 using(v20);
create or replace TEMP view aggView8078453959142588073 as select v4, SUM(v49) as v49, v50, SUM(annot) as annot from aggJoin6330249180346456558 group by v4,v50,v49;
create or replace TEMP view aggJoin4517502731228569090 as select v4, v42, v43, v49, v50, annot from semiDown6538306008843653818 join aggView8078453959142588073 using(v4);
create or replace TEMP view aggView5251116298872919178 as select v43 from semiDown6499649600439296490;
create or replace TEMP view aggJoin5847514657280575726 as select v4, v42, v49, v50, annot from aggJoin4517502731228569090 join aggView5251116298872919178 using(v43);
create or replace TEMP view aggView8068952097994836490 as select v42, SUM(v49) as v49, v4, v50, SUM(annot) as annot from aggJoin5847514657280575726 group by v42,v4,v50,v49;
create or replace TEMP view aggJoin4170726206832793921 as select v42 from aggView8068952097994836490 where v4 = v50;
create or replace TEMP view res as select v42, SUM(v49) as v49 from aggJoin4170726206832793921 group by v42;
select sum(v42+v49) from res;
