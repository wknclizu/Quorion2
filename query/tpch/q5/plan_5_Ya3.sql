create or replace TEMP view semiUp2120815777257239565 as select l_orderkey as v18, l_suppkey as v20, l_extendedprice as v23, l_discount as v24 from lineitem AS lineitem where (l_suppkey) in (select s_suppkey from supplier AS supplier);
create or replace TEMP view semiUp9184803246550181643 as select n_nationkey as v4, n_name as v42, n_regionkey as v43 from nation AS nation where (n_regionkey) in (select r_regionkey from region AS region where (r_name = 'ASIA'));
create or replace TEMP view semiUp6071679557626193533 as select c_custkey as v1, c_nationkey as v4 from customer AS customer where (c_nationkey) in (select v4 from semiUp9184803246550181643);
create or replace TEMP view semiUp3634004519534990521 as select o_orderkey as v18, o_custkey as v1 from orders AS orders where (o_custkey) in (select v1 from semiUp6071679557626193533) and (o_orderdate >= DATE '1993-12-31') and (o_orderdate < DATE '1994-12-31');
create or replace TEMP view semiUp6812604448339045326 as select v18, v20, v23, v24 from semiUp2120815777257239565 where (v18) in (select v18 from semiUp3634004519534990521);
create or replace TEMP view semiDown1195586053105560345 as select s_suppkey as v20, s_nationkey as v51 from supplier AS supplier where (s_suppkey) in (select v20 from semiUp6812604448339045326);
create or replace TEMP view semiDown5848410436316564081 as select v18, v1 from semiUp3634004519534990521 where (v18) in (select v18 from semiUp6812604448339045326);
create or replace TEMP view semiDown4045705295662989293 as select v1, v4 from semiUp6071679557626193533 where (v1) in (select v1 from semiDown5848410436316564081);
create or replace TEMP view semiDown6831622407047941481 as select v4, v42, v43 from semiUp9184803246550181643 where (v4) in (select v4 from semiDown4045705295662989293);
create or replace TEMP view semiDown873924110512530485 as select r_regionkey as v43 from region AS region where (r_regionkey) in (select v43 from semiDown6831622407047941481) and (r_name = 'ASIA');
create or replace TEMP view aggView3661843369830824001 as select v43 from semiDown873924110512530485;
create or replace TEMP view aggJoin3578832993688319580 as select v4, v42 from semiDown6831622407047941481 join aggView3661843369830824001 using(v43);
create or replace TEMP view aggView2681550858081488974 as select v4, v42, COUNT(*) as annot from aggJoin3578832993688319580 group by v4,v42;
create or replace TEMP view aggJoin2520218338446711253 as select v1, v4, v42, annot from semiDown4045705295662989293 join aggView2681550858081488974 using(v4);
create or replace TEMP view aggView6302309283532449539 as select v1, v4, v42, SUM(annot) as annot from aggJoin2520218338446711253 group by v1,v4,v42;
create or replace TEMP view aggJoin2965731024996298805 as select v18, v4, v42, annot from semiDown5848410436316564081 join aggView6302309283532449539 using(v1);
create or replace TEMP view aggView7529197793377492880 as select v18, v4, v42, SUM(annot) as annot from aggJoin2965731024996298805 group by v18,v4,v42;
create or replace TEMP view aggJoin6218611009270258818 as select v20, v23, v24, v4, v42, annot from semiUp6812604448339045326 join aggView7529197793377492880 using(v18);
create or replace TEMP view aggView7667789814926916128 as select v20, v51 from semiDown1195586053105560345;
create or replace TEMP view aggJoin4774277361794725323 as select v23, v24, v42, annot from aggJoin6218611009270258818 join aggView7667789814926916128 using(v20) where v4 = v51;
create or replace TEMP view res as select v42, SUM((v23 * (1 - v24))*annot) as v49 from aggJoin4774277361794725323 group by v42;
select sum(v42+v49) from res;
