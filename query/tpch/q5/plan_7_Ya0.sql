create or replace TEMP view semiUp5325693968908203006 as select n_nationkey as v4, n_name as v42, n_regionkey as v43 from nation AS nation where (n_regionkey) in (select r_regionkey from region AS region where (r_name = 'ASIA'));
create or replace TEMP view semiUp535231253357222956 as select s_suppkey as v20, s_nationkey as v4 from supplier AS supplier where (s_nationkey) in (select v4 from semiUp5325693968908203006);
create or replace TEMP view semiUp4490759337322790329 as select l_orderkey as v18, l_suppkey as v20, l_extendedprice as v23, l_discount as v24 from lineitem AS lineitem where (l_suppkey) in (select v20 from semiUp535231253357222956);
create or replace TEMP view semiUp4139745081164711582 as select o_orderkey as v18, o_custkey as v1 from orders AS orders where (o_custkey) in (select c_custkey from customer AS customer) and (o_orderdate >= DATE '1993-12-31') and (o_orderdate < DATE '1994-12-31');
create or replace TEMP view semiUp7505647740329795951 as select v18, v20, v23, v24 from semiUp4490759337322790329 where (v18) in (select v18 from semiUp4139745081164711582);
create or replace TEMP view semiDown6110004833372838773 as select v20, v4 from semiUp535231253357222956 where (v20) in (select v20 from semiUp7505647740329795951);
create or replace TEMP view semiDown1197567300048171416 as select v18, v1 from semiUp4139745081164711582 where (v18) in (select v18 from semiUp7505647740329795951);
create or replace TEMP view semiDown8345511976592742376 as select v4, v42, v43 from semiUp5325693968908203006 where (v4) in (select v4 from semiDown6110004833372838773);
create or replace TEMP view semiDown778927892076546273 as select c_custkey as v1, c_nationkey as v4 from customer AS customer where (c_custkey) in (select v1 from semiDown1197567300048171416);
create or replace TEMP view semiDown2036592710872241684 as select r_regionkey as v43 from region AS region where (r_regionkey) in (select v43 from semiDown8345511976592742376) and (r_name = 'ASIA');
create or replace TEMP view aggView7551352956241187970 as select v43 from semiDown2036592710872241684;
create or replace TEMP view aggJoin7852282680839475296 as select v4, v42 from semiDown8345511976592742376 join aggView7551352956241187970 using(v43);
create or replace TEMP view aggView5906256581173883616 as select v1, v4 from semiDown778927892076546273;
create or replace TEMP view aggJoin1467039161868921483 as select v18, v4 from semiDown1197567300048171416 join aggView5906256581173883616 using(v1);
create or replace TEMP view aggView9219379334958363607 as select v4, v42, COUNT(*) as annot from aggJoin7852282680839475296 group by v4,v42;
create or replace TEMP view aggJoin6455508834164610564 as select v20, v4, v42, annot from semiDown6110004833372838773 join aggView9219379334958363607 using(v4);
create or replace TEMP view aggView209188415499328293 as select v20, v4, v42, SUM(annot) as annot from aggJoin6455508834164610564 group by v20,v4,v42;
create or replace TEMP view aggJoin8617608060557950387 as select v18, v23, v24, v4, v42, annot from semiUp7505647740329795951 join aggView209188415499328293 using(v20);
create or replace TEMP view aggView3270051889518860197 as select v4, v18, COUNT(*) as annot from aggJoin1467039161868921483 group by v4,v18;
create or replace TEMP view aggJoin727453516812002863 as select v23, v24, v4, v42, aggJoin8617608060557950387.annot * aggView3270051889518860197.annot as annot from aggJoin8617608060557950387 join aggView3270051889518860197 using(v4,v18);
create or replace TEMP view res as select v42, SUM((v23 * (1 - v24))*annot) as v49 from aggJoin727453516812002863 group by v42;
select sum(v42+v49) from res;
