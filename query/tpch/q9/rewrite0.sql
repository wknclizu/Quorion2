create or replace TEMP view aggView3137327906790379782 as select n_name as v49, n_nationkey as v13 from nation as nation;
create or replace TEMP view aggView5631690413656091340 as select o_orderkey as v38, o_year as v39 from orderswithyear as orderswithyear;
create or replace TEMP view aggView8615152041091495447 as select p_partkey as v33 from part as part where (p_name LIKE '%green%');
create or replace TEMP view aggJoin8688916361879760557 as select ps_partkey as v33, ps_suppkey as v10, ps_supplycost as v36 from partsupp as partsupp, aggView8615152041091495447 where partsupp.ps_partkey=aggView8615152041091495447.v33;
create or replace TEMP view aggView7127138066053092236 as select v10, v33, SUM(v36)/COUNT(*) as v36, COUNT(*) as annot from aggJoin8688916361879760557 group by v10,v33;
create or replace TEMP view aggJoin5663350833483639051 as select l_orderkey as v38, l_suppkey as v10, l_quantity as v21, l_extendedprice as v22, l_discount as v23, v36, annot from lineitem as lineitem, aggView7127138066053092236 where lineitem.l_suppkey=aggView7127138066053092236.v10 and lineitem.l_partkey=aggView7127138066053092236.v33;
create or replace TEMP view semiJoinView1803006566857398732 as select s_suppkey as v10, s_nationkey as v13 from supplier AS supplier where (s_nationkey) in (select v13 from aggView3137327906790379782);
create or replace TEMP view semiJoinView3759183627068817424 as select v38, v10, v21, v22, v23, v36, annot, (v22 * (1 - v23)) as v54 from aggJoin5663350833483639051 where (v10) in (select v10 from semiJoinView1803006566857398732);
create or replace TEMP view semiJoinView4386473773249263313 as select distinct v38, v39 from aggView5631690413656091340 where (v38) in (select v38 from semiJoinView3759183627068817424);
create or replace TEMP view semiEnum539167024002859720 as select distinct v10, v39, annot, v54, v22, v36, v23, v21 from semiJoinView4386473773249263313 join semiJoinView3759183627068817424 using(v38);
create or replace TEMP view semiEnum3895965893194841591 as select distinct v39, annot, v13, v54, v22, v36, v23, v21 from semiEnum539167024002859720 join semiJoinView1803006566857398732 using(v10);
create or replace TEMP view semiEnum1914835948019800359 as select v49, v39, annot, v54, v22, v36, v23, v21 from semiEnum3895965893194841591 join aggView3137327906790379782 using(v13);
create or replace TEMP view res as select v49, v39, SUM(v54) as v54, SUM((v36 * v21)*annot) as v55 from semiEnum1914835948019800359 group by v49, v39;
select sum(v49+v39+v54+v55) from res;
