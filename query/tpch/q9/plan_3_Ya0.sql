create or replace TEMP view orderswithyearAux81 as select o_orderkey as v38, o_year as v39 from orderswithyear;
create or replace TEMP view nationAux66 as select n_nationkey as v13, n_name as v49 from nation;
create or replace TEMP view semiUp2735369317644942152 as select ps_partkey as v33, ps_suppkey as v10, ps_supplycost as v36 from partsupp AS partsupp where (ps_partkey) in (select p_partkey from part AS part where (p_name LIKE '%green%'));
create or replace TEMP view semiUp7954205799482637533 as select s_suppkey as v10, s_nationkey as v13 from supplier AS supplier where (s_nationkey) in (select v13 from nationAux66);
create or replace TEMP view semiUp1385039975683004472 as select l_orderkey as v38, l_partkey as v33, l_suppkey as v10, l_quantity as v21, l_extendedprice as v22, l_discount as v23 from lineitem AS lineitem where (l_suppkey, l_partkey) in (select v10, v33 from semiUp2735369317644942152);
create or replace TEMP view semiUp8218924216593048137 as select v38, v33, v10, v21, v22, v23 from semiUp1385039975683004472 where (v38) in (select v38 from orderswithyearAux81);
create or replace TEMP view semiUp5922472268651509328 as select v10, v13 from semiUp7954205799482637533 where (v10) in (select v10 from semiUp8218924216593048137);
create or replace TEMP view semiDown3126116403975899451 as select v13, v49 from nationAux66 where (v13) in (select v13 from semiUp5922472268651509328);
create or replace TEMP view semiDown634530940007271936 as select v38, v33, v10, v21, v22, v23 from semiUp8218924216593048137 where (v10) in (select v10 from semiUp5922472268651509328);
create or replace TEMP view semiDown7468209414306853302 as select n_nationkey as v13, n_name as v49 from nation AS nation where (n_name, n_nationkey) in (select v49, v13 from semiDown3126116403975899451);
create or replace TEMP view semiDown3251190306283283802 as select v38, v39 from orderswithyearAux81 where (v38) in (select v38 from semiDown634530940007271936);
create or replace TEMP view semiDown3949156716823453105 as select v33, v10, v36 from semiUp2735369317644942152 where (v10, v33) in (select v10, v33 from semiDown634530940007271936);
create or replace TEMP view semiDown7943677959418345041 as select o_orderkey as v38, o_year as v39 from orderswithyear AS orderswithyear where (o_year, o_orderkey) in (select v39, v38 from semiDown3251190306283283802);
create or replace TEMP view semiDown9042133916838938218 as select p_partkey as v33 from part AS part where (p_partkey) in (select v33 from semiDown3949156716823453105) and (p_name LIKE '%green%');
create or replace TEMP view aggView8521379721066901657 as select v39, v38 from semiDown7943677959418345041;
create or replace TEMP view aggView8492328645016801119 as select v49, v13 from semiDown7468209414306853302;
create or replace TEMP view aggView6474840365570169113 as select v33 from semiDown9042133916838938218;
create or replace TEMP view aggJoin8185865683453019534 as select v33, v10, v36 from semiDown3949156716823453105 join aggView6474840365570169113 using(v33);
create or replace TEMP view aggView6819422217391698398 as select v10, v33, SUM(v36)/COUNT(*) as v36, COUNT(*) as annot from aggJoin8185865683453019534 group by v10,v33;
create or replace TEMP view aggJoin803155463651662990 as select v38, v10, v21, v22, v23, v36, annot from semiDown634530940007271936 join aggView6819422217391698398 using(v10,v33);
create or replace TEMP view aggView4029219547221090378 as select v38, v39, COUNT(*) as annot from aggView8521379721066901657 group by v38,v39;
create or replace TEMP view aggJoin8322645212330707249 as select v10, v21, v22, v23, v36, aggJoin803155463651662990.annot * aggView4029219547221090378.annot as annot, v39 from aggJoin803155463651662990 join aggView4029219547221090378 using(v38);
create or replace TEMP view aggView5266435009923816000 as select v13, v49, COUNT(*) as annot from aggView8492328645016801119 group by v13,v49;
create or replace TEMP view aggJoin8689646077204456537 as select v10, v49, annot from semiUp5922472268651509328 join aggView5266435009923816000 using(v13);
create or replace TEMP view aggView8631118237265779843 as select v10, SUM((v22 * (1 - v23)) * annot) as v54, SUM((v36 * v21) * annot) as v55, v39, SUM(annot) as annot from aggJoin8322645212330707249 group by v10,v39;
create or replace TEMP view aggJoin2397811435058851144 as select v49, v54 * aggJoin8689646077204456537.annot as v54, v55 * aggJoin8689646077204456537.annot as v55, v39 from aggJoin8689646077204456537 join aggView8631118237265779843 using(v10);
create or replace TEMP view res as select v49, v39, SUM(v54) as v54, SUM(v55) as v55 from aggJoin2397811435058851144 group by v49, v39;
select sum(v49+v39+v54+v55) from res;
