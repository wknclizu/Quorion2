create or replace TEMP view orderswithyearAux23 as select o_orderkey as v38, o_year as v39 from orderswithyear;
create or replace TEMP view nationAux53 as select n_nationkey as v13, n_name as v49 from nation;
create or replace TEMP view semiUp2464349202294567108 as select l_orderkey as v38, l_partkey as v33, l_suppkey as v10, l_quantity as v21, l_extendedprice as v22, l_discount as v23 from lineitem AS lineitem where (l_partkey, l_suppkey) in (select ps_partkey, ps_suppkey from partsupp AS partsupp);
create or replace TEMP view semiUp6493475874788332965 as select s_suppkey as v10, s_nationkey as v13 from supplier AS supplier where (s_nationkey) in (select v13 from nationAux53);
create or replace TEMP view semiUp8875192610611895539 as select v38, v33, v10, v21, v22, v23 from semiUp2464349202294567108 where (v10) in (select v10 from semiUp6493475874788332965);
create or replace TEMP view semiUp7448687552233164811 as select v38, v33, v10, v21, v22, v23 from semiUp8875192610611895539 where (v33) in (select p_partkey from part AS part where (p_name LIKE '%green%'));
create or replace TEMP view semiUp2087601879767590041 as select v38, v39 from orderswithyearAux23 where (v38) in (select v38 from semiUp7448687552233164811);
create or replace TEMP view semiDown4679366462232592054 as select o_orderkey as v38, o_year as v39 from orderswithyear AS orderswithyear where (o_year, o_orderkey) in (select v39, v38 from semiUp2087601879767590041);
create or replace TEMP view semiDown1785127623853845365 as select v38, v33, v10, v21, v22, v23 from semiUp7448687552233164811 where (v38) in (select v38 from semiUp2087601879767590041);
create or replace TEMP view semiDown5242980199998603684 as select v10, v13 from semiUp6493475874788332965 where (v10) in (select v10 from semiDown1785127623853845365);
create or replace TEMP view semiDown4992798991595879425 as select p_partkey as v33 from part AS part where (p_partkey) in (select v33 from semiDown1785127623853845365) and (p_name LIKE '%green%');
create or replace TEMP view semiDown1286805931935615413 as select ps_partkey as v33, ps_suppkey as v10, ps_supplycost as v36 from partsupp AS partsupp where (ps_partkey, ps_suppkey) in (select v33, v10 from semiDown1785127623853845365);
create or replace TEMP view semiDown7921698724702882763 as select v13, v49 from nationAux53 where (v13) in (select v13 from semiDown5242980199998603684);
create or replace TEMP view semiDown7413859257522937473 as select n_nationkey as v13, n_name as v49 from nation AS nation where (n_name, n_nationkey) in (select v49, v13 from semiDown7921698724702882763);
create or replace TEMP view aggView4483307646936073119 as select v49, v13 from semiDown7413859257522937473;
create or replace TEMP view aggView1502758054578245914 as select v39, v38 from semiDown4679366462232592054;
create or replace TEMP view aggView742663863338686251 as select v13, v49, COUNT(*) as annot from aggView4483307646936073119 group by v13,v49;
create or replace TEMP view aggJoin7922458131882526659 as select v10, v49, annot from semiDown5242980199998603684 join aggView742663863338686251 using(v13);
create or replace TEMP view aggView3205041863124761458 as select v33, v10, v36 from semiDown1286805931935615413;
create or replace TEMP view aggJoin4917324338590505176 as select v38, v33, v10, v21, v22, v23, v36 from semiDown1785127623853845365 join aggView3205041863124761458 using(v33,v10);
create or replace TEMP view aggView1459501537930136221 as select v33 from semiDown4992798991595879425;
create or replace TEMP view aggJoin3193850232305276661 as select v38, v10, v21, v22, v23, v36 from aggJoin4917324338590505176 join aggView1459501537930136221 using(v33);
create or replace TEMP view aggView7466655501299650224 as select v10, v49, SUM(annot) as annot from aggJoin7922458131882526659 group by v10,v49;
create or replace TEMP view aggJoin7158408216590863876 as select v38, v21, v22, v23, v36, v49, annot from aggJoin3193850232305276661 join aggView7466655501299650224 using(v10);
create or replace TEMP view aggView6946529407398963623 as select v38, SUM((v22 * (1 - v23)) * annot) as v54, SUM((v36 * v21) * annot) as v55, v49, SUM(annot) as annot from aggJoin7158408216590863876 group by v38,v49;
create or replace TEMP view aggJoin735753826097040559 as select v39, v54, v55, v49 from aggView1502758054578245914 join aggView6946529407398963623 using(v38);
create or replace TEMP view res as select v49, v39, SUM(v54) as v54, SUM(v55) as v55 from aggJoin735753826097040559 group by v49, v39;
select sum(v49+v39+v54+v55) from res;
