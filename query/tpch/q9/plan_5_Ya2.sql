create or replace TEMP view nationAux27 as select n_nationkey as v13, n_name as v49 from nation;
create or replace TEMP view orderswithyearAux90 as select o_orderkey as v38, o_year as v39 from orderswithyear;
create or replace TEMP view semiUp4583234805532704326 as select l_orderkey as v38, l_partkey as v33, l_suppkey as v10, l_quantity as v21, l_extendedprice as v22, l_discount as v23 from lineitem AS lineitem where (l_partkey) in (select p_partkey from part AS part where (p_name LIKE '%green%'));
create or replace TEMP view semiUp3411466042866211262 as select v38, v33, v10, v21, v22, v23 from semiUp4583234805532704326 where (v33, v10) in (select ps_partkey, ps_suppkey from partsupp AS partsupp);
create or replace TEMP view semiUp6390857937115344587 as select v38, v33, v10, v21, v22, v23 from semiUp3411466042866211262 where (v38) in (select v38 from orderswithyearAux90);
create or replace TEMP view semiUp54049498130110084 as select s_suppkey as v10, s_nationkey as v13 from supplier AS supplier where (s_suppkey) in (select v10 from semiUp6390857937115344587);
create or replace TEMP view semiUp6447029552541097216 as select v13, v49 from nationAux27 where (v13) in (select v13 from semiUp54049498130110084);
create or replace TEMP view semiDown4691871650936876457 as select n_nationkey as v13, n_name as v49 from nation AS nation where (n_nationkey, n_name) in (select v13, v49 from semiUp6447029552541097216);
create or replace TEMP view semiDown3320257846276584885 as select v10, v13 from semiUp54049498130110084 where (v13) in (select v13 from semiUp6447029552541097216);
create or replace TEMP view semiDown4515421910264598455 as select v38, v33, v10, v21, v22, v23 from semiUp6390857937115344587 where (v10) in (select v10 from semiDown3320257846276584885);
create or replace TEMP view semiDown259190447896164051 as select v38, v39 from orderswithyearAux90 where (v38) in (select v38 from semiDown4515421910264598455);
create or replace TEMP view semiDown2608604790427852528 as select p_partkey as v33 from part AS part where (p_partkey) in (select v33 from semiDown4515421910264598455) and (p_name LIKE '%green%');
create or replace TEMP view semiDown1622057484209750599 as select ps_partkey as v33, ps_suppkey as v10, ps_supplycost as v36 from partsupp AS partsupp where (ps_partkey, ps_suppkey) in (select v33, v10 from semiDown4515421910264598455);
create or replace TEMP view semiDown3114440937540833954 as select o_orderkey as v38, o_year as v39 from orderswithyear AS orderswithyear where (o_year, o_orderkey) in (select v39, v38 from semiDown259190447896164051);
create or replace TEMP view aggView4878525443419486203 as select v39, v38 from semiDown3114440937540833954;
create or replace TEMP view aggView411620068093474141 as select v13, v49 from semiDown4691871650936876457;
create or replace TEMP view aggView5717272918679254051 as select v33, v10, v36 from semiDown1622057484209750599;
create or replace TEMP view aggJoin4468702189875677149 as select v38, v33, v10, v21, v22, v23, v36 from semiDown4515421910264598455 join aggView5717272918679254051 using(v33,v10);
create or replace TEMP view aggView5164487155179130873 as select v33 from semiDown2608604790427852528;
create or replace TEMP view aggJoin8987842151263923219 as select v38, v10, v21, v22, v23, v36 from aggJoin4468702189875677149 join aggView5164487155179130873 using(v33);
create or replace TEMP view aggView1233462128444833274 as select v38, v39, COUNT(*) as annot from aggView4878525443419486203 group by v38,v39;
create or replace TEMP view aggJoin4836215214463878516 as select v10, v21, v22, v23, v36, v39, annot from aggJoin8987842151263923219 join aggView1233462128444833274 using(v38);
create or replace TEMP view aggView5051570433489422955 as select v10, SUM((v22 * (1 - v23)) * annot) as v54, SUM((v36 * v21) * annot) as v55, v39, SUM(annot) as annot from aggJoin4836215214463878516 group by v10,v39;
create or replace TEMP view aggJoin1225334575216147498 as select v13, v54, v55, v39, annot from semiDown3320257846276584885 join aggView5051570433489422955 using(v10);
create or replace TEMP view aggView2243585753788625374 as select v13, SUM(v54) as v54, SUM(v55) as v55, v39, SUM(annot) as annot from aggJoin1225334575216147498 group by v13,v54,v39,v55;
create or replace TEMP view aggJoin7077924163404405160 as select v49, v54, v55, v39 from aggView411620068093474141 join aggView2243585753788625374 using(v13);
create or replace TEMP view res as select v49, v39, SUM(v54) as v54, SUM(v55) as v55 from aggJoin7077924163404405160 group by v49, v39;
select sum(v49+v39+v54+v55) from res;
