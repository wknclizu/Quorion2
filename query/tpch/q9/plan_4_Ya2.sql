create or replace TEMP view nationAux23 as select n_nationkey as v13, n_name as v49 from nation;
create or replace TEMP view orderswithyearAux46 as select o_orderkey as v38, o_year as v39 from orderswithyear;
create or replace TEMP view semiUp4981244237297609985 as select l_orderkey as v38, l_partkey as v33, l_suppkey as v10, l_quantity as v21, l_extendedprice as v22, l_discount as v23 from lineitem AS lineitem where (l_orderkey) in (select v38 from orderswithyearAux46);
create or replace TEMP view semiUp907142688176238063 as select ps_partkey as v33, ps_suppkey as v10, ps_supplycost as v36 from partsupp AS partsupp where (ps_partkey) in (select p_partkey from part AS part where (p_name LIKE '%green%'));
create or replace TEMP view semiUp2693943278091338337 as select v38, v33, v10, v21, v22, v23 from semiUp4981244237297609985 where (v10, v33) in (select v10, v33 from semiUp907142688176238063);
create or replace TEMP view semiUp4342234628756253298 as select s_suppkey as v10, s_nationkey as v13 from supplier AS supplier where (s_suppkey) in (select v10 from semiUp2693943278091338337);
create or replace TEMP view semiUp8657900479201086587 as select v13, v49 from nationAux23 where (v13) in (select v13 from semiUp4342234628756253298);
create or replace TEMP view semiDown2534065030600403472 as select n_nationkey as v13, n_name as v49 from nation AS nation where (n_name, n_nationkey) in (select v49, v13 from semiUp8657900479201086587);
create or replace TEMP view semiDown6633495807013999366 as select v10, v13 from semiUp4342234628756253298 where (v13) in (select v13 from semiUp8657900479201086587);
create or replace TEMP view semiDown6584276476068305714 as select v38, v33, v10, v21, v22, v23 from semiUp2693943278091338337 where (v10) in (select v10 from semiDown6633495807013999366);
create or replace TEMP view semiDown5588700040334367376 as select v38, v39 from orderswithyearAux46 where (v38) in (select v38 from semiDown6584276476068305714);
create or replace TEMP view semiDown5490429630278473716 as select v33, v10, v36 from semiUp907142688176238063 where (v10, v33) in (select v10, v33 from semiDown6584276476068305714);
create or replace TEMP view semiDown7741582442803527723 as select o_orderkey as v38, o_year as v39 from orderswithyear AS orderswithyear where (o_orderkey, o_year) in (select v38, v39 from semiDown5588700040334367376);
create or replace TEMP view semiDown5899388684324496996 as select p_partkey as v33 from part AS part where (p_partkey) in (select v33 from semiDown5490429630278473716) and (p_name LIKE '%green%');
create or replace TEMP view aggView5137721292435532214 as select v38, v39 from semiDown7741582442803527723;
create or replace TEMP view aggView4140903780399024935 as select v49, v13 from semiDown2534065030600403472;
create or replace TEMP view aggView502718466494430215 as select v33 from semiDown5899388684324496996;
create or replace TEMP view aggJoin5264539010235653164 as select v33, v10, v36 from semiDown5490429630278473716 join aggView502718466494430215 using(v33);
create or replace TEMP view aggView4464985427587162231 as select v33, v10, SUM(v36)/COUNT(*) as v36, COUNT(*) as annot from aggJoin5264539010235653164 group by v33,v10;
create or replace TEMP view aggJoin1400437779621202239 as select v38, v10, v21, v22, v23, v36, annot from semiDown6584276476068305714 join aggView4464985427587162231 using(v33,v10);
create or replace TEMP view aggView6333747531236863588 as select v38, v39, COUNT(*) as annot from aggView5137721292435532214 group by v38,v39;
create or replace TEMP view aggJoin2016130222470175871 as select v10, v21, v22, v23, v36, aggJoin1400437779621202239.annot * aggView6333747531236863588.annot as annot, v39 from aggJoin1400437779621202239 join aggView6333747531236863588 using(v38);
create or replace TEMP view aggView7744080658058433969 as select v10, SUM((v22 * (1 - v23)) * annot) as v54, SUM((v36 * v21) * annot) as v55, v39, SUM(annot) as annot from aggJoin2016130222470175871 group by v10,v39;
create or replace TEMP view aggJoin7965513687741238482 as select v13, v54, v55, v39, annot from semiDown6633495807013999366 join aggView7744080658058433969 using(v10);
create or replace TEMP view aggView1988693739327723834 as select v13, SUM(v54) as v54, SUM(v55) as v55, v39, SUM(annot) as annot from aggJoin7965513687741238482 group by v13,v39,v55,v54;
create or replace TEMP view aggJoin8414168240109539005 as select v49, v54, v55, v39 from aggView4140903780399024935 join aggView1988693739327723834 using(v13);
create or replace TEMP view res as select v49, v39, SUM(v54) as v54, SUM(v55) as v55 from aggJoin8414168240109539005 group by v49, v39;
select sum(v49+v39+v54+v55) from res;
