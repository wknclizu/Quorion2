create or replace TEMP view nationAux11 as select n_nationkey as v13, n_name as v49 from nation;
create or replace TEMP view orderswithyearAux49 as select o_orderkey as v38, o_year as v39 from orderswithyear;
create or replace TEMP view semiUp2472132399009323262 as select l_orderkey as v38, l_partkey as v33, l_suppkey as v10, l_quantity as v21, l_extendedprice as v22, l_discount as v23 from lineitem AS lineitem where (l_partkey) in (select p_partkey from part AS part where (p_name LIKE '%green%'));
create or replace TEMP view semiUp8593146919459374042 as select v38, v33, v10, v21, v22, v23 from semiUp2472132399009323262 where (v10, v33) in (select ps_suppkey, ps_partkey from partsupp AS partsupp);
create or replace TEMP view semiUp6555806127732022134 as select v38, v33, v10, v21, v22, v23 from semiUp8593146919459374042 where (v38) in (select v38 from orderswithyearAux49);
create or replace TEMP view semiUp2033688478850263888 as select s_suppkey as v10, s_nationkey as v13 from supplier AS supplier where (s_suppkey) in (select v10 from semiUp6555806127732022134);
create or replace TEMP view semiUp6857962344429917130 as select v13, v49 from nationAux11 where (v13) in (select v13 from semiUp2033688478850263888);
create or replace TEMP view semiDown9058959767200317647 as select n_nationkey as v13, n_name as v49 from nation AS nation where (n_nationkey, n_name) in (select v13, v49 from semiUp6857962344429917130);
create or replace TEMP view semiDown1521702459042902895 as select v10, v13 from semiUp2033688478850263888 where (v13) in (select v13 from semiUp6857962344429917130);
create or replace TEMP view semiDown7469434923945234499 as select v38, v33, v10, v21, v22, v23 from semiUp6555806127732022134 where (v10) in (select v10 from semiDown1521702459042902895);
create or replace TEMP view semiDown6300426287973449665 as select v38, v39 from orderswithyearAux49 where (v38) in (select v38 from semiDown7469434923945234499);
create or replace TEMP view semiDown804377688882682110 as select p_partkey as v33 from part AS part where (p_partkey) in (select v33 from semiDown7469434923945234499) and (p_name LIKE '%green%');
create or replace TEMP view semiDown5268035435979876448 as select ps_partkey as v33, ps_suppkey as v10, ps_supplycost as v36 from partsupp AS partsupp where (ps_suppkey, ps_partkey) in (select v10, v33 from semiDown7469434923945234499);
create or replace TEMP view semiDown7224212512695135815 as select o_orderkey as v38, o_year as v39 from orderswithyear AS orderswithyear where (o_year, o_orderkey) in (select v39, v38 from semiDown6300426287973449665);
create or replace TEMP view aggView3565268438751995591 as select v39, v38 from semiDown7224212512695135815;
create or replace TEMP view aggView2666359849413801304 as select v13, v49 from semiDown9058959767200317647;
create or replace TEMP view aggView7987251567018037699 as select v10, v33, v36 from semiDown5268035435979876448;
create or replace TEMP view aggJoin3674580067553499968 as select v38, v33, v10, v21, v22, v23, v36 from semiDown7469434923945234499 join aggView7987251567018037699 using(v10,v33);
create or replace TEMP view aggView434677912570566214 as select v33 from semiDown804377688882682110;
create or replace TEMP view aggJoin2172871497594770638 as select v38, v10, v21, v22, v23, v36 from aggJoin3674580067553499968 join aggView434677912570566214 using(v33);
create or replace TEMP view aggView4625042457742329001 as select v38, v39, COUNT(*) as annot from aggView3565268438751995591 group by v38,v39;
create or replace TEMP view aggJoin3019051991249370761 as select v10, v21, v22, v23, v36, v39, annot from aggJoin2172871497594770638 join aggView4625042457742329001 using(v38);
create or replace TEMP view aggView2005018424668637776 as select v10, SUM((v22 * (1 - v23)) * annot) as v54, SUM((v36 * v21) * annot) as v55, v39, SUM(annot) as annot from aggJoin3019051991249370761 group by v10,v39;
create or replace TEMP view aggJoin1422399766224886744 as select v13, v54, v55, v39, annot from semiDown1521702459042902895 join aggView2005018424668637776 using(v10);
create or replace TEMP view aggView8565231297332269819 as select v13, SUM(v54) as v54, SUM(v55) as v55, v39, SUM(annot) as annot from aggJoin1422399766224886744 group by v13,v54,v39,v55;
create or replace TEMP view aggJoin4425671029406597559 as select v49, v54, v55, v39 from aggView2666359849413801304 join aggView8565231297332269819 using(v13);
create or replace TEMP view res as select v49, v39, SUM(v54) as v54, SUM(v55) as v55 from aggJoin4425671029406597559 group by v49, v39;
select sum(v49+v39+v54+v55) from res;
