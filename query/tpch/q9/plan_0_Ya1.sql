create or replace TEMP view nationAux33 as select n_nationkey as v13, n_name as v49 from nation;
create or replace TEMP view orderswithyearAux27 as select o_orderkey as v38, o_year as v39 from orderswithyear;
create or replace TEMP view semiUp912138041080082331 as select l_orderkey as v38, l_partkey as v33, l_suppkey as v10, l_quantity as v21, l_extendedprice as v22, l_discount as v23 from lineitem AS lineitem where (l_partkey) in (select p_partkey from part AS part where (p_name LIKE '%green%'));
create or replace TEMP view semiUp6100629292716015810 as select v38, v33, v10, v21, v22, v23 from semiUp912138041080082331 where (v33, v10) in (select ps_partkey, ps_suppkey from partsupp AS partsupp);
create or replace TEMP view semiUp7228010358057676401 as select s_suppkey as v10, s_nationkey as v13 from supplier AS supplier where (s_nationkey) in (select v13 from nationAux33);
create or replace TEMP view semiUp7648450738548148201 as select v38, v33, v10, v21, v22, v23 from semiUp6100629292716015810 where (v10) in (select v10 from semiUp7228010358057676401);
create or replace TEMP view semiUp5447115239932995185 as select v38, v39 from orderswithyearAux27 where (v38) in (select v38 from semiUp7648450738548148201);
create or replace TEMP view semiDown6582833692132702164 as select o_orderkey as v38, o_year as v39 from orderswithyear AS orderswithyear where (o_orderkey, o_year) in (select v38, v39 from semiUp5447115239932995185);
create or replace TEMP view semiDown8406252682003736605 as select v38, v33, v10, v21, v22, v23 from semiUp7648450738548148201 where (v38) in (select v38 from semiUp5447115239932995185);
create or replace TEMP view semiDown3694484329907025506 as select v10, v13 from semiUp7228010358057676401 where (v10) in (select v10 from semiDown8406252682003736605);
create or replace TEMP view semiDown155361749849191302 as select p_partkey as v33 from part AS part where (p_partkey) in (select v33 from semiDown8406252682003736605) and (p_name LIKE '%green%');
create or replace TEMP view semiDown5640191803085151032 as select ps_partkey as v33, ps_suppkey as v10, ps_supplycost as v36 from partsupp AS partsupp where (ps_partkey, ps_suppkey) in (select v33, v10 from semiDown8406252682003736605);
create or replace TEMP view semiDown1961260660043769420 as select v13, v49 from nationAux33 where (v13) in (select v13 from semiDown3694484329907025506);
create or replace TEMP view semiDown756069995070177913 as select n_nationkey as v13, n_name as v49 from nation AS nation where (n_name, n_nationkey) in (select v49, v13 from semiDown1961260660043769420);
create or replace TEMP view aggView8431725265522630590 as select v49, v13 from semiDown756069995070177913;
create or replace TEMP view aggView8299898784417234422 as select v38, v39 from semiDown6582833692132702164;
create or replace TEMP view aggView921711579165674864 as select v13, v49, COUNT(*) as annot from aggView8431725265522630590 group by v13,v49;
create or replace TEMP view aggJoin4914074856078441986 as select v10, v49, annot from semiDown3694484329907025506 join aggView921711579165674864 using(v13);
create or replace TEMP view aggView2621331466490058728 as select v10, v49, SUM(annot) as annot from aggJoin4914074856078441986 group by v10,v49;
create or replace TEMP view aggJoin3107333911008557526 as select v38, v33, v10, v21, v22, v23, v49, annot from semiDown8406252682003736605 join aggView2621331466490058728 using(v10);
create or replace TEMP view aggView1005241895426836939 as select v33, v10, v36 from semiDown5640191803085151032;
create or replace TEMP view aggJoin1355880444480277214 as select v38, v33, v21, v22, v23, v49, annot, v36 from aggJoin3107333911008557526 join aggView1005241895426836939 using(v33,v10);
create or replace TEMP view aggView1020981379162447472 as select v33 from semiDown155361749849191302;
create or replace TEMP view aggJoin8026358581288369360 as select v38, v21, v22, v23, v49, annot, v36 from aggJoin1355880444480277214 join aggView1020981379162447472 using(v33);
create or replace TEMP view aggView5654372158743016072 as select v38, SUM((v22 * (1 - v23)) * annot) as v54, SUM((v36 * v21) * annot) as v55, v49, SUM(annot) as annot from aggJoin8026358581288369360 group by v38,v49;
create or replace TEMP view aggJoin514343730171258979 as select v39, v54, v55, v49 from aggView8299898784417234422 join aggView5654372158743016072 using(v38);
create or replace TEMP view res as select v49, v39, SUM(v54) as v54, SUM(v55) as v55 from aggJoin514343730171258979 group by v49, v39;
select sum(v49+v39+v54+v55) from res;
