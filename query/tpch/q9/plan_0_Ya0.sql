create or replace TEMP view orderswithyearAux53 as select o_orderkey as v38, o_year as v39 from orderswithyear;
create or replace TEMP view nationAux95 as select n_nationkey as v13, n_name as v49 from nation;
create or replace TEMP view semiUp462085710547589380 as select s_suppkey as v10, s_nationkey as v13 from supplier AS supplier where (s_nationkey) in (select v13 from nationAux95);
create or replace TEMP view semiUp6747703538904751152 as select l_orderkey as v38, l_partkey as v33, l_suppkey as v10, l_quantity as v21, l_extendedprice as v22, l_discount as v23 from lineitem AS lineitem where (l_suppkey, l_partkey) in (select ps_suppkey, ps_partkey from partsupp AS partsupp);
create or replace TEMP view semiUp6980504220529869568 as select v38, v33, v10, v21, v22, v23 from semiUp6747703538904751152 where (v10) in (select v10 from semiUp462085710547589380);
create or replace TEMP view semiUp5659205510709198020 as select v38, v33, v10, v21, v22, v23 from semiUp6980504220529869568 where (v33) in (select p_partkey from part AS part where (p_name LIKE '%green%'));
create or replace TEMP view semiUp4606566806588755539 as select v38, v39 from orderswithyearAux53 where (v38) in (select v38 from semiUp5659205510709198020);
create or replace TEMP view semiDown4476363607215642128 as select o_orderkey as v38, o_year as v39 from orderswithyear AS orderswithyear where (o_year, o_orderkey) in (select v39, v38 from semiUp4606566806588755539);
create or replace TEMP view semiDown333109325359018853 as select v38, v33, v10, v21, v22, v23 from semiUp5659205510709198020 where (v38) in (select v38 from semiUp4606566806588755539);
create or replace TEMP view semiDown2051394113976246620 as select v10, v13 from semiUp462085710547589380 where (v10) in (select v10 from semiDown333109325359018853);
create or replace TEMP view semiDown7460910272408599030 as select p_partkey as v33 from part AS part where (p_partkey) in (select v33 from semiDown333109325359018853) and (p_name LIKE '%green%');
create or replace TEMP view semiDown5288348883333393774 as select ps_partkey as v33, ps_suppkey as v10, ps_supplycost as v36 from partsupp AS partsupp where (ps_suppkey, ps_partkey) in (select v10, v33 from semiDown333109325359018853);
create or replace TEMP view semiDown157156018751027291 as select v13, v49 from nationAux95 where (v13) in (select v13 from semiDown2051394113976246620);
create or replace TEMP view semiDown2717904150013136626 as select n_nationkey as v13, n_name as v49 from nation AS nation where (n_nationkey, n_name) in (select v13, v49 from semiDown157156018751027291);
create or replace TEMP view aggView6639586488143477293 as select v13, v49 from semiDown2717904150013136626;
create or replace TEMP view aggView6343755288930187392 as select v39, v38 from semiDown4476363607215642128;
create or replace TEMP view aggView2119469019030656064 as select v13, v49, COUNT(*) as annot from aggView6639586488143477293 group by v13,v49;
create or replace TEMP view aggJoin2209378310748025271 as select v10, v49, annot from semiDown2051394113976246620 join aggView2119469019030656064 using(v13);
create or replace TEMP view aggView1896729704927594375 as select v10, v49, SUM(annot) as annot from aggJoin2209378310748025271 group by v10,v49;
create or replace TEMP view aggJoin1853387879336538026 as select v38, v33, v10, v21, v22, v23, v49, annot from semiDown333109325359018853 join aggView1896729704927594375 using(v10);
create or replace TEMP view aggView606208219350390416 as select v10, v33, v36 from semiDown5288348883333393774;
create or replace TEMP view aggJoin5404552477868623182 as select v38, v33, v21, v22, v23, v49, annot, v36 from aggJoin1853387879336538026 join aggView606208219350390416 using(v10,v33);
create or replace TEMP view aggView1238169696677334715 as select v33 from semiDown7460910272408599030;
create or replace TEMP view aggJoin7765097031323476077 as select v38, v21, v22, v23, v49, annot, v36 from aggJoin5404552477868623182 join aggView1238169696677334715 using(v33);
create or replace TEMP view aggView5256255917283060662 as select v38, SUM((v22 * (1 - v23)) * annot) as v54, SUM((v36 * v21) * annot) as v55, v49, SUM(annot) as annot from aggJoin7765097031323476077 group by v38,v49;
create or replace TEMP view aggJoin5998987310461522256 as select v39, v54, v55, v49 from aggView6343755288930187392 join aggView5256255917283060662 using(v38);
create or replace TEMP view res as select v49, v39, SUM(v54) as v54, SUM(v55) as v55 from aggJoin5998987310461522256 group by v49, v39;
select sum(v49+v39+v54+v55) from res;
