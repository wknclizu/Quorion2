create or replace TEMP view semiUp7001727561404518036 as select s_suppkey as v10, s_nationkey as v13 from supplier AS supplier where (s_nationkey) in (select n_nationkey from nation AS nation);
create or replace TEMP view semiUp799210051150133161 as select l_orderkey as v38, l_partkey as v33, l_suppkey as v10, l_quantity as v21, l_extendedprice as v22, l_discount as v23 from lineitem AS lineitem where (l_orderkey) in (select o_orderkey from orderswithyear AS orderswithyear);
create or replace TEMP view semiUp1504436680480920753 as select v38, v33, v10, v21, v22, v23 from semiUp799210051150133161 where (v33) in (select p_partkey from part AS part where (p_name LIKE '%green%'));
create or replace TEMP view semiUp8005863596812392234 as select ps_partkey as v33, ps_suppkey as v10, ps_supplycost as v36 from partsupp AS partsupp where (ps_suppkey) in (select v10 from semiUp7001727561404518036);
create or replace TEMP view semiUp4466698187210240907 as select v38, v33, v10, v21, v22, v23 from semiUp1504436680480920753 where (v10, v33) in (select v10, v33 from semiUp8005863596812392234);
create or replace TEMP view semiDown1043668915620737422 as select p_partkey as v33 from part AS part where (p_partkey) in (select v33 from semiUp4466698187210240907) and (p_name LIKE '%green%');
create or replace TEMP view semiDown8053620677565486779 as select v33, v10, v36 from semiUp8005863596812392234 where (v10, v33) in (select v10, v33 from semiUp4466698187210240907);
create or replace TEMP view semiDown7165593863557649953 as select o_orderkey as v38, o_year as v39 from orderswithyear AS orderswithyear where (o_orderkey) in (select v38 from semiUp4466698187210240907);
create or replace TEMP view semiDown3950083595219832270 as select v10, v13 from semiUp7001727561404518036 where (v10) in (select v10 from semiDown8053620677565486779);
create or replace TEMP view semiDown1331149704871664335 as select n_nationkey as v13, n_name as v49 from nation AS nation where (n_nationkey) in (select v13 from semiDown3950083595219832270);
create or replace TEMP view aggView7801775996557493051 as select v13, v49 from semiDown1331149704871664335;
create or replace TEMP view aggJoin8698036502484306375 as select v10, v49 from semiDown3950083595219832270 join aggView7801775996557493051 using(v13);
create or replace TEMP view aggView6272841344707631429 as select v10, v49, COUNT(*) as annot from aggJoin8698036502484306375 group by v10,v49;
create or replace TEMP view aggJoin1544210246629062123 as select v33, v10, v36, v49, annot from semiDown8053620677565486779 join aggView6272841344707631429 using(v10);
create or replace TEMP view aggView7009651382762630215 as select v33, v10, SUM(v36)/COUNT(*) as v36, v49, SUM(annot) as annot from aggJoin1544210246629062123 group by v33,v10,v49;
create or replace TEMP view aggJoin5052043942154158897 as select v38, v33, v21, v22, v23, v36, v49, annot from semiUp4466698187210240907 join aggView7009651382762630215 using(v33,v10);
create or replace TEMP view aggView2427544139756982584 as select v38, v39 from semiDown7165593863557649953;
create or replace TEMP view aggJoin5952380162138181134 as select v33, v21, v22, v23, v36, v49, annot, v39 from aggJoin5052043942154158897 join aggView2427544139756982584 using(v38);
create or replace TEMP view aggView7639258769126777790 as select v33 from semiDown1043668915620737422;
create or replace TEMP view aggJoin5880463111247276441 as select v21, v22, v23, v36, v49, annot, v39 from aggJoin5952380162138181134 join aggView7639258769126777790 using(v33);
create or replace TEMP view res as select v49, v39, SUM((v22 * (1 - v23))*annot) as v54, SUM((v36 * v21)*annot) as v55 from aggJoin5880463111247276441 group by v49, v39;
select sum(v49+v39+v54+v55) from res;
