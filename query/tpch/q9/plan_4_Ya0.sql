create or replace TEMP view orderswithyearAux22 as select o_orderkey as v38, o_year as v39 from orderswithyear;
create or replace TEMP view nationAux14 as select n_nationkey as v13, n_name as v49 from nation;
create or replace TEMP view semiUp5728507403906168476 as select s_suppkey as v10, s_nationkey as v13 from supplier AS supplier where (s_nationkey) in (select v13 from nationAux14);
create or replace TEMP view semiUp1095535883627167529 as select l_orderkey as v38, l_partkey as v33, l_suppkey as v10, l_quantity as v21, l_extendedprice as v22, l_discount as v23 from lineitem AS lineitem where (l_suppkey) in (select v10 from semiUp5728507403906168476);
create or replace TEMP view semiUp2698233220220790252 as select v38, v33, v10, v21, v22, v23 from semiUp1095535883627167529 where (v33, v10) in (select ps_partkey, ps_suppkey from partsupp AS partsupp);
create or replace TEMP view semiUp6322982480241391123 as select v38, v33, v10, v21, v22, v23 from semiUp2698233220220790252 where (v33) in (select p_partkey from part AS part where (p_name LIKE '%green%'));
create or replace TEMP view semiUp1109600055383960497 as select v38, v39 from orderswithyearAux22 where (v38) in (select v38 from semiUp6322982480241391123);
create or replace TEMP view semiDown2515366934810110832 as select o_orderkey as v38, o_year as v39 from orderswithyear AS orderswithyear where (o_orderkey, o_year) in (select v38, v39 from semiUp1109600055383960497);
create or replace TEMP view semiDown5104026816053488212 as select v38, v33, v10, v21, v22, v23 from semiUp6322982480241391123 where (v38) in (select v38 from semiUp1109600055383960497);
create or replace TEMP view semiDown1697839798918851625 as select v10, v13 from semiUp5728507403906168476 where (v10) in (select v10 from semiDown5104026816053488212);
create or replace TEMP view semiDown7764446532073572720 as select p_partkey as v33 from part AS part where (p_partkey) in (select v33 from semiDown5104026816053488212) and (p_name LIKE '%green%');
create or replace TEMP view semiDown7091384501183756960 as select ps_partkey as v33, ps_suppkey as v10, ps_supplycost as v36 from partsupp AS partsupp where (ps_partkey, ps_suppkey) in (select v33, v10 from semiDown5104026816053488212);
create or replace TEMP view semiDown859897678840770887 as select v13, v49 from nationAux14 where (v13) in (select v13 from semiDown1697839798918851625);
create or replace TEMP view semiDown4843160085634276464 as select n_nationkey as v13, n_name as v49 from nation AS nation where (n_nationkey, n_name) in (select v13, v49 from semiDown859897678840770887);
create or replace TEMP view aggView1807210331949785687 as select v13, v49 from semiDown4843160085634276464;
create or replace TEMP view aggView2831339042758895556 as select v38, v39 from semiDown2515366934810110832;
create or replace TEMP view aggView1154000415498047164 as select v13, v49, COUNT(*) as annot from aggView1807210331949785687 group by v13,v49;
create or replace TEMP view aggJoin2706037821856067605 as select v10, v49, annot from semiDown1697839798918851625 join aggView1154000415498047164 using(v13);
create or replace TEMP view aggView8314612154977845010 as select v33, v10, v36 from semiDown7091384501183756960;
create or replace TEMP view aggJoin8840849416057106901 as select v38, v33, v10, v21, v22, v23, v36 from semiDown5104026816053488212 join aggView8314612154977845010 using(v33,v10);
create or replace TEMP view aggView832640268389627709 as select v10, v49, SUM(annot) as annot from aggJoin2706037821856067605 group by v10,v49;
create or replace TEMP view aggJoin3180663433105882754 as select v38, v33, v21, v22, v23, v36, v49, annot from aggJoin8840849416057106901 join aggView832640268389627709 using(v10);
create or replace TEMP view aggView1779210979253008426 as select v33 from semiDown7764446532073572720;
create or replace TEMP view aggJoin1918716225332482056 as select v38, v21, v22, v23, v36, v49, annot from aggJoin3180663433105882754 join aggView1779210979253008426 using(v33);
create or replace TEMP view aggView583431384851628174 as select v38, SUM((v22 * (1 - v23)) * annot) as v54, SUM((v36 * v21) * annot) as v55, v49, SUM(annot) as annot from aggJoin1918716225332482056 group by v38,v49;
create or replace TEMP view aggJoin1170755206706896231 as select v39, v54, v55, v49 from aggView2831339042758895556 join aggView583431384851628174 using(v38);
create or replace TEMP view res as select v49, v39, SUM(v54) as v54, SUM(v55) as v55 from aggJoin1170755206706896231 group by v49, v39;
select sum(v49+v39+v54+v55) from res;
