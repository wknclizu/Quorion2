create or replace TEMP view orderswithyearAux93 as select o_orderkey as v38, o_year as v39 from orderswithyear;
create or replace TEMP view nationAux13 as select n_nationkey as v13, n_name as v49 from nation;
create or replace TEMP view semiUp3182187538623043502 as select s_suppkey as v10, s_nationkey as v13 from supplier AS supplier where (s_nationkey) in (select v13 from nationAux13);
create or replace TEMP view semiUp5507865450004278164 as select ps_partkey as v33, ps_suppkey as v10, ps_supplycost as v36 from partsupp AS partsupp where (ps_partkey) in (select p_partkey from part AS part where (p_name LIKE '%green%'));
create or replace TEMP view semiUp4414248092037764363 as select l_orderkey as v38, l_partkey as v33, l_suppkey as v10, l_quantity as v21, l_extendedprice as v22, l_discount as v23 from lineitem AS lineitem where (l_suppkey, l_partkey) in (select v10, v33 from semiUp5507865450004278164);
create or replace TEMP view semiUp8115216757366403679 as select v38, v33, v10, v21, v22, v23 from semiUp4414248092037764363 where (v10) in (select v10 from semiUp3182187538623043502);
create or replace TEMP view semiUp5015078842645791297 as select v38, v39 from orderswithyearAux93 where (v38) in (select v38 from semiUp8115216757366403679);
create or replace TEMP view semiDown1520161616175788690 as select o_orderkey as v38, o_year as v39 from orderswithyear AS orderswithyear where (o_year, o_orderkey) in (select v39, v38 from semiUp5015078842645791297);
create or replace TEMP view semiDown3375935741771538298 as select v38, v33, v10, v21, v22, v23 from semiUp8115216757366403679 where (v38) in (select v38 from semiUp5015078842645791297);
create or replace TEMP view semiDown4198935920283743716 as select v10, v13 from semiUp3182187538623043502 where (v10) in (select v10 from semiDown3375935741771538298);
create or replace TEMP view semiDown8667058763601302659 as select v33, v10, v36 from semiUp5507865450004278164 where (v10, v33) in (select v10, v33 from semiDown3375935741771538298);
create or replace TEMP view semiDown7078202208440752843 as select v13, v49 from nationAux13 where (v13) in (select v13 from semiDown4198935920283743716);
create or replace TEMP view semiDown2965342774833443212 as select p_partkey as v33 from part AS part where (p_partkey) in (select v33 from semiDown8667058763601302659) and (p_name LIKE '%green%');
create or replace TEMP view semiDown1077138876153576090 as select n_nationkey as v13, n_name as v49 from nation AS nation where (n_nationkey, n_name) in (select v13, v49 from semiDown7078202208440752843);
create or replace TEMP view aggView1777681055223774740 as select v13, v49 from semiDown1077138876153576090;
create or replace TEMP view aggView2717739550987702152 as select v39, v38 from semiDown1520161616175788690;
create or replace TEMP view aggView8240543260790901412 as select v13, v49, COUNT(*) as annot from aggView1777681055223774740 group by v13,v49;
create or replace TEMP view aggJoin1809961045582597435 as select v10, v49, annot from semiDown4198935920283743716 join aggView8240543260790901412 using(v13);
create or replace TEMP view aggView8499641439078495036 as select v33 from semiDown2965342774833443212;
create or replace TEMP view aggJoin8439008409570150296 as select v33, v10, v36 from semiDown8667058763601302659 join aggView8499641439078495036 using(v33);
create or replace TEMP view aggView120742840159593688 as select v10, v33, SUM(v36)/COUNT(*) as v36, COUNT(*) as annot from aggJoin8439008409570150296 group by v10,v33;
create or replace TEMP view aggJoin5280667584069164173 as select v38, v10, v21, v22, v23, v36, annot from semiDown3375935741771538298 join aggView120742840159593688 using(v10,v33);
create or replace TEMP view aggView5908240992607388222 as select v10, v49, SUM(annot) as annot from aggJoin1809961045582597435 group by v10,v49;
create or replace TEMP view aggJoin4229699479194951231 as select v38, v21, v22, v23, v36, aggJoin5280667584069164173.annot * aggView5908240992607388222.annot as annot, v49 from aggJoin5280667584069164173 join aggView5908240992607388222 using(v10);
create or replace TEMP view aggView2152875796759803810 as select v38, SUM((v22 * (1 - v23)) * annot) as v54, SUM((v36 * v21) * annot) as v55, v49, SUM(annot) as annot from aggJoin4229699479194951231 group by v38,v49;
create or replace TEMP view aggJoin2364766961861200240 as select v39, v54, v55, v49 from aggView2717739550987702152 join aggView2152875796759803810 using(v38);
create or replace TEMP view res as select v49, v39, SUM(v54) as v54, SUM(v55) as v55 from aggJoin2364766961861200240 group by v49, v39;
select sum(v49+v39+v54+v55) from res;
