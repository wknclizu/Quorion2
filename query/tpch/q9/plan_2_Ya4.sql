create or replace TEMP view semiUp2977193457788425637 as select s_suppkey as v10, s_nationkey as v13 from supplier AS supplier where (s_nationkey) in (select n_nationkey from nation AS nation);
create or replace TEMP view semiUp2211669858426366541 as select ps_partkey as v33, ps_suppkey as v10, ps_supplycost as v36 from partsupp AS partsupp where (ps_partkey) in (select p_partkey from part AS part where (p_name LIKE '%green%'));
create or replace TEMP view semiUp8330935282065925800 as select l_orderkey as v38, l_partkey as v33, l_suppkey as v10, l_quantity as v21, l_extendedprice as v22, l_discount as v23 from lineitem AS lineitem where (l_orderkey) in (select o_orderkey from orderswithyear AS orderswithyear);
create or replace TEMP view semiUp256558273909105966 as select v38, v33, v10, v21, v22, v23 from semiUp8330935282065925800 where (v10, v33) in (select v10, v33 from semiUp2211669858426366541);
create or replace TEMP view semiUp3233981562886465475 as select v38, v33, v10, v21, v22, v23 from semiUp256558273909105966 where (v10) in (select v10 from semiUp2977193457788425637);
create or replace TEMP view semiDown6700224579711332040 as select v10, v13 from semiUp2977193457788425637 where (v10) in (select v10 from semiUp3233981562886465475);
create or replace TEMP view semiDown7033637270376149079 as select v33, v10, v36 from semiUp2211669858426366541 where (v10, v33) in (select v10, v33 from semiUp3233981562886465475);
create or replace TEMP view semiDown8750779016181727392 as select o_orderkey as v38, o_year as v39 from orderswithyear AS orderswithyear where (o_orderkey) in (select v38 from semiUp3233981562886465475);
create or replace TEMP view semiDown1873045937163727858 as select n_nationkey as v13, n_name as v49 from nation AS nation where (n_nationkey) in (select v13 from semiDown6700224579711332040);
create or replace TEMP view semiDown2955732509865823911 as select p_partkey as v33 from part AS part where (p_partkey) in (select v33 from semiDown7033637270376149079) and (p_name LIKE '%green%');
create or replace TEMP view aggView3653879477309028338 as select v13, v49 from semiDown1873045937163727858;
create or replace TEMP view aggJoin2568166189783406680 as select v10, v49 from semiDown6700224579711332040 join aggView3653879477309028338 using(v13);
create or replace TEMP view aggView6450954553313845495 as select v10, v49, COUNT(*) as annot from aggJoin2568166189783406680 group by v10,v49;
create or replace TEMP view aggJoin814593975743231427 as select v38, v33, v10, v21, v22, v23, v49, annot from semiUp3233981562886465475 join aggView6450954553313845495 using(v10);
create or replace TEMP view aggView8632816351014230905 as select v33 from semiDown2955732509865823911;
create or replace TEMP view aggJoin670576503903805166 as select v33, v10, v36 from semiDown7033637270376149079 join aggView8632816351014230905 using(v33);
create or replace TEMP view aggView4328339146849664497 as select v33, v10, SUM(v36)/COUNT(*) as v36, COUNT(*) as annot from aggJoin670576503903805166 group by v33,v10;
create or replace TEMP view aggJoin757526364451719170 as select v38, v21, v22, v23, v49, aggJoin814593975743231427.annot * aggView4328339146849664497.annot as annot, v36 from aggJoin814593975743231427 join aggView4328339146849664497 using(v33,v10);
create or replace TEMP view aggView9150088644110443894 as select v38, v39 from semiDown8750779016181727392;
create or replace TEMP view aggJoin1326384135943818313 as select v21, v22, v23, v49, annot, v36, v39 from aggJoin757526364451719170 join aggView9150088644110443894 using(v38);
create or replace TEMP view res as select v49, v39, SUM((v22 * (1 - v23))*annot) as v54, SUM((v36 * v21)*annot) as v55 from aggJoin1326384135943818313 group by v49, v39;
select sum(v49+v39+v54+v55) from res;
