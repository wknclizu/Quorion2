create or replace TEMP view semiUp3004531602672176762 as select ps_partkey as v33, ps_suppkey as v10, ps_supplycost as v36 from partsupp AS partsupp where (ps_partkey) in (select p_partkey from part AS part where (p_name LIKE '%green%'));
create or replace TEMP view semiUp8240192323946300923 as select s_suppkey as v10, s_nationkey as v13 from supplier AS supplier where (s_nationkey) in (select n_nationkey from nation AS nation);
create or replace TEMP view semiUp939633793062585850 as select v33, v10, v36 from semiUp3004531602672176762 where (v10) in (select v10 from semiUp8240192323946300923);
create or replace TEMP view semiUp3364032478898446198 as select l_orderkey as v38, l_partkey as v33, l_suppkey as v10, l_quantity as v21, l_extendedprice as v22, l_discount as v23 from lineitem AS lineitem where (l_orderkey) in (select o_orderkey from orderswithyear AS orderswithyear);
create or replace TEMP view semiUp4246242248628511232 as select v38, v33, v10, v21, v22, v23 from semiUp3364032478898446198 where (v10, v33) in (select v10, v33 from semiUp939633793062585850);
create or replace TEMP view semiDown1272400524539335279 as select v33, v10, v36 from semiUp939633793062585850 where (v10, v33) in (select v10, v33 from semiUp4246242248628511232);
create or replace TEMP view semiDown6232472370776992245 as select o_orderkey as v38, o_year as v39 from orderswithyear AS orderswithyear where (o_orderkey) in (select v38 from semiUp4246242248628511232);
create or replace TEMP view semiDown7314789653244526886 as select v10, v13 from semiUp8240192323946300923 where (v10) in (select v10 from semiDown1272400524539335279);
create or replace TEMP view semiDown3566651953865125320 as select p_partkey as v33 from part AS part where (p_partkey) in (select v33 from semiDown1272400524539335279) and (p_name LIKE '%green%');
create or replace TEMP view semiDown909274300654448278 as select n_nationkey as v13, n_name as v49 from nation AS nation where (n_nationkey) in (select v13 from semiDown7314789653244526886);
create or replace TEMP view aggView2640768548251715199 as select v38, v39 from semiDown6232472370776992245;
create or replace TEMP view aggJoin6109507579845299030 as select v33, v10, v21, v22, v23, v39 from semiUp4246242248628511232 join aggView2640768548251715199 using(v38);
create or replace TEMP view aggView8429338090690602764 as select v13, v49 from semiDown909274300654448278;
create or replace TEMP view aggJoin5991184131415380251 as select v10, v49 from semiDown7314789653244526886 join aggView8429338090690602764 using(v13);
create or replace TEMP view aggView5871157923526203961 as select v10, v49, COUNT(*) as annot from aggJoin5991184131415380251 group by v10,v49;
create or replace TEMP view aggJoin5609951128014207780 as select v33, v10, v36, v49, annot from semiDown1272400524539335279 join aggView5871157923526203961 using(v10);
create or replace TEMP view aggView6015060973117709295 as select v33 from semiDown3566651953865125320;
create or replace TEMP view aggJoin1178267280659787056 as select v33, v10, v36, v49, annot from aggJoin5609951128014207780 join aggView6015060973117709295 using(v33);
create or replace TEMP view aggView5439144818785504210 as select v10, v33, SUM(v36)/COUNT(*) as v36, v49, SUM(annot) as annot from aggJoin1178267280659787056 group by v10,v33,v49;
create or replace TEMP view aggJoin358491786375764296 as select v21, v22, v23, v39, v36, v49, annot from aggJoin6109507579845299030 join aggView5439144818785504210 using(v10,v33);
create or replace TEMP view res as select v49, v39, SUM((v22 * (1 - v23))*annot) as v54, SUM((v36 * v21)*annot) as v55 from aggJoin358491786375764296 group by v49, v39;
select sum(v49+v39+v54+v55) from res;
