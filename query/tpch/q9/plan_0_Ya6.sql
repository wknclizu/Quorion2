create or replace TEMP view semiUp5128923669679384430 as select l_orderkey as v38, l_partkey as v33, l_suppkey as v10, l_quantity as v21, l_extendedprice as v22, l_discount as v23 from lineitem AS lineitem where (l_orderkey) in (select o_orderkey from orderswithyear AS orderswithyear);
create or replace TEMP view semiUp6305126463964843649 as select v38, v33, v10, v21, v22, v23 from semiUp5128923669679384430 where (v33) in (select p_partkey from part AS part where (p_name LIKE '%green%'));
create or replace TEMP view semiUp1098631742139090426 as select s_suppkey as v10, s_nationkey as v13 from supplier AS supplier where (s_nationkey) in (select n_nationkey from nation AS nation);
create or replace TEMP view semiUp2564214203072932334 as select ps_partkey as v33, ps_suppkey as v10, ps_supplycost as v36 from partsupp AS partsupp where (ps_suppkey) in (select v10 from semiUp1098631742139090426);
create or replace TEMP view semiUp5568696732811547668 as select v38, v33, v10, v21, v22, v23 from semiUp6305126463964843649 where (v33, v10) in (select v33, v10 from semiUp2564214203072932334);
create or replace TEMP view semiDown1542275595452403478 as select p_partkey as v33 from part AS part where (p_partkey) in (select v33 from semiUp5568696732811547668) and (p_name LIKE '%green%');
create or replace TEMP view semiDown4730789486087640456 as select v33, v10, v36 from semiUp2564214203072932334 where (v33, v10) in (select v33, v10 from semiUp5568696732811547668);
create or replace TEMP view semiDown6435775063354121989 as select o_orderkey as v38, o_year as v39 from orderswithyear AS orderswithyear where (o_orderkey) in (select v38 from semiUp5568696732811547668);
create or replace TEMP view semiDown6885101770339889700 as select v10, v13 from semiUp1098631742139090426 where (v10) in (select v10 from semiDown4730789486087640456);
create or replace TEMP view semiDown9085351575288437746 as select n_nationkey as v13, n_name as v49 from nation AS nation where (n_nationkey) in (select v13 from semiDown6885101770339889700);
create or replace TEMP view aggView7404516150095662149 as select v13, v49 from semiDown9085351575288437746;
create or replace TEMP view aggJoin7145005253909200829 as select v10, v49 from semiDown6885101770339889700 join aggView7404516150095662149 using(v13);
create or replace TEMP view aggView600010458014624589 as select v38, v39 from semiDown6435775063354121989;
create or replace TEMP view aggJoin5258031520252787909 as select v33, v10, v21, v22, v23, v39 from semiUp5568696732811547668 join aggView600010458014624589 using(v38);
create or replace TEMP view aggView8215582395883910787 as select v10, v49, COUNT(*) as annot from aggJoin7145005253909200829 group by v10,v49;
create or replace TEMP view aggJoin5822278894892446504 as select v33, v10, v36, v49, annot from semiDown4730789486087640456 join aggView8215582395883910787 using(v10);
create or replace TEMP view aggView1275877821708927741 as select v33, v10, SUM(v36)/COUNT(*) as v36, v49, SUM(annot) as annot from aggJoin5822278894892446504 group by v33,v10,v49;
create or replace TEMP view aggJoin8253531848794397424 as select v33, v21, v22, v23, v39, v36, v49, annot from aggJoin5258031520252787909 join aggView1275877821708927741 using(v33,v10);
create or replace TEMP view aggView2157879793663975604 as select v33 from semiDown1542275595452403478;
create or replace TEMP view aggJoin8987983011112579879 as select v21, v22, v23, v39, v36, v49, annot from aggJoin8253531848794397424 join aggView2157879793663975604 using(v33);
create or replace TEMP view res as select v49, v39, SUM((v22 * (1 - v23))*annot) as v54, SUM((v36 * v21)*annot) as v55 from aggJoin8987983011112579879 group by v49, v39;
select sum(v49+v39+v54+v55) from res;
