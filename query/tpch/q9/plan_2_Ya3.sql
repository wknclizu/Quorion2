create or replace TEMP view nationAux100 as select n_nationkey as v13, n_name as v49 from nation;
create or replace TEMP view orderswithyearAux55 as select o_orderkey as v38, o_year as v39 from orderswithyear;
create or replace TEMP view semiUp8602351953921581626 as select l_orderkey as v38, l_partkey as v33, l_suppkey as v10, l_quantity as v21, l_extendedprice as v22, l_discount as v23 from lineitem AS lineitem where (l_partkey) in (select p_partkey from part AS part where (p_name LIKE '%green%'));
create or replace TEMP view semiUp1715462241673705184 as select s_suppkey as v10, s_nationkey as v13 from supplier AS supplier where (s_nationkey) in (select v13 from nationAux100);
create or replace TEMP view semiUp7592124346744383758 as select v38, v33, v10, v21, v22, v23 from semiUp8602351953921581626 where (v33, v10) in (select ps_partkey, ps_suppkey from partsupp AS partsupp);
create or replace TEMP view semiUp1976729061485129076 as select v38, v33, v10, v21, v22, v23 from semiUp7592124346744383758 where (v10) in (select v10 from semiUp1715462241673705184);
create or replace TEMP view semiUp7553752808307240404 as select v38, v39 from orderswithyearAux55 where (v38) in (select v38 from semiUp1976729061485129076);
create or replace TEMP view semiDown2204900965328343331 as select o_orderkey as v38, o_year as v39 from orderswithyear AS orderswithyear where (o_orderkey, o_year) in (select v38, v39 from semiUp7553752808307240404);
create or replace TEMP view semiDown1459551279368859733 as select v38, v33, v10, v21, v22, v23 from semiUp1976729061485129076 where (v38) in (select v38 from semiUp7553752808307240404);
create or replace TEMP view semiDown3457182619436457057 as select v10, v13 from semiUp1715462241673705184 where (v10) in (select v10 from semiDown1459551279368859733);
create or replace TEMP view semiDown8391164720918782757 as select p_partkey as v33 from part AS part where (p_partkey) in (select v33 from semiDown1459551279368859733) and (p_name LIKE '%green%');
create or replace TEMP view semiDown3436012278334864828 as select ps_partkey as v33, ps_suppkey as v10, ps_supplycost as v36 from partsupp AS partsupp where (ps_partkey, ps_suppkey) in (select v33, v10 from semiDown1459551279368859733);
create or replace TEMP view semiDown523392530134626894 as select v13, v49 from nationAux100 where (v13) in (select v13 from semiDown3457182619436457057);
create or replace TEMP view semiDown1671364452956484392 as select n_nationkey as v13, n_name as v49 from nation AS nation where (n_name, n_nationkey) in (select v49, v13 from semiDown523392530134626894);
create or replace TEMP view aggView3770736625995963082 as select v49, v13 from semiDown1671364452956484392;
create or replace TEMP view aggView141846285534998042 as select v38, v39 from semiDown2204900965328343331;
create or replace TEMP view aggView8052648153420387625 as select v13, v49, COUNT(*) as annot from aggView3770736625995963082 group by v13,v49;
create or replace TEMP view aggJoin6258572773884925181 as select v10, v49, annot from semiDown3457182619436457057 join aggView8052648153420387625 using(v13);
create or replace TEMP view aggView6089870781819593550 as select v10, v49, SUM(annot) as annot from aggJoin6258572773884925181 group by v10,v49;
create or replace TEMP view aggJoin5076064282932007810 as select v38, v33, v10, v21, v22, v23, v49, annot from semiDown1459551279368859733 join aggView6089870781819593550 using(v10);
create or replace TEMP view aggView6414809309268939703 as select v33, v10, v36 from semiDown3436012278334864828;
create or replace TEMP view aggJoin5441507956184417082 as select v38, v33, v21, v22, v23, v49, annot, v36 from aggJoin5076064282932007810 join aggView6414809309268939703 using(v33,v10);
create or replace TEMP view aggView8656938823547092668 as select v33 from semiDown8391164720918782757;
create or replace TEMP view aggJoin169387435755459867 as select v38, v21, v22, v23, v49, annot, v36 from aggJoin5441507956184417082 join aggView8656938823547092668 using(v33);
create or replace TEMP view aggView1526177286719691121 as select v38, SUM((v22 * (1 - v23)) * annot) as v54, SUM((v36 * v21) * annot) as v55, v49, SUM(annot) as annot from aggJoin169387435755459867 group by v38,v49;
create or replace TEMP view aggJoin6235938374410759138 as select v39, v54, v55, v49 from aggView141846285534998042 join aggView1526177286719691121 using(v38);
create or replace TEMP view res as select v49, v39, SUM(v54) as v54, SUM(v55) as v55 from aggJoin6235938374410759138 group by v49, v39;
select sum(v49+v39+v54+v55) from res;
