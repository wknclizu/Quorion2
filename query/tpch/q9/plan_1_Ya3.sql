create or replace TEMP view orderswithyearAux14 as select o_orderkey as v38, o_year as v39 from orderswithyear;
create or replace TEMP view nationAux44 as select n_nationkey as v13, n_name as v49 from nation;
create or replace TEMP view semiUp4446240566688306624 as select l_orderkey as v38, l_partkey as v33, l_suppkey as v10, l_quantity as v21, l_extendedprice as v22, l_discount as v23 from lineitem AS lineitem where (l_orderkey) in (select v38 from orderswithyearAux14);
create or replace TEMP view semiUp5084895440601876360 as select ps_partkey as v33, ps_suppkey as v10, ps_supplycost as v36 from partsupp AS partsupp where (ps_partkey) in (select p_partkey from part AS part where (p_name LIKE '%green%'));
create or replace TEMP view semiUp8464132579341286760 as select v38, v33, v10, v21, v22, v23 from semiUp4446240566688306624 where (v10, v33) in (select v10, v33 from semiUp5084895440601876360);
create or replace TEMP view semiUp2120022274059705189 as select s_suppkey as v10, s_nationkey as v13 from supplier AS supplier where (s_suppkey) in (select v10 from semiUp8464132579341286760);
create or replace TEMP view semiUp1781970110751002402 as select v13, v49 from nationAux44 where (v13) in (select v13 from semiUp2120022274059705189);
create or replace TEMP view semiDown3720931349318453552 as select n_nationkey as v13, n_name as v49 from nation AS nation where (n_nationkey, n_name) in (select v13, v49 from semiUp1781970110751002402);
create or replace TEMP view semiDown6104565325353605664 as select v10, v13 from semiUp2120022274059705189 where (v13) in (select v13 from semiUp1781970110751002402);
create or replace TEMP view semiDown1524768471100779119 as select v38, v33, v10, v21, v22, v23 from semiUp8464132579341286760 where (v10) in (select v10 from semiDown6104565325353605664);
create or replace TEMP view semiDown1332653846485223112 as select v38, v39 from orderswithyearAux14 where (v38) in (select v38 from semiDown1524768471100779119);
create or replace TEMP view semiDown6285890977697358695 as select v33, v10, v36 from semiUp5084895440601876360 where (v10, v33) in (select v10, v33 from semiDown1524768471100779119);
create or replace TEMP view semiDown6546778189287889828 as select o_orderkey as v38, o_year as v39 from orderswithyear AS orderswithyear where (o_orderkey, o_year) in (select v38, v39 from semiDown1332653846485223112);
create or replace TEMP view semiDown4438509665063131023 as select p_partkey as v33 from part AS part where (p_partkey) in (select v33 from semiDown6285890977697358695) and (p_name LIKE '%green%');
create or replace TEMP view aggView6614054135085623335 as select v38, v39 from semiDown6546778189287889828;
create or replace TEMP view aggView1586075881161019592 as select v13, v49 from semiDown3720931349318453552;
create or replace TEMP view aggView1160885767240735080 as select v33 from semiDown4438509665063131023;
create or replace TEMP view aggJoin5076559278055680441 as select v33, v10, v36 from semiDown6285890977697358695 join aggView1160885767240735080 using(v33);
create or replace TEMP view aggView2200067178666034341 as select v10, v33, SUM(v36)/COUNT(*) as v36, COUNT(*) as annot from aggJoin5076559278055680441 group by v10,v33;
create or replace TEMP view aggJoin4701924751448292393 as select v38, v10, v21, v22, v23, v36, annot from semiDown1524768471100779119 join aggView2200067178666034341 using(v10,v33);
create or replace TEMP view aggView658975382126295577 as select v38, v39, COUNT(*) as annot from aggView6614054135085623335 group by v38,v39;
create or replace TEMP view aggJoin6906486262132990803 as select v10, v21, v22, v23, v36, aggJoin4701924751448292393.annot * aggView658975382126295577.annot as annot, v39 from aggJoin4701924751448292393 join aggView658975382126295577 using(v38);
create or replace TEMP view aggView2279680830200238039 as select v10, SUM((v22 * (1 - v23)) * annot) as v54, SUM((v36 * v21) * annot) as v55, v39, SUM(annot) as annot from aggJoin6906486262132990803 group by v10,v39;
create or replace TEMP view aggJoin7763995201383071569 as select v13, v54, v55, v39, annot from semiDown6104565325353605664 join aggView2279680830200238039 using(v10);
create or replace TEMP view aggView5993786853830615174 as select v13, SUM(v54) as v54, SUM(v55) as v55, v39, SUM(annot) as annot from aggJoin7763995201383071569 group by v13,v54,v55,v39;
create or replace TEMP view aggJoin3155597119883860421 as select v49, v54, v55, v39 from aggView1586075881161019592 join aggView5993786853830615174 using(v13);
create or replace TEMP view res as select v49, v39, SUM(v54) as v54, SUM(v55) as v55 from aggJoin3155597119883860421 group by v49, v39;
select sum(v49+v39+v54+v55) from res;
