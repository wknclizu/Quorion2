create or replace TEMP view nationAux35 as select n_nationkey as v13, n_name as v49 from nation;
create or replace TEMP view orderswithyearAux55 as select o_orderkey as v38, o_year as v39 from orderswithyear;
create or replace TEMP view semiUp8373313788521565639 as select l_orderkey as v38, l_partkey as v33, l_suppkey as v10, l_quantity as v21, l_extendedprice as v22, l_discount as v23 from lineitem AS lineitem where (l_orderkey) in (select v38 from orderswithyearAux55);
create or replace TEMP view semiUp3648749641746384731 as select v38, v33, v10, v21, v22, v23 from semiUp8373313788521565639 where (v33) in (select p_partkey from part AS part where (p_name LIKE '%green%'));
create or replace TEMP view semiUp5263340268467114692 as select v38, v33, v10, v21, v22, v23 from semiUp3648749641746384731 where (v33, v10) in (select ps_partkey, ps_suppkey from partsupp AS partsupp);
create or replace TEMP view semiUp3984969409836905489 as select s_suppkey as v10, s_nationkey as v13 from supplier AS supplier where (s_suppkey) in (select v10 from semiUp5263340268467114692);
create or replace TEMP view semiUp5460509840511643785 as select v13, v49 from nationAux35 where (v13) in (select v13 from semiUp3984969409836905489);
create or replace TEMP view semiDown7000780501876224530 as select n_nationkey as v13, n_name as v49 from nation AS nation where (n_name, n_nationkey) in (select v49, v13 from semiUp5460509840511643785);
create or replace TEMP view semiDown7245967689740893509 as select v10, v13 from semiUp3984969409836905489 where (v13) in (select v13 from semiUp5460509840511643785);
create or replace TEMP view semiDown421503434588163520 as select v38, v33, v10, v21, v22, v23 from semiUp5263340268467114692 where (v10) in (select v10 from semiDown7245967689740893509);
create or replace TEMP view semiDown1654365709961936808 as select v38, v39 from orderswithyearAux55 where (v38) in (select v38 from semiDown421503434588163520);
create or replace TEMP view semiDown1955457363157864679 as select p_partkey as v33 from part AS part where (p_partkey) in (select v33 from semiDown421503434588163520) and (p_name LIKE '%green%');
create or replace TEMP view semiDown8653167035265780310 as select ps_partkey as v33, ps_suppkey as v10, ps_supplycost as v36 from partsupp AS partsupp where (ps_partkey, ps_suppkey) in (select v33, v10 from semiDown421503434588163520);
create or replace TEMP view semiDown976507644418481294 as select o_orderkey as v38, o_year as v39 from orderswithyear AS orderswithyear where (o_orderkey, o_year) in (select v38, v39 from semiDown1654365709961936808);
create or replace TEMP view aggView845715387512457573 as select v38, v39 from semiDown976507644418481294;
create or replace TEMP view aggView7499845623966065517 as select v49, v13 from semiDown7000780501876224530;
create or replace TEMP view aggView3881907020115176505 as select v33, v10, v36 from semiDown8653167035265780310;
create or replace TEMP view aggJoin6266363391558648494 as select v38, v33, v10, v21, v22, v23, v36 from semiDown421503434588163520 join aggView3881907020115176505 using(v33,v10);
create or replace TEMP view aggView9142942967814563169 as select v38, v39, COUNT(*) as annot from aggView845715387512457573 group by v38,v39;
create or replace TEMP view aggJoin6744020704281022761 as select v33, v10, v21, v22, v23, v36, v39, annot from aggJoin6266363391558648494 join aggView9142942967814563169 using(v38);
create or replace TEMP view aggView5668228121660946943 as select v33 from semiDown1955457363157864679;
create or replace TEMP view aggJoin7769126948204573424 as select v10, v21, v22, v23, v36, v39, annot from aggJoin6744020704281022761 join aggView5668228121660946943 using(v33);
create or replace TEMP view aggView4831230937084876112 as select v10, SUM((v22 * (1 - v23)) * annot) as v54, SUM((v36 * v21) * annot) as v55, v39, SUM(annot) as annot from aggJoin7769126948204573424 group by v10,v39;
create or replace TEMP view aggJoin4165999771340341465 as select v13, v54, v55, v39, annot from semiDown7245967689740893509 join aggView4831230937084876112 using(v10);
create or replace TEMP view aggView6671007045493618767 as select v13, SUM(v54) as v54, SUM(v55) as v55, v39, SUM(annot) as annot from aggJoin4165999771340341465 group by v13,v39,v54,v55;
create or replace TEMP view aggJoin2054930426687365424 as select v49, v54, v55, v39 from aggView7499845623966065517 join aggView6671007045493618767 using(v13);
create or replace TEMP view res as select v49, v39, SUM(v54) as v54, SUM(v55) as v55 from aggJoin2054930426687365424 group by v49, v39;
select sum(v49+v39+v54+v55) from res;
