create or replace TEMP view semiUp3213665391407070165 as select s_suppkey as v10, s_nationkey as v13 from supplier AS supplier where (s_nationkey) in (select n_nationkey from nation AS nation);
create or replace TEMP view semiUp1037389337405660609 as select l_orderkey as v38, l_partkey as v33, l_suppkey as v10, l_quantity as v21, l_extendedprice as v22, l_discount as v23 from lineitem AS lineitem where (l_orderkey) in (select o_orderkey from orderswithyear AS orderswithyear);
create or replace TEMP view semiUp5940574800312912131 as select v38, v33, v10, v21, v22, v23 from semiUp1037389337405660609 where (v10) in (select v10 from semiUp3213665391407070165);
create or replace TEMP view semiUp8722662308405502943 as select v38, v33, v10, v21, v22, v23 from semiUp5940574800312912131 where (v10, v33) in (select ps_suppkey, ps_partkey from partsupp AS partsupp);
create or replace TEMP view semiUp5189768147425358144 as select v38, v33, v10, v21, v22, v23 from semiUp8722662308405502943 where (v33) in (select p_partkey from part AS part where (p_name LIKE '%green%'));
create or replace TEMP view semiDown324926491845174635 as select v10, v13 from semiUp3213665391407070165 where (v10) in (select v10 from semiUp5189768147425358144);
create or replace TEMP view semiDown815484092317407444 as select p_partkey as v33 from part AS part where (p_partkey) in (select v33 from semiUp5189768147425358144) and (p_name LIKE '%green%');
create or replace TEMP view semiDown485554402373060781 as select ps_partkey as v33, ps_suppkey as v10, ps_supplycost as v36 from partsupp AS partsupp where (ps_suppkey, ps_partkey) in (select v10, v33 from semiUp5189768147425358144);
create or replace TEMP view semiDown5893682914404165375 as select o_orderkey as v38, o_year as v39 from orderswithyear AS orderswithyear where (o_orderkey) in (select v38 from semiUp5189768147425358144);
create or replace TEMP view semiDown2337044750321869720 as select n_nationkey as v13, n_name as v49 from nation AS nation where (n_nationkey) in (select v13 from semiDown324926491845174635);
create or replace TEMP view aggView403251760923634250 as select v13, v49 from semiDown2337044750321869720;
create or replace TEMP view aggJoin5981246011717799372 as select v10, v49 from semiDown324926491845174635 join aggView403251760923634250 using(v13);
create or replace TEMP view aggView8957961499561986219 as select v38, v39 from semiDown5893682914404165375;
create or replace TEMP view aggJoin6154943895830579982 as select v33, v10, v21, v22, v23, v39 from semiUp5189768147425358144 join aggView8957961499561986219 using(v38);
create or replace TEMP view aggView4194283611074542111 as select v10, v33, v36 from semiDown485554402373060781;
create or replace TEMP view aggJoin8806462275094292688 as select v33, v10, v21, v22, v23, v39, v36 from aggJoin6154943895830579982 join aggView4194283611074542111 using(v10,v33);
create or replace TEMP view aggView4679986003825741384 as select v33 from semiDown815484092317407444;
create or replace TEMP view aggJoin3213701242728152396 as select v10, v21, v22, v23, v39, v36 from aggJoin8806462275094292688 join aggView4679986003825741384 using(v33);
create or replace TEMP view aggView5645077631132159611 as select v10, v49, COUNT(*) as annot from aggJoin5981246011717799372 group by v10,v49;
create or replace TEMP view aggJoin5056768507501671711 as select v21, v22, v23, v39, v36, v49, annot from aggJoin3213701242728152396 join aggView5645077631132159611 using(v10);
create or replace TEMP view res as select v49, v39, SUM((v22 * (1 - v23))*annot) as v54, SUM((v36 * v21)*annot) as v55 from aggJoin5056768507501671711 group by v49, v39;
select sum(v49+v39+v54+v55) from res;
