create or replace TEMP view customerAux92 as select c_custkey as v1, c_name as v2, c_address as v3, c_nationkey as v4, c_phone as v5, c_acctbal as v6, c_comment as v8 from customer;
create or replace TEMP view nationAux78 as select n_nationkey as v4, n_name as v35 from nation;
create or replace TEMP view semiUp2824376080912943476 as select o_orderkey as v18, o_custkey as v1 from orders AS orders where (o_orderkey) in (select l_orderkey from lineitem AS lineitem where (l_returnflag = 'R')) and (o_orderdate >= DATE '1993-09-30') and (o_orderdate < DATE '1993-12-31');
create or replace TEMP view semiUp6951164346876057092 as select v1, v2, v3, v4, v5, v6, v8 from customerAux92 where (v1) in (select v1 from semiUp2824376080912943476);
create or replace TEMP view semiUp3399816706685144869 as select v4, v35 from nationAux78 where (v4) in (select v4 from semiUp6951164346876057092);
create or replace TEMP view semiDown6056148983799056553 as select v1, v2, v3, v4, v5, v6, v8 from semiUp6951164346876057092 where (v4) in (select v4 from semiUp3399816706685144869);
create or replace TEMP view semiDown2883096792151400842 as select n_nationkey as v4, n_name as v35 from nation AS nation where (n_nationkey, n_name) in (select v4, v35 from semiUp3399816706685144869);
create or replace TEMP view semiDown7134839179880436364 as select v18, v1 from semiUp2824376080912943476 where (v1) in (select v1 from semiDown6056148983799056553);
create or replace TEMP view semiDown7132432415383726551 as select c_custkey as v1, c_name as v2, c_address as v3, c_nationkey as v4, c_phone as v5, c_acctbal as v6, c_comment as v8 from customer AS customer where (c_address, c_nationkey, c_custkey, c_name, c_comment, c_phone, c_acctbal) in (select v3, v4, v1, v2, v8, v5, v6 from semiDown6056148983799056553);
create or replace TEMP view semiDown8226177432015290604 as select l_orderkey as v18, l_extendedprice as v23, l_discount as v24 from lineitem AS lineitem where (l_orderkey) in (select v18 from semiDown7134839179880436364) and (l_returnflag = 'R');
create or replace TEMP view aggView9104425438536209479 as select v3, v4, v1, v2, v8, v5, v6 from semiDown7132432415383726551;
create or replace TEMP view aggView8814034114091221649 as select v4, v35 from semiDown2883096792151400842;
create or replace TEMP view aggView1596382997475287988 as select v18, SUM(v23 * (1 - v24)) as v39, COUNT(*) as annot from semiDown8226177432015290604 group by v18;
create or replace TEMP view aggJoin9167988285895066072 as select v1, v39, annot from semiDown7134839179880436364 join aggView1596382997475287988 using(v18);
create or replace TEMP view aggView8538622017217305353 as select v1, SUM(v39) as v39, SUM(annot) as annot from aggJoin9167988285895066072 group by v1,v39;
create or replace TEMP view aggJoin626980550949119605 as select v3, v4, v1, v2, v8, v5, v6, v39, annot from aggView9104425438536209479 join aggView8538622017217305353 using(v1);
create or replace TEMP view aggView5788590068248126658 as select v4, SUM(v39) as v39, v3, v1, v2, v8, v5, v6, SUM(annot) as annot from aggJoin626980550949119605 group by v4,v3,v1,v2,v8,v39,v5,v6;
create or replace TEMP view aggJoin4779779288312662318 as select v35, v39, v3, v1, v2, v8, v5, v6 from aggView8814034114091221649 join aggView5788590068248126658 using(v4);
create or replace TEMP view res as select v1, v2, SUM(v39) as v39, v6, v35, v3, v5, v8 from aggJoin4779779288312662318 group by v1, v2, v6, v5, v35, v3, v8;
select sum(v1+v2+v39+v6+v35+v3+v5+v8) from res;
