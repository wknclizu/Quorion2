create or replace TEMP view customerAux37 as select c_custkey as v1, c_name as v2, c_address as v3, c_nationkey as v4, c_phone as v5, c_acctbal as v6, c_comment as v8 from customer;
create or replace TEMP view nationAux30 as select n_nationkey as v4, n_name as v35 from nation;
create or replace TEMP view semiUp7265660937671684106 as select v1, v2, v3, v4, v5, v6, v8 from customerAux37 where (v4) in (select v4 from nationAux30);
create or replace TEMP view semiUp2932137443210190624 as select o_orderkey as v18, o_custkey as v1 from orders AS orders where (o_orderkey) in (select l_orderkey from lineitem AS lineitem where (l_returnflag = 'R')) and (o_orderdate >= DATE '1993-09-30') and (o_orderdate < DATE '1993-12-31');
create or replace TEMP view semiUp522023903310114202 as select v1, v2, v3, v4, v5, v6, v8 from semiUp7265660937671684106 where (v1) in (select v1 from semiUp2932137443210190624);
create or replace TEMP view semiDown2148613762264104825 as select v4, v35 from nationAux30 where (v4) in (select v4 from semiUp522023903310114202);
create or replace TEMP view semiDown6783745480652214513 as select v18, v1 from semiUp2932137443210190624 where (v1) in (select v1 from semiUp522023903310114202);
create or replace TEMP view semiDown4141590072252757228 as select c_custkey as v1, c_name as v2, c_address as v3, c_nationkey as v4, c_phone as v5, c_acctbal as v6, c_comment as v8 from customer AS customer where (c_nationkey, c_comment, c_address, c_phone, c_name, c_custkey, c_acctbal) in (select v4, v8, v3, v5, v2, v1, v6 from semiUp522023903310114202);
create or replace TEMP view semiDown2056384652142223064 as select n_nationkey as v4, n_name as v35 from nation AS nation where (n_nationkey, n_name) in (select v4, v35 from semiDown2148613762264104825);
create or replace TEMP view semiDown1864150843714892671 as select l_orderkey as v18, l_extendedprice as v23, l_discount as v24 from lineitem AS lineitem where (l_orderkey) in (select v18 from semiDown6783745480652214513) and (l_returnflag = 'R');
create or replace TEMP view aggView2120500350010355567 as select v4, v35 from semiDown2056384652142223064;
create or replace TEMP view aggView6170754614793062278 as select v4, v5, v3, v8, v2, v1, v6 from semiDown4141590072252757228;
create or replace TEMP view aggView6134167308288196315 as select v18, SUM(v23 * (1 - v24)) as v39, COUNT(*) as annot from semiDown1864150843714892671 group by v18;
create or replace TEMP view aggJoin8750488883188036884 as select v1, v39, annot from semiDown6783745480652214513 join aggView6134167308288196315 using(v18);
create or replace TEMP view aggView7724917467522362851 as select v4, v35, COUNT(*) as annot from aggView2120500350010355567 group by v4,v35;
create or replace TEMP view aggJoin7875321223138510282 as select v5, v3, v8, v2, v1, v6, v35, annot from aggView6170754614793062278 join aggView7724917467522362851 using(v4);
create or replace TEMP view aggView4842386926069806355 as select v1, SUM(v39) as v39, SUM(annot) as annot from aggJoin8750488883188036884 group by v1,v39;
create or replace TEMP view aggJoin809007104479599588 as select v5, v3, v8, v2, v1, v6, v35, v39 * aggJoin7875321223138510282.annot as v39 from aggJoin7875321223138510282 join aggView4842386926069806355 using(v1);
create or replace TEMP view res as select v1, v2, SUM(v39) as v39, v6, v35, v3, v5, v8 from aggJoin809007104479599588 group by v1, v2, v6, v5, v35, v3, v8;
select sum(v1+v2+v39+v6+v35+v3+v5+v8) from res;
