create or replace TEMP view nationAux52 as select n_nationkey as v4, n_name as v35 from nation;
create or replace TEMP view customerAux84 as select c_custkey as v1, c_name as v2, c_address as v3, c_nationkey as v4, c_phone as v5, c_acctbal as v6, c_comment as v8 from customer;
create or replace TEMP view semiUp3179772933852161551 as select o_orderkey as v18, o_custkey as v1 from orders AS orders where (o_orderkey) in (select l_orderkey from lineitem AS lineitem where (l_returnflag = 'R')) and (o_orderdate >= DATE '1993-09-30') and (o_orderdate < DATE '1993-12-31');
create or replace TEMP view semiUp3489706815933935508 as select v1, v2, v3, v4, v5, v6, v8 from customerAux84 where (v1) in (select v1 from semiUp3179772933852161551);
create or replace TEMP view semiUp6442561187561294472 as select v4, v35 from nationAux52 where (v4) in (select v4 from semiUp3489706815933935508);
create or replace TEMP view semiDown7617537043605485223 as select v1, v2, v3, v4, v5, v6, v8 from semiUp3489706815933935508 where (v4) in (select v4 from semiUp6442561187561294472);
create or replace TEMP view semiDown7174586241833766254 as select n_nationkey as v4, n_name as v35 from nation AS nation where (n_name, n_nationkey) in (select v35, v4 from semiUp6442561187561294472);
create or replace TEMP view semiDown5093693696982036174 as select v18, v1 from semiUp3179772933852161551 where (v1) in (select v1 from semiDown7617537043605485223);
create or replace TEMP view semiDown2808083903250414371 as select c_custkey as v1, c_name as v2, c_address as v3, c_nationkey as v4, c_phone as v5, c_acctbal as v6, c_comment as v8 from customer AS customer where (c_nationkey, c_acctbal, c_comment, c_address, c_custkey, c_name, c_phone) in (select v4, v6, v8, v3, v1, v2, v5 from semiDown7617537043605485223);
create or replace TEMP view semiDown1632495113161604859 as select l_orderkey as v18, l_extendedprice as v23, l_discount as v24 from lineitem AS lineitem where (l_orderkey) in (select v18 from semiDown5093693696982036174) and (l_returnflag = 'R');
create or replace TEMP view aggView2278536182841494000 as select v4, v6, v8, v3, v1, v2, v5 from semiDown2808083903250414371;
create or replace TEMP view aggView6043524190943780736 as select v35, v4 from semiDown7174586241833766254;
create or replace TEMP view aggView9053842003709153381 as select v18, SUM(v23 * (1 - v24)) as v39, COUNT(*) as annot from semiDown1632495113161604859 group by v18;
create or replace TEMP view aggJoin480340330577308979 as select v1, v39, annot from semiDown5093693696982036174 join aggView9053842003709153381 using(v18);
create or replace TEMP view aggView6599034103271081813 as select v1, SUM(v39) as v39, SUM(annot) as annot from aggJoin480340330577308979 group by v1,v39;
create or replace TEMP view aggJoin6234104287492065762 as select v4, v6, v8, v3, v1, v2, v5, v39, annot from aggView2278536182841494000 join aggView6599034103271081813 using(v1);
create or replace TEMP view aggView9043939141801400045 as select v4, SUM(v39) as v39, v6, v8, v3, v1, v5, v2, SUM(annot) as annot from aggJoin6234104287492065762 group by v4,v6,v8,v3,v1,v39,v5,v2;
create or replace TEMP view aggJoin6422397152041634315 as select v35, v39, v6, v8, v3, v1, v5, v2 from aggView6043524190943780736 join aggView9043939141801400045 using(v4);
create or replace TEMP view res as select v1, v2, SUM(v39) as v39, v6, v35, v3, v5, v8 from aggJoin6422397152041634315 group by v1, v2, v6, v5, v35, v3, v8;
select sum(v1+v2+v39+v6+v35+v3+v5+v8) from res;
