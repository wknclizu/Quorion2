create or replace TEMP view customerAux20 as select c_custkey as v1, c_name as v2, c_address as v3, c_nationkey as v4, c_phone as v5, c_acctbal as v6, c_comment as v8 from customer;
create or replace TEMP view nationAux87 as select n_nationkey as v4, n_name as v35 from nation;
create or replace TEMP view semiUp3816000364777210263 as select o_orderkey as v18, o_custkey as v1 from orders AS orders where (o_orderkey) in (select l_orderkey from lineitem AS lineitem where (l_returnflag = 'R')) and (o_orderdate >= DATE '1993-09-30') and (o_orderdate < DATE '1993-12-31');
create or replace TEMP view semiUp2996750737276033923 as select v1, v2, v3, v4, v5, v6, v8 from customerAux20 where (v1) in (select v1 from semiUp3816000364777210263);
create or replace TEMP view semiUp6369437002871220882 as select v4, v35 from nationAux87 where (v4) in (select v4 from semiUp2996750737276033923);
create or replace TEMP view semiDown5125835909815765544 as select v1, v2, v3, v4, v5, v6, v8 from semiUp2996750737276033923 where (v4) in (select v4 from semiUp6369437002871220882);
create or replace TEMP view semiDown5151043004945191192 as select n_nationkey as v4, n_name as v35 from nation AS nation where (n_name, n_nationkey) in (select v35, v4 from semiUp6369437002871220882);
create or replace TEMP view semiDown4786966788460667201 as select v18, v1 from semiUp3816000364777210263 where (v1) in (select v1 from semiDown5125835909815765544);
create or replace TEMP view semiDown5083769070056583321 as select c_custkey as v1, c_name as v2, c_address as v3, c_nationkey as v4, c_phone as v5, c_acctbal as v6, c_comment as v8 from customer AS customer where (c_custkey, c_comment, c_name, c_address, c_acctbal, c_phone, c_nationkey) in (select v1, v8, v2, v3, v6, v5, v4 from semiDown5125835909815765544);
create or replace TEMP view semiDown4533768593120170841 as select l_orderkey as v18, l_extendedprice as v23, l_discount as v24 from lineitem AS lineitem where (l_orderkey) in (select v18 from semiDown4786966788460667201) and (l_returnflag = 'R');
create or replace TEMP view aggView5262353967382855798 as select v1, v8, v2, v3, v6, v5, v4 from semiDown5083769070056583321;
create or replace TEMP view aggView8754720239565756513 as select v35, v4 from semiDown5151043004945191192;
create or replace TEMP view aggView5807593142580380100 as select v18, SUM(v23 * (1 - v24)) as v39, COUNT(*) as annot from semiDown4533768593120170841 group by v18;
create or replace TEMP view aggJoin8334985931566144153 as select v1, v39, annot from semiDown4786966788460667201 join aggView5807593142580380100 using(v18);
create or replace TEMP view aggView8425850718014706347 as select v1, SUM(v39) as v39, SUM(annot) as annot from aggJoin8334985931566144153 group by v1,v39;
create or replace TEMP view aggJoin8872497476455633839 as select v1, v8, v2, v3, v6, v5, v4, v39, annot from aggView5262353967382855798 join aggView8425850718014706347 using(v1);
create or replace TEMP view aggView79697061631103278 as select v4, SUM(v39) as v39, v1, v8, v2, v3, v6, v5, SUM(annot) as annot from aggJoin8872497476455633839 group by v4,v1,v8,v2,v3,v6,v39,v5;
create or replace TEMP view aggJoin1783378476639830564 as select v35, v39, v1, v8, v2, v3, v6, v5 from aggView8754720239565756513 join aggView79697061631103278 using(v4);
create or replace TEMP view res as select v1, v2, SUM(v39) as v39, v6, v35, v3, v5, v8 from aggJoin1783378476639830564 group by v1, v2, v6, v5, v35, v3, v8;
select sum(v1+v2+v39+v6+v35+v3+v5+v8) from res;
