create or replace TEMP view customerAux37 as select c_custkey as v1, c_name as v2, c_address as v3, c_nationkey as v4, c_phone as v5, c_acctbal as v6, c_comment as v8 from customer;
create or replace TEMP view nationAux68 as select n_nationkey as v4, n_name as v35 from nation;
create or replace TEMP view semiUp2346655396905535215 as select o_orderkey as v18, o_custkey as v1 from orders AS orders where (o_orderkey) in (select l_orderkey from lineitem AS lineitem where (l_returnflag = 'R')) and (o_orderdate >= DATE '1993-09-30') and (o_orderdate < DATE '1993-12-31');
create or replace TEMP view semiUp6656675294752612075 as select v1, v2, v3, v4, v5, v6, v8 from customerAux37 where (v1) in (select v1 from semiUp2346655396905535215);
create or replace TEMP view semiUp6807342554290100261 as select v4, v35 from nationAux68 where (v4) in (select v4 from semiUp6656675294752612075);
create or replace TEMP view semiDown4805235938959889435 as select v1, v2, v3, v4, v5, v6, v8 from semiUp6656675294752612075 where (v4) in (select v4 from semiUp6807342554290100261);
create or replace TEMP view semiDown5555792064729046781 as select n_nationkey as v4, n_name as v35 from nation AS nation where (n_name, n_nationkey) in (select v35, v4 from semiUp6807342554290100261);
create or replace TEMP view semiDown3075452523929249251 as select v18, v1 from semiUp2346655396905535215 where (v1) in (select v1 from semiDown4805235938959889435);
create or replace TEMP view semiDown7143914125662624387 as select c_custkey as v1, c_name as v2, c_address as v3, c_nationkey as v4, c_phone as v5, c_acctbal as v6, c_comment as v8 from customer AS customer where (c_acctbal, c_nationkey, c_phone, c_custkey, c_name, c_comment, c_address) in (select v6, v4, v5, v1, v2, v8, v3 from semiDown4805235938959889435);
create or replace TEMP view semiDown8601417433057172723 as select l_orderkey as v18, l_extendedprice as v23, l_discount as v24 from lineitem AS lineitem where (l_orderkey) in (select v18 from semiDown3075452523929249251) and (l_returnflag = 'R');
create or replace TEMP view aggView6296861845750422489 as select v6, v4, v5, v1, v2, v8, v3 from semiDown7143914125662624387;
create or replace TEMP view aggView1273381936359075159 as select v35, v4 from semiDown5555792064729046781;
create or replace TEMP view aggView763827991998250775 as select v18, SUM(v23 * (1 - v24)) as v39, COUNT(*) as annot from semiDown8601417433057172723 group by v18;
create or replace TEMP view aggJoin868642542723706729 as select v1, v39, annot from semiDown3075452523929249251 join aggView763827991998250775 using(v18);
create or replace TEMP view aggView438939842001578995 as select v1, SUM(v39) as v39, SUM(annot) as annot from aggJoin868642542723706729 group by v1,v39;
create or replace TEMP view aggJoin735904245847183755 as select v6, v4, v5, v1, v2, v8, v3, v39, annot from aggView6296861845750422489 join aggView438939842001578995 using(v1);
create or replace TEMP view aggView4425481414594374133 as select v4, SUM(v39) as v39, v6, v5, v1, v2, v8, v3, SUM(annot) as annot from aggJoin735904245847183755 group by v4,v6,v5,v1,v2,v39,v8,v3;
create or replace TEMP view aggJoin1085491235115746002 as select v35, v39, v6, v5, v1, v2, v8, v3 from aggView1273381936359075159 join aggView4425481414594374133 using(v4);
create or replace TEMP view res as select v1, v2, SUM(v39) as v39, v6, v35, v3, v5, v8 from aggJoin1085491235115746002 group by v1, v2, v6, v5, v35, v3, v8;
select sum(v1+v2+v39+v6+v35+v3+v5+v8) from res;
