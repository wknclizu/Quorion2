create or replace TEMP view customerAux62 as select c_custkey as v1, c_name as v2, c_address as v3, c_nationkey as v4, c_phone as v5, c_acctbal as v6, c_comment as v8 from customer;
create or replace TEMP view nationAux79 as select n_nationkey as v4, n_name as v35 from nation;
create or replace TEMP view semiUp7084945713389467582 as select o_orderkey as v18, o_custkey as v1 from orders AS orders where (o_orderkey) in (select l_orderkey from lineitem AS lineitem where (l_returnflag = 'R')) and (o_orderdate >= DATE '1993-09-30') and (o_orderdate < DATE '1993-12-31');
create or replace TEMP view semiUp4186384978722281182 as select v1, v2, v3, v4, v5, v6, v8 from customerAux62 where (v1) in (select v1 from semiUp7084945713389467582);
create or replace TEMP view semiUp498398677515244858 as select v4, v35 from nationAux79 where (v4) in (select v4 from semiUp4186384978722281182);
create or replace TEMP view semiDown2616994154818563888 as select v1, v2, v3, v4, v5, v6, v8 from semiUp4186384978722281182 where (v4) in (select v4 from semiUp498398677515244858);
create or replace TEMP view semiDown896190747302529868 as select n_nationkey as v4, n_name as v35 from nation AS nation where (n_nationkey, n_name) in (select v4, v35 from semiUp498398677515244858);
create or replace TEMP view semiDown1744543289211216092 as select v18, v1 from semiUp7084945713389467582 where (v1) in (select v1 from semiDown2616994154818563888);
create or replace TEMP view semiDown9119400661614517073 as select c_custkey as v1, c_name as v2, c_address as v3, c_nationkey as v4, c_phone as v5, c_acctbal as v6, c_comment as v8 from customer AS customer where (c_custkey, c_comment, c_acctbal, c_name, c_phone, c_address, c_nationkey) in (select v1, v8, v6, v2, v5, v3, v4 from semiDown2616994154818563888);
create or replace TEMP view semiDown7148406988707412971 as select l_orderkey as v18, l_extendedprice as v23, l_discount as v24 from lineitem AS lineitem where (l_orderkey) in (select v18 from semiDown1744543289211216092) and (l_returnflag = 'R');
create or replace TEMP view aggView6861932690354835497 as select v1, v8, v6, v2, v5, v3, v4 from semiDown9119400661614517073;
create or replace TEMP view aggView5576591609920952514 as select v4, v35 from semiDown896190747302529868;
create or replace TEMP view aggView2456597628738043123 as select v18, SUM(v23 * (1 - v24)) as v39, COUNT(*) as annot from semiDown7148406988707412971 group by v18;
create or replace TEMP view aggJoin1288121415524493967 as select v1, v39, annot from semiDown1744543289211216092 join aggView2456597628738043123 using(v18);
create or replace TEMP view aggView727579940608132655 as select v1, SUM(v39) as v39, SUM(annot) as annot from aggJoin1288121415524493967 group by v1,v39;
create or replace TEMP view aggJoin2324832504317532726 as select v1, v8, v6, v2, v5, v3, v4, v39, annot from aggView6861932690354835497 join aggView727579940608132655 using(v1);
create or replace TEMP view aggView5055582478822427637 as select v4, SUM(v39) as v39, v1, v8, v6, v2, v5, v3, SUM(annot) as annot from aggJoin2324832504317532726 group by v4,v1,v8,v6,v39,v2,v5,v3;
create or replace TEMP view aggJoin6198441675002699589 as select v35, v39, v1, v8, v6, v2, v5, v3 from aggView5576591609920952514 join aggView5055582478822427637 using(v4);
create or replace TEMP view res as select v1, v2, SUM(v39) as v39, v6, v35, v3, v5, v8 from aggJoin6198441675002699589 group by v1, v2, v6, v5, v35, v3, v8;
select sum(v1+v2+v39+v6+v35+v3+v5+v8) from res;
