create or replace TEMP view semiUp3744642438509821039 as select o_orderkey as v18, o_custkey as v1 from orders AS orders where (o_orderkey) in (select l_orderkey from lineitem AS lineitem where (l_returnflag = 'R')) and (o_orderdate >= DATE '1993-09-30') and (o_orderdate < DATE '1993-12-31');
create or replace TEMP view semiUp7277399892669153781 as select c_custkey as v1, c_name as v2, c_address as v3, c_nationkey as v4, c_phone as v5, c_acctbal as v6, c_comment as v8 from customer AS customer where (c_nationkey) in (select n_nationkey from nation AS nation);
create or replace TEMP view semiUp3708633572476377588 as select v18, v1 from semiUp3744642438509821039 where (v1) in (select v1 from semiUp7277399892669153781);
create or replace TEMP view semiDown5786619688960895473 as select v1, v2, v3, v4, v5, v6, v8 from semiUp7277399892669153781 where (v1) in (select v1 from semiUp3708633572476377588);
create or replace TEMP view semiDown2213127320265199139 as select l_orderkey as v18, l_extendedprice as v23, l_discount as v24 from lineitem AS lineitem where (l_orderkey) in (select v18 from semiUp3708633572476377588) and (l_returnflag = 'R');
create or replace TEMP view semiDown8603208600153979727 as select n_nationkey as v4, n_name as v35 from nation AS nation where (n_nationkey) in (select v4 from semiDown5786619688960895473);
create or replace TEMP view aggView5188534132962306347 as select v4, v35 from semiDown8603208600153979727;
create or replace TEMP view aggJoin621887583158661363 as select v1, v2, v3, v5, v6, v8, v35 from semiDown5786619688960895473 join aggView5188534132962306347 using(v4);
create or replace TEMP view aggView6898297284649471153 as select v18, SUM(v23 * (1 - v24)) as v39, COUNT(*) as annot from semiDown2213127320265199139 group by v18;
create or replace TEMP view aggJoin4881437802295358920 as select v1, v39, annot from semiUp3708633572476377588 join aggView6898297284649471153 using(v18);
create or replace TEMP view aggView7272230749812737590 as select v1, v5, v8, v6, v35, v2, v3, COUNT(*) as annot from aggJoin621887583158661363 group by v1,v5,v8,v6,v35,v2,v3;
create or replace TEMP view aggJoin6747910201715849264 as select v1, v39*aggView7272230749812737590.annot as v39, v5, v8, v6, v35, v2, v3 from aggJoin4881437802295358920 join aggView7272230749812737590 using(v1);
create or replace TEMP view res as select v1, v2, SUM(v39) as v39, v6, v35, v3, v5, v8 from aggJoin6747910201715849264 group by v1, v2, v6, v5, v35, v3, v8;
select sum(v1+v2+v39+v6+v35+v3+v5+v8) from res;
