create or replace TEMP view customerAux24 as select c_custkey as v1, c_name as v2, c_address as v3, c_nationkey as v4, c_phone as v5, c_acctbal as v6, c_comment as v8 from customer;
create or replace TEMP view nationAux52 as select n_nationkey as v4, n_name as v35 from nation;
create or replace TEMP view semiUp8532273631307655641 as select o_orderkey as v18, o_custkey as v1 from orders AS orders where (o_orderkey) in (select l_orderkey from lineitem AS lineitem where (l_returnflag = 'R')) and (o_orderdate >= DATE '1993-09-30') and (o_orderdate < DATE '1993-12-31');
create or replace TEMP view semiUp6569224757144856372 as select v1, v2, v3, v4, v5, v6, v8 from customerAux24 where (v1) in (select v1 from semiUp8532273631307655641);
create or replace TEMP view semiUp5135268296048952325 as select v4, v35 from nationAux52 where (v4) in (select v4 from semiUp6569224757144856372);
create or replace TEMP view semiDown5415498576216484820 as select v1, v2, v3, v4, v5, v6, v8 from semiUp6569224757144856372 where (v4) in (select v4 from semiUp5135268296048952325);
create or replace TEMP view semiDown5295380988288321823 as select n_nationkey as v4, n_name as v35 from nation AS nation where (n_nationkey, n_name) in (select v4, v35 from semiUp5135268296048952325);
create or replace TEMP view semiDown1651783644639642357 as select v18, v1 from semiUp8532273631307655641 where (v1) in (select v1 from semiDown5415498576216484820);
create or replace TEMP view semiDown1758786098561533410 as select c_custkey as v1, c_name as v2, c_address as v3, c_nationkey as v4, c_phone as v5, c_acctbal as v6, c_comment as v8 from customer AS customer where (c_comment, c_name, c_address, c_nationkey, c_phone, c_acctbal, c_custkey) in (select v8, v2, v3, v4, v5, v6, v1 from semiDown5415498576216484820);
create or replace TEMP view semiDown2189557869543665732 as select l_orderkey as v18, l_extendedprice as v23, l_discount as v24 from lineitem AS lineitem where (l_orderkey) in (select v18 from semiDown1651783644639642357) and (l_returnflag = 'R');
create or replace TEMP view aggView2065099510626543386 as select v2, v8, v3, v4, v5, v6, v1 from semiDown1758786098561533410;
create or replace TEMP view aggView2057360986953424981 as select v4, v35 from semiDown5295380988288321823;
create or replace TEMP view aggView6620848308716307104 as select v18, SUM(v23 * (1 - v24)) as v39, COUNT(*) as annot from semiDown2189557869543665732 group by v18;
create or replace TEMP view aggJoin7290672238386454817 as select v1, v39, annot from semiDown1651783644639642357 join aggView6620848308716307104 using(v18);
create or replace TEMP view aggView5533114917085164246 as select v1, SUM(v39) as v39, SUM(annot) as annot from aggJoin7290672238386454817 group by v1,v39;
create or replace TEMP view aggJoin1902316906844861491 as select v2, v8, v3, v4, v5, v6, v1, v39, annot from aggView2065099510626543386 join aggView5533114917085164246 using(v1);
create or replace TEMP view aggView1177954487195688461 as select v4, SUM(v39) as v39, v8, v2, v3, v5, v6, v1, SUM(annot) as annot from aggJoin1902316906844861491 group by v4,v8,v2,v39,v3,v5,v6,v1;
create or replace TEMP view aggJoin8938435959295422435 as select v35, v39, v8, v2, v3, v5, v6, v1 from aggView2057360986953424981 join aggView1177954487195688461 using(v4);
create or replace TEMP view res as select v1, v2, SUM(v39) as v39, v6, v35, v3, v5, v8 from aggJoin8938435959295422435 group by v1, v2, v6, v5, v35, v3, v8;
select sum(v1+v2+v39+v6+v35+v3+v5+v8) from res;
