create or replace TEMP view customerAux64 as select c_custkey as v1, c_name as v2, c_address as v3, c_nationkey as v4, c_phone as v5, c_acctbal as v6, c_comment as v8 from customer;
create or replace TEMP view nationAux65 as select n_nationkey as v4, n_name as v35 from nation;
create or replace TEMP view semiUp3405137349948883025 as select o_orderkey as v18, o_custkey as v1 from orders AS orders where (o_orderkey) in (select l_orderkey from lineitem AS lineitem where (l_returnflag = 'R')) and (o_orderdate >= DATE '1993-09-30') and (o_orderdate < DATE '1993-12-31');
create or replace TEMP view semiUp5161092781944645301 as select v1, v2, v3, v4, v5, v6, v8 from customerAux64 where (v1) in (select v1 from semiUp3405137349948883025);
create or replace TEMP view semiUp8949284721107254715 as select v4, v35 from nationAux65 where (v4) in (select v4 from semiUp5161092781944645301);
create or replace TEMP view semiDown1539891904175434235 as select v1, v2, v3, v4, v5, v6, v8 from semiUp5161092781944645301 where (v4) in (select v4 from semiUp8949284721107254715);
create or replace TEMP view semiDown6234010907864274184 as select n_nationkey as v4, n_name as v35 from nation AS nation where (n_name, n_nationkey) in (select v35, v4 from semiUp8949284721107254715);
create or replace TEMP view semiDown3450920736290420213 as select v18, v1 from semiUp3405137349948883025 where (v1) in (select v1 from semiDown1539891904175434235);
create or replace TEMP view semiDown3941364790343071598 as select c_custkey as v1, c_name as v2, c_address as v3, c_nationkey as v4, c_phone as v5, c_acctbal as v6, c_comment as v8 from customer AS customer where (c_nationkey, c_name, c_custkey, c_acctbal, c_phone, c_address, c_comment) in (select v4, v2, v1, v6, v5, v3, v8 from semiDown1539891904175434235);
create or replace TEMP view semiDown3031548451764184052 as select l_orderkey as v18, l_extendedprice as v23, l_discount as v24 from lineitem AS lineitem where (l_orderkey) in (select v18 from semiDown3450920736290420213) and (l_returnflag = 'R');
create or replace TEMP view aggView4851823797374371191 as select v4, v2, v1, v6, v5, v3, v8 from semiDown3941364790343071598;
create or replace TEMP view aggView7749544422102024004 as select v35, v4 from semiDown6234010907864274184;
create or replace TEMP view aggView4227466901122662466 as select v18, SUM(v23 * (1 - v24)) as v39, COUNT(*) as annot from semiDown3031548451764184052 group by v18;
create or replace TEMP view aggJoin1560396015063385594 as select v1, v39, annot from semiDown3450920736290420213 join aggView4227466901122662466 using(v18);
create or replace TEMP view aggView2077686576595369031 as select v1, SUM(v39) as v39, SUM(annot) as annot from aggJoin1560396015063385594 group by v1,v39;
create or replace TEMP view aggJoin7011538811512741263 as select v4, v2, v1, v6, v5, v3, v8, v39, annot from aggView4851823797374371191 join aggView2077686576595369031 using(v1);
create or replace TEMP view aggView2712317265728667806 as select v4, SUM(v39) as v39, v2, v1, v6, v5, v3, v8, SUM(annot) as annot from aggJoin7011538811512741263 group by v4,v2,v1,v6,v5,v39,v3,v8;
create or replace TEMP view aggJoin7438494905009044824 as select v35, v39, v2, v1, v6, v5, v3, v8 from aggView7749544422102024004 join aggView2712317265728667806 using(v4);
create or replace TEMP view res as select v1, v2, SUM(v39) as v39, v6, v35, v3, v5, v8 from aggJoin7438494905009044824 group by v1, v2, v6, v5, v35, v3, v8;
select sum(v1+v2+v39+v6+v35+v3+v5+v8) from res;
