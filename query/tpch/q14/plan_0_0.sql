create or replace TEMP view aggView1821215727117368924 as select p_partkey as v2, CASE WHEN p_type LIKE 'PROMO%' THEN 1 ELSE 0 END as caseCond from part as part;
create or replace TEMP view aggJoin7061695225860784264 as select l_extendedprice as v6, l_discount as v7, l_shipdate as v11, caseCond from lineitem as lineitem, aggView1821215727117368924 where lineitem.l_partkey=aggView1821215727117368924.v2 and (l_shipdate >= DATE '1995-08-31') and (l_shipdate < DATE '1995-09-30');
create or replace TEMP view res as select ((100.0 * SUM( CASE WHEN caseCond = 1 THEN v6 * (1 - v7) ELSE 0.0 END)) / SUM((v6 * (1 - v7)))) as v30 from aggJoin7061695225860784264;
select sum(v30) from res;