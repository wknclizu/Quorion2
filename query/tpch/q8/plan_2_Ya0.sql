create or replace TEMP view semiUp7602058091376129091 as select s_suppkey as v10, s_nationkey as v13 from supplier AS supplier where (s_nationkey) in (select n_nationkey from nation AS n2);
create or replace TEMP view semiUp3989155754347311232 as select n_nationkey as v46, n_regionkey as v53 from nation AS n1 where (n_regionkey) in (select r_regionkey from region AS region where (r_name = 'AMERICA'));
create or replace TEMP view semiUp1600223944142069792 as select l_orderkey as v17, l_partkey as v1, l_suppkey as v10, l_extendedprice as v22, l_discount as v23 from lineitem AS lineitem where (l_suppkey) in (select v10 from semiUp7602058091376129091);
create or replace TEMP view semiUp8511589720000699155 as select v17, v1, v10, v22, v23 from semiUp1600223944142069792 where (v1) in (select p_partkey from part AS part where (p_type = 'ECONOMY ANODIZED STEEL'));
create or replace TEMP view semiUp2726781658100708041 as select o_orderkey as v17, o_year as v34, o_custkey as v35 from orderswithyear AS orderswithyear where (o_orderkey) in (select v17 from semiUp8511589720000699155) and (o_orderdate >= DATE '1994-12-31') and (o_orderdate <= DATE '1996-12-30');
create or replace TEMP view semiUp1274940424500745644 as select c_custkey as v35, c_nationkey as v46 from customer AS customer where (c_custkey) in (select v35 from semiUp2726781658100708041);
create or replace TEMP view semiUp1318493979094851144 as select v46, v53 from semiUp3989155754347311232 where (v46) in (select v46 from semiUp1274940424500745644);
create or replace TEMP view semiDown6784928390006213342 as select r_regionkey as v53 from region AS region where (r_regionkey) in (select v53 from semiUp1318493979094851144) and (r_name = 'AMERICA');
create or replace TEMP view semiDown4903706000363092204 as select v35, v46 from semiUp1274940424500745644 where (v46) in (select v46 from semiUp1318493979094851144);
create or replace TEMP view semiDown3012962939331373061 as select v17, v34, v35 from semiUp2726781658100708041 where (v35) in (select v35 from semiDown4903706000363092204);
create or replace TEMP view semiDown5637515313158860052 as select v17, v1, v10, v22, v23 from semiUp8511589720000699155 where (v17) in (select v17 from semiDown3012962939331373061);
create or replace TEMP view semiDown995631747518278995 as select p_partkey as v1 from part AS part where (p_partkey) in (select v1 from semiDown5637515313158860052) and (p_type = 'ECONOMY ANODIZED STEEL');
create or replace TEMP view semiDown9003655890007926334 as select v10, v13 from semiUp7602058091376129091 where (v10) in (select v10 from semiDown5637515313158860052);
create or replace TEMP view semiDown2903030970493894259 as select n_nationkey as v13, n_name as v56 from nation AS n2 where (n_nationkey) in (select v13 from semiDown9003655890007926334);
create or replace TEMP view aggView5577381344257221640 as select v13, CASE WHEN v56 = 'BRAZIL' THEN 1 ELSE 0 END as caseCond from semiDown2903030970493894259;
create or replace TEMP view aggJoin9035462758267192300 as select v10, caseCond from semiDown9003655890007926334 join aggView5577381344257221640 using(v13);
create or replace TEMP view aggView6842690470830195174 as select v10, caseCond, COUNT(*) as annot from aggJoin9035462758267192300 group by v10,caseCond;
create or replace TEMP view aggJoin3375809062208202017 as select v17, v1, v22, v23, caseCond, annot from semiDown5637515313158860052 join aggView6842690470830195174 using(v10);
create or replace TEMP view aggView3929820155516706305 as select v53 from semiDown6784928390006213342;
create or replace TEMP view aggJoin8626348236497538200 as select v46 from semiUp1318493979094851144 join aggView3929820155516706305 using(v53);
create or replace TEMP view aggView4523343828228531718 as select v1 from semiDown995631747518278995;
create or replace TEMP view aggJoin2338023682105800726 as select v17, v22, v23, caseCond, annot from aggJoin3375809062208202017 join aggView4523343828228531718 using(v1);
create or replace TEMP view aggView9038974731403621733 as select v17, SUM( CASE WHEN caseCond = 1 THEN v22 * (1 - v23)*annot ELSE 0.0 END) as v64, SUM((v22 * (1 - v23)) * annot) as v65, SUM(annot) as annot from aggJoin2338023682105800726 group by v17;
create or replace TEMP view aggJoin6617192054091764363 as select v34, v35, v64, v65, annot from semiDown3012962939331373061 join aggView9038974731403621733 using(v17);
create or replace TEMP view aggView4280294621074450837 as select v35, SUM(v64) as v64, SUM(v65) as v65, v34, SUM(annot) as annot from aggJoin6617192054091764363 group by v35,v34;
create or replace TEMP view aggJoin5552933795093148767 as select v46, v64, v65, v34, annot from semiDown4903706000363092204 join aggView4280294621074450837 using(v35);
create or replace TEMP view aggView1884330791922057730 as select v46, SUM(v64) as v64, SUM(v65) as v65, v34, SUM(annot) as annot from aggJoin5552933795093148767 group by v46,v34;
create or replace TEMP view aggJoin7959088815213316124 as select v64, v65, v34 from aggJoin8626348236497538200 join aggView1884330791922057730 using(v46);
create or replace TEMP view res as select v34, (SUM(v66) as  / SUM(v66) as ) as v66 from aggJoin7959088815213316124 group by v34;
select sum(v34+ / SUM(v66)) from res;
