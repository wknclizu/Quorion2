create or replace TEMP view semiUp1087805320792091055 as select l_orderkey as v17, l_partkey as v1, l_suppkey as v10, l_extendedprice as v22, l_discount as v23 from lineitem AS lineitem where (l_partkey) in (select p_partkey from part AS part where (p_type = 'ECONOMY ANODIZED STEEL'));
create or replace TEMP view semiUp4500144745209233791 as select s_suppkey as v10, s_nationkey as v13 from supplier AS supplier where (s_nationkey) in (select n_nationkey from nation AS n2);
create or replace TEMP view semiUp273039416543228535 as select v17, v1, v10, v22, v23 from semiUp1087805320792091055 where (v10) in (select v10 from semiUp4500144745209233791);
create or replace TEMP view semiUp430659124823348566 as select o_orderkey as v17, o_year as v34, o_custkey as v35 from orderswithyear AS orderswithyear where (o_orderkey) in (select v17 from semiUp273039416543228535) and (o_orderdate >= DATE '1994-12-31') and (o_orderdate <= DATE '1996-12-30');
create or replace TEMP view semiUp33406623571148672 as select c_custkey as v35, c_nationkey as v46 from customer AS customer where (c_custkey) in (select v35 from semiUp430659124823348566);
create or replace TEMP view semiUp2995179559453458654 as select n_nationkey as v46, n_regionkey as v53 from nation AS n1 where (n_nationkey) in (select v46 from semiUp33406623571148672);
create or replace TEMP view semiUp9040614413749287216 as select r_regionkey as v53 from region AS region where (r_regionkey) in (select v53 from semiUp2995179559453458654) and (r_name = 'AMERICA');
create or replace TEMP view semiDown6927389086259882399 as select v46, v53 from semiUp2995179559453458654 where (v53) in (select v53 from semiUp9040614413749287216);
create or replace TEMP view semiDown6619150200692775772 as select v35, v46 from semiUp33406623571148672 where (v46) in (select v46 from semiDown6927389086259882399);
create or replace TEMP view semiDown3579776798414551014 as select v17, v34, v35 from semiUp430659124823348566 where (v35) in (select v35 from semiDown6619150200692775772);
create or replace TEMP view semiDown4828552726712346365 as select v17, v1, v10, v22, v23 from semiUp273039416543228535 where (v17) in (select v17 from semiDown3579776798414551014);
create or replace TEMP view semiDown1987724371391198139 as select p_partkey as v1 from part AS part where (p_partkey) in (select v1 from semiDown4828552726712346365) and (p_type = 'ECONOMY ANODIZED STEEL');
create or replace TEMP view semiDown6037399450855298852 as select v10, v13 from semiUp4500144745209233791 where (v10) in (select v10 from semiDown4828552726712346365);
create or replace TEMP view semiDown1195501546679296649 as select n_nationkey as v13, n_name as v56 from nation AS n2 where (n_nationkey) in (select v13 from semiDown6037399450855298852);
create or replace TEMP view aggView8197641497513212201 as select v13, CASE WHEN v56 = 'BRAZIL' THEN 1 ELSE 0 END as caseCond from semiDown1195501546679296649;
create or replace TEMP view aggJoin2724013397518652713 as select v10, caseCond from semiDown6037399450855298852 join aggView8197641497513212201 using(v13);
create or replace TEMP view aggView8850180474787622479 as select v10, caseCond, COUNT(*) as annot from aggJoin2724013397518652713 group by v10,caseCond;
create or replace TEMP view aggJoin4143171145561517782 as select v17, v1, v22, v23, caseCond, annot from semiDown4828552726712346365 join aggView8850180474787622479 using(v10);
create or replace TEMP view aggView2090074705250130409 as select v1 from semiDown1987724371391198139;
create or replace TEMP view aggJoin1626892310855662516 as select v17, v22, v23, caseCond, annot from aggJoin4143171145561517782 join aggView2090074705250130409 using(v1);
create or replace TEMP view aggView3254008994777815742 as select v17, SUM( CASE WHEN caseCond = 1 THEN v22 * (1 - v23)*annot ELSE 0.0 END) as v64, SUM((v22 * (1 - v23)) * annot) as v65, SUM(annot) as annot from aggJoin1626892310855662516 group by v17;
create or replace TEMP view aggJoin7493347017151901940 as select v34, v35, v64, v65, annot from semiDown3579776798414551014 join aggView3254008994777815742 using(v17);
create or replace TEMP view aggView8605786232061686667 as select v35, SUM(v64) as v64, SUM(v65) as v65, v34, SUM(annot) as annot from aggJoin7493347017151901940 group by v35,v34;
create or replace TEMP view aggJoin8697268695545941673 as select v46, v64, v65, v34, annot from semiDown6619150200692775772 join aggView8605786232061686667 using(v35);
create or replace TEMP view aggView1216822352788241983 as select v46, SUM(v64) as v64, SUM(v65) as v65, v34, SUM(annot) as annot from aggJoin8697268695545941673 group by v46,v34;
create or replace TEMP view aggJoin1327369706306234802 as select v53, v64, v65, v34, annot from semiDown6927389086259882399 join aggView1216822352788241983 using(v46);
create or replace TEMP view aggView9223337633636941914 as select v53, SUM(v64) as v64, SUM(v65) as v65, v34, SUM(annot) as annot from aggJoin1327369706306234802 group by v53,v34;
create or replace TEMP view aggJoin7315413713851726385 as select v64, v65, v34 from semiUp9040614413749287216 join aggView9223337633636941914 using(v53);
create or replace TEMP view res as select v34, (SUM(v66) as  / SUM(v66) as ) as v66 from aggJoin7315413713851726385 group by v34;
select sum(v34+ / SUM(v66)) from res;
