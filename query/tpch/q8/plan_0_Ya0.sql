create or replace TEMP view semiUp2765856763674115282 as select l_orderkey as v17, l_partkey as v1, l_suppkey as v10, l_extendedprice as v22, l_discount as v23 from lineitem AS lineitem where (l_partkey) in (select p_partkey from part AS part where (p_type = 'ECONOMY ANODIZED STEEL'));
create or replace TEMP view semiUp7064805138687473266 as select n_nationkey as v46, n_regionkey as v53 from nation AS n1 where (n_regionkey) in (select r_regionkey from region AS region where (r_name = 'AMERICA'));
create or replace TEMP view semiUp7176356967391409691 as select s_suppkey as v10, s_nationkey as v13 from supplier AS supplier where (s_nationkey) in (select n_nationkey from nation AS n2);
create or replace TEMP view semiUp1552083610483475797 as select v17, v1, v10, v22, v23 from semiUp2765856763674115282 where (v10) in (select v10 from semiUp7176356967391409691);
create or replace TEMP view semiUp5911807521405743599 as select o_orderkey as v17, o_year as v34, o_custkey as v35 from orderswithyear AS orderswithyear where (o_orderkey) in (select v17 from semiUp1552083610483475797) and (o_orderdate >= DATE '1994-12-31') and (o_orderdate <= DATE '1996-12-30');
create or replace TEMP view semiUp7148780279800754967 as select c_custkey as v35, c_nationkey as v46 from customer AS customer where (c_nationkey) in (select v46 from semiUp7064805138687473266);
create or replace TEMP view semiUp1089406720817509487 as select v17, v34, v35 from semiUp5911807521405743599 where (v35) in (select v35 from semiUp7148780279800754967);
create or replace TEMP view orderswithyearAux10 as select v34 from semiUp1089406720817509487;
create or replace TEMP view semiDown8221338732638685859 as select v17, v34, v35 from semiUp1089406720817509487 where (v34) in (select v34 from orderswithyearAux10);
create or replace TEMP view semiDown9061237363034976820 as select v35, v46 from semiUp7148780279800754967 where (v35) in (select v35 from semiDown8221338732638685859);
create or replace TEMP view semiDown574764170687866913 as select v17, v1, v10, v22, v23 from semiUp1552083610483475797 where (v17) in (select v17 from semiDown8221338732638685859);
create or replace TEMP view semiDown8637898519522102821 as select v46, v53 from semiUp7064805138687473266 where (v46) in (select v46 from semiDown9061237363034976820);
create or replace TEMP view semiDown970619196969696801 as select p_partkey as v1 from part AS part where (p_partkey) in (select v1 from semiDown574764170687866913) and (p_type = 'ECONOMY ANODIZED STEEL');
create or replace TEMP view semiDown8746215178352005163 as select v10, v13 from semiUp7176356967391409691 where (v10) in (select v10 from semiDown574764170687866913);
create or replace TEMP view semiDown6208446373209630582 as select r_regionkey as v53 from region AS region where (r_regionkey) in (select v53 from semiDown8637898519522102821) and (r_name = 'AMERICA');
create or replace TEMP view semiDown1538672055851674289 as select n_nationkey as v13, n_name as v56 from nation AS n2 where (n_nationkey) in (select v13 from semiDown8746215178352005163);
create or replace TEMP view aggView6537729831988092158 as select v53 from semiDown6208446373209630582;
create or replace TEMP view aggJoin2981609724804178308 as select v46 from semiDown8637898519522102821 join aggView6537729831988092158 using(v53);
create or replace TEMP view aggView5807480237244909301 as select v13, CASE WHEN v56 = 'BRAZIL' THEN 1 ELSE 0 END as caseCond from semiDown1538672055851674289;
create or replace TEMP view aggJoin5278501119838022172 as select v10, caseCond from semiDown8746215178352005163 join aggView5807480237244909301 using(v13);
create or replace TEMP view aggView1692984542949647165 as select v10, caseCond, COUNT(*) as annot from aggJoin5278501119838022172 group by v10,caseCond;
create or replace TEMP view aggJoin6813691860018625736 as select v17, v1, v22, v23, caseCond, annot from semiDown574764170687866913 join aggView1692984542949647165 using(v10);
create or replace TEMP view aggView7481616316455608413 as select v46, COUNT(*) as annot from aggJoin2981609724804178308 group by v46;
create or replace TEMP view aggJoin2287242751567982017 as select v35, annot from semiDown9061237363034976820 join aggView7481616316455608413 using(v46);
create or replace TEMP view aggView4458350059240152981 as select v1 from semiDown970619196969696801;
create or replace TEMP view aggJoin3495842008332091627 as select v17, v22, v23, caseCond, annot from aggJoin6813691860018625736 join aggView4458350059240152981 using(v1);
create or replace TEMP view aggView5694867148589669050 as select v17, SUM( CASE WHEN caseCond = 1 THEN v22 * (1 - v23)*annot ELSE 0.0 END) as v64, SUM((v22 * (1 - v23)) * annot) as v65, SUM(annot) as annot from aggJoin3495842008332091627 group by v17;
create or replace TEMP view aggJoin2529541361594169661 as select v34, v35, v64, v65, annot from semiDown8221338732638685859 join aggView5694867148589669050 using(v17);
create or replace TEMP view aggView8561435279398083185 as select v35, SUM(annot) as annot from aggJoin2287242751567982017 group by v35;
create or replace TEMP view aggJoin7489818545984744644 as select v34, v64*aggView8561435279398083185.annot as v64, v65*aggView8561435279398083185.annot as v65, aggJoin2529541361594169661.annot * aggView8561435279398083185.annot as annot from aggJoin2529541361594169661 join aggView8561435279398083185 using(v35);
create or replace TEMP view aggView8159066753486561056 as select v34, SUM(v64) as v64, SUM(v65) as v65, SUM(annot) as annot from aggJoin7489818545984744644 group by v34;
create or replace TEMP view res as select v34, (SUM(v66) as  / SUM(v66) as ) as v66 from aggView8159066753486561056 group by v34;
select sum(v34+ / SUM(v66)) from res;
