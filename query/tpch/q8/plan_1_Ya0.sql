create or replace TEMP view semiUp69615569662882335 as select n_nationkey as v46, n_regionkey as v53 from nation AS n1 where (n_regionkey) in (select r_regionkey from region AS region where (r_name = 'AMERICA'));
create or replace TEMP view semiUp1349086174789731440 as select l_orderkey as v17, l_partkey as v1, l_suppkey as v10, l_extendedprice as v22, l_discount as v23 from lineitem AS lineitem where (l_partkey) in (select p_partkey from part AS part where (p_type = 'ECONOMY ANODIZED STEEL'));
create or replace TEMP view semiUp4799226749874827648 as select s_suppkey as v10, s_nationkey as v13 from supplier AS supplier where (s_nationkey) in (select n_nationkey from nation AS n2);
create or replace TEMP view semiUp731054249126965837 as select c_custkey as v35, c_nationkey as v46 from customer AS customer where (c_nationkey) in (select v46 from semiUp69615569662882335);
create or replace TEMP view semiUp4199707968842963558 as select o_orderkey as v17, o_year as v34, o_custkey as v35 from orderswithyear AS orderswithyear where (o_custkey) in (select v35 from semiUp731054249126965837) and (o_orderdate >= DATE '1994-12-31') and (o_orderdate <= DATE '1996-12-30');
create or replace TEMP view semiUp5039071223661696051 as select v17, v1, v10, v22, v23 from semiUp1349086174789731440 where (v10) in (select v10 from semiUp4799226749874827648);
create or replace TEMP view semiUp2457509366366880902 as select v17, v34, v35 from semiUp4199707968842963558 where (v17) in (select v17 from semiUp5039071223661696051);
create or replace TEMP view orderswithyearAux66 as select v34 from semiUp2457509366366880902;
create or replace TEMP view semiDown8517495980003822778 as select v17, v34, v35 from semiUp2457509366366880902 where (v34) in (select v34 from orderswithyearAux66);
create or replace TEMP view semiDown2345957124654375103 as select v35, v46 from semiUp731054249126965837 where (v35) in (select v35 from semiDown8517495980003822778);
create or replace TEMP view semiDown4140219279805590512 as select v17, v1, v10, v22, v23 from semiUp5039071223661696051 where (v17) in (select v17 from semiDown8517495980003822778);
create or replace TEMP view semiDown4903221194075605530 as select v46, v53 from semiUp69615569662882335 where (v46) in (select v46 from semiDown2345957124654375103);
create or replace TEMP view semiDown15829128052498173 as select p_partkey as v1 from part AS part where (p_partkey) in (select v1 from semiDown4140219279805590512) and (p_type = 'ECONOMY ANODIZED STEEL');
create or replace TEMP view semiDown6802022656416263709 as select v10, v13 from semiUp4799226749874827648 where (v10) in (select v10 from semiDown4140219279805590512);
create or replace TEMP view semiDown3633962268941812659 as select r_regionkey as v53 from region AS region where (r_regionkey) in (select v53 from semiDown4903221194075605530) and (r_name = 'AMERICA');
create or replace TEMP view semiDown7028651836200770550 as select n_nationkey as v13, n_name as v56 from nation AS n2 where (n_nationkey) in (select v13 from semiDown6802022656416263709);
create or replace TEMP view aggView2540191352637234193 as select v53 from semiDown3633962268941812659;
create or replace TEMP view aggJoin1257062324879888789 as select v46 from semiDown4903221194075605530 join aggView2540191352637234193 using(v53);
create or replace TEMP view aggView7883972000713839285 as select v13, CASE WHEN v56 = 'BRAZIL' THEN 1 ELSE 0 END as caseCond from semiDown7028651836200770550;
create or replace TEMP view aggJoin2455609978655880801 as select v10, caseCond from semiDown6802022656416263709 join aggView7883972000713839285 using(v13);
create or replace TEMP view aggView3799850234565520420 as select v46, COUNT(*) as annot from aggJoin1257062324879888789 group by v46;
create or replace TEMP view aggJoin2896025735935997764 as select v35, annot from semiDown2345957124654375103 join aggView3799850234565520420 using(v46);
create or replace TEMP view aggView4453826366694618754 as select v10, caseCond, COUNT(*) as annot from aggJoin2455609978655880801 group by v10,caseCond;
create or replace TEMP view aggJoin1926173896631686530 as select v17, v1, v22, v23, caseCond, annot from semiDown4140219279805590512 join aggView4453826366694618754 using(v10);
create or replace TEMP view aggView3968925868586814248 as select v35, SUM(annot) as annot from aggJoin2896025735935997764 group by v35;
create or replace TEMP view aggJoin3508104072036865280 as select v17, v34, annot from semiDown8517495980003822778 join aggView3968925868586814248 using(v35);
create or replace TEMP view aggView7721117515228330179 as select v1 from semiDown15829128052498173;
create or replace TEMP view aggJoin7119020206845933381 as select v17, v22, v23, caseCond, annot from aggJoin1926173896631686530 join aggView7721117515228330179 using(v1);
create or replace TEMP view aggView6236618488936341611 as select v17, SUM( CASE WHEN caseCond = 1 THEN v22 * (1 - v23)*annot ELSE 0.0 END) as v64, SUM((v22 * (1 - v23)) * annot) as v65, SUM(annot) as annot from aggJoin7119020206845933381 group by v17;
create or replace TEMP view aggJoin2690861511081767175 as select v34, aggJoin3508104072036865280.annot * aggView6236618488936341611.annot as annot, v64 * aggJoin3508104072036865280.annot as v64, v65 * aggJoin3508104072036865280.annot as v65 from aggJoin3508104072036865280 join aggView6236618488936341611 using(v17);
create or replace TEMP view aggView5979640041995736219 as select v34, SUM(v64) as v64, SUM(v65) as v65, SUM(annot) as annot from aggJoin2690861511081767175 group by v34;
create or replace TEMP view res as select v34, (SUM(v66) as  / SUM(v66) as ) as v66 from aggView5979640041995736219 group by v34;
select sum(v34+ / SUM(v66)) from res;
