create or replace TEMP view semiUp7841012572480370943 as select l_orderkey as v17, l_partkey as v1, l_suppkey as v10, l_extendedprice as v22, l_discount as v23 from lineitem AS lineitem where (l_partkey) in (select p_partkey from part AS part where (p_type = 'ECONOMY ANODIZED STEEL'));
create or replace TEMP view semiUp400511530180168001 as select n_nationkey as v46, n_regionkey as v53 from nation AS n1 where (n_regionkey) in (select r_regionkey from region AS region where (r_name = 'AMERICA'));
create or replace TEMP view semiUp3538265174750788320 as select c_custkey as v35, c_nationkey as v46 from customer AS customer where (c_nationkey) in (select v46 from semiUp400511530180168001);
create or replace TEMP view semiUp9163739313987378378 as select o_orderkey as v17, o_year as v34, o_custkey as v35 from orderswithyear AS orderswithyear where (o_custkey) in (select v35 from semiUp3538265174750788320) and (o_orderdate >= DATE '1994-12-31') and (o_orderdate <= DATE '1996-12-30');
create or replace TEMP view semiUp147105007930444031 as select v17, v1, v10, v22, v23 from semiUp7841012572480370943 where (v17) in (select v17 from semiUp9163739313987378378);
create or replace TEMP view semiUp2187871398151719231 as select s_suppkey as v10, s_nationkey as v13 from supplier AS supplier where (s_nationkey) in (select n_nationkey from nation AS n2);
create or replace TEMP view semiUp52536791414171529 as select v17, v1, v10, v22, v23 from semiUp147105007930444031 where (v10) in (select v10 from semiUp2187871398151719231);
create or replace TEMP view semiDown2615766117545298960 as select p_partkey as v1 from part AS part where (p_partkey) in (select v1 from semiUp52536791414171529) and (p_type = 'ECONOMY ANODIZED STEEL');
create or replace TEMP view semiDown9184666554653847760 as select v10, v13 from semiUp2187871398151719231 where (v10) in (select v10 from semiUp52536791414171529);
create or replace TEMP view semiDown6173878038113495442 as select v17, v34, v35 from semiUp9163739313987378378 where (v17) in (select v17 from semiUp52536791414171529);
create or replace TEMP view semiDown5959956320757847561 as select n_nationkey as v13, n_name as v56 from nation AS n2 where (n_nationkey) in (select v13 from semiDown9184666554653847760);
create or replace TEMP view semiDown1405204995192513669 as select v35, v46 from semiUp3538265174750788320 where (v35) in (select v35 from semiDown6173878038113495442);
create or replace TEMP view semiDown2374899185830632178 as select v46, v53 from semiUp400511530180168001 where (v46) in (select v46 from semiDown1405204995192513669);
create or replace TEMP view semiDown3018972849609703217 as select r_regionkey as v53 from region AS region where (r_regionkey) in (select v53 from semiDown2374899185830632178) and (r_name = 'AMERICA');
create or replace TEMP view aggView2983487417203560938 as select v53 from semiDown3018972849609703217;
create or replace TEMP view aggJoin3114959877468571496 as select v46 from semiDown2374899185830632178 join aggView2983487417203560938 using(v53);
create or replace TEMP view aggView4834558565238900537 as select v46, COUNT(*) as annot from aggJoin3114959877468571496 group by v46;
create or replace TEMP view aggJoin9120492125231571712 as select v35, annot from semiDown1405204995192513669 join aggView4834558565238900537 using(v46);
create or replace TEMP view aggView4095301968222184233 as select v13, CASE WHEN v56 = 'BRAZIL' THEN 1 ELSE 0 END as caseCond from semiDown5959956320757847561;
create or replace TEMP view aggJoin8416373632342707953 as select v10, caseCond from semiDown9184666554653847760 join aggView4095301968222184233 using(v13);
create or replace TEMP view aggView5570293101643793928 as select v35, SUM(annot) as annot from aggJoin9120492125231571712 group by v35;
create or replace TEMP view aggJoin4123000012725360184 as select v17, v34, annot from semiDown6173878038113495442 join aggView5570293101643793928 using(v35);
create or replace TEMP view aggView53069256214821894 as select v1 from semiDown2615766117545298960;
create or replace TEMP view aggJoin1039043258797006254 as select v17, v10, v22, v23 from semiUp52536791414171529 join aggView53069256214821894 using(v1);
create or replace TEMP view aggView4564784818734799583 as select v17, v34, SUM(annot) as annot from aggJoin4123000012725360184 group by v17,v34;
create or replace TEMP view aggJoin1038888441312278654 as select v10, v22, v23, v34, annot from aggJoin1039043258797006254 join aggView4564784818734799583 using(v17);
create or replace TEMP view aggView792315326964617660 as select v10, caseCond, COUNT(*) as annot from aggJoin8416373632342707953 group by v10,caseCond;
create or replace TEMP view aggJoin1378593477172614533 as select v22, v23, v34, aggJoin1038888441312278654.annot * aggView792315326964617660.annot as annot, caseCond from aggJoin1038888441312278654 join aggView792315326964617660 using(v10);
create or replace TEMP view res as select v34, (SUM(CASE WHEN (v56 = 'BRAZIL') THEN (v22 * (1 - v23)) ELSE 0.0 END*annot) as v66 / SUM((v22 * (1 - v23))*annot) as v66) as v66 from aggJoin1378593477172614533 group by v34;
select sum(v34+v66 / SUM((v22 * (1 - v23))*annot)) from res;
