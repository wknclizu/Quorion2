create or replace TEMP view semiUp3112801635939432858 as select l_orderkey as v17, l_partkey as v1, l_suppkey as v10, l_extendedprice as v22, l_discount as v23 from lineitem AS lineitem where (l_partkey) in (select p_partkey from part AS part where (p_type = 'ECONOMY ANODIZED STEEL'));
create or replace TEMP view semiUp5130905787342359467 as select n_nationkey as v46, n_regionkey as v53 from nation AS n1 where (n_regionkey) in (select r_regionkey from region AS region where (r_name = 'AMERICA'));
create or replace TEMP view semiUp1524903959995601301 as select s_suppkey as v10, s_nationkey as v13 from supplier AS supplier where (s_nationkey) in (select n_nationkey from nation AS n2);
create or replace TEMP view semiUp8729517538662323953 as select c_custkey as v35, c_nationkey as v46 from customer AS customer where (c_nationkey) in (select v46 from semiUp5130905787342359467);
create or replace TEMP view semiUp7563432225058563553 as select v17, v1, v10, v22, v23 from semiUp3112801635939432858 where (v10) in (select v10 from semiUp1524903959995601301);
create or replace TEMP view semiUp579197657645811196 as select o_orderkey as v17, o_year as v34, o_custkey as v35 from orderswithyear AS orderswithyear where (o_orderkey) in (select v17 from semiUp7563432225058563553) and (o_orderdate >= DATE '1994-12-31') and (o_orderdate <= DATE '1996-12-30');
create or replace TEMP view semiUp98520386465078693 as select v17, v34, v35 from semiUp579197657645811196 where (v35) in (select v35 from semiUp8729517538662323953);
create or replace TEMP view orderswithyearAux27 as select v34 from semiUp98520386465078693;
create or replace TEMP view semiDown5546208876056789447 as select v17, v34, v35 from semiUp98520386465078693 where (v34) in (select v34 from orderswithyearAux27);
create or replace TEMP view semiDown7020803986507321114 as select v35, v46 from semiUp8729517538662323953 where (v35) in (select v35 from semiDown5546208876056789447);
create or replace TEMP view semiDown6142876775144024389 as select v17, v1, v10, v22, v23 from semiUp7563432225058563553 where (v17) in (select v17 from semiDown5546208876056789447);
create or replace TEMP view semiDown2927890948743772502 as select v46, v53 from semiUp5130905787342359467 where (v46) in (select v46 from semiDown7020803986507321114);
create or replace TEMP view semiDown6493008172299685322 as select p_partkey as v1 from part AS part where (p_partkey) in (select v1 from semiDown6142876775144024389) and (p_type = 'ECONOMY ANODIZED STEEL');
create or replace TEMP view semiDown3765525671570318106 as select v10, v13 from semiUp1524903959995601301 where (v10) in (select v10 from semiDown6142876775144024389);
create or replace TEMP view semiDown3176959232575167042 as select r_regionkey as v53 from region AS region where (r_regionkey) in (select v53 from semiDown2927890948743772502) and (r_name = 'AMERICA');
create or replace TEMP view semiDown230195503869725234 as select n_nationkey as v13, n_name as v56 from nation AS n2 where (n_nationkey) in (select v13 from semiDown3765525671570318106);
create or replace TEMP view aggView6141625398593016656 as select v13, CASE WHEN v56 = 'BRAZIL' THEN 1 ELSE 0 END as caseCond from semiDown230195503869725234;
create or replace TEMP view aggJoin195195920899238562 as select v10, caseCond from semiDown3765525671570318106 join aggView6141625398593016656 using(v13);
create or replace TEMP view aggView8468019905830550014 as select v53 from semiDown3176959232575167042;
create or replace TEMP view aggJoin8601259438539120233 as select v46 from semiDown2927890948743772502 join aggView8468019905830550014 using(v53);
create or replace TEMP view aggView2195442256762475181 as select v46, COUNT(*) as annot from aggJoin8601259438539120233 group by v46;
create or replace TEMP view aggJoin2038300622388034968 as select v35, annot from semiDown7020803986507321114 join aggView2195442256762475181 using(v46);
create or replace TEMP view aggView2353022105055149625 as select v10, caseCond, COUNT(*) as annot from aggJoin195195920899238562 group by v10,caseCond;
create or replace TEMP view aggJoin8605485822661364479 as select v17, v1, v22, v23, caseCond, annot from semiDown6142876775144024389 join aggView2353022105055149625 using(v10);
create or replace TEMP view aggView5975790803003895538 as select v1 from semiDown6493008172299685322;
create or replace TEMP view aggJoin8203616211210493780 as select v17, v22, v23, caseCond, annot from aggJoin8605485822661364479 join aggView5975790803003895538 using(v1);
create or replace TEMP view aggView3175452050929840983 as select v17, SUM( CASE WHEN caseCond = 1 THEN v22 * (1 - v23)*annot ELSE 0.0 END) as v64, SUM((v22 * (1 - v23)) * annot) as v65, SUM(annot) as annot from aggJoin8203616211210493780 group by v17;
create or replace TEMP view aggJoin339612216899628067 as select v34, v35, v64, v65, annot from semiDown5546208876056789447 join aggView3175452050929840983 using(v17);
create or replace TEMP view aggView7151286396430897995 as select v35, SUM(annot) as annot from aggJoin2038300622388034968 group by v35;
create or replace TEMP view aggJoin8120670816394934028 as select v34, v64*aggView7151286396430897995.annot as v64, v65*aggView7151286396430897995.annot as v65, aggJoin339612216899628067.annot * aggView7151286396430897995.annot as annot from aggJoin339612216899628067 join aggView7151286396430897995 using(v35);
create or replace TEMP view aggView265686815580865228 as select v34, SUM(v64) as v64, SUM(v65) as v65, SUM(annot) as annot from aggJoin8120670816394934028 group by v34;
create or replace TEMP view res as select v34, (SUM(v66) as  / SUM(v66) as ) as v66 from aggView265686815580865228 group by v34;
select sum(v34+ / SUM(v66)) from res;
