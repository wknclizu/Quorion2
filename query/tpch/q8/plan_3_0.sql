create or replace TEMP view aggView1276788486461040660 as select r_regionkey as v53 from region as region where (r_name = 'AMERICA');
create or replace TEMP view aggJoin7695777911305637695 as select n_nationkey as v46 from nation as n1, aggView1276788486461040660 where n1.n_regionkey=aggView1276788486461040660.v53;
create or replace TEMP view aggView5704939107576604410 as select v46, COUNT(*) as annot from aggJoin7695777911305637695 group by v46;
create or replace TEMP view aggJoin7140146697018636632 as select c_custkey as v35, annot from customer as customer, aggView5704939107576604410 where customer.c_nationkey=aggView5704939107576604410.v46;
create or replace TEMP view aggView5173332658990382786 as select v35, SUM(annot) as annot from aggJoin7140146697018636632 group by v35;
create or replace TEMP view aggJoin7533491492455106231 as select o_orderkey as v17, o_year as v34, o_orderdate as v38, annot from orderswithyear as orderswithyear, aggView5173332658990382786 where orderswithyear.o_custkey=aggView5173332658990382786.v35 and (o_orderdate >= DATE '1994-12-31') and (o_orderdate <= DATE '1996-12-30');
create or replace TEMP view aggView5861429440670757578 as select p_partkey as v1 from part as part where (p_type = 'ECONOMY ANODIZED STEEL');
create or replace TEMP view aggJoin2920327500342432194 as select l_orderkey as v17, l_suppkey as v10, l_extendedprice as v22, l_discount as v23 from lineitem as lineitem, aggView5861429440670757578 where lineitem.l_partkey=aggView5861429440670757578.v1;
create or replace TEMP view semiJoinView5517424470030432367 as select v17, v10, v22, v23, (v22 * (1 - v23)) as v65 from aggJoin2920327500342432194 where (v17) in (select v17 from aggJoin7533491492455106231);
create or replace TEMP view semiJoinView307987277386232834 as select s_suppkey as v10, s_nationkey as v13 from supplier AS supplier where (s_suppkey) in (select v10 from semiJoinView5517424470030432367);
create or replace TEMP view semiJoinView647941525640119563 as select distinct n_nationkey as v13, n_name as v56 from nation AS n2 where (n_nationkey) in (select v13 from semiJoinView307987277386232834);
create or replace TEMP view semiEnum1855403204018141609 as select distinct v10, v56 from semiJoinView647941525640119563 join semiJoinView307987277386232834 using(v13);
create or replace TEMP view semiEnum2427157461909944412 as select distinct v56, v23, v65, v17, v22 from semiEnum1855403204018141609 join semiJoinView5517424470030432367 using(v10);
create or replace TEMP view semiEnum346753862590286809 as select v23, v34, v56, annot, v65*aggJoin7533491492455106231.annot as v65, v22 from semiEnum2427157461909944412 join aggJoin7533491492455106231 using(v17);
create or replace TEMP view res as select v34, (SUM(CASE WHEN (v56 = 'BRAZIL') THEN (v22 * (1 - v23)) ELSE 0.0 END* annot) / SUM(v66)) as v66 from semiEnum346753862590286809 group by v34;
select sum(v34+v66) from res;
