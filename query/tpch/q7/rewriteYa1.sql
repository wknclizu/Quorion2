create or replace TEMP view lineitemwithyearAux78 as select l_orderkey as v25, l_year as v9, l_suppkey as v1 from lineitemwithyear where (l_shipdate >= DATE '1994-12-31') and (l_shipdate <= DATE '1996-12-30');
create or replace TEMP view n2Aux45 as select n_nationkey as v37, n_name as v47 from nation;
create or replace TEMP view n1Aux90 as select n_nationkey as v4, n_name as v43 from nation where (n_name = 'FRANCE');
create or replace TEMP view semiUp588837934603676289 as select c_custkey as v34, c_nationkey as v37 from customer AS customer where (c_nationkey) in (select v37 from n2Aux45);
create or replace TEMP view semiUp943734923227126410 as select o_orderkey as v25, o_custkey as v34 from orders AS orders where (o_custkey) in (select v34 from semiUp588837934603676289);
create or replace TEMP view semiUp4641151663731218672 as select v25, v9, v1 from lineitemwithyearAux78 where (v25) in (select v25 from semiUp943734923227126410);
create or replace TEMP view semiUp2394619099861094925 as select s_suppkey as v1, s_nationkey as v4 from supplier AS supplier where (s_suppkey) in (select v1 from semiUp4641151663731218672);
create or replace TEMP view semiUp800834510391271724 as select v4, v43 from n1Aux90 where (v4) in (select v4 from semiUp2394619099861094925);
create or replace TEMP view semiDown717224930353686626 as select n_nationkey as v4, n_name as v43 from nation AS n1 where (n_nationkey, n_name) in (select v4, v43 from semiUp800834510391271724) and (n_name = 'FRANCE');
create or replace TEMP view semiDown3039936174947107860 as select v1, v4 from semiUp2394619099861094925 where (v4) in (select v4 from semiUp800834510391271724);
create or replace TEMP view semiDown3215709113925182654 as select v25, v9, v1 from semiUp4641151663731218672 where (v1) in (select v1 from semiDown3039936174947107860);
create or replace TEMP view semiDown7669932310940651816 as select v25, v34 from semiUp943734923227126410 where (v25) in (select v25 from semiDown3215709113925182654);
create or replace TEMP view semiDown752128675811857485 as select l_orderkey as v25, l_year as v9, l_suppkey as v1, l_extendedprice as v14, l_discount as v15 from lineitemwithyear AS lineitemwithyear where (l_year, l_suppkey, l_orderkey) in (select v9, v1, v25 from semiDown3215709113925182654) and (l_shipdate >= DATE '1994-12-31') and (l_shipdate <= DATE '1996-12-30');
create or replace TEMP view semiDown6268887330697185664 as select v34, v37 from semiUp588837934603676289 where (v34) in (select v34 from semiDown7669932310940651816);
create or replace TEMP view semiDown528014794959460993 as select v37, v47 from n2Aux45 where (v37) in (select v37 from semiDown6268887330697185664);
create or replace TEMP view semiDown8161861436303141971 as select n_nationkey as v37, n_name as v47 from nation AS n2 where (n_name, n_nationkey) in (select v47, v37 from semiDown528014794959460993);
create or replace TEMP view aggView8751564848466978209 as select v47, v37 from semiDown8161861436303141971;
create or replace TEMP view aggView4992058545477262887 as select v9, v1, v25, SUM(v14 * (1 - v15)) as v51, COUNT(*) as annot from semiDown752128675811857485 group by v9,v1,v25;
create or replace TEMP view aggView5389414564446473884 as select v4, v43 from semiDown717224930353686626;
create or replace TEMP view aggView1908695138905278990 as select v37, v47, COUNT(*) as annot from aggView8751564848466978209 group by v37,v47;
create or replace TEMP view aggJoin6765792192583829648 as select v34, v47, annot from semiDown6268887330697185664 join aggView1908695138905278990 using(v37);
create or replace TEMP view aggView8874416286947595249 as select v34, v47, SUM(annot) as annot from aggJoin6765792192583829648 group by v34,v47;
create or replace TEMP view aggJoin5688428407349211617 as select v25, v47, annot from semiDown7669932310940651816 join aggView8874416286947595249 using(v34);
create or replace TEMP view aggView8573086556958259893 as select v25, v47, SUM(annot) as annot from aggJoin5688428407349211617 group by v25,v47;
create or replace TEMP view aggJoin3438702234421698211 as select v9, v1, v51*aggView8573086556958259893.annot as v51, aggView4992058545477262887.annot * aggView8573086556958259893.annot as annot, v47 from aggView4992058545477262887 join aggView8573086556958259893 using(v25);
create or replace TEMP view aggView4458039322243533267 as select v1, SUM(v51) as v51, v9, v47, SUM(annot) as annot from aggJoin3438702234421698211 group by v1,v9,v47,v51;
create or replace TEMP view aggJoin2292014668113643461 as select v4, v51, v9, v47, annot from semiDown3039936174947107860 join aggView4458039322243533267 using(v1);
create or replace TEMP view aggView5384155304581349826 as select v4, SUM(v51) as v51, v9, v47, SUM(annot) as annot from aggJoin2292014668113643461 group by v4,v9,v47,v51;
create or replace TEMP view aggJoin5532064043164849412 as select v43, v51, v9, v47 from aggView5389414564446473884 join aggView5384155304581349826 using(v4);
create or replace TEMP view res as select v43, v47, v9, SUM(v51) as v51 from aggJoin5532064043164849412 group by v43, v47, v9;
select sum(v43+v47+v9+v51) from res;
