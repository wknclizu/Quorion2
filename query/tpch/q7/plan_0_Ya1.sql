create or replace TEMP view n1Aux26 as select n_nationkey as v4, n_name as v43 from nation where (n_name = 'FRANCE');
create or replace TEMP view lineitemwithyearAux86 as select l_orderkey as v25, l_year as v9, l_suppkey as v1 from lineitemwithyear where (l_shipdate >= DATE '1994-12-31') and (l_shipdate <= DATE '1996-12-30');
create or replace TEMP view n2Aux67 as select n_nationkey as v37, n_name as v47 from nation;
create or replace TEMP view semiUp7083741263302736353 as select c_custkey as v34, c_nationkey as v37 from customer AS customer where (c_nationkey) in (select v37 from n2Aux67);
create or replace TEMP view semiUp250955793050404489 as select o_orderkey as v25, o_custkey as v34 from orders AS orders where (o_custkey) in (select v34 from semiUp7083741263302736353);
create or replace TEMP view semiUp6855153319024093017 as select v25, v9, v1 from lineitemwithyearAux86 where (v25) in (select v25 from semiUp250955793050404489);
create or replace TEMP view semiUp1871783011083003063 as select s_suppkey as v1, s_nationkey as v4 from supplier AS supplier where (s_suppkey) in (select v1 from semiUp6855153319024093017);
create or replace TEMP view semiUp5817235639064857816 as select v4, v43 from n1Aux26 where (v4) in (select v4 from semiUp1871783011083003063);
create or replace TEMP view semiDown7675947409051431648 as select n_nationkey as v4, n_name as v43 from nation AS n1 where (n_nationkey, n_name) in (select v4, v43 from semiUp5817235639064857816) and (n_name = 'FRANCE');
create or replace TEMP view semiDown2128376628349827385 as select v1, v4 from semiUp1871783011083003063 where (v4) in (select v4 from semiUp5817235639064857816);
create or replace TEMP view semiDown3315943843890613623 as select v25, v9, v1 from semiUp6855153319024093017 where (v1) in (select v1 from semiDown2128376628349827385);
create or replace TEMP view semiDown6326073465327479192 as select v25, v34 from semiUp250955793050404489 where (v25) in (select v25 from semiDown3315943843890613623);
create or replace TEMP view semiDown236284752330363805 as select l_orderkey as v25, l_year as v9, l_suppkey as v1, l_extendedprice as v14, l_discount as v15 from lineitemwithyear AS lineitemwithyear where (l_orderkey, l_year, l_suppkey) in (select v25, v9, v1 from semiDown3315943843890613623) and (l_shipdate >= DATE '1994-12-31') and (l_shipdate <= DATE '1996-12-30');
create or replace TEMP view semiDown4676528540524612902 as select v34, v37 from semiUp7083741263302736353 where (v34) in (select v34 from semiDown6326073465327479192);
create or replace TEMP view semiDown447729037887121925 as select v37, v47 from n2Aux67 where (v37) in (select v37 from semiDown4676528540524612902);
create or replace TEMP view semiDown255026792923826246 as select n_nationkey as v37, n_name as v47 from nation AS n2 where (n_name, n_nationkey) in (select v47, v37 from semiDown447729037887121925);
create or replace TEMP view aggView7102961196761530211 as select v47, v37 from semiDown255026792923826246;
create or replace TEMP view aggView2530163823629137636 as select v25, v9, v1, SUM(v14 * (1 - v15)) as v51, COUNT(*) as annot from semiDown236284752330363805 group by v25,v9,v1;
create or replace TEMP view aggView1888551427785282495 as select v4, v43 from semiDown7675947409051431648;
create or replace TEMP view aggView4916775168161935844 as select v37, v47, COUNT(*) as annot from aggView7102961196761530211 group by v37,v47;
create or replace TEMP view aggJoin5347282861246807941 as select v34, v47, annot from semiDown4676528540524612902 join aggView4916775168161935844 using(v37);
create or replace TEMP view aggView7975373045738889223 as select v34, v47, SUM(annot) as annot from aggJoin5347282861246807941 group by v34,v47;
create or replace TEMP view aggJoin7620484609262498881 as select v25, v47, annot from semiDown6326073465327479192 join aggView7975373045738889223 using(v34);
create or replace TEMP view aggView7381400591978662860 as select v25, v47, SUM(annot) as annot from aggJoin7620484609262498881 group by v25,v47;
create or replace TEMP view aggJoin1396281216350923085 as select v9, v1, v51*aggView7381400591978662860.annot as v51, aggView2530163823629137636.annot * aggView7381400591978662860.annot as annot, v47 from aggView2530163823629137636 join aggView7381400591978662860 using(v25);
create or replace TEMP view aggView5822409453903800564 as select v1, SUM(v51) as v51, v47, v9, SUM(annot) as annot from aggJoin1396281216350923085 group by v1,v47,v51,v9;
create or replace TEMP view aggJoin6875806712525248741 as select v4, v51, v47, v9, annot from semiDown2128376628349827385 join aggView5822409453903800564 using(v1);
create or replace TEMP view aggView2200446402148433517 as select v4, SUM(v51) as v51, v47, v9, SUM(annot) as annot from aggJoin6875806712525248741 group by v4,v47,v51,v9;
create or replace TEMP view aggJoin4160188153411726724 as select v43, v51, v47, v9 from aggView1888551427785282495 join aggView2200446402148433517 using(v4);
create or replace TEMP view res as select v43, v47, v9, SUM(v51) as v51 from aggJoin4160188153411726724 group by v43, v47, v9;
select sum(v43+v47+v9+v51) from res;
