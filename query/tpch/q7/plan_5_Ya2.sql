create or replace TEMP view n1Aux80 as select n_nationkey as v4, n_name as v43 from nation;
create or replace TEMP view n2Aux81 as select n_nationkey as v37, n_name as v47 from nation where (n_name = 'GERMANY');
create or replace TEMP view lineitemwithyearAux66 as select l_orderkey as v25, l_year as v9, l_suppkey as v1 from lineitemwithyear where (l_shipdate >= DATE '1994-12-31') and (l_shipdate <= DATE '1996-12-30');
create or replace TEMP view semiUp2288333252045402068 as select s_suppkey as v1, s_nationkey as v4 from supplier AS supplier where (s_nationkey) in (select v4 from n1Aux80);
create or replace TEMP view semiUp4470379557421659952 as select v25, v9, v1 from lineitemwithyearAux66 where (v1) in (select v1 from semiUp2288333252045402068);
create or replace TEMP view semiUp1318628150190512861 as select o_orderkey as v25, o_custkey as v34 from orders AS orders where (o_orderkey) in (select v25 from semiUp4470379557421659952);
create or replace TEMP view semiUp5189282994133271541 as select c_custkey as v34, c_nationkey as v37 from customer AS customer where (c_custkey) in (select v34 from semiUp1318628150190512861);
create or replace TEMP view semiUp5313039414276431348 as select v37, v47 from n2Aux81 where (v37) in (select v37 from semiUp5189282994133271541);
create or replace TEMP view semiDown6395439623795325259 as select n_nationkey as v37, n_name as v47 from nation AS n2 where (n_name, n_nationkey) in (select v47, v37 from semiUp5313039414276431348) and (n_name = 'GERMANY');
create or replace TEMP view semiDown4180695053166732008 as select v34, v37 from semiUp5189282994133271541 where (v37) in (select v37 from semiUp5313039414276431348);
create or replace TEMP view semiDown7406703327316065225 as select v25, v34 from semiUp1318628150190512861 where (v34) in (select v34 from semiDown4180695053166732008);
create or replace TEMP view semiDown8535617293144465662 as select v25, v9, v1 from semiUp4470379557421659952 where (v25) in (select v25 from semiDown7406703327316065225);
create or replace TEMP view semiDown4078851822087391737 as select v1, v4 from semiUp2288333252045402068 where (v1) in (select v1 from semiDown8535617293144465662);
create or replace TEMP view semiDown2350072829756283603 as select l_orderkey as v25, l_year as v9, l_suppkey as v1, l_extendedprice as v14, l_discount as v15 from lineitemwithyear AS lineitemwithyear where (l_year, l_orderkey, l_suppkey) in (select v9, v25, v1 from semiDown8535617293144465662) and (l_shipdate >= DATE '1994-12-31') and (l_shipdate <= DATE '1996-12-30');
create or replace TEMP view semiDown8927438539077173843 as select v4, v43 from n1Aux80 where (v4) in (select v4 from semiDown4078851822087391737);
create or replace TEMP view semiDown7794931912249462141 as select n_nationkey as v4, n_name as v43 from nation AS n1 where (n_name, n_nationkey) in (select v43, v4 from semiDown8927438539077173843);
create or replace TEMP view aggView7732706451463399824 as select v43, v4 from semiDown7794931912249462141;
create or replace TEMP view aggView213866801926271446 as select v9, v25, v1, SUM(v14 * (1 - v15)) as v51, COUNT(*) as annot from semiDown2350072829756283603 group by v9,v25,v1;
create or replace TEMP view aggView3458288553339421096 as select v47, v37 from semiDown6395439623795325259;
create or replace TEMP view aggView1611607576465239669 as select v4, v43, COUNT(*) as annot from aggView7732706451463399824 group by v4,v43;
create or replace TEMP view aggJoin1582105975721450410 as select v1, v43, annot from semiDown4078851822087391737 join aggView1611607576465239669 using(v4);
create or replace TEMP view aggView7352778446660227747 as select v1, v43, SUM(annot) as annot from aggJoin1582105975721450410 group by v1,v43;
create or replace TEMP view aggJoin6236553568643845515 as select v9, v25, v51*aggView7352778446660227747.annot as v51, aggView213866801926271446.annot * aggView7352778446660227747.annot as annot, v43 from aggView213866801926271446 join aggView7352778446660227747 using(v1);
create or replace TEMP view aggView311487804201202661 as select v25, SUM(v51) as v51, v43, v9, SUM(annot) as annot from aggJoin6236553568643845515 group by v25,v43,v51,v9;
create or replace TEMP view aggJoin4417038483185021885 as select v34, v51, v43, v9, annot from semiDown7406703327316065225 join aggView311487804201202661 using(v25);
create or replace TEMP view aggView5805908126740569573 as select v34, SUM(v51) as v51, v43, v9, SUM(annot) as annot from aggJoin4417038483185021885 group by v34,v43,v51,v9;
create or replace TEMP view aggJoin4216783492279516925 as select v37, v51, v43, v9, annot from semiDown4180695053166732008 join aggView5805908126740569573 using(v34);
create or replace TEMP view aggView2911128624040813640 as select v37, SUM(v51) as v51, v43, v9, SUM(annot) as annot from aggJoin4216783492279516925 group by v37,v43,v51,v9;
create or replace TEMP view aggJoin507816599233159264 as select v47, v51, v43, v9 from aggView3458288553339421096 join aggView2911128624040813640 using(v37);
create or replace TEMP view res as select v43, v47, v9, SUM(v51) as v51 from aggJoin507816599233159264 group by v43, v47, v9;
select sum(v43+v47+v9+v51) from res;
