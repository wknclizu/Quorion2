create or replace TEMP view n1Aux2 as select n_nationkey as v4, n_name as v43 from nation where (n_name = 'FRANCE');
create or replace TEMP view lineitemwithyearAux98 as select l_orderkey as v25, l_year as v9, l_suppkey as v1 from lineitemwithyear where (l_shipdate >= DATE '1994-12-31') and (l_shipdate <= DATE '1996-12-30');
create or replace TEMP view n2Aux35 as select n_nationkey as v37, n_name as v47 from nation where (n_name = 'GERMANY');
create or replace TEMP view semiUp4191467733377025269 as select s_suppkey as v1, s_nationkey as v4 from supplier AS supplier where (s_nationkey) in (select v4 from n1Aux2);
create or replace TEMP view semiUp3977918989137528111 as select c_custkey as v34, c_nationkey as v37 from customer AS customer where (c_nationkey) in (select v37 from n2Aux35);
create or replace TEMP view semiUp6699170617361562626 as select v25, v9, v1 from lineitemwithyearAux98 where (v1) in (select v1 from semiUp4191467733377025269);
create or replace TEMP view semiUp3161533207740750949 as select o_orderkey as v25, o_custkey as v34 from orders AS orders where (o_custkey) in (select v34 from semiUp3977918989137528111);
create or replace TEMP view semiUp5513755847842028727 as select v25, v9, v1 from semiUp6699170617361562626 where (v25) in (select v25 from semiUp3161533207740750949);
create or replace TEMP view semiDown2564400494765888670 as select v1, v4 from semiUp4191467733377025269 where (v1) in (select v1 from semiUp5513755847842028727);
create or replace TEMP view semiDown4346797029571163608 as select v25, v34 from semiUp3161533207740750949 where (v25) in (select v25 from semiUp5513755847842028727);
create or replace TEMP view semiDown5913717911749330450 as select l_orderkey as v25, l_year as v9, l_suppkey as v1, l_extendedprice as v14, l_discount as v15 from lineitemwithyear AS lineitemwithyear where (l_orderkey, l_suppkey, l_year) in (select v25, v1, v9 from semiUp5513755847842028727) and (l_shipdate >= DATE '1994-12-31') and (l_shipdate <= DATE '1996-12-30');
create or replace TEMP view semiDown8044076308756633487 as select v4, v43 from n1Aux2 where (v4) in (select v4 from semiDown2564400494765888670);
create or replace TEMP view semiDown7807829920538517912 as select v34, v37 from semiUp3977918989137528111 where (v34) in (select v34 from semiDown4346797029571163608);
create or replace TEMP view semiDown1614872376378927877 as select n_nationkey as v4, n_name as v43 from nation AS n1 where (n_name, n_nationkey) in (select v43, v4 from semiDown8044076308756633487) and (n_name = 'FRANCE');
create or replace TEMP view semiDown7516101807204029617 as select v37, v47 from n2Aux35 where (v37) in (select v37 from semiDown7807829920538517912);
create or replace TEMP view semiDown7531567708884980907 as select n_nationkey as v37, n_name as v47 from nation AS n2 where (n_nationkey, n_name) in (select v37, v47 from semiDown7516101807204029617) and (n_name = 'GERMANY');
create or replace TEMP view aggView2323529667575858744 as select v37, v47 from semiDown7531567708884980907;
create or replace TEMP view aggView6649554885115472093 as select v43, v4 from semiDown1614872376378927877;
create or replace TEMP view aggView9163906773534601720 as select v25, v1, v9, SUM(v14 * (1 - v15)) as v51, COUNT(*) as annot from semiDown5913717911749330450 group by v25,v1,v9;
create or replace TEMP view aggView2878583743604952541 as select v37, v47, COUNT(*) as annot from aggView2323529667575858744 group by v37,v47;
create or replace TEMP view aggJoin8847268732066524117 as select v34, v47, annot from semiDown7807829920538517912 join aggView2878583743604952541 using(v37);
create or replace TEMP view aggView8333351888445765251 as select v34, v47, SUM(annot) as annot from aggJoin8847268732066524117 group by v34,v47;
create or replace TEMP view aggJoin8130665005634173880 as select v25, v47, annot from semiDown4346797029571163608 join aggView8333351888445765251 using(v34);
create or replace TEMP view aggView2599045802159392679 as select v4, v43, COUNT(*) as annot from aggView6649554885115472093 group by v4,v43;
create or replace TEMP view aggJoin2810213055884631949 as select v1, v43, annot from semiDown2564400494765888670 join aggView2599045802159392679 using(v4);
create or replace TEMP view aggView5217905791146812425 as select v25, v47, SUM(annot) as annot from aggJoin8130665005634173880 group by v25,v47;
create or replace TEMP view aggJoin2181969396805134558 as select v1, v9, v51*aggView5217905791146812425.annot as v51, aggView9163906773534601720.annot * aggView5217905791146812425.annot as annot, v47 from aggView9163906773534601720 join aggView5217905791146812425 using(v25);
create or replace TEMP view aggView7525454842801583304 as select v1, v43, SUM(annot) as annot from aggJoin2810213055884631949 group by v1,v43;
create or replace TEMP view aggJoin9203789509960240138 as select v9, v51*aggView7525454842801583304.annot as v51, v47, v43 from aggJoin2181969396805134558 join aggView7525454842801583304 using(v1);
create or replace TEMP view res as select v43, v47, v9, SUM(v51) as v51 from aggJoin9203789509960240138 group by v43, v47, v9;
select sum(v43+v47+v9+v51) from res;
