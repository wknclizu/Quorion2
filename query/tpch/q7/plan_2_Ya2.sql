create or replace TEMP view n2Aux5 as select n_nationkey as v37, n_name as v47 from nation;
create or replace TEMP view lineitemwithyearAux68 as select l_orderkey as v25, l_year as v9, l_suppkey as v1 from lineitemwithyear where (l_shipdate >= DATE '1994-12-31') and (l_shipdate <= DATE '1996-12-30');
create or replace TEMP view n1Aux38 as select n_nationkey as v4, n_name as v43 from nation where (n_name = 'FRANCE');
create or replace TEMP view semiUp8018877892481273846 as select s_suppkey as v1, s_nationkey as v4 from supplier AS supplier where (s_nationkey) in (select v4 from n1Aux38);
create or replace TEMP view semiUp3596299051321739200 as select v25, v9, v1 from lineitemwithyearAux68 where (v1) in (select v1 from semiUp8018877892481273846);
create or replace TEMP view semiUp264833764993704493 as select o_orderkey as v25, o_custkey as v34 from orders AS orders where (o_orderkey) in (select v25 from semiUp3596299051321739200);
create or replace TEMP view semiUp3729198783708292930 as select c_custkey as v34, c_nationkey as v37 from customer AS customer where (c_custkey) in (select v34 from semiUp264833764993704493);
create or replace TEMP view semiUp1469185610929866492 as select v37, v47 from n2Aux5 where (v37) in (select v37 from semiUp3729198783708292930);
create or replace TEMP view semiDown5813649773837943483 as select n_nationkey as v37, n_name as v47 from nation AS n2 where (n_nationkey, n_name) in (select v37, v47 from semiUp1469185610929866492);
create or replace TEMP view semiDown2070977660531666935 as select v34, v37 from semiUp3729198783708292930 where (v37) in (select v37 from semiUp1469185610929866492);
create or replace TEMP view semiDown7456000909839831297 as select v25, v34 from semiUp264833764993704493 where (v34) in (select v34 from semiDown2070977660531666935);
create or replace TEMP view semiDown5991461926526303138 as select v25, v9, v1 from semiUp3596299051321739200 where (v25) in (select v25 from semiDown7456000909839831297);
create or replace TEMP view semiDown9076142255750583874 as select v1, v4 from semiUp8018877892481273846 where (v1) in (select v1 from semiDown5991461926526303138);
create or replace TEMP view semiDown8270023363153407049 as select l_orderkey as v25, l_year as v9, l_suppkey as v1, l_extendedprice as v14, l_discount as v15 from lineitemwithyear AS lineitemwithyear where (l_suppkey, l_year, l_orderkey) in (select v1, v9, v25 from semiDown5991461926526303138) and (l_shipdate >= DATE '1994-12-31') and (l_shipdate <= DATE '1996-12-30');
create or replace TEMP view semiDown6149243807523660800 as select v4, v43 from n1Aux38 where (v4) in (select v4 from semiDown9076142255750583874);
create or replace TEMP view semiDown1399619850024923054 as select n_nationkey as v4, n_name as v43 from nation AS n1 where (n_name, n_nationkey) in (select v43, v4 from semiDown6149243807523660800) and (n_name = 'FRANCE');
create or replace TEMP view aggView4219710621088252464 as select v43, v4 from semiDown1399619850024923054;
create or replace TEMP view aggView6239090048773959467 as select v1, v9, v25, SUM(v14 * (1 - v15)) as v51, COUNT(*) as annot from semiDown8270023363153407049 group by v1,v9,v25;
create or replace TEMP view aggView1449669173146712626 as select v37, v47 from semiDown5813649773837943483;
create or replace TEMP view aggView4595041603463517692 as select v4, v43, COUNT(*) as annot from aggView4219710621088252464 group by v4,v43;
create or replace TEMP view aggJoin7809012103339918966 as select v1, v43, annot from semiDown9076142255750583874 join aggView4595041603463517692 using(v4);
create or replace TEMP view aggView9039628919361405971 as select v1, v43, SUM(annot) as annot from aggJoin7809012103339918966 group by v1,v43;
create or replace TEMP view aggJoin7200658374203200470 as select v9, v25, v51*aggView9039628919361405971.annot as v51, aggView6239090048773959467.annot * aggView9039628919361405971.annot as annot, v43 from aggView6239090048773959467 join aggView9039628919361405971 using(v1);
create or replace TEMP view aggView4773767062466518625 as select v25, SUM(v51) as v51, v43, v9, SUM(annot) as annot from aggJoin7200658374203200470 group by v25,v43,v51,v9;
create or replace TEMP view aggJoin7166032826984688403 as select v34, v51, v43, v9, annot from semiDown7456000909839831297 join aggView4773767062466518625 using(v25);
create or replace TEMP view aggView7317026384782157366 as select v34, SUM(v51) as v51, v43, v9, SUM(annot) as annot from aggJoin7166032826984688403 group by v34,v43,v51,v9;
create or replace TEMP view aggJoin5372906162208328119 as select v37, v51, v43, v9, annot from semiDown2070977660531666935 join aggView7317026384782157366 using(v34);
create or replace TEMP view aggView4681423650577751351 as select v37, SUM(v51) as v51, v43, v9, SUM(annot) as annot from aggJoin5372906162208328119 group by v37,v43,v51,v9;
create or replace TEMP view aggJoin5211171668960505633 as select v47, v51, v43, v9 from aggView1449669173146712626 join aggView4681423650577751351 using(v37);
create or replace TEMP view res as select v43, v47, v9, SUM(v51) as v51 from aggJoin5211171668960505633 group by v43, v47, v9;
select sum(v43+v47+v9+v51) from res;
