create or replace TEMP view lineitemwithyearAux36 as select l_orderkey as v25, l_year as v9, l_suppkey as v1 from lineitemwithyear where (l_shipdate >= DATE '1994-12-31') and (l_shipdate <= DATE '1996-12-30');
create or replace TEMP view n2Aux27 as select n_nationkey as v37, n_name as v47 from nation;
create or replace TEMP view n1Aux68 as select n_nationkey as v4, n_name as v43 from nation where (n_name = 'FRANCE');
create or replace TEMP view semiUp1118494805345950847 as select c_custkey as v34, c_nationkey as v37 from customer AS customer where (c_nationkey) in (select v37 from n2Aux27);
create or replace TEMP view semiUp3794509838020083824 as select o_orderkey as v25, o_custkey as v34 from orders AS orders where (o_custkey) in (select v34 from semiUp1118494805345950847);
create or replace TEMP view semiUp4478171905309383239 as select v25, v9, v1 from lineitemwithyearAux36 where (v25) in (select v25 from semiUp3794509838020083824);
create or replace TEMP view semiUp3500074129870307815 as select s_suppkey as v1, s_nationkey as v4 from supplier AS supplier where (s_suppkey) in (select v1 from semiUp4478171905309383239);
create or replace TEMP view semiUp6585303180263582411 as select v4, v43 from n1Aux68 where (v4) in (select v4 from semiUp3500074129870307815);
create or replace TEMP view semiDown2365302884891307871 as select n_nationkey as v4, n_name as v43 from nation AS n1 where (n_nationkey, n_name) in (select v4, v43 from semiUp6585303180263582411) and (n_name = 'FRANCE');
create or replace TEMP view semiDown1450311420190957886 as select v1, v4 from semiUp3500074129870307815 where (v4) in (select v4 from semiUp6585303180263582411);
create or replace TEMP view semiDown6211508261559193576 as select v25, v9, v1 from semiUp4478171905309383239 where (v1) in (select v1 from semiDown1450311420190957886);
create or replace TEMP view semiDown6447959021275149852 as select v25, v34 from semiUp3794509838020083824 where (v25) in (select v25 from semiDown6211508261559193576);
create or replace TEMP view semiDown4236174893787966389 as select l_orderkey as v25, l_year as v9, l_suppkey as v1, l_extendedprice as v14, l_discount as v15 from lineitemwithyear AS lineitemwithyear where (l_orderkey, l_suppkey, l_year) in (select v25, v1, v9 from semiDown6211508261559193576) and (l_shipdate >= DATE '1994-12-31') and (l_shipdate <= DATE '1996-12-30');
create or replace TEMP view semiDown437610201616717297 as select v34, v37 from semiUp1118494805345950847 where (v34) in (select v34 from semiDown6447959021275149852);
create or replace TEMP view semiDown8517629075531510681 as select v37, v47 from n2Aux27 where (v37) in (select v37 from semiDown437610201616717297);
create or replace TEMP view semiDown2514987547654605440 as select n_nationkey as v37, n_name as v47 from nation AS n2 where (n_nationkey, n_name) in (select v37, v47 from semiDown8517629075531510681);
create or replace TEMP view aggView4782517131552058920 as select v37, v47 from semiDown2514987547654605440;
create or replace TEMP view aggView6059833508775032599 as select v25, v1, v9, SUM(v14 * (1 - v15)) as v51, COUNT(*) as annot from semiDown4236174893787966389 group by v25,v1,v9;
create or replace TEMP view aggView4849485214404997468 as select v4, v43 from semiDown2365302884891307871;
create or replace TEMP view aggView5066710589554621164 as select v37, v47, COUNT(*) as annot from aggView4782517131552058920 group by v37,v47;
create or replace TEMP view aggJoin8453169023015051359 as select v34, v47, annot from semiDown437610201616717297 join aggView5066710589554621164 using(v37);
create or replace TEMP view aggView5213559005625464140 as select v34, v47, SUM(annot) as annot from aggJoin8453169023015051359 group by v34,v47;
create or replace TEMP view aggJoin1039718044328370320 as select v25, v47, annot from semiDown6447959021275149852 join aggView5213559005625464140 using(v34);
create or replace TEMP view aggView6252517036803008794 as select v25, v47, SUM(annot) as annot from aggJoin1039718044328370320 group by v25,v47;
create or replace TEMP view aggJoin6074700027683563249 as select v1, v9, v51*aggView6252517036803008794.annot as v51, aggView6059833508775032599.annot * aggView6252517036803008794.annot as annot, v47 from aggView6059833508775032599 join aggView6252517036803008794 using(v25);
create or replace TEMP view aggView4979439617230508978 as select v1, SUM(v51) as v51, v47, v9, SUM(annot) as annot from aggJoin6074700027683563249 group by v1,v47,v51,v9;
create or replace TEMP view aggJoin6598968226164396831 as select v4, v51, v47, v9, annot from semiDown1450311420190957886 join aggView4979439617230508978 using(v1);
create or replace TEMP view aggView3427723534180749766 as select v4, SUM(v51) as v51, v47, v9, SUM(annot) as annot from aggJoin6598968226164396831 group by v4,v47,v51,v9;
create or replace TEMP view aggJoin710477299864250835 as select v43, v51, v47, v9 from aggView4849485214404997468 join aggView3427723534180749766 using(v4);
create or replace TEMP view res as select v43, v47, v9, SUM(v51) as v51 from aggJoin710477299864250835 group by v43, v47, v9;
select sum(v43+v47+v9+v51) from res;
