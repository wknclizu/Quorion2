create or replace TEMP view lineitemwithyearAux71 as select l_orderkey as v25, l_year as v9, l_suppkey as v1 from lineitemwithyear where (l_shipdate >= DATE '1994-12-31') and (l_shipdate <= DATE '1996-12-30');
create or replace TEMP view n1Aux71 as select n_nationkey as v4, n_name as v43 from nation where (n_name = 'FRANCE');
create or replace TEMP view n2Aux28 as select n_nationkey as v37, n_name as v47 from nation where (n_name = 'GERMANY');
create or replace TEMP view semiUp5534049746323294845 as select c_custkey as v34, c_nationkey as v37 from customer AS customer where (c_nationkey) in (select v37 from n2Aux28);
create or replace TEMP view semiUp5480343271835948936 as select o_orderkey as v25, o_custkey as v34 from orders AS orders where (o_custkey) in (select v34 from semiUp5534049746323294845);
create or replace TEMP view semiUp1188606904962901639 as select v25, v9, v1 from lineitemwithyearAux71 where (v25) in (select v25 from semiUp5480343271835948936);
create or replace TEMP view semiUp9159988357243719726 as select s_suppkey as v1, s_nationkey as v4 from supplier AS supplier where (s_suppkey) in (select v1 from semiUp1188606904962901639);
create or replace TEMP view semiUp3379504493678254497 as select v4, v43 from n1Aux71 where (v4) in (select v4 from semiUp9159988357243719726);
create or replace TEMP view semiDown5128336936873523387 as select n_nationkey as v4, n_name as v43 from nation AS n1 where (n_nationkey, n_name) in (select v4, v43 from semiUp3379504493678254497) and (n_name = 'FRANCE');
create or replace TEMP view semiDown2343733081321836739 as select v1, v4 from semiUp9159988357243719726 where (v4) in (select v4 from semiUp3379504493678254497);
create or replace TEMP view semiDown7129001001707402127 as select v25, v9, v1 from semiUp1188606904962901639 where (v1) in (select v1 from semiDown2343733081321836739);
create or replace TEMP view semiDown6109268215474090320 as select v25, v34 from semiUp5480343271835948936 where (v25) in (select v25 from semiDown7129001001707402127);
create or replace TEMP view semiDown6593017003790324408 as select l_orderkey as v25, l_year as v9, l_suppkey as v1, l_extendedprice as v14, l_discount as v15 from lineitemwithyear AS lineitemwithyear where (l_year, l_orderkey, l_suppkey) in (select v9, v25, v1 from semiDown7129001001707402127) and (l_shipdate >= DATE '1994-12-31') and (l_shipdate <= DATE '1996-12-30');
create or replace TEMP view semiDown7149534943599818758 as select v34, v37 from semiUp5534049746323294845 where (v34) in (select v34 from semiDown6109268215474090320);
create or replace TEMP view semiDown5202697507995355733 as select v37, v47 from n2Aux28 where (v37) in (select v37 from semiDown7149534943599818758);
create or replace TEMP view semiDown952981595117746828 as select n_nationkey as v37, n_name as v47 from nation AS n2 where (n_name, n_nationkey) in (select v47, v37 from semiDown5202697507995355733) and (n_name = 'GERMANY');
create or replace TEMP view aggView8211780435829811807 as select v47, v37 from semiDown952981595117746828;
create or replace TEMP view aggView5023245041536062078 as select v9, v25, v1, SUM(v14 * (1 - v15)) as v51, COUNT(*) as annot from semiDown6593017003790324408 group by v9,v25,v1;
create or replace TEMP view aggView3866522618658202563 as select v4, v43 from semiDown5128336936873523387;
create or replace TEMP view aggView4683118482392549655 as select v37, v47, COUNT(*) as annot from aggView8211780435829811807 group by v37,v47;
create or replace TEMP view aggJoin5919995033398412970 as select v34, v47, annot from semiDown7149534943599818758 join aggView4683118482392549655 using(v37);
create or replace TEMP view aggView7042976458874750506 as select v34, v47, SUM(annot) as annot from aggJoin5919995033398412970 group by v34,v47;
create or replace TEMP view aggJoin219110673705423656 as select v25, v47, annot from semiDown6109268215474090320 join aggView7042976458874750506 using(v34);
create or replace TEMP view aggView332858262572458657 as select v25, v47, SUM(annot) as annot from aggJoin219110673705423656 group by v25,v47;
create or replace TEMP view aggJoin1595395775698549708 as select v9, v1, v51*aggView332858262572458657.annot as v51, aggView5023245041536062078.annot * aggView332858262572458657.annot as annot, v47 from aggView5023245041536062078 join aggView332858262572458657 using(v25);
create or replace TEMP view aggView2347955733335116877 as select v1, SUM(v51) as v51, v9, v47, SUM(annot) as annot from aggJoin1595395775698549708 group by v1,v9,v51,v47;
create or replace TEMP view aggJoin8594988495142421918 as select v4, v51, v9, v47, annot from semiDown2343733081321836739 join aggView2347955733335116877 using(v1);
create or replace TEMP view aggView651411725292247362 as select v4, SUM(v51) as v51, v9, v47, SUM(annot) as annot from aggJoin8594988495142421918 group by v4,v9,v51,v47;
create or replace TEMP view aggJoin4081900217678601511 as select v43, v51, v9, v47 from aggView3866522618658202563 join aggView651411725292247362 using(v4);
create or replace TEMP view res as select v43, v47, v9, SUM(v51) as v51 from aggJoin4081900217678601511 group by v43, v47, v9;
select sum(v43+v47+v9+v51) from res;
