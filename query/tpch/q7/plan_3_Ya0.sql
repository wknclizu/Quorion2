create or replace TEMP view semiUp3798830226172382027 as select s_suppkey as v1, s_nationkey as v4 from supplier AS supplier where (s_nationkey) in (select n_nationkey from nation AS n1 where (n_name = 'FRANCE'));
create or replace TEMP view semiUp4130942513968882616 as select l_orderkey as v25, l_year as v9, l_suppkey as v1, l_extendedprice as v14, l_discount as v15 from lineitemwithyear AS lineitemwithyear where (l_suppkey) in (select v1 from semiUp3798830226172382027) and (l_shipdate >= DATE '1994-12-31') and (l_shipdate <= DATE '1996-12-30');
create or replace TEMP view semiUp128855571051314777 as select o_orderkey as v25, o_custkey as v34 from orders AS orders where (o_orderkey) in (select v25 from semiUp4130942513968882616);
create or replace TEMP view semiUp5245610629970281328 as select c_custkey as v34, c_nationkey as v37 from customer AS customer where (c_custkey) in (select v34 from semiUp128855571051314777);
create or replace TEMP view semiUp1260184268244346715 as select n_nationkey as v37, n_name as v47 from nation AS n2 where (n_nationkey) in (select v37 from semiUp5245610629970281328) and (n_name = 'GERMANY');
create or replace TEMP view semiDown7977839347623151960 as select v34, v37 from semiUp5245610629970281328 where (v37) in (select v37 from semiUp1260184268244346715);
create or replace TEMP view semiDown1288040478074705239 as select v25, v34 from semiUp128855571051314777 where (v34) in (select v34 from semiDown7977839347623151960);
create or replace TEMP view semiDown2554158550531752376 as select v25, v9, v1, v14, v15 from semiUp4130942513968882616 where (v25) in (select v25 from semiDown1288040478074705239);
create or replace TEMP view semiDown2816731450250198961 as select v1, v4 from semiUp3798830226172382027 where (v1) in (select v1 from semiDown2554158550531752376);
create or replace TEMP view semiDown5407311358562932867 as select n_nationkey as v4, n_name as v43 from nation AS n1 where (n_nationkey) in (select v4 from semiDown2816731450250198961) and (n_name = 'FRANCE');
create or replace TEMP view aggView344034397133337714 as select v4, v43 from semiDown5407311358562932867;
create or replace TEMP view aggJoin7330111598637165372 as select v1, v43 from semiDown2816731450250198961 join aggView344034397133337714 using(v4);
create or replace TEMP view aggView5305208168524684594 as select v1, v43, COUNT(*) as annot from aggJoin7330111598637165372 group by v1,v43;
create or replace TEMP view aggJoin4186961397501860586 as select v25, v9, v14, v15, v43, annot from semiDown2554158550531752376 join aggView5305208168524684594 using(v1);
create or replace TEMP view aggView5483793999109449259 as select v25, SUM((v14 * (1 - v15)) * annot) as v51, v43, v9, SUM(annot) as annot from aggJoin4186961397501860586 group by v25,v43,v9;
create or replace TEMP view aggJoin3215009145026382884 as select v34, v51, v43, v9, annot from semiDown1288040478074705239 join aggView5483793999109449259 using(v25);
create or replace TEMP view aggView8453257077115577104 as select v34, SUM(v51) as v51, v43, v9, SUM(annot) as annot from aggJoin3215009145026382884 group by v34,v43,v51,v9;
create or replace TEMP view aggJoin8052441965196244489 as select v37, v51, v43, v9, annot from semiDown7977839347623151960 join aggView8453257077115577104 using(v34);
create or replace TEMP view aggView8306085234452599405 as select v37, SUM(v51) as v51, v43, v9, SUM(annot) as annot from aggJoin8052441965196244489 group by v37,v43,v51,v9;
create or replace TEMP view aggJoin9218542382572218127 as select v47, v51, v43, v9 from semiUp1260184268244346715 join aggView8306085234452599405 using(v37);
create or replace TEMP view res as select v43, v47, v9, SUM(v51) as v51 from aggJoin9218542382572218127 group by v43, v47, v9;
select sum(v43+v47+v9+v51) from res;
