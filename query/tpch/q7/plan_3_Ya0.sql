create or replace TEMP view n1Aux2 as select n_nationkey as v4, n_name as v43 from nation;
create or replace TEMP view n2Aux42 as select n_nationkey as v37, n_name as v47 from nation;
create or replace TEMP view lineitemwithyearAux2 as select l_orderkey as v25, l_year as v9, l_suppkey as v1 from lineitemwithyear where (l_shipdate >= DATE '1994-12-31') and (l_shipdate <= DATE '1996-12-30');
create or replace TEMP view semiUp9110207800457789 as select c_custkey as v34, c_nationkey as v37 from customer AS customer where (c_nationkey) in (select v37 from n2Aux42);
create or replace TEMP view semiUp2196859325896130383 as select o_orderkey as v25, o_custkey as v34 from orders AS orders where (o_custkey) in (select v34 from semiUp9110207800457789);
create or replace TEMP view semiUp2498022836057121636 as select v25, v9, v1 from lineitemwithyearAux2 where (v25) in (select v25 from semiUp2196859325896130383);
create or replace TEMP view semiUp4003711973989681676 as select s_suppkey as v1, s_nationkey as v4 from supplier AS supplier where (s_suppkey) in (select v1 from semiUp2498022836057121636);
create or replace TEMP view semiUp8429289366232589842 as select v4, v43 from n1Aux2 where (v4) in (select v4 from semiUp4003711973989681676);
create or replace TEMP view semiDown9070839296058662492 as select n_nationkey as v4, n_name as v43 from nation AS n1 where (n_name, n_nationkey) in (select v43, v4 from semiUp8429289366232589842);
create or replace TEMP view semiDown5411402557358030453 as select v1, v4 from semiUp4003711973989681676 where (v4) in (select v4 from semiUp8429289366232589842);
create or replace TEMP view semiDown4085679747823086419 as select v25, v9, v1 from semiUp2498022836057121636 where (v1) in (select v1 from semiDown5411402557358030453);
create or replace TEMP view semiDown5931552167558350418 as select v25, v34 from semiUp2196859325896130383 where (v25) in (select v25 from semiDown4085679747823086419);
create or replace TEMP view semiDown3869635255724034642 as select l_orderkey as v25, l_year as v9, l_suppkey as v1, l_extendedprice as v14, l_discount as v15 from lineitemwithyear AS lineitemwithyear where (l_suppkey, l_orderkey, l_year) in (select v1, v25, v9 from semiDown4085679747823086419) and (l_shipdate >= DATE '1994-12-31') and (l_shipdate <= DATE '1996-12-30');
create or replace TEMP view semiDown1647285668707062597 as select v34, v37 from semiUp9110207800457789 where (v34) in (select v34 from semiDown5931552167558350418);
create or replace TEMP view semiDown7427130250735594556 as select v37, v47 from n2Aux42 where (v37) in (select v37 from semiDown1647285668707062597);
create or replace TEMP view semiDown8370831431292071926 as select n_nationkey as v37, n_name as v47 from nation AS n2 where (n_nationkey, n_name) in (select v37, v47 from semiDown7427130250735594556);
create or replace TEMP view aggView3390672407139255482 as select v37, v47 from semiDown8370831431292071926;
create or replace TEMP view aggView4663615591730359731 as select v1, v25, v9, SUM(v14 * (1 - v15)) as v51, COUNT(*) as annot from semiDown3869635255724034642 group by v1,v25,v9;
create or replace TEMP view aggView8215261977055998123 as select v43, v4 from semiDown9070839296058662492;
create or replace TEMP view aggView267093890439404626 as select v37, v47, COUNT(*) as annot from aggView3390672407139255482 group by v37,v47;
create or replace TEMP view aggJoin6317845044179180277 as select v34, v47, annot from semiDown1647285668707062597 join aggView267093890439404626 using(v37);
create or replace TEMP view aggView5655625571534935487 as select v34, v47, SUM(annot) as annot from aggJoin6317845044179180277 group by v34,v47;
create or replace TEMP view aggJoin4372742000694801834 as select v25, v47, annot from semiDown5931552167558350418 join aggView5655625571534935487 using(v34);
create or replace TEMP view aggView582192848743050607 as select v25, v47, SUM(annot) as annot from aggJoin4372742000694801834 group by v25,v47;
create or replace TEMP view aggJoin5653956749710176076 as select v1, v9, v51*aggView582192848743050607.annot as v51, aggView4663615591730359731.annot * aggView582192848743050607.annot as annot, v47 from aggView4663615591730359731 join aggView582192848743050607 using(v25);
create or replace TEMP view aggView229888122143907240 as select v1, SUM(v51) as v51, v9, v47, SUM(annot) as annot from aggJoin5653956749710176076 group by v1,v51,v9,v47;
create or replace TEMP view aggJoin3286548683500948282 as select v4, v51, v9, v47, annot from semiDown5411402557358030453 join aggView229888122143907240 using(v1);
create or replace TEMP view aggView1503118649625646069 as select v4, SUM(v51) as v51, v9, v47, SUM(annot) as annot from aggJoin3286548683500948282 group by v4,v51,v9,v47;
create or replace TEMP view aggJoin7336762187430070007 as select v43, v51, v9, v47 from aggView8215261977055998123 join aggView1503118649625646069 using(v4);
create or replace TEMP view res as select v43, v47, v9, SUM(v51) as v51 from aggJoin7336762187430070007 group by v43, v47, v9;
select sum(v43+v47+v9+v51) from res;
