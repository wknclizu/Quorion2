create or replace TEMP view n2Aux49 as select n_nationkey as v37, n_name as v47 from nation;
create or replace TEMP view n1Aux43 as select n_nationkey as v4, n_name as v43 from nation where (n_name = 'FRANCE');
create or replace TEMP view lineitemwithyearAux35 as select l_orderkey as v25, l_year as v9, l_suppkey as v1 from lineitemwithyear where (l_shipdate >= DATE '1994-12-31') and (l_shipdate <= DATE '1996-12-30');
create or replace TEMP view semiUp6506517116292746350 as select c_custkey as v34, c_nationkey as v37 from customer AS customer where (c_nationkey) in (select v37 from n2Aux49);
create or replace TEMP view semiUp8817364730461787662 as select o_orderkey as v25, o_custkey as v34 from orders AS orders where (o_custkey) in (select v34 from semiUp6506517116292746350);
create or replace TEMP view semiUp4228168168010260350 as select v25, v9, v1 from lineitemwithyearAux35 where (v25) in (select v25 from semiUp8817364730461787662);
create or replace TEMP view semiUp7441317662478308177 as select s_suppkey as v1, s_nationkey as v4 from supplier AS supplier where (s_suppkey) in (select v1 from semiUp4228168168010260350);
create or replace TEMP view semiUp639044923552835060 as select v4, v43 from n1Aux43 where (v4) in (select v4 from semiUp7441317662478308177);
create or replace TEMP view semiDown7517812357536838321 as select n_nationkey as v4, n_name as v43 from nation AS n1 where (n_name, n_nationkey) in (select v43, v4 from semiUp639044923552835060) and (n_name = 'FRANCE');
create or replace TEMP view semiDown5734916713921752334 as select v1, v4 from semiUp7441317662478308177 where (v4) in (select v4 from semiUp639044923552835060);
create or replace TEMP view semiDown3655467749422952733 as select v25, v9, v1 from semiUp4228168168010260350 where (v1) in (select v1 from semiDown5734916713921752334);
create or replace TEMP view semiDown7018906474300248603 as select v25, v34 from semiUp8817364730461787662 where (v25) in (select v25 from semiDown3655467749422952733);
create or replace TEMP view semiDown6762876291259814234 as select l_orderkey as v25, l_year as v9, l_suppkey as v1, l_extendedprice as v14, l_discount as v15 from lineitemwithyear AS lineitemwithyear where (l_suppkey, l_year, l_orderkey) in (select v1, v9, v25 from semiDown3655467749422952733) and (l_shipdate >= DATE '1994-12-31') and (l_shipdate <= DATE '1996-12-30');
create or replace TEMP view semiDown9148493830618802910 as select v34, v37 from semiUp6506517116292746350 where (v34) in (select v34 from semiDown7018906474300248603);
create or replace TEMP view semiDown8103210208010266271 as select v37, v47 from n2Aux49 where (v37) in (select v37 from semiDown9148493830618802910);
create or replace TEMP view semiDown6651628347189499088 as select n_nationkey as v37, n_name as v47 from nation AS n2 where (n_nationkey, n_name) in (select v37, v47 from semiDown8103210208010266271);
create or replace TEMP view aggView5571852225975199191 as select v37, v47 from semiDown6651628347189499088;
create or replace TEMP view aggView5674729001705571228 as select v1, v9, v25, SUM(v14 * (1 - v15)) as v51, COUNT(*) as annot from semiDown6762876291259814234 group by v1,v9,v25;
create or replace TEMP view aggView3803256914848228657 as select v43, v4 from semiDown7517812357536838321;
create or replace TEMP view aggView6956358972297180111 as select v37, v47, COUNT(*) as annot from aggView5571852225975199191 group by v37,v47;
create or replace TEMP view aggJoin7794483741264428421 as select v34, v47, annot from semiDown9148493830618802910 join aggView6956358972297180111 using(v37);
create or replace TEMP view aggView6825030582039468701 as select v34, v47, SUM(annot) as annot from aggJoin7794483741264428421 group by v34,v47;
create or replace TEMP view aggJoin1764115961881951806 as select v25, v47, annot from semiDown7018906474300248603 join aggView6825030582039468701 using(v34);
create or replace TEMP view aggView484993146197260806 as select v25, v47, SUM(annot) as annot from aggJoin1764115961881951806 group by v25,v47;
create or replace TEMP view aggJoin6031407704065575537 as select v1, v9, v51*aggView484993146197260806.annot as v51, aggView5674729001705571228.annot * aggView484993146197260806.annot as annot, v47 from aggView5674729001705571228 join aggView484993146197260806 using(v25);
create or replace TEMP view aggView4756087383028510656 as select v1, SUM(v51) as v51, v47, v9, SUM(annot) as annot from aggJoin6031407704065575537 group by v1,v51,v47,v9;
create or replace TEMP view aggJoin8640863104033062625 as select v4, v51, v47, v9, annot from semiDown5734916713921752334 join aggView4756087383028510656 using(v1);
create or replace TEMP view aggView7984452974286948873 as select v4, SUM(v51) as v51, v47, v9, SUM(annot) as annot from aggJoin8640863104033062625 group by v4,v51,v47,v9;
create or replace TEMP view aggJoin3926466173098545768 as select v43, v51, v47, v9 from aggView3803256914848228657 join aggView7984452974286948873 using(v4);
create or replace TEMP view res as select v43, v47, v9, SUM(v51) as v51 from aggJoin3926466173098545768 group by v43, v47, v9;
select sum(v43+v47+v9+v51) from res;
