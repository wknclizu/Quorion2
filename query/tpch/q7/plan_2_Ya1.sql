create or replace TEMP view n2Aux13 as select n_nationkey as v37, n_name as v47 from nation;
create or replace TEMP view n1Aux55 as select n_nationkey as v4, n_name as v43 from nation where (n_name = 'FRANCE');
create or replace TEMP view lineitemwithyearAux79 as select l_orderkey as v25, l_year as v9, l_suppkey as v1 from lineitemwithyear where (l_shipdate >= DATE '1994-12-31') and (l_shipdate <= DATE '1996-12-30');
create or replace TEMP view semiUp8976311308566219285 as select s_suppkey as v1, s_nationkey as v4 from supplier AS supplier where (s_nationkey) in (select v4 from n1Aux55);
create or replace TEMP view semiUp5099248274883364558 as select v25, v9, v1 from lineitemwithyearAux79 where (v1) in (select v1 from semiUp8976311308566219285);
create or replace TEMP view semiUp885437707761909979 as select o_orderkey as v25, o_custkey as v34 from orders AS orders where (o_orderkey) in (select v25 from semiUp5099248274883364558);
create or replace TEMP view semiUp8070627334133573705 as select c_custkey as v34, c_nationkey as v37 from customer AS customer where (c_custkey) in (select v34 from semiUp885437707761909979);
create or replace TEMP view semiUp3189250980755431865 as select v37, v47 from n2Aux13 where (v37) in (select v37 from semiUp8070627334133573705);
create or replace TEMP view semiDown2951677030960374564 as select n_nationkey as v37, n_name as v47 from nation AS n2 where (n_nationkey, n_name) in (select v37, v47 from semiUp3189250980755431865);
create or replace TEMP view semiDown4404969848206614604 as select v34, v37 from semiUp8070627334133573705 where (v37) in (select v37 from semiUp3189250980755431865);
create or replace TEMP view semiDown3508138243999166526 as select v25, v34 from semiUp885437707761909979 where (v34) in (select v34 from semiDown4404969848206614604);
create or replace TEMP view semiDown5384136464320971033 as select v25, v9, v1 from semiUp5099248274883364558 where (v25) in (select v25 from semiDown3508138243999166526);
create or replace TEMP view semiDown5285094586028569875 as select v1, v4 from semiUp8976311308566219285 where (v1) in (select v1 from semiDown5384136464320971033);
create or replace TEMP view semiDown5031414060506873453 as select l_orderkey as v25, l_year as v9, l_suppkey as v1, l_extendedprice as v14, l_discount as v15 from lineitemwithyear AS lineitemwithyear where (l_orderkey, l_suppkey, l_year) in (select v25, v1, v9 from semiDown5384136464320971033) and (l_shipdate >= DATE '1994-12-31') and (l_shipdate <= DATE '1996-12-30');
create or replace TEMP view semiDown7160612712554834210 as select v4, v43 from n1Aux55 where (v4) in (select v4 from semiDown5285094586028569875);
create or replace TEMP view semiDown7251997906139935595 as select n_nationkey as v4, n_name as v43 from nation AS n1 where (n_nationkey, n_name) in (select v4, v43 from semiDown7160612712554834210) and (n_name = 'FRANCE');
create or replace TEMP view aggView5660493528458785151 as select v4, v43 from semiDown7251997906139935595;
create or replace TEMP view aggView2992349674633426852 as select v25, v1, v9, SUM(v14 * (1 - v15)) as v51, COUNT(*) as annot from semiDown5031414060506873453 group by v25,v1,v9;
create or replace TEMP view aggView5586888232333220610 as select v37, v47 from semiDown2951677030960374564;
create or replace TEMP view aggView8838039092203712727 as select v4, v43, COUNT(*) as annot from aggView5660493528458785151 group by v4,v43;
create or replace TEMP view aggJoin5508788630918323351 as select v1, v43, annot from semiDown5285094586028569875 join aggView8838039092203712727 using(v4);
create or replace TEMP view aggView2153488347425503416 as select v1, v43, SUM(annot) as annot from aggJoin5508788630918323351 group by v1,v43;
create or replace TEMP view aggJoin8854750725764442156 as select v25, v9, v51*aggView2153488347425503416.annot as v51, aggView2992349674633426852.annot * aggView2153488347425503416.annot as annot, v43 from aggView2992349674633426852 join aggView2153488347425503416 using(v1);
create or replace TEMP view aggView3255495428094251684 as select v25, SUM(v51) as v51, v43, v9, SUM(annot) as annot from aggJoin8854750725764442156 group by v25,v43,v51,v9;
create or replace TEMP view aggJoin7023716860304995767 as select v34, v51, v43, v9, annot from semiDown3508138243999166526 join aggView3255495428094251684 using(v25);
create or replace TEMP view aggView4189977338491159708 as select v34, SUM(v51) as v51, v43, v9, SUM(annot) as annot from aggJoin7023716860304995767 group by v34,v43,v51,v9;
create or replace TEMP view aggJoin2788472701937674105 as select v37, v51, v43, v9, annot from semiDown4404969848206614604 join aggView4189977338491159708 using(v34);
create or replace TEMP view aggView4168876539917913739 as select v37, SUM(v51) as v51, v43, v9, SUM(annot) as annot from aggJoin2788472701937674105 group by v37,v43,v51,v9;
create or replace TEMP view aggJoin6506027181926740972 as select v47, v51, v43, v9 from aggView5586888232333220610 join aggView4168876539917913739 using(v37);
create or replace TEMP view res as select v43, v47, v9, SUM(v51) as v51 from aggJoin6506027181926740972 group by v43, v47, v9;
select sum(v43+v47+v9+v51) from res;
