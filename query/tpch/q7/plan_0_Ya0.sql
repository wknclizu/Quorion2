create or replace TEMP view n2Aux15 as select n_nationkey as v37, n_name as v47 from nation;
create or replace TEMP view n1Aux75 as select n_nationkey as v4, n_name as v43 from nation where (n_name = 'FRANCE');
create or replace TEMP view lineitemwithyearAux92 as select l_orderkey as v25, l_year as v9, l_suppkey as v1 from lineitemwithyear where (l_shipdate >= DATE '1994-12-31') and (l_shipdate <= DATE '1996-12-30');
create or replace TEMP view semiUp6649114594893640272 as select s_suppkey as v1, s_nationkey as v4 from supplier AS supplier where (s_nationkey) in (select v4 from n1Aux75);
create or replace TEMP view semiUp5823133573841741480 as select v25, v9, v1 from lineitemwithyearAux92 where (v1) in (select v1 from semiUp6649114594893640272);
create or replace TEMP view semiUp3821805010645846360 as select o_orderkey as v25, o_custkey as v34 from orders AS orders where (o_orderkey) in (select v25 from semiUp5823133573841741480);
create or replace TEMP view semiUp3683144684539960187 as select c_custkey as v34, c_nationkey as v37 from customer AS customer where (c_custkey) in (select v34 from semiUp3821805010645846360);
create or replace TEMP view semiUp2894138607131782975 as select v37, v47 from n2Aux15 where (v37) in (select v37 from semiUp3683144684539960187);
create or replace TEMP view semiDown8823429029417447094 as select n_nationkey as v37, n_name as v47 from nation AS n2 where (n_name, n_nationkey) in (select v47, v37 from semiUp2894138607131782975);
create or replace TEMP view semiDown2368692836754424382 as select v34, v37 from semiUp3683144684539960187 where (v37) in (select v37 from semiUp2894138607131782975);
create or replace TEMP view semiDown4095883958223767692 as select v25, v34 from semiUp3821805010645846360 where (v34) in (select v34 from semiDown2368692836754424382);
create or replace TEMP view semiDown3336963407558526638 as select v25, v9, v1 from semiUp5823133573841741480 where (v25) in (select v25 from semiDown4095883958223767692);
create or replace TEMP view semiDown4585868857252577077 as select v1, v4 from semiUp6649114594893640272 where (v1) in (select v1 from semiDown3336963407558526638);
create or replace TEMP view semiDown7733718462848334903 as select l_orderkey as v25, l_year as v9, l_suppkey as v1, l_extendedprice as v14, l_discount as v15 from lineitemwithyear AS lineitemwithyear where (l_orderkey, l_year, l_suppkey) in (select v25, v9, v1 from semiDown3336963407558526638) and (l_shipdate >= DATE '1994-12-31') and (l_shipdate <= DATE '1996-12-30');
create or replace TEMP view semiDown2857169423636902803 as select v4, v43 from n1Aux75 where (v4) in (select v4 from semiDown4585868857252577077);
create or replace TEMP view semiDown1448404514001653067 as select n_nationkey as v4, n_name as v43 from nation AS n1 where (n_nationkey, n_name) in (select v4, v43 from semiDown2857169423636902803) and (n_name = 'FRANCE');
create or replace TEMP view aggView4241321205497566490 as select v4, v43 from semiDown1448404514001653067;
create or replace TEMP view aggView8830322128989236185 as select v25, v9, v1, SUM(v14 * (1 - v15)) as v51, COUNT(*) as annot from semiDown7733718462848334903 group by v25,v9,v1;
create or replace TEMP view aggView2897791941933846779 as select v47, v37 from semiDown8823429029417447094;
create or replace TEMP view aggView7580437339180838119 as select v4, v43, COUNT(*) as annot from aggView4241321205497566490 group by v4,v43;
create or replace TEMP view aggJoin1969792015570710166 as select v1, v43, annot from semiDown4585868857252577077 join aggView7580437339180838119 using(v4);
create or replace TEMP view aggView3695513068445540180 as select v1, v43, SUM(annot) as annot from aggJoin1969792015570710166 group by v1,v43;
create or replace TEMP view aggJoin1319483544473431721 as select v25, v9, v51*aggView3695513068445540180.annot as v51, aggView8830322128989236185.annot * aggView3695513068445540180.annot as annot, v43 from aggView8830322128989236185 join aggView3695513068445540180 using(v1);
create or replace TEMP view aggView1507669082297834334 as select v25, SUM(v51) as v51, v9, v43, SUM(annot) as annot from aggJoin1319483544473431721 group by v25,v9,v51,v43;
create or replace TEMP view aggJoin9097254959038478597 as select v34, v51, v9, v43, annot from semiDown4095883958223767692 join aggView1507669082297834334 using(v25);
create or replace TEMP view aggView1944112981739224355 as select v34, SUM(v51) as v51, v9, v43, SUM(annot) as annot from aggJoin9097254959038478597 group by v34,v9,v51,v43;
create or replace TEMP view aggJoin4793289855277443254 as select v37, v51, v9, v43, annot from semiDown2368692836754424382 join aggView1944112981739224355 using(v34);
create or replace TEMP view aggView7863606239252108229 as select v37, SUM(v51) as v51, v9, v43, SUM(annot) as annot from aggJoin4793289855277443254 group by v37,v9,v51,v43;
create or replace TEMP view aggJoin4208127875728262953 as select v47, v51, v9, v43 from aggView2897791941933846779 join aggView7863606239252108229 using(v37);
create or replace TEMP view res as select v43, v47, v9, SUM(v51) as v51 from aggJoin4208127875728262953 group by v43, v47, v9;
select sum(v43+v47+v9+v51) from res;
