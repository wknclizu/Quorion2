create or replace TEMP view semiUp6991806789780473629 as select c_custkey as v34, c_nationkey as v37 from customer AS customer where (c_nationkey) in (select n_nationkey from nation AS n2 where (n_name = 'GERMANY'));
create or replace TEMP view semiUp7036345735503756077 as select s_suppkey as v1, s_nationkey as v4 from supplier AS supplier where (s_nationkey) in (select n_nationkey from nation AS n1 where (n_name = 'FRANCE'));
create or replace TEMP view semiUp102293946477391029 as select l_orderkey as v25, l_year as v9, l_suppkey as v1, l_extendedprice as v14, l_discount as v15 from lineitemwithyear AS lineitemwithyear where (l_suppkey) in (select v1 from semiUp7036345735503756077) and (l_shipdate >= DATE '1994-12-31') and (l_shipdate <= DATE '1996-12-30');
create or replace TEMP view semiUp1610397415195210436 as select o_orderkey as v25, o_custkey as v34 from orders AS orders where (o_orderkey) in (select v25 from semiUp102293946477391029);
create or replace TEMP view semiUp5627081596357790636 as select v34, v37 from semiUp6991806789780473629 where (v34) in (select v34 from semiUp1610397415195210436);
create or replace TEMP view semiDown7610237432922700021 as select n_nationkey as v37, n_name as v47 from nation AS n2 where (n_nationkey) in (select v37 from semiUp5627081596357790636) and (n_name = 'GERMANY');
create or replace TEMP view semiDown2295762109568099517 as select v25, v34 from semiUp1610397415195210436 where (v34) in (select v34 from semiUp5627081596357790636);
create or replace TEMP view semiDown236243473822828930 as select v25, v9, v1, v14, v15 from semiUp102293946477391029 where (v25) in (select v25 from semiDown2295762109568099517);
create or replace TEMP view semiDown402952642381814039 as select v1, v4 from semiUp7036345735503756077 where (v1) in (select v1 from semiDown236243473822828930);
create or replace TEMP view semiDown2471216076074065479 as select n_nationkey as v4, n_name as v43 from nation AS n1 where (n_nationkey) in (select v4 from semiDown402952642381814039) and (n_name = 'FRANCE');
create or replace TEMP view aggView606734577136141165 as select v4, v43 from semiDown2471216076074065479;
create or replace TEMP view aggJoin2816747698952139001 as select v1, v43 from semiDown402952642381814039 join aggView606734577136141165 using(v4);
create or replace TEMP view aggView7407112683679479263 as select v1, v43, COUNT(*) as annot from aggJoin2816747698952139001 group by v1,v43;
create or replace TEMP view aggJoin7758006046770736096 as select v25, v9, v14, v15, v43, annot from semiDown236243473822828930 join aggView7407112683679479263 using(v1);
create or replace TEMP view aggView2424541481285956393 as select v25, SUM((v14 * (1 - v15)) * annot) as v51, v9, v43, SUM(annot) as annot from aggJoin7758006046770736096 group by v25,v9,v43;
create or replace TEMP view aggJoin3410046834860093062 as select v34, v51, v9, v43, annot from semiDown2295762109568099517 join aggView2424541481285956393 using(v25);
create or replace TEMP view aggView1649837112117540559 as select v34, SUM(v51) as v51, v9, v43, SUM(annot) as annot from aggJoin3410046834860093062 group by v34,v9,v43,v51;
create or replace TEMP view aggJoin1523434967367790151 as select v37, v51, v9, v43, annot from semiUp5627081596357790636 join aggView1649837112117540559 using(v34);
create or replace TEMP view aggView93214555537898483 as select v37, v47 from semiDown7610237432922700021;
create or replace TEMP view aggJoin4425004221576144439 as select v51, v9, v43, v47 from aggJoin1523434967367790151 join aggView93214555537898483 using(v37);
create or replace TEMP view res as select v43, v47, v9, SUM(v51) as v51 from aggJoin4425004221576144439 group by v43, v47, v9;
select sum(v43+v47+v9+v51) from res;
