create or replace TEMP view lineitemwithyearAux89 as select l_orderkey as v25, l_year as v9, l_suppkey as v1 from lineitemwithyear where (l_shipdate >= DATE '1994-12-31') and (l_shipdate <= DATE '1996-12-30');
create or replace TEMP view n2Aux70 as select n_nationkey as v37, n_name as v47 from nation;
create or replace TEMP view n1Aux13 as select n_nationkey as v4, n_name as v43 from nation where (n_name = 'FRANCE');
create or replace TEMP view semiUp1581252095722273027 as select c_custkey as v34, c_nationkey as v37 from customer AS customer where (c_nationkey) in (select v37 from n2Aux70);
create or replace TEMP view semiUp7386991832270993412 as select o_orderkey as v25, o_custkey as v34 from orders AS orders where (o_custkey) in (select v34 from semiUp1581252095722273027);
create or replace TEMP view semiUp8929953884624242334 as select v25, v9, v1 from lineitemwithyearAux89 where (v25) in (select v25 from semiUp7386991832270993412);
create or replace TEMP view semiUp3204853525442040103 as select s_suppkey as v1, s_nationkey as v4 from supplier AS supplier where (s_nationkey) in (select v4 from n1Aux13);
create or replace TEMP view semiUp1109724176724459810 as select v25, v9, v1 from semiUp8929953884624242334 where (v1) in (select v1 from semiUp3204853525442040103);
create or replace TEMP view semiDown7922421193608527052 as select v1, v4 from semiUp3204853525442040103 where (v1) in (select v1 from semiUp1109724176724459810);
create or replace TEMP view semiDown455384854957572260 as select v25, v34 from semiUp7386991832270993412 where (v25) in (select v25 from semiUp1109724176724459810);
create or replace TEMP view semiDown206519715631072462 as select l_orderkey as v25, l_year as v9, l_suppkey as v1, l_extendedprice as v14, l_discount as v15 from lineitemwithyear AS lineitemwithyear where (l_orderkey, l_suppkey, l_year) in (select v25, v1, v9 from semiUp1109724176724459810) and (l_shipdate >= DATE '1994-12-31') and (l_shipdate <= DATE '1996-12-30');
create or replace TEMP view semiDown5326162477306206484 as select v4, v43 from n1Aux13 where (v4) in (select v4 from semiDown7922421193608527052);
create or replace TEMP view semiDown9040596990206409334 as select v34, v37 from semiUp1581252095722273027 where (v34) in (select v34 from semiDown455384854957572260);
create or replace TEMP view semiDown8871446267772672692 as select n_nationkey as v4, n_name as v43 from nation AS n1 where (n_nationkey, n_name) in (select v4, v43 from semiDown5326162477306206484) and (n_name = 'FRANCE');
create or replace TEMP view semiDown8456563041704223176 as select v37, v47 from n2Aux70 where (v37) in (select v37 from semiDown9040596990206409334);
create or replace TEMP view semiDown2151266161484735093 as select n_nationkey as v37, n_name as v47 from nation AS n2 where (n_nationkey, n_name) in (select v37, v47 from semiDown8456563041704223176);
create or replace TEMP view aggView8950858561484205185 as select v37, v47 from semiDown2151266161484735093;
create or replace TEMP view aggView8528857268395730438 as select v4, v43 from semiDown8871446267772672692;
create or replace TEMP view aggView202738826469749801 as select v25, v1, v9, SUM(v14 * (1 - v15)) as v51, COUNT(*) as annot from semiDown206519715631072462 group by v25,v1,v9;
create or replace TEMP view aggView8127477397056529640 as select v37, v47, COUNT(*) as annot from aggView8950858561484205185 group by v37,v47;
create or replace TEMP view aggJoin3029099567817466596 as select v34, v47, annot from semiDown9040596990206409334 join aggView8127477397056529640 using(v37);
create or replace TEMP view aggView1219256079577483676 as select v34, v47, SUM(annot) as annot from aggJoin3029099567817466596 group by v34,v47;
create or replace TEMP view aggJoin600781525818664802 as select v25, v47, annot from semiDown455384854957572260 join aggView1219256079577483676 using(v34);
create or replace TEMP view aggView659542720867693438 as select v4, v43, COUNT(*) as annot from aggView8528857268395730438 group by v4,v43;
create or replace TEMP view aggJoin2412701420569028946 as select v1, v43, annot from semiDown7922421193608527052 join aggView659542720867693438 using(v4);
create or replace TEMP view aggView2586259116924168205 as select v1, v43, SUM(annot) as annot from aggJoin2412701420569028946 group by v1,v43;
create or replace TEMP view aggJoin5818763688323672931 as select v25, v9, v51*aggView2586259116924168205.annot as v51, aggView202738826469749801.annot * aggView2586259116924168205.annot as annot, v43 from aggView202738826469749801 join aggView2586259116924168205 using(v1);
create or replace TEMP view aggView625873787662795683 as select v25, v47, SUM(annot) as annot from aggJoin600781525818664802 group by v25,v47;
create or replace TEMP view aggJoin4493460033565005333 as select v9, v51*aggView625873787662795683.annot as v51, v43, v47 from aggJoin5818763688323672931 join aggView625873787662795683 using(v25);
create or replace TEMP view res as select v43, v47, v9, SUM(v51) as v51 from aggJoin4493460033565005333 group by v43, v47, v9;
select sum(v43+v47+v9+v51) from res;
