create or replace TEMP view n2Aux28 as select n_nationkey as v37, n_name as v47 from nation;
create or replace TEMP view n1Aux42 as select n_nationkey as v4, n_name as v43 from nation where (n_name = 'FRANCE');
create or replace TEMP view lineitemwithyearAux39 as select l_orderkey as v25, l_year as v9, l_suppkey as v1 from lineitemwithyear where (l_shipdate >= DATE '1994-12-31') and (l_shipdate <= DATE '1996-12-30');
create or replace TEMP view semiUp3398042846950290827 as select s_suppkey as v1, s_nationkey as v4 from supplier AS supplier where (s_nationkey) in (select v4 from n1Aux42);
create or replace TEMP view semiUp3989134266860278186 as select c_custkey as v34, c_nationkey as v37 from customer AS customer where (c_nationkey) in (select v37 from n2Aux28);
create or replace TEMP view semiUp2938331059570235932 as select v25, v9, v1 from lineitemwithyearAux39 where (v1) in (select v1 from semiUp3398042846950290827);
create or replace TEMP view semiUp2052618647186645182 as select o_orderkey as v25, o_custkey as v34 from orders AS orders where (o_custkey) in (select v34 from semiUp3989134266860278186);
create or replace TEMP view semiUp6242568605998567057 as select v25, v9, v1 from semiUp2938331059570235932 where (v25) in (select v25 from semiUp2052618647186645182);
create or replace TEMP view semiDown6944378925748457473 as select v1, v4 from semiUp3398042846950290827 where (v1) in (select v1 from semiUp6242568605998567057);
create or replace TEMP view semiDown9147161459219094912 as select v25, v34 from semiUp2052618647186645182 where (v25) in (select v25 from semiUp6242568605998567057);
create or replace TEMP view semiDown8111236353617616233 as select l_orderkey as v25, l_year as v9, l_suppkey as v1, l_extendedprice as v14, l_discount as v15 from lineitemwithyear AS lineitemwithyear where (l_suppkey, l_year, l_orderkey) in (select v1, v9, v25 from semiUp6242568605998567057) and (l_shipdate >= DATE '1994-12-31') and (l_shipdate <= DATE '1996-12-30');
create or replace TEMP view semiDown9183823930616311494 as select v4, v43 from n1Aux42 where (v4) in (select v4 from semiDown6944378925748457473);
create or replace TEMP view semiDown969998874824757609 as select v34, v37 from semiUp3989134266860278186 where (v34) in (select v34 from semiDown9147161459219094912);
create or replace TEMP view semiDown6998265844926010563 as select n_nationkey as v4, n_name as v43 from nation AS n1 where (n_name, n_nationkey) in (select v43, v4 from semiDown9183823930616311494) and (n_name = 'FRANCE');
create or replace TEMP view semiDown2376212753747624155 as select v37, v47 from n2Aux28 where (v37) in (select v37 from semiDown969998874824757609);
create or replace TEMP view semiDown7038682129105509893 as select n_nationkey as v37, n_name as v47 from nation AS n2 where (n_nationkey, n_name) in (select v37, v47 from semiDown2376212753747624155);
create or replace TEMP view aggView5588522567956045848 as select v37, v47 from semiDown7038682129105509893;
create or replace TEMP view aggView562208341232784139 as select v43, v4 from semiDown6998265844926010563;
create or replace TEMP view aggView2471941398005435087 as select v1, v9, v25, SUM(v14 * (1 - v15)) as v51, COUNT(*) as annot from semiDown8111236353617616233 group by v1,v9,v25;
create or replace TEMP view aggView9087536748184781760 as select v37, v47, COUNT(*) as annot from aggView5588522567956045848 group by v37,v47;
create or replace TEMP view aggJoin3959979215260579576 as select v34, v47, annot from semiDown969998874824757609 join aggView9087536748184781760 using(v37);
create or replace TEMP view aggView347643337074520170 as select v34, v47, SUM(annot) as annot from aggJoin3959979215260579576 group by v34,v47;
create or replace TEMP view aggJoin7391142475069652444 as select v25, v47, annot from semiDown9147161459219094912 join aggView347643337074520170 using(v34);
create or replace TEMP view aggView2020239991644826762 as select v4, v43, COUNT(*) as annot from aggView562208341232784139 group by v4,v43;
create or replace TEMP view aggJoin199923990504801610 as select v1, v43, annot from semiDown6944378925748457473 join aggView2020239991644826762 using(v4);
create or replace TEMP view aggView3382313058912282792 as select v25, v47, SUM(annot) as annot from aggJoin7391142475069652444 group by v25,v47;
create or replace TEMP view aggJoin964747543676192963 as select v1, v9, v51*aggView3382313058912282792.annot as v51, aggView2471941398005435087.annot * aggView3382313058912282792.annot as annot, v47 from aggView2471941398005435087 join aggView3382313058912282792 using(v25);
create or replace TEMP view aggView4495455933092421544 as select v1, v43, SUM(annot) as annot from aggJoin199923990504801610 group by v1,v43;
create or replace TEMP view aggJoin6123174815166679176 as select v9, v51*aggView4495455933092421544.annot as v51, v47, v43 from aggJoin964747543676192963 join aggView4495455933092421544 using(v1);
create or replace TEMP view res as select v43, v47, v9, SUM(v51) as v51 from aggJoin6123174815166679176 group by v43, v47, v9;
select sum(v43+v47+v9+v51) from res;
