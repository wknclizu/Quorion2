create or replace TEMP view n2Aux57 as select n_nationkey as v37, n_name as v47 from nation;
create or replace TEMP view lineitemwithyearAux18 as select l_orderkey as v25, l_year as v9, l_suppkey as v1 from lineitemwithyear where (l_shipdate >= DATE '1994-12-31') and (l_shipdate <= DATE '1996-12-30');
create or replace TEMP view n1Aux42 as select n_nationkey as v4, n_name as v43 from nation where (n_name = 'FRANCE');
create or replace TEMP view semiUp3909033811522750356 as select s_suppkey as v1, s_nationkey as v4 from supplier AS supplier where (s_nationkey) in (select v4 from n1Aux42);
create or replace TEMP view semiUp1027950145005167370 as select v25, v9, v1 from lineitemwithyearAux18 where (v1) in (select v1 from semiUp3909033811522750356);
create or replace TEMP view semiUp5836340205091912452 as select o_orderkey as v25, o_custkey as v34 from orders AS orders where (o_orderkey) in (select v25 from semiUp1027950145005167370);
create or replace TEMP view semiUp6536806586048982316 as select c_custkey as v34, c_nationkey as v37 from customer AS customer where (c_custkey) in (select v34 from semiUp5836340205091912452);
create or replace TEMP view semiUp9008436039833855192 as select v37, v47 from n2Aux57 where (v37) in (select v37 from semiUp6536806586048982316);
create or replace TEMP view semiDown1297909280485382486 as select n_nationkey as v37, n_name as v47 from nation AS n2 where (n_name, n_nationkey) in (select v47, v37 from semiUp9008436039833855192);
create or replace TEMP view semiDown767050372783323675 as select v34, v37 from semiUp6536806586048982316 where (v37) in (select v37 from semiUp9008436039833855192);
create or replace TEMP view semiDown8258773232483400520 as select v25, v34 from semiUp5836340205091912452 where (v34) in (select v34 from semiDown767050372783323675);
create or replace TEMP view semiDown7614922553943612099 as select v25, v9, v1 from semiUp1027950145005167370 where (v25) in (select v25 from semiDown8258773232483400520);
create or replace TEMP view semiDown5877994779581580184 as select v1, v4 from semiUp3909033811522750356 where (v1) in (select v1 from semiDown7614922553943612099);
create or replace TEMP view semiDown1557573658545921958 as select l_orderkey as v25, l_year as v9, l_suppkey as v1, l_extendedprice as v14, l_discount as v15 from lineitemwithyear AS lineitemwithyear where (l_orderkey, l_suppkey, l_year) in (select v25, v1, v9 from semiDown7614922553943612099) and (l_shipdate >= DATE '1994-12-31') and (l_shipdate <= DATE '1996-12-30');
create or replace TEMP view semiDown7150953613487581827 as select v4, v43 from n1Aux42 where (v4) in (select v4 from semiDown5877994779581580184);
create or replace TEMP view semiDown6818812830748529077 as select n_nationkey as v4, n_name as v43 from nation AS n1 where (n_nationkey, n_name) in (select v4, v43 from semiDown7150953613487581827) and (n_name = 'FRANCE');
create or replace TEMP view aggView4340506904638198676 as select v4, v43 from semiDown6818812830748529077;
create or replace TEMP view aggView8647407101054659606 as select v25, v1, v9, SUM(v14 * (1 - v15)) as v51, COUNT(*) as annot from semiDown1557573658545921958 group by v25,v1,v9;
create or replace TEMP view aggView4440708553334289939 as select v47, v37 from semiDown1297909280485382486;
create or replace TEMP view aggView2112399468768900592 as select v4, v43, COUNT(*) as annot from aggView4340506904638198676 group by v4,v43;
create or replace TEMP view aggJoin5224615961807639051 as select v1, v43, annot from semiDown5877994779581580184 join aggView2112399468768900592 using(v4);
create or replace TEMP view aggView6744434023283253918 as select v1, v43, SUM(annot) as annot from aggJoin5224615961807639051 group by v1,v43;
create or replace TEMP view aggJoin2688902904443875350 as select v25, v9, v51*aggView6744434023283253918.annot as v51, aggView8647407101054659606.annot * aggView6744434023283253918.annot as annot, v43 from aggView8647407101054659606 join aggView6744434023283253918 using(v1);
create or replace TEMP view aggView6049798784069291980 as select v25, SUM(v51) as v51, v43, v9, SUM(annot) as annot from aggJoin2688902904443875350 group by v25,v43,v9,v51;
create or replace TEMP view aggJoin6762092419129052881 as select v34, v51, v43, v9, annot from semiDown8258773232483400520 join aggView6049798784069291980 using(v25);
create or replace TEMP view aggView1819557887923199867 as select v34, SUM(v51) as v51, v43, v9, SUM(annot) as annot from aggJoin6762092419129052881 group by v34,v43,v9,v51;
create or replace TEMP view aggJoin5711339333979722467 as select v37, v51, v43, v9, annot from semiDown767050372783323675 join aggView1819557887923199867 using(v34);
create or replace TEMP view aggView4231491807286723918 as select v37, SUM(v51) as v51, v43, v9, SUM(annot) as annot from aggJoin5711339333979722467 group by v37,v43,v9,v51;
create or replace TEMP view aggJoin4193572719289823997 as select v47, v51, v43, v9 from aggView4440708553334289939 join aggView4231491807286723918 using(v37);
create or replace TEMP view res as select v43, v47, v9, SUM(v51) as v51 from aggJoin4193572719289823997 group by v43, v47, v9;
select sum(v43+v47+v9+v51) from res;
