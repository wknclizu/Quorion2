create or replace TEMP view lineitemwithyearAux74 as select l_orderkey as v25, l_year as v9, l_suppkey as v1 from lineitemwithyear where (l_shipdate >= DATE '1994-12-31') and (l_shipdate <= DATE '1996-12-30');
create or replace TEMP view n1Aux91 as select n_nationkey as v4, n_name as v43 from nation;
create or replace TEMP view n2Aux4 as select n_nationkey as v37, n_name as v47 from nation where (n_name = 'GERMANY');
create or replace TEMP view semiUp1574038297521340801 as select c_custkey as v34, c_nationkey as v37 from customer AS customer where (c_nationkey) in (select v37 from n2Aux4);
create or replace TEMP view semiUp4189707304300428630 as select o_orderkey as v25, o_custkey as v34 from orders AS orders where (o_custkey) in (select v34 from semiUp1574038297521340801);
create or replace TEMP view semiUp3042688916312633952 as select v25, v9, v1 from lineitemwithyearAux74 where (v25) in (select v25 from semiUp4189707304300428630);
create or replace TEMP view semiUp8713128548172362720 as select s_suppkey as v1, s_nationkey as v4 from supplier AS supplier where (s_suppkey) in (select v1 from semiUp3042688916312633952);
create or replace TEMP view semiUp3512172246800865101 as select v4, v43 from n1Aux91 where (v4) in (select v4 from semiUp8713128548172362720);
create or replace TEMP view semiDown1895176159343665780 as select n_nationkey as v4, n_name as v43 from nation AS n1 where (n_name, n_nationkey) in (select v43, v4 from semiUp3512172246800865101);
create or replace TEMP view semiDown2632363764405038208 as select v1, v4 from semiUp8713128548172362720 where (v4) in (select v4 from semiUp3512172246800865101);
create or replace TEMP view semiDown4511830324377901083 as select v25, v9, v1 from semiUp3042688916312633952 where (v1) in (select v1 from semiDown2632363764405038208);
create or replace TEMP view semiDown6639594030616428597 as select v25, v34 from semiUp4189707304300428630 where (v25) in (select v25 from semiDown4511830324377901083);
create or replace TEMP view semiDown5582927353041629873 as select l_orderkey as v25, l_year as v9, l_suppkey as v1, l_extendedprice as v14, l_discount as v15 from lineitemwithyear AS lineitemwithyear where (l_year, l_orderkey, l_suppkey) in (select v9, v25, v1 from semiDown4511830324377901083) and (l_shipdate >= DATE '1994-12-31') and (l_shipdate <= DATE '1996-12-30');
create or replace TEMP view semiDown8976045952734933128 as select v34, v37 from semiUp1574038297521340801 where (v34) in (select v34 from semiDown6639594030616428597);
create or replace TEMP view semiDown5101265603813626603 as select v37, v47 from n2Aux4 where (v37) in (select v37 from semiDown8976045952734933128);
create or replace TEMP view semiDown1733575656255038890 as select n_nationkey as v37, n_name as v47 from nation AS n2 where (n_name, n_nationkey) in (select v47, v37 from semiDown5101265603813626603) and (n_name = 'GERMANY');
create or replace TEMP view aggView7021651505563693871 as select v47, v37 from semiDown1733575656255038890;
create or replace TEMP view aggView5844859836986681171 as select v9, v25, v1, SUM(v14 * (1 - v15)) as v51, COUNT(*) as annot from semiDown5582927353041629873 group by v9,v25,v1;
create or replace TEMP view aggView2088317747972760685 as select v43, v4 from semiDown1895176159343665780;
create or replace TEMP view aggView9077170652217602993 as select v37, v47, COUNT(*) as annot from aggView7021651505563693871 group by v37,v47;
create or replace TEMP view aggJoin9062585463527381329 as select v34, v47, annot from semiDown8976045952734933128 join aggView9077170652217602993 using(v37);
create or replace TEMP view aggView3986860445766637226 as select v34, v47, SUM(annot) as annot from aggJoin9062585463527381329 group by v34,v47;
create or replace TEMP view aggJoin3699882451771316160 as select v25, v47, annot from semiDown6639594030616428597 join aggView3986860445766637226 using(v34);
create or replace TEMP view aggView8488859353313983992 as select v25, v47, SUM(annot) as annot from aggJoin3699882451771316160 group by v25,v47;
create or replace TEMP view aggJoin7964474082821603339 as select v9, v1, v51*aggView8488859353313983992.annot as v51, aggView5844859836986681171.annot * aggView8488859353313983992.annot as annot, v47 from aggView5844859836986681171 join aggView8488859353313983992 using(v25);
create or replace TEMP view aggView6874039205850346823 as select v1, SUM(v51) as v51, v47, v9, SUM(annot) as annot from aggJoin7964474082821603339 group by v1,v47,v51,v9;
create or replace TEMP view aggJoin3872181409229914206 as select v4, v51, v47, v9, annot from semiDown2632363764405038208 join aggView6874039205850346823 using(v1);
create or replace TEMP view aggView539942300200238294 as select v4, SUM(v51) as v51, v47, v9, SUM(annot) as annot from aggJoin3872181409229914206 group by v4,v47,v51,v9;
create or replace TEMP view aggJoin4016933735673769530 as select v43, v51, v47, v9 from aggView2088317747972760685 join aggView539942300200238294 using(v4);
create or replace TEMP view res as select v43, v47, v9, SUM(v51) as v51 from aggJoin4016933735673769530 group by v43, v47, v9;
select sum(v43+v47+v9+v51) from res;
