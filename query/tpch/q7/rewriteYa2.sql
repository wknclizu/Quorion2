create or replace TEMP view n2Aux62 as select n_nationkey as v37, n_name as v47 from nation;
create or replace TEMP view n1Aux34 as select n_nationkey as v4, n_name as v43 from nation where (n_name = 'FRANCE');
create or replace TEMP view lineitemwithyearAux35 as select l_orderkey as v25, l_year as v9, l_suppkey as v1 from lineitemwithyear where (l_shipdate >= DATE '1994-12-31') and (l_shipdate <= DATE '1996-12-30');
create or replace TEMP view semiUp5446190458010349366 as select s_suppkey as v1, s_nationkey as v4 from supplier AS supplier where (s_nationkey) in (select v4 from n1Aux34);
create or replace TEMP view semiUp4548908078068025004 as select v25, v9, v1 from lineitemwithyearAux35 where (v1) in (select v1 from semiUp5446190458010349366);
create or replace TEMP view semiUp5116068710355522870 as select o_orderkey as v25, o_custkey as v34 from orders AS orders where (o_orderkey) in (select v25 from semiUp4548908078068025004);
create or replace TEMP view semiUp3523180225282602531 as select c_custkey as v34, c_nationkey as v37 from customer AS customer where (c_custkey) in (select v34 from semiUp5116068710355522870);
create or replace TEMP view semiUp7093114423365650644 as select v37, v47 from n2Aux62 where (v37) in (select v37 from semiUp3523180225282602531);
create or replace TEMP view semiDown5863870201351873674 as select n_nationkey as v37, n_name as v47 from nation AS n2 where (n_name, n_nationkey) in (select v47, v37 from semiUp7093114423365650644);
create or replace TEMP view semiDown2890594818333809571 as select v34, v37 from semiUp3523180225282602531 where (v37) in (select v37 from semiUp7093114423365650644);
create or replace TEMP view semiDown943843868620368288 as select v25, v34 from semiUp5116068710355522870 where (v34) in (select v34 from semiDown2890594818333809571);
create or replace TEMP view semiDown4836740054547891621 as select v25, v9, v1 from semiUp4548908078068025004 where (v25) in (select v25 from semiDown943843868620368288);
create or replace TEMP view semiDown3956516852383818848 as select v1, v4 from semiUp5446190458010349366 where (v1) in (select v1 from semiDown4836740054547891621);
create or replace TEMP view semiDown2358628982144861738 as select l_orderkey as v25, l_year as v9, l_suppkey as v1, l_extendedprice as v14, l_discount as v15 from lineitemwithyear AS lineitemwithyear where (l_year, l_suppkey, l_orderkey) in (select v9, v1, v25 from semiDown4836740054547891621) and (l_shipdate >= DATE '1994-12-31') and (l_shipdate <= DATE '1996-12-30');
create or replace TEMP view semiDown1462136761374033728 as select v4, v43 from n1Aux34 where (v4) in (select v4 from semiDown3956516852383818848);
create or replace TEMP view semiDown1949742471423485909 as select n_nationkey as v4, n_name as v43 from nation AS n1 where (n_nationkey, n_name) in (select v4, v43 from semiDown1462136761374033728) and (n_name = 'FRANCE');
create or replace TEMP view aggView971020741617175008 as select v4, v43 from semiDown1949742471423485909;
create or replace TEMP view aggView5543189407703194373 as select v9, v1, v25, SUM(v14 * (1 - v15)) as v51, COUNT(*) as annot from semiDown2358628982144861738 group by v9,v1,v25;
create or replace TEMP view aggView3137072295201446402 as select v47, v37 from semiDown5863870201351873674;
create or replace TEMP view aggView3560310570591811438 as select v4, v43, COUNT(*) as annot from aggView971020741617175008 group by v4,v43;
create or replace TEMP view aggJoin6432208562411406859 as select v1, v43, annot from semiDown3956516852383818848 join aggView3560310570591811438 using(v4);
create or replace TEMP view aggView5416410117787002298 as select v1, v43, SUM(annot) as annot from aggJoin6432208562411406859 group by v1,v43;
create or replace TEMP view aggJoin2550846014147857145 as select v9, v25, v51*aggView5416410117787002298.annot as v51, aggView5543189407703194373.annot * aggView5416410117787002298.annot as annot, v43 from aggView5543189407703194373 join aggView5416410117787002298 using(v1);
create or replace TEMP view aggView6822222491209925177 as select v25, SUM(v51) as v51, v9, v43, SUM(annot) as annot from aggJoin2550846014147857145 group by v25,v9,v43,v51;
create or replace TEMP view aggJoin6089108003420586380 as select v34, v51, v9, v43, annot from semiDown943843868620368288 join aggView6822222491209925177 using(v25);
create or replace TEMP view aggView3689997744164450422 as select v34, SUM(v51) as v51, v9, v43, SUM(annot) as annot from aggJoin6089108003420586380 group by v34,v9,v43,v51;
create or replace TEMP view aggJoin7043214582559063620 as select v37, v51, v9, v43, annot from semiDown2890594818333809571 join aggView3689997744164450422 using(v34);
create or replace TEMP view aggView408764714766496347 as select v37, SUM(v51) as v51, v9, v43, SUM(annot) as annot from aggJoin7043214582559063620 group by v37,v9,v43,v51;
create or replace TEMP view aggJoin94773665147601475 as select v47, v51, v9, v43 from aggView3137072295201446402 join aggView408764714766496347 using(v37);
create or replace TEMP view res as select v43, v47, v9, SUM(v51) as v51 from aggJoin94773665147601475 group by v43, v47, v9;
select sum(v43+v47+v9+v51) from res;
