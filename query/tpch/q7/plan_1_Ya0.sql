create or replace TEMP view semiUp1786628367104026955 as select s_suppkey as v1, s_nationkey as v4 from supplier AS supplier where (s_nationkey) in (select n_nationkey from nation AS n1 where (n_name = 'FRANCE'));
create or replace TEMP view semiUp1975094289921867778 as select c_custkey as v34, c_nationkey as v37 from customer AS customer where (c_nationkey) in (select n_nationkey from nation AS n2 where (n_name = 'GERMANY'));
create or replace TEMP view semiUp7944429204441574047 as select o_orderkey as v25, o_custkey as v34 from orders AS orders where (o_custkey) in (select v34 from semiUp1975094289921867778);
create or replace TEMP view semiUp8428344307244844845 as select l_orderkey as v25, l_year as v9, l_suppkey as v1, l_extendedprice as v14, l_discount as v15 from lineitemwithyear AS lineitemwithyear where (l_orderkey) in (select v25 from semiUp7944429204441574047) and (l_shipdate >= DATE '1994-12-31') and (l_shipdate <= DATE '1996-12-30');
create or replace TEMP view semiUp7648124581577331085 as select v25, v9, v1, v14, v15 from semiUp8428344307244844845 where (v1) in (select v1 from semiUp1786628367104026955);
create or replace TEMP view semiDown8159763421103624199 as select v1, v4 from semiUp1786628367104026955 where (v1) in (select v1 from semiUp7648124581577331085);
create or replace TEMP view semiDown6025192275334981991 as select v25, v34 from semiUp7944429204441574047 where (v25) in (select v25 from semiUp7648124581577331085);
create or replace TEMP view semiDown1841937764048278974 as select n_nationkey as v4, n_name as v43 from nation AS n1 where (n_nationkey) in (select v4 from semiDown8159763421103624199) and (n_name = 'FRANCE');
create or replace TEMP view semiDown3716107605646815013 as select v34, v37 from semiUp1975094289921867778 where (v34) in (select v34 from semiDown6025192275334981991);
create or replace TEMP view semiDown228285939715234275 as select n_nationkey as v37, n_name as v47 from nation AS n2 where (n_nationkey) in (select v37 from semiDown3716107605646815013) and (n_name = 'GERMANY');
create or replace TEMP view aggView1210545690518505785 as select v37, v47 from semiDown228285939715234275;
create or replace TEMP view aggJoin498309212214667011 as select v34, v47 from semiDown3716107605646815013 join aggView1210545690518505785 using(v37);
create or replace TEMP view aggView7878763259199366103 as select v34, v47, COUNT(*) as annot from aggJoin498309212214667011 group by v34,v47;
create or replace TEMP view aggJoin1191927912543995473 as select v25, v47, annot from semiDown6025192275334981991 join aggView7878763259199366103 using(v34);
create or replace TEMP view aggView1900552902807209201 as select v4, v43 from semiDown1841937764048278974;
create or replace TEMP view aggJoin7895535783503503744 as select v1, v43 from semiDown8159763421103624199 join aggView1900552902807209201 using(v4);
create or replace TEMP view aggView8121516737891918535 as select v1, v43, COUNT(*) as annot from aggJoin7895535783503503744 group by v1,v43;
create or replace TEMP view aggJoin8043291838215003636 as select v25, v9, v14, v15, v43, annot from semiUp7648124581577331085 join aggView8121516737891918535 using(v1);
create or replace TEMP view aggView7949349714210046173 as select v25, v47, SUM(annot) as annot from aggJoin1191927912543995473 group by v25,v47;
create or replace TEMP view aggJoin6464769682254357204 as select v9, v14, v15, v43, aggJoin8043291838215003636.annot * aggView7949349714210046173.annot as annot, v47 from aggJoin8043291838215003636 join aggView7949349714210046173 using(v25);
create or replace TEMP view res as select v43, v47, v9, SUM((v14 * (1 - v15))*annot) as v51 from aggJoin6464769682254357204 group by v43, v47, v9;
select sum(v43+v47+v9+v51) from res;
