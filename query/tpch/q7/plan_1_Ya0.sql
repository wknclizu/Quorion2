create or replace TEMP view n1Aux32 as select n_nationkey as v4, n_name as v43 from nation where (n_name = 'FRANCE');
create or replace TEMP view n2Aux22 as select n_nationkey as v37, n_name as v47 from nation where (n_name = 'GERMANY');
create or replace TEMP view lineitemwithyearAux11 as select l_orderkey as v25, l_year as v9, l_suppkey as v1 from lineitemwithyear where (l_shipdate >= DATE '1994-12-31') and (l_shipdate <= DATE '1996-12-30');
create or replace TEMP view semiUp927862059423627538 as select s_suppkey as v1, s_nationkey as v4 from supplier AS supplier where (s_nationkey) in (select v4 from n1Aux32);
create or replace TEMP view semiUp5441922094127734672 as select v25, v9, v1 from lineitemwithyearAux11 where (v1) in (select v1 from semiUp927862059423627538);
create or replace TEMP view semiUp4223766356948029722 as select o_orderkey as v25, o_custkey as v34 from orders AS orders where (o_orderkey) in (select v25 from semiUp5441922094127734672);
create or replace TEMP view semiUp6066380199072442907 as select c_custkey as v34, c_nationkey as v37 from customer AS customer where (c_custkey) in (select v34 from semiUp4223766356948029722);
create or replace TEMP view semiUp176072309703252289 as select v37, v47 from n2Aux22 where (v37) in (select v37 from semiUp6066380199072442907);
create or replace TEMP view semiDown96153428091684804 as select n_nationkey as v37, n_name as v47 from nation AS n2 where (n_nationkey, n_name) in (select v37, v47 from semiUp176072309703252289) and (n_name = 'GERMANY');
create or replace TEMP view semiDown1776976436244387726 as select v34, v37 from semiUp6066380199072442907 where (v37) in (select v37 from semiUp176072309703252289);
create or replace TEMP view semiDown2380286492659258884 as select v25, v34 from semiUp4223766356948029722 where (v34) in (select v34 from semiDown1776976436244387726);
create or replace TEMP view semiDown7890400656586156943 as select v25, v9, v1 from semiUp5441922094127734672 where (v25) in (select v25 from semiDown2380286492659258884);
create or replace TEMP view semiDown7572156476036014104 as select v1, v4 from semiUp927862059423627538 where (v1) in (select v1 from semiDown7890400656586156943);
create or replace TEMP view semiDown2247527715029039100 as select l_orderkey as v25, l_year as v9, l_suppkey as v1, l_extendedprice as v14, l_discount as v15 from lineitemwithyear AS lineitemwithyear where (l_orderkey, l_suppkey, l_year) in (select v25, v1, v9 from semiDown7890400656586156943) and (l_shipdate >= DATE '1994-12-31') and (l_shipdate <= DATE '1996-12-30');
create or replace TEMP view semiDown1484503767581791738 as select v4, v43 from n1Aux32 where (v4) in (select v4 from semiDown7572156476036014104);
create or replace TEMP view semiDown948986094568940355 as select n_nationkey as v4, n_name as v43 from nation AS n1 where (n_name, n_nationkey) in (select v43, v4 from semiDown1484503767581791738) and (n_name = 'FRANCE');
create or replace TEMP view aggView2385100819166963280 as select v43, v4 from semiDown948986094568940355;
create or replace TEMP view aggView579941910629334722 as select v25, v1, v9, SUM(v14 * (1 - v15)) as v51, COUNT(*) as annot from semiDown2247527715029039100 group by v25,v1,v9;
create or replace TEMP view aggView80516310250162004 as select v37, v47 from semiDown96153428091684804;
create or replace TEMP view aggView5175850837974273168 as select v4, v43, COUNT(*) as annot from aggView2385100819166963280 group by v4,v43;
create or replace TEMP view aggJoin3807108345375755635 as select v1, v43, annot from semiDown7572156476036014104 join aggView5175850837974273168 using(v4);
create or replace TEMP view aggView8979951814909752745 as select v1, v43, SUM(annot) as annot from aggJoin3807108345375755635 group by v1,v43;
create or replace TEMP view aggJoin5386729303170739941 as select v25, v9, v51*aggView8979951814909752745.annot as v51, aggView579941910629334722.annot * aggView8979951814909752745.annot as annot, v43 from aggView579941910629334722 join aggView8979951814909752745 using(v1);
create or replace TEMP view aggView8284333960530842737 as select v25, SUM(v51) as v51, v43, v9, SUM(annot) as annot from aggJoin5386729303170739941 group by v25,v43,v51,v9;
create or replace TEMP view aggJoin7378297791414519654 as select v34, v51, v43, v9, annot from semiDown2380286492659258884 join aggView8284333960530842737 using(v25);
create or replace TEMP view aggView2104558507804476869 as select v34, SUM(v51) as v51, v43, v9, SUM(annot) as annot from aggJoin7378297791414519654 group by v34,v43,v51,v9;
create or replace TEMP view aggJoin471570749923040529 as select v37, v51, v43, v9, annot from semiDown1776976436244387726 join aggView2104558507804476869 using(v34);
create or replace TEMP view aggView89091552492933267 as select v37, SUM(v51) as v51, v43, v9, SUM(annot) as annot from aggJoin471570749923040529 group by v37,v43,v51,v9;
create or replace TEMP view aggJoin6281596440482084745 as select v47, v51, v43, v9 from aggView80516310250162004 join aggView89091552492933267 using(v37);
create or replace TEMP view res as select v43, v47, v9, SUM(v51) as v51 from aggJoin6281596440482084745 group by v43, v47, v9;
select sum(v43+v47+v9+v51) from res;
