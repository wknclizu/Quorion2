create or replace TEMP view n2Aux78 as select n_nationkey as v37, n_name as v47 from nation where (n_name = 'GERMANY');
create or replace TEMP view lineitemwithyearAux45 as select l_orderkey as v25, l_year as v9, l_suppkey as v1 from lineitemwithyear where (l_shipdate >= DATE '1994-12-31') and (l_shipdate <= DATE '1996-12-30');
create or replace TEMP view n1Aux33 as select n_nationkey as v4, n_name as v43 from nation where (n_name = 'FRANCE');
create or replace TEMP view semiUp2547842388509726347 as select c_custkey as v34, c_nationkey as v37 from customer AS customer where (c_nationkey) in (select v37 from n2Aux78);
create or replace TEMP view semiUp8126468992191502041 as select o_orderkey as v25, o_custkey as v34 from orders AS orders where (o_custkey) in (select v34 from semiUp2547842388509726347);
create or replace TEMP view semiUp7258971941076719570 as select v25, v9, v1 from lineitemwithyearAux45 where (v25) in (select v25 from semiUp8126468992191502041);
create or replace TEMP view semiUp778359154131948351 as select s_suppkey as v1, s_nationkey as v4 from supplier AS supplier where (s_suppkey) in (select v1 from semiUp7258971941076719570);
create or replace TEMP view semiUp3334384768375834700 as select v4, v43 from n1Aux33 where (v4) in (select v4 from semiUp778359154131948351);
create or replace TEMP view semiDown8925946720803192315 as select n_nationkey as v4, n_name as v43 from nation AS n1 where (n_name, n_nationkey) in (select v43, v4 from semiUp3334384768375834700) and (n_name = 'FRANCE');
create or replace TEMP view semiDown7740473748963012111 as select v1, v4 from semiUp778359154131948351 where (v4) in (select v4 from semiUp3334384768375834700);
create or replace TEMP view semiDown8071000965530053920 as select v25, v9, v1 from semiUp7258971941076719570 where (v1) in (select v1 from semiDown7740473748963012111);
create or replace TEMP view semiDown8298189431713090851 as select v25, v34 from semiUp8126468992191502041 where (v25) in (select v25 from semiDown8071000965530053920);
create or replace TEMP view semiDown2075771250873123671 as select l_orderkey as v25, l_year as v9, l_suppkey as v1, l_extendedprice as v14, l_discount as v15 from lineitemwithyear AS lineitemwithyear where (l_suppkey, l_orderkey, l_year) in (select v1, v25, v9 from semiDown8071000965530053920) and (l_shipdate >= DATE '1994-12-31') and (l_shipdate <= DATE '1996-12-30');
create or replace TEMP view semiDown549080914493045069 as select v34, v37 from semiUp2547842388509726347 where (v34) in (select v34 from semiDown8298189431713090851);
create or replace TEMP view semiDown7603934767887702388 as select v37, v47 from n2Aux78 where (v37) in (select v37 from semiDown549080914493045069);
create or replace TEMP view semiDown4670939446712518584 as select n_nationkey as v37, n_name as v47 from nation AS n2 where (n_nationkey, n_name) in (select v37, v47 from semiDown7603934767887702388) and (n_name = 'GERMANY');
create or replace TEMP view aggView1627309038909397489 as select v37, v47 from semiDown4670939446712518584;
create or replace TEMP view aggView4253641880281200561 as select v1, v25, v9, SUM(v14 * (1 - v15)) as v51, COUNT(*) as annot from semiDown2075771250873123671 group by v1,v25,v9;
create or replace TEMP view aggView2433755707477328204 as select v43, v4 from semiDown8925946720803192315;
create or replace TEMP view aggView7457297817540802640 as select v37, v47, COUNT(*) as annot from aggView1627309038909397489 group by v37,v47;
create or replace TEMP view aggJoin4525070894941727505 as select v34, v47, annot from semiDown549080914493045069 join aggView7457297817540802640 using(v37);
create or replace TEMP view aggView4012733428508995883 as select v34, v47, SUM(annot) as annot from aggJoin4525070894941727505 group by v34,v47;
create or replace TEMP view aggJoin9007582376300438728 as select v25, v47, annot from semiDown8298189431713090851 join aggView4012733428508995883 using(v34);
create or replace TEMP view aggView1063142408771256572 as select v25, v47, SUM(annot) as annot from aggJoin9007582376300438728 group by v25,v47;
create or replace TEMP view aggJoin9136088651809661947 as select v1, v9, v51*aggView1063142408771256572.annot as v51, aggView4253641880281200561.annot * aggView1063142408771256572.annot as annot, v47 from aggView4253641880281200561 join aggView1063142408771256572 using(v25);
create or replace TEMP view aggView1741939389139157513 as select v1, SUM(v51) as v51, v9, v47, SUM(annot) as annot from aggJoin9136088651809661947 group by v1,v51,v9,v47;
create or replace TEMP view aggJoin8564181948375161476 as select v4, v51, v9, v47, annot from semiDown7740473748963012111 join aggView1741939389139157513 using(v1);
create or replace TEMP view aggView3855173956951941862 as select v4, SUM(v51) as v51, v9, v47, SUM(annot) as annot from aggJoin8564181948375161476 group by v4,v51,v9,v47;
create or replace TEMP view aggJoin7720569604132488814 as select v43, v51, v9, v47 from aggView2433755707477328204 join aggView3855173956951941862 using(v4);
create or replace TEMP view res as select v43, v47, v9, SUM(v51) as v51 from aggJoin7720569604132488814 group by v43, v47, v9;
select sum(v43+v47+v9+v51) from res;
