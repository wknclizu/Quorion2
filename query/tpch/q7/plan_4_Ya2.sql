create or replace TEMP view lineitemwithyearAux80 as select l_orderkey as v25, l_year as v9, l_suppkey as v1 from lineitemwithyear where (l_shipdate >= DATE '1994-12-31') and (l_shipdate <= DATE '1996-12-30');
create or replace TEMP view n1Aux97 as select n_nationkey as v4, n_name as v43 from nation where (n_name = 'FRANCE');
create or replace TEMP view n2Aux33 as select n_nationkey as v37, n_name as v47 from nation;
create or replace TEMP view semiUp3676292933747081219 as select c_custkey as v34, c_nationkey as v37 from customer AS customer where (c_nationkey) in (select v37 from n2Aux33);
create or replace TEMP view semiUp8367364999786523550 as select o_orderkey as v25, o_custkey as v34 from orders AS orders where (o_custkey) in (select v34 from semiUp3676292933747081219);
create or replace TEMP view semiUp1343465264522932987 as select v25, v9, v1 from lineitemwithyearAux80 where (v25) in (select v25 from semiUp8367364999786523550);
create or replace TEMP view semiUp3228337138382757391 as select s_suppkey as v1, s_nationkey as v4 from supplier AS supplier where (s_suppkey) in (select v1 from semiUp1343465264522932987);
create or replace TEMP view semiUp2421504628605899224 as select v4, v43 from n1Aux97 where (v4) in (select v4 from semiUp3228337138382757391);
create or replace TEMP view semiDown6886176822403618502 as select n_nationkey as v4, n_name as v43 from nation AS n1 where (n_nationkey, n_name) in (select v4, v43 from semiUp2421504628605899224) and (n_name = 'FRANCE');
create or replace TEMP view semiDown3521906633078053289 as select v1, v4 from semiUp3228337138382757391 where (v4) in (select v4 from semiUp2421504628605899224);
create or replace TEMP view semiDown3259530406091385139 as select v25, v9, v1 from semiUp1343465264522932987 where (v1) in (select v1 from semiDown3521906633078053289);
create or replace TEMP view semiDown8120621865760793843 as select v25, v34 from semiUp8367364999786523550 where (v25) in (select v25 from semiDown3259530406091385139);
create or replace TEMP view semiDown4929763938813832112 as select l_orderkey as v25, l_year as v9, l_suppkey as v1, l_extendedprice as v14, l_discount as v15 from lineitemwithyear AS lineitemwithyear where (l_orderkey, l_suppkey, l_year) in (select v25, v1, v9 from semiDown3259530406091385139) and (l_shipdate >= DATE '1994-12-31') and (l_shipdate <= DATE '1996-12-30');
create or replace TEMP view semiDown878719168778325374 as select v34, v37 from semiUp3676292933747081219 where (v34) in (select v34 from semiDown8120621865760793843);
create or replace TEMP view semiDown649668328763024189 as select v37, v47 from n2Aux33 where (v37) in (select v37 from semiDown878719168778325374);
create or replace TEMP view semiDown1444705687039328263 as select n_nationkey as v37, n_name as v47 from nation AS n2 where (n_name, n_nationkey) in (select v47, v37 from semiDown649668328763024189);
create or replace TEMP view aggView6756227772108257694 as select v47, v37 from semiDown1444705687039328263;
create or replace TEMP view aggView8650887144585718630 as select v25, v1, v9, SUM(v14 * (1 - v15)) as v51, COUNT(*) as annot from semiDown4929763938813832112 group by v25,v1,v9;
create or replace TEMP view aggView2514845271340051158 as select v4, v43 from semiDown6886176822403618502;
create or replace TEMP view aggView7372435820967104386 as select v37, v47, COUNT(*) as annot from aggView6756227772108257694 group by v37,v47;
create or replace TEMP view aggJoin9200942061185645631 as select v34, v47, annot from semiDown878719168778325374 join aggView7372435820967104386 using(v37);
create or replace TEMP view aggView622779447897405644 as select v34, v47, SUM(annot) as annot from aggJoin9200942061185645631 group by v34,v47;
create or replace TEMP view aggJoin3936789288818444221 as select v25, v47, annot from semiDown8120621865760793843 join aggView622779447897405644 using(v34);
create or replace TEMP view aggView3718789971444186333 as select v25, v47, SUM(annot) as annot from aggJoin3936789288818444221 group by v25,v47;
create or replace TEMP view aggJoin7168151623011108157 as select v1, v9, v51*aggView3718789971444186333.annot as v51, aggView8650887144585718630.annot * aggView3718789971444186333.annot as annot, v47 from aggView8650887144585718630 join aggView3718789971444186333 using(v25);
create or replace TEMP view aggView4092248588225580534 as select v1, SUM(v51) as v51, v9, v47, SUM(annot) as annot from aggJoin7168151623011108157 group by v1,v9,v51,v47;
create or replace TEMP view aggJoin4475260054819633633 as select v4, v51, v9, v47, annot from semiDown3521906633078053289 join aggView4092248588225580534 using(v1);
create or replace TEMP view aggView1359347166791614318 as select v4, SUM(v51) as v51, v9, v47, SUM(annot) as annot from aggJoin4475260054819633633 group by v4,v9,v51,v47;
create or replace TEMP view aggJoin8513777540393081826 as select v43, v51, v9, v47 from aggView2514845271340051158 join aggView1359347166791614318 using(v4);
create or replace TEMP view res as select v43, v47, v9, SUM(v51) as v51 from aggJoin8513777540393081826 group by v43, v47, v9;
select sum(v43+v47+v9+v51) from res;
