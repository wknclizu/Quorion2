create or replace TEMP view n1Aux31 as select n_nationkey as v4, n_name as v43 from nation where (n_name = 'FRANCE');
create or replace TEMP view n2Aux78 as select n_nationkey as v37, n_name as v47 from nation where (n_name = 'GERMANY');
create or replace TEMP view lineitemwithyearAux52 as select l_orderkey as v25, l_year as v9, l_suppkey as v1 from lineitemwithyear where (l_shipdate >= DATE '1994-12-31') and (l_shipdate <= DATE '1996-12-30');
create or replace TEMP view semiUp7087539297081915682 as select s_suppkey as v1, s_nationkey as v4 from supplier AS supplier where (s_nationkey) in (select v4 from n1Aux31);
create or replace TEMP view semiUp8073385315812983940 as select v25, v9, v1 from lineitemwithyearAux52 where (v1) in (select v1 from semiUp7087539297081915682);
create or replace TEMP view semiUp3567548987397180505 as select o_orderkey as v25, o_custkey as v34 from orders AS orders where (o_orderkey) in (select v25 from semiUp8073385315812983940);
create or replace TEMP view semiUp5320671239697190011 as select c_custkey as v34, c_nationkey as v37 from customer AS customer where (c_custkey) in (select v34 from semiUp3567548987397180505);
create or replace TEMP view semiUp4506350264846938198 as select v37, v47 from n2Aux78 where (v37) in (select v37 from semiUp5320671239697190011);
create or replace TEMP view semiDown2675417717049695391 as select n_nationkey as v37, n_name as v47 from nation AS n2 where (n_nationkey, n_name) in (select v37, v47 from semiUp4506350264846938198) and (n_name = 'GERMANY');
create or replace TEMP view semiDown3939319129385454595 as select v34, v37 from semiUp5320671239697190011 where (v37) in (select v37 from semiUp4506350264846938198);
create or replace TEMP view semiDown9071056540632867684 as select v25, v34 from semiUp3567548987397180505 where (v34) in (select v34 from semiDown3939319129385454595);
create or replace TEMP view semiDown597671525147513096 as select v25, v9, v1 from semiUp8073385315812983940 where (v25) in (select v25 from semiDown9071056540632867684);
create or replace TEMP view semiDown8152210153268903672 as select v1, v4 from semiUp7087539297081915682 where (v1) in (select v1 from semiDown597671525147513096);
create or replace TEMP view semiDown969927466876193356 as select l_orderkey as v25, l_year as v9, l_suppkey as v1, l_extendedprice as v14, l_discount as v15 from lineitemwithyear AS lineitemwithyear where (l_suppkey, l_orderkey, l_year) in (select v1, v25, v9 from semiDown597671525147513096) and (l_shipdate >= DATE '1994-12-31') and (l_shipdate <= DATE '1996-12-30');
create or replace TEMP view semiDown5104366169074466548 as select v4, v43 from n1Aux31 where (v4) in (select v4 from semiDown8152210153268903672);
create or replace TEMP view semiDown630815887012769942 as select n_nationkey as v4, n_name as v43 from nation AS n1 where (n_name, n_nationkey) in (select v43, v4 from semiDown5104366169074466548) and (n_name = 'FRANCE');
create or replace TEMP view aggView5277663034932343668 as select v43, v4 from semiDown630815887012769942;
create or replace TEMP view aggView4625156568327215420 as select v1, v25, v9, SUM(v14 * (1 - v15)) as v51, COUNT(*) as annot from semiDown969927466876193356 group by v1,v25,v9;
create or replace TEMP view aggView5245493950485910 as select v37, v47 from semiDown2675417717049695391;
create or replace TEMP view aggView3342691186516493862 as select v4, v43, COUNT(*) as annot from aggView5277663034932343668 group by v4,v43;
create or replace TEMP view aggJoin6498971603174133238 as select v1, v43, annot from semiDown8152210153268903672 join aggView3342691186516493862 using(v4);
create or replace TEMP view aggView8968242452387500151 as select v1, v43, SUM(annot) as annot from aggJoin6498971603174133238 group by v1,v43;
create or replace TEMP view aggJoin2928853763653012472 as select v25, v9, v51*aggView8968242452387500151.annot as v51, aggView4625156568327215420.annot * aggView8968242452387500151.annot as annot, v43 from aggView4625156568327215420 join aggView8968242452387500151 using(v1);
create or replace TEMP view aggView545720596693182360 as select v25, SUM(v51) as v51, v43, v9, SUM(annot) as annot from aggJoin2928853763653012472 group by v25,v51,v43,v9;
create or replace TEMP view aggJoin8351688996529010929 as select v34, v51, v43, v9, annot from semiDown9071056540632867684 join aggView545720596693182360 using(v25);
create or replace TEMP view aggView2291001382204887825 as select v34, SUM(v51) as v51, v43, v9, SUM(annot) as annot from aggJoin8351688996529010929 group by v34,v51,v43,v9;
create or replace TEMP view aggJoin1606626642159380218 as select v37, v51, v43, v9, annot from semiDown3939319129385454595 join aggView2291001382204887825 using(v34);
create or replace TEMP view aggView2283562721772500503 as select v37, SUM(v51) as v51, v43, v9, SUM(annot) as annot from aggJoin1606626642159380218 group by v37,v51,v43,v9;
create or replace TEMP view aggJoin7457437823996350583 as select v47, v51, v43, v9 from aggView5245493950485910 join aggView2283562721772500503 using(v37);
create or replace TEMP view res as select v43, v47, v9, SUM(v51) as v51 from aggJoin7457437823996350583 group by v43, v47, v9;
select sum(v43+v47+v9+v51) from res;
