create or replace TEMP view semiUp7058062208349715855 as select s_suppkey as v1, s_nationkey as v4 from supplier AS supplier where (s_nationkey) in (select n_nationkey from nation AS n1 where (n_name = 'FRANCE'));
create or replace TEMP view semiUp1709417848463968552 as select l_orderkey as v25, l_year as v9, l_suppkey as v1, l_extendedprice as v14, l_discount as v15 from lineitemwithyear AS lineitemwithyear where (l_suppkey) in (select v1 from semiUp7058062208349715855) and (l_shipdate >= DATE '1994-12-31') and (l_shipdate <= DATE '1996-12-30');
create or replace TEMP view semiUp8641933532894187745 as select c_custkey as v34, c_nationkey as v37 from customer AS customer where (c_nationkey) in (select n_nationkey from nation AS n2 where (n_name = 'GERMANY'));
create or replace TEMP view semiUp249928247626159382 as select o_orderkey as v25, o_custkey as v34 from orders AS orders where (o_orderkey) in (select v25 from semiUp1709417848463968552);
create or replace TEMP view semiUp1555838821673247077 as select v25, v34 from semiUp249928247626159382 where (v34) in (select v34 from semiUp8641933532894187745);
create or replace TEMP view semiDown3018624869657292014 as select v34, v37 from semiUp8641933532894187745 where (v34) in (select v34 from semiUp1555838821673247077);
create or replace TEMP view semiDown4708213383814628263 as select v25, v9, v1, v14, v15 from semiUp1709417848463968552 where (v25) in (select v25 from semiUp1555838821673247077);
create or replace TEMP view semiDown3254871843101198412 as select n_nationkey as v37, n_name as v47 from nation AS n2 where (n_nationkey) in (select v37 from semiDown3018624869657292014) and (n_name = 'GERMANY');
create or replace TEMP view semiDown5418764740010303028 as select v1, v4 from semiUp7058062208349715855 where (v1) in (select v1 from semiDown4708213383814628263);
create or replace TEMP view semiDown6797535441247829559 as select n_nationkey as v4, n_name as v43 from nation AS n1 where (n_nationkey) in (select v4 from semiDown5418764740010303028) and (n_name = 'FRANCE');
create or replace TEMP view aggView8702399626130898630 as select v4, v43 from semiDown6797535441247829559;
create or replace TEMP view aggJoin5396494503870208761 as select v1, v43 from semiDown5418764740010303028 join aggView8702399626130898630 using(v4);
create or replace TEMP view aggView7185101088762345217 as select v37, v47 from semiDown3254871843101198412;
create or replace TEMP view aggJoin1624397850519421284 as select v34, v47 from semiDown3018624869657292014 join aggView7185101088762345217 using(v37);
create or replace TEMP view aggView4889383847705187101 as select v1, v43, COUNT(*) as annot from aggJoin5396494503870208761 group by v1,v43;
create or replace TEMP view aggJoin6736143366550053000 as select v25, v9, v14, v15, v43, annot from semiDown4708213383814628263 join aggView4889383847705187101 using(v1);
create or replace TEMP view aggView1407678710624999101 as select v25, SUM((v14 * (1 - v15)) * annot) as v51, v43, v9, SUM(annot) as annot from aggJoin6736143366550053000 group by v25,v43,v9;
create or replace TEMP view aggJoin5576448496118365853 as select v34, v51, v43, v9, annot from semiUp1555838821673247077 join aggView1407678710624999101 using(v25);
create or replace TEMP view aggView1016580373790086085 as select v34, v47, COUNT(*) as annot from aggJoin1624397850519421284 group by v34,v47;
create or replace TEMP view aggJoin5444701033261233091 as select v51*aggView1016580373790086085.annot as v51, v43, v9, v47 from aggJoin5576448496118365853 join aggView1016580373790086085 using(v34);
create or replace TEMP view res as select v43, v47, v9, SUM(v51) as v51 from aggJoin5444701033261233091 group by v43, v47, v9;
select sum(v43+v47+v9+v51) from res;
