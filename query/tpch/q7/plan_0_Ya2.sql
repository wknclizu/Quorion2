create or replace TEMP view n1Aux51 as select n_nationkey as v4, n_name as v43 from nation where (n_name = 'FRANCE');
create or replace TEMP view n2Aux99 as select n_nationkey as v37, n_name as v47 from nation;
create or replace TEMP view lineitemwithyearAux48 as select l_orderkey as v25, l_year as v9, l_suppkey as v1 from lineitemwithyear where (l_shipdate >= DATE '1994-12-31') and (l_shipdate <= DATE '1996-12-30');
create or replace TEMP view semiUp5926659233243494957 as select c_custkey as v34, c_nationkey as v37 from customer AS customer where (c_nationkey) in (select v37 from n2Aux99);
create or replace TEMP view semiUp3961681241894064504 as select s_suppkey as v1, s_nationkey as v4 from supplier AS supplier where (s_nationkey) in (select v4 from n1Aux51);
create or replace TEMP view semiUp8339986960630153869 as select v25, v9, v1 from lineitemwithyearAux48 where (v1) in (select v1 from semiUp3961681241894064504);
create or replace TEMP view semiUp3553398493723777581 as select o_orderkey as v25, o_custkey as v34 from orders AS orders where (o_custkey) in (select v34 from semiUp5926659233243494957);
create or replace TEMP view semiUp5114070211153071565 as select v25, v9, v1 from semiUp8339986960630153869 where (v25) in (select v25 from semiUp3553398493723777581);
create or replace TEMP view semiDown5380206584260173068 as select v1, v4 from semiUp3961681241894064504 where (v1) in (select v1 from semiUp5114070211153071565);
create or replace TEMP view semiDown4758165384803577709 as select v25, v34 from semiUp3553398493723777581 where (v25) in (select v25 from semiUp5114070211153071565);
create or replace TEMP view semiDown7836426176527973184 as select l_orderkey as v25, l_year as v9, l_suppkey as v1, l_extendedprice as v14, l_discount as v15 from lineitemwithyear AS lineitemwithyear where (l_orderkey, l_year, l_suppkey) in (select v25, v9, v1 from semiUp5114070211153071565) and (l_shipdate >= DATE '1994-12-31') and (l_shipdate <= DATE '1996-12-30');
create or replace TEMP view semiDown4103040988516748575 as select v4, v43 from n1Aux51 where (v4) in (select v4 from semiDown5380206584260173068);
create or replace TEMP view semiDown6107393738332470087 as select v34, v37 from semiUp5926659233243494957 where (v34) in (select v34 from semiDown4758165384803577709);
create or replace TEMP view semiDown413748774669312305 as select n_nationkey as v4, n_name as v43 from nation AS n1 where (n_nationkey, n_name) in (select v4, v43 from semiDown4103040988516748575) and (n_name = 'FRANCE');
create or replace TEMP view semiDown1845495148742874591 as select v37, v47 from n2Aux99 where (v37) in (select v37 from semiDown6107393738332470087);
create or replace TEMP view semiDown787307664428491821 as select n_nationkey as v37, n_name as v47 from nation AS n2 where (n_name, n_nationkey) in (select v47, v37 from semiDown1845495148742874591);
create or replace TEMP view aggView8563984984992668168 as select v47, v37 from semiDown787307664428491821;
create or replace TEMP view aggView5327152993120413520 as select v4, v43 from semiDown413748774669312305;
create or replace TEMP view aggView3813691217239180005 as select v25, v9, v1, SUM(v14 * (1 - v15)) as v51, COUNT(*) as annot from semiDown7836426176527973184 group by v25,v9,v1;
create or replace TEMP view aggView8006139527111892054 as select v37, v47, COUNT(*) as annot from aggView8563984984992668168 group by v37,v47;
create or replace TEMP view aggJoin301275030178784138 as select v34, v47, annot from semiDown6107393738332470087 join aggView8006139527111892054 using(v37);
create or replace TEMP view aggView6765671451112248328 as select v4, v43, COUNT(*) as annot from aggView5327152993120413520 group by v4,v43;
create or replace TEMP view aggJoin4169791863493319554 as select v1, v43, annot from semiDown5380206584260173068 join aggView6765671451112248328 using(v4);
create or replace TEMP view aggView5594947331721489094 as select v34, v47, SUM(annot) as annot from aggJoin301275030178784138 group by v34,v47;
create or replace TEMP view aggJoin216373139669207937 as select v25, v47, annot from semiDown4758165384803577709 join aggView5594947331721489094 using(v34);
create or replace TEMP view aggView6044046155228833072 as select v25, v47, SUM(annot) as annot from aggJoin216373139669207937 group by v25,v47;
create or replace TEMP view aggJoin4224428028534442578 as select v9, v1, v51*aggView6044046155228833072.annot as v51, aggView3813691217239180005.annot * aggView6044046155228833072.annot as annot, v47 from aggView3813691217239180005 join aggView6044046155228833072 using(v25);
create or replace TEMP view aggView5723775409175170478 as select v1, v43, SUM(annot) as annot from aggJoin4169791863493319554 group by v1,v43;
create or replace TEMP view aggJoin6282610358247450274 as select v9, v51*aggView5723775409175170478.annot as v51, v47, v43 from aggJoin4224428028534442578 join aggView5723775409175170478 using(v1);
create or replace TEMP view res as select v43, v47, v9, SUM(v51) as v51 from aggJoin6282610358247450274 group by v43, v47, v9;
select sum(v43+v47+v9+v51) from res;
