create or replace TEMP view semiUp9218646395878337537 as select c_custkey as v34, c_nationkey as v37 from customer AS customer where (c_nationkey) in (select n_nationkey from nation AS n2 where (n_name = 'GERMANY'));
create or replace TEMP view semiUp4655705066643662819 as select s_suppkey as v1, s_nationkey as v4 from supplier AS supplier where (s_nationkey) in (select n_nationkey from nation AS n1 where (n_name = 'FRANCE'));
create or replace TEMP view semiUp7458182430729582169 as select o_orderkey as v25, o_custkey as v34 from orders AS orders where (o_custkey) in (select v34 from semiUp9218646395878337537);
create or replace TEMP view semiUp3276769321095921679 as select l_orderkey as v25, l_year as v9, l_suppkey as v1, l_extendedprice as v14, l_discount as v15 from lineitemwithyear AS lineitemwithyear where (l_orderkey) in (select v25 from semiUp7458182430729582169) and (l_shipdate >= DATE '1994-12-31') and (l_shipdate <= DATE '1996-12-30');
create or replace TEMP view semiUp2025361735245158931 as select v1, v4 from semiUp4655705066643662819 where (v1) in (select v1 from semiUp3276769321095921679);
create or replace TEMP view semiDown7204926047487590343 as select n_nationkey as v4, n_name as v43 from nation AS n1 where (n_nationkey) in (select v4 from semiUp2025361735245158931) and (n_name = 'FRANCE');
create or replace TEMP view semiDown6780124652657464012 as select v25, v9, v1, v14, v15 from semiUp3276769321095921679 where (v1) in (select v1 from semiUp2025361735245158931);
create or replace TEMP view semiDown8432609475376396514 as select v25, v34 from semiUp7458182430729582169 where (v25) in (select v25 from semiDown6780124652657464012);
create or replace TEMP view semiDown7050037430067833006 as select v34, v37 from semiUp9218646395878337537 where (v34) in (select v34 from semiDown8432609475376396514);
create or replace TEMP view semiDown332548987266498429 as select n_nationkey as v37, n_name as v47 from nation AS n2 where (n_nationkey) in (select v37 from semiDown7050037430067833006) and (n_name = 'GERMANY');
create or replace TEMP view aggView8439083723110509743 as select v37, v47 from semiDown332548987266498429;
create or replace TEMP view aggJoin2761393799974142152 as select v34, v47 from semiDown7050037430067833006 join aggView8439083723110509743 using(v37);
create or replace TEMP view aggView5915489021258901175 as select v34, v47, COUNT(*) as annot from aggJoin2761393799974142152 group by v34,v47;
create or replace TEMP view aggJoin3869289295489946779 as select v25, v47, annot from semiDown8432609475376396514 join aggView5915489021258901175 using(v34);
create or replace TEMP view aggView8676536669463671460 as select v25, v47, SUM(annot) as annot from aggJoin3869289295489946779 group by v25,v47;
create or replace TEMP view aggJoin3641929291484378993 as select v9, v1, v14, v15, v47, annot from semiDown6780124652657464012 join aggView8676536669463671460 using(v25);
create or replace TEMP view aggView1716045469438121757 as select v4, v43 from semiDown7204926047487590343;
create or replace TEMP view aggJoin704755756820843675 as select v1, v43 from semiUp2025361735245158931 join aggView1716045469438121757 using(v4);
create or replace TEMP view aggView364120384167432691 as select v1, SUM((v14 * (1 - v15)) * annot) as v51, v9, v47, SUM(annot) as annot from aggJoin3641929291484378993 group by v1,v9,v47;
create or replace TEMP view aggJoin401901184737651155 as select v43, v51, v9, v47 from aggJoin704755756820843675 join aggView364120384167432691 using(v1);
create or replace TEMP view res as select v43, v47, v9, SUM(v51) as v51 from aggJoin401901184737651155 group by v43, v47, v9;
select sum(v43+v47+v9+v51) from res;
