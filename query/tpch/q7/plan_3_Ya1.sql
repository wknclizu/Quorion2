create or replace TEMP view n1Aux73 as select n_nationkey as v4, n_name as v43 from nation;
create or replace TEMP view n2Aux83 as select n_nationkey as v37, n_name as v47 from nation;
create or replace TEMP view lineitemwithyearAux39 as select l_orderkey as v25, l_year as v9, l_suppkey as v1 from lineitemwithyear where (l_shipdate >= DATE '1994-12-31') and (l_shipdate <= DATE '1996-12-30');
create or replace TEMP view semiUp5500662335567165170 as select s_suppkey as v1, s_nationkey as v4 from supplier AS supplier where (s_nationkey) in (select v4 from n1Aux73);
create or replace TEMP view semiUp8229741013730575562 as select v25, v9, v1 from lineitemwithyearAux39 where (v1) in (select v1 from semiUp5500662335567165170);
create or replace TEMP view semiUp9206280813355571060 as select o_orderkey as v25, o_custkey as v34 from orders AS orders where (o_orderkey) in (select v25 from semiUp8229741013730575562);
create or replace TEMP view semiUp8062069447519710220 as select c_custkey as v34, c_nationkey as v37 from customer AS customer where (c_custkey) in (select v34 from semiUp9206280813355571060);
create or replace TEMP view semiUp4051428993355483361 as select v37, v47 from n2Aux83 where (v37) in (select v37 from semiUp8062069447519710220);
create or replace TEMP view semiDown1379151851217049792 as select n_nationkey as v37, n_name as v47 from nation AS n2 where (n_nationkey, n_name) in (select v37, v47 from semiUp4051428993355483361);
create or replace TEMP view semiDown3682999232143448427 as select v34, v37 from semiUp8062069447519710220 where (v37) in (select v37 from semiUp4051428993355483361);
create or replace TEMP view semiDown8014545556623739894 as select v25, v34 from semiUp9206280813355571060 where (v34) in (select v34 from semiDown3682999232143448427);
create or replace TEMP view semiDown1443586045582607500 as select v25, v9, v1 from semiUp8229741013730575562 where (v25) in (select v25 from semiDown8014545556623739894);
create or replace TEMP view semiDown9188460577761376595 as select v1, v4 from semiUp5500662335567165170 where (v1) in (select v1 from semiDown1443586045582607500);
create or replace TEMP view semiDown8825713503774343631 as select l_orderkey as v25, l_year as v9, l_suppkey as v1, l_extendedprice as v14, l_discount as v15 from lineitemwithyear AS lineitemwithyear where (l_suppkey, l_orderkey, l_year) in (select v1, v25, v9 from semiDown1443586045582607500) and (l_shipdate >= DATE '1994-12-31') and (l_shipdate <= DATE '1996-12-30');
create or replace TEMP view semiDown6659065442807869193 as select v4, v43 from n1Aux73 where (v4) in (select v4 from semiDown9188460577761376595);
create or replace TEMP view semiDown7585615463389012287 as select n_nationkey as v4, n_name as v43 from nation AS n1 where (n_name, n_nationkey) in (select v43, v4 from semiDown6659065442807869193);
create or replace TEMP view aggView3345215757883552961 as select v43, v4 from semiDown7585615463389012287;
create or replace TEMP view aggView6789715827194009540 as select v1, v25, v9, SUM(v14 * (1 - v15)) as v51, COUNT(*) as annot from semiDown8825713503774343631 group by v1,v25,v9;
create or replace TEMP view aggView2443759096048679488 as select v37, v47 from semiDown1379151851217049792;
create or replace TEMP view aggView1932002875661519302 as select v4, v43, COUNT(*) as annot from aggView3345215757883552961 group by v4,v43;
create or replace TEMP view aggJoin1630890249534049550 as select v1, v43, annot from semiDown9188460577761376595 join aggView1932002875661519302 using(v4);
create or replace TEMP view aggView7096583599644741227 as select v1, v43, SUM(annot) as annot from aggJoin1630890249534049550 group by v1,v43;
create or replace TEMP view aggJoin1745789180920815285 as select v25, v9, v51*aggView7096583599644741227.annot as v51, aggView6789715827194009540.annot * aggView7096583599644741227.annot as annot, v43 from aggView6789715827194009540 join aggView7096583599644741227 using(v1);
create or replace TEMP view aggView1227813627019031945 as select v25, SUM(v51) as v51, v43, v9, SUM(annot) as annot from aggJoin1745789180920815285 group by v25,v43,v51,v9;
create or replace TEMP view aggJoin3117865854515421315 as select v34, v51, v43, v9, annot from semiDown8014545556623739894 join aggView1227813627019031945 using(v25);
create or replace TEMP view aggView3249334766031616924 as select v34, SUM(v51) as v51, v43, v9, SUM(annot) as annot from aggJoin3117865854515421315 group by v34,v43,v51,v9;
create or replace TEMP view aggJoin6823152568606587950 as select v37, v51, v43, v9, annot from semiDown3682999232143448427 join aggView3249334766031616924 using(v34);
create or replace TEMP view aggView4391335607334934230 as select v37, SUM(v51) as v51, v43, v9, SUM(annot) as annot from aggJoin6823152568606587950 group by v37,v43,v51,v9;
create or replace TEMP view aggJoin8552580959722254724 as select v47, v51, v43, v9 from aggView2443759096048679488 join aggView4391335607334934230 using(v37);
create or replace TEMP view res as select v43, v47, v9, SUM(v51) as v51 from aggJoin8552580959722254724 group by v43, v47, v9;
select sum(v43+v47+v9+v51) from res;
