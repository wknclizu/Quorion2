create or replace TEMP view semiUp581622494678726029 as select movie_id as v23, keyword_id as v8 from movie_keyword AS mk where (movie_id) in (select id from title AS t where (production_year > 2000));
create or replace TEMP view semiUp6660409424027066223 as select v23, v8 from semiUp581622494678726029 where (v8) in (select id from keyword AS k where (keyword = 'marvel-cinematic-universe'));
create or replace TEMP view semiUp8688202024408495535 as select person_id as v14, movie_id as v23 from cast_info AS ci where (movie_id) in (select v23 from semiUp6660409424027066223);
create or replace TEMP view semiUp8575899867147490209 as select id as v14, name as v15 from name AS n where (id) in (select v14 from semiUp8688202024408495535) and (name LIKE '%Downey%Robert%');
create or replace TEMP view semiDown4198241342953488357 as select v14, v23 from semiUp8688202024408495535 where (v14) in (select v14 from semiUp8575899867147490209);
create or replace TEMP view semiDown7908817507928930372 as select v23, v8 from semiUp6660409424027066223 where (v23) in (select v23 from semiDown4198241342953488357);
create or replace TEMP view semiDown8732701279198357056 as select id as v8, keyword as v9 from keyword AS k where (id) in (select v8 from semiDown7908817507928930372) and (keyword = 'marvel-cinematic-universe');
create or replace TEMP view semiDown7617498790119498035 as select id as v23, title as v24 from title AS t where (id) in (select v23 from semiDown7908817507928930372) and (production_year > 2000);
create or replace TEMP view aggView6658275141991903957 as select v23, v24 as v37 from semiDown7617498790119498035;
create or replace TEMP view aggJoin8827817318774431435 as select v23, v8, v37 from semiDown7908817507928930372 join aggView6658275141991903957 using(v23);
create or replace TEMP view aggView8507434628867077809 as select v8, v9 as v35 from semiDown8732701279198357056;
create or replace TEMP view aggJoin2939809418703564403 as select v23, v37, v35 from aggJoin8827817318774431435 join aggView8507434628867077809 using(v8);
create or replace TEMP view aggView8440751468909310581 as select v23, MIN(v37) as v37, MIN(v35) as v35 from aggJoin2939809418703564403 group by v23,v35,v37;
create or replace TEMP view aggJoin8658673784743757282 as select v14, v37, v35 from semiDown4198241342953488357 join aggView8440751468909310581 using(v23);
create or replace TEMP view aggView2349747461547384761 as select v14, MIN(v37) as v37, MIN(v35) as v35 from aggJoin8658673784743757282 group by v14,v35,v37;
create or replace TEMP view aggJoin8696377527585317077 as select v15, v37, v35 from semiUp8575899867147490209 join aggView2349747461547384761 using(v14);
create or replace TEMP view res as select MIN(v35) as v35, MIN(v15) as v36, MIN(v37) as v37 from aggJoin8696377527585317077;
select sum(v35+v36+v37) from res;
