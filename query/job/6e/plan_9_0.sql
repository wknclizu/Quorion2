create or replace TEMP view aggView1537635214037917103 as select id as v8, keyword as v35 from keyword as k where (keyword = 'marvel-cinematic-universe');
create or replace TEMP view aggJoin5785913434799514163 as select movie_id as v23, v35 from movie_keyword as mk, aggView1537635214037917103 where mk.keyword_id=aggView1537635214037917103.v8;
create or replace TEMP view aggView4815652622316666531 as select id as v14, name as v36 from name as n where (name LIKE '%Downey%Robert%');
create or replace TEMP view aggJoin5398772353206113704 as select movie_id as v23, v36 from cast_info as ci, aggView4815652622316666531 where ci.person_id=aggView4815652622316666531.v14;
create or replace TEMP view aggView8500213704766593856 as select v23, MIN(v35) as v35, COUNT(*) as annot from aggJoin5785913434799514163 group by v23;
create or replace TEMP view aggJoin649218272031878380 as select v23, v36 as v36, v35, annot from aggJoin5398772353206113704 join aggView8500213704766593856 using(v23);
create or replace TEMP view aggView1738776946984324318 as select v23, MIN(v36) as v36, MIN(v35) as v35, SUM(annot) as annot from aggJoin649218272031878380 group by v23;
create or replace TEMP view aggJoin8095445278679384286 as select title as v24, production_year as v27, v36, v35, annot from title as t, aggView1738776946984324318 where t.id=aggView1738776946984324318.v23 and (production_year > 2000);
create or replace TEMP view res as select MIN(v35) as v35, MIN(v36) as v36, MIN(v24) as v37 from aggJoin8095445278679384286;
select sum(v35+v36+v37) from res;