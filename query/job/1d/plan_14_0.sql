create or replace TEMP view aggView2144678119999623209 as select id as v3 from info_type as it where (info = 'bottom 10 rank');
create or replace TEMP view aggJoin6902916872812216733 as select movie_id as v15 from movie_info_idx as mi_idx, aggView2144678119999623209 where mi_idx.info_type_id=aggView2144678119999623209.v3;
create or replace TEMP view aggView5608915488395423063 as select id as v1 from company_type as ct where (kind = 'production companies');
create or replace TEMP view aggJoin5823052419274771340 as select movie_id as v15, note as v9 from movie_companies as mc, aggView5608915488395423063 where mc.company_type_id=aggView5608915488395423063.v1 and (note NOT LIKE '%(as Metro-Goldwyn-Mayer Pictures)%');
create or replace TEMP view aggView1536419165832676860 as select v15, COUNT(*) as annot from aggJoin6902916872812216733 group by v15;
create or replace TEMP view aggJoin4536291330530156262 as select id as v15, title as v16, production_year as v19, annot from title as t, aggView1536419165832676860 where t.id=aggView1536419165832676860.v15 and (production_year > 2000);
create or replace TEMP view aggView2185336967705086884 as select v15, MIN(v9) as v27, COUNT(*) as annot from aggJoin5823052419274771340 group by v15;
create or replace TEMP view aggJoin4673019416097741774 as select v16, v19, aggJoin4536291330530156262.annot * aggView2185336967705086884.annot as annot, v27 from aggJoin4536291330530156262 join aggView2185336967705086884 using(v15);
create or replace TEMP view res as select MIN(v27) as v27, MIN(v16) as v28, MIN(v19) as v29 from aggJoin4673019416097741774;
select sum(v27+v28+v29) from res;