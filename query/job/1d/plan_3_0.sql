create or replace TEMP view aggView7615101220631439431 as select id as v15, title as v28, production_year as v29 from title as t where (production_year > 2000);
create or replace TEMP view aggJoin6400625644328805254 as select movie_id as v15, company_type_id as v1, note as v9, v28, v29 from movie_companies as mc, aggView7615101220631439431 where mc.movie_id=aggView7615101220631439431.v15 and (note NOT LIKE '%(as Metro-Goldwyn-Mayer Pictures)%');
create or replace TEMP view aggView4045213055159025308 as select id as v1 from company_type as ct where (kind = 'production companies');
create or replace TEMP view aggJoin4593848832480082318 as select v15, v9, v28, v29 from aggJoin6400625644328805254 join aggView4045213055159025308 using(v1);
create or replace TEMP view aggView2072287502027086354 as select v15, MIN(v28) as v28, MIN(v29) as v29, MIN(v9) as v27, COUNT(*) as annot from aggJoin4593848832480082318 group by v15;
create or replace TEMP view aggJoin2029386186983985976 as select info_type_id as v3, v28, v29, v27, annot from movie_info_idx as mi_idx, aggView2072287502027086354 where mi_idx.movie_id=aggView2072287502027086354.v15;
create or replace TEMP view aggView8804324375615701042 as select id as v3 from info_type as it where (info = 'bottom 10 rank');
create or replace TEMP view aggJoin7868632641780741780 as select v28, v29, v27, annot from aggJoin2029386186983985976 join aggView8804324375615701042 using(v3);
create or replace TEMP view res as select MIN(v27) as v27, MIN(v28) as v28, MIN(v29) as v29 from aggJoin7868632641780741780;
select sum(v27+v28+v29) from res;