create or replace TEMP view aggView4519402060505106213 as select id as v1 from company_type as ct where (kind = 'production companies');
create or replace TEMP view aggJoin6774707866900381413 as select movie_id as v15, note as v9 from movie_companies as mc, aggView4519402060505106213 where mc.company_type_id=aggView4519402060505106213.v1 and (note NOT LIKE '%(as Metro-Goldwyn-Mayer Pictures)%') and ((note LIKE '%(co-production)%') OR (note LIKE '%(presents)%'));
create or replace TEMP view aggView3781132579357491950 as select v15, MIN(v9) as v27, COUNT(*) as annot from aggJoin6774707866900381413 group by v15;
create or replace TEMP view aggJoin7463833485659486540 as select movie_id as v15, info_type_id as v3, v27, annot from movie_info_idx as mi_idx, aggView3781132579357491950 where mi_idx.movie_id=aggView3781132579357491950.v15;
create or replace TEMP view aggView5398174190444080289 as select id as v3 from info_type as it where (info = 'top 250 rank');
create or replace TEMP view aggJoin3634263465958185347 as select v15, v27, annot from aggJoin7463833485659486540 join aggView5398174190444080289 using(v3);
create or replace TEMP view aggView8670919762439899378 as select v15, MIN(v27) as v27, SUM(annot) as annot from aggJoin3634263465958185347 group by v15;
create or replace TEMP view aggJoin7855575106016505280 as select title as v16, production_year as v19, v27, annot from title as t, aggView8670919762439899378 where t.id=aggView8670919762439899378.v15;
create or replace TEMP view res as select MIN(v27) as v27, MIN(v16) as v28, MIN(v19) as v29 from aggJoin7855575106016505280;
select sum(v27+v28+v29) from res;