create or replace TEMP view aggView3996447223781536067 as select id as v3 from keyword as k where (keyword LIKE '%sequel%');
create or replace TEMP view aggJoin8681631565829783659 as select movie_id as v14 from movie_keyword as mk, aggView3996447223781536067 where mk.keyword_id=aggView3996447223781536067.v3;
create or replace TEMP view aggView819069557066125462 as select id as v14, title as v27 from title as t where (production_year > 1990);
create or replace TEMP view aggJoin6446820980819726488 as select movie_id as v14, info_type_id as v1, info as v9, v27 from movie_info_idx as mi_idx, aggView819069557066125462 where mi_idx.movie_id=aggView819069557066125462.v14 and (info > '2.0');
create or replace TEMP view aggView3381897156058487738 as select v14, COUNT(*) as annot from aggJoin8681631565829783659 group by v14;
create or replace TEMP view aggJoin6902179308512065013 as select v1, v9, v27 as v27, annot from aggJoin6446820980819726488 join aggView3381897156058487738 using(v14);
create or replace TEMP view aggView5327729449891025443 as select v1, MIN(v27) as v27, MIN(v9) as v26, SUM(annot) as annot from aggJoin6902179308512065013 group by v1;
create or replace TEMP view aggJoin2460616445792212345 as select info as v2, v27, v26, annot from info_type as it, aggView5327729449891025443 where it.id=aggView5327729449891025443.v1 and (info = 'rating');
create or replace TEMP view res as select MIN(v26) as v26, MIN(v27) as v27 from aggJoin2460616445792212345;
select sum(v26+v27) from res;