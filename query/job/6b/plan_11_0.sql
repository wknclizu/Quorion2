create or replace TEMP view aggView1795054031562833589 as select id as v14, name as v36 from name as n where (name LIKE '%Downey%Robert%');
create or replace TEMP view aggJoin4000668948020724059 as select movie_id as v23, v36 from cast_info as ci, aggView1795054031562833589 where ci.person_id=aggView1795054031562833589.v14;
create or replace TEMP view aggView5057149458817694379 as select v23, MIN(v36) as v36, COUNT(*) as annot from aggJoin4000668948020724059 group by v23;
create or replace TEMP view aggJoin4246211694078989757 as select id as v23, title as v24, production_year as v27, v36, annot from title as t, aggView5057149458817694379 where t.id=aggView5057149458817694379.v23 and (production_year > 2014);
create or replace TEMP view aggView7821124266893871464 as select v23, MIN(v36) as v36, MIN(v24) as v37, SUM(annot) as annot from aggJoin4246211694078989757 group by v23;
create or replace TEMP view aggJoin7299046627411213551 as select keyword_id as v8, v36, v37, annot from movie_keyword as mk, aggView7821124266893871464 where mk.movie_id=aggView7821124266893871464.v23;
create or replace TEMP view aggView5861650359758545827 as select v8, MIN(v36) as v36, MIN(v37) as v37, SUM(annot) as annot from aggJoin7299046627411213551 group by v8;
create or replace TEMP view aggJoin4044688479176013785 as select keyword as v9, v36, v37, annot from keyword as k, aggView5861650359758545827 where k.id=aggView5861650359758545827.v8 and (keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence'));
create or replace TEMP view res as select MIN(v9) as v35, MIN(v36) as v36, MIN(v37) as v37 from aggJoin4044688479176013785;
select sum(v35+v36+v37) from res;