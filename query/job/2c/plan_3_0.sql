create or replace TEMP view aggView2666589386906740203 as select id as v12, title as v31 from title as t;
create or replace TEMP view aggJoin8852655073075314392 as select movie_id as v12, company_id as v1, v31 from movie_companies as mc, aggView2666589386906740203 where mc.movie_id=aggView2666589386906740203.v12;
create or replace TEMP view aggView8923628095122847623 as select id as v1 from company_name as cn where (country_code = '[sm]');
create or replace TEMP view aggJoin2036684754339419675 as select v12, v31 from aggJoin8852655073075314392 join aggView8923628095122847623 using(v1);
create or replace TEMP view aggView2025814789490255613 as select v12, MIN(v31) as v31, COUNT(*) as annot from aggJoin2036684754339419675 group by v12;
create or replace TEMP view aggJoin5925670116460187614 as select keyword_id as v18, v31, annot from movie_keyword as mk, aggView2025814789490255613 where mk.movie_id=aggView2025814789490255613.v12;
create or replace TEMP view aggView2046131601501210453 as select id as v18 from keyword as k where (keyword = 'character-name-in-title');
create or replace TEMP view aggJoin7274742473320637210 as select v31, annot from aggJoin5925670116460187614 join aggView2046131601501210453 using(v18);
create or replace TEMP view res as select MIN(v31) as v31 from aggJoin7274742473320637210;
select sum(v31) from res;