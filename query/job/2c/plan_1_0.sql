create or replace TEMP view aggView2608349248566973494 as select id as v12, title as v31 from title as t;
create or replace TEMP view aggJoin6688869918691266171 as select movie_id as v12, company_id as v1, v31 from movie_companies as mc, aggView2608349248566973494 where mc.movie_id=aggView2608349248566973494.v12;
create or replace TEMP view aggView6337486765871887516 as select id as v1 from company_name as cn where (country_code = '[sm]');
create or replace TEMP view aggJoin3225660291547242416 as select v12, v31 from aggJoin6688869918691266171 join aggView6337486765871887516 using(v1);
create or replace TEMP view aggView6782336370060925423 as select v12, MIN(v31) as v31, COUNT(*) as annot from aggJoin3225660291547242416 group by v12;
create or replace TEMP view aggJoin2726899836361860749 as select keyword_id as v18, v31, annot from movie_keyword as mk, aggView6782336370060925423 where mk.movie_id=aggView6782336370060925423.v12;
create or replace TEMP view aggView1437297037879248892 as select v18, MIN(v31) as v31, SUM(annot) as annot from aggJoin2726899836361860749 group by v18;
create or replace TEMP view aggJoin4815606806086945410 as select keyword as v9, v31, annot from keyword as k, aggView1437297037879248892 where k.id=aggView1437297037879248892.v18 and (keyword = 'character-name-in-title');
create or replace TEMP view res as select MIN(v31) as v31 from aggJoin4815606806086945410;
select sum(v31) from res;