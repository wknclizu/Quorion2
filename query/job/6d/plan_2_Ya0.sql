create or replace TEMP view semiUp4158419029927954434 as select movie_id as v23, keyword_id as v8 from movie_keyword AS mk where (movie_id) in (select id from title AS t where (production_year > 2000));
create or replace TEMP view semiUp2738596792670413702 as select person_id as v14, movie_id as v23 from cast_info AS ci where (person_id) in (select id from name AS n where (name LIKE '%Downey%Robert%'));
create or replace TEMP view semiUp5122321132127767977 as select v23, v8 from semiUp4158419029927954434 where (v8) in (select id from keyword AS k where (keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence')));
create or replace TEMP view semiUp9138314496848733617 as select v23, v8 from semiUp5122321132127767977 where (v23) in (select v23 from semiUp2738596792670413702);
create or replace TEMP view semiDown8282007023156165553 as select id as v8, keyword as v9 from keyword AS k where (id) in (select v8 from semiUp9138314496848733617) and (keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence'));
create or replace TEMP view semiDown1059812671802247244 as select id as v23, title as v24 from title AS t where (id) in (select v23 from semiUp9138314496848733617) and (production_year > 2000);
create or replace TEMP view semiDown7126610225417112452 as select v14, v23 from semiUp2738596792670413702 where (v23) in (select v23 from semiUp9138314496848733617);
create or replace TEMP view semiDown2189268981077745279 as select id as v14, name as v15 from name AS n where (id) in (select v14 from semiDown7126610225417112452) and (name LIKE '%Downey%Robert%');
create or replace TEMP view aggView5770057433174519855 as select v14, v15 as v36 from semiDown2189268981077745279;
create or replace TEMP view aggJoin3120418592676011669 as select v23, v36 from semiDown7126610225417112452 join aggView5770057433174519855 using(v14);
create or replace TEMP view aggView2686104564597053991 as select v23, v24 as v37 from semiDown1059812671802247244;
create or replace TEMP view aggJoin8837119881920403961 as select v23, v8, v37 from semiUp9138314496848733617 join aggView2686104564597053991 using(v23);
create or replace TEMP view aggView7999953279158790909 as select v8, v9 as v35 from semiDown8282007023156165553;
create or replace TEMP view aggJoin1987631304750386906 as select v23, v37, v35 from aggJoin8837119881920403961 join aggView7999953279158790909 using(v8);
create or replace TEMP view aggView4940683421649432222 as select v23, MIN(v36) as v36 from aggJoin3120418592676011669 group by v23,v36;
create or replace TEMP view aggJoin3200431028596473701 as select v37 as v37, v35 as v35, v36 from aggJoin1987631304750386906 join aggView4940683421649432222 using(v23);
create or replace TEMP view res as select MIN(v35) as v35, MIN(v36) as v36, MIN(v37) as v37 from aggJoin3200431028596473701;
select sum(v35+v36+v37) from res;
