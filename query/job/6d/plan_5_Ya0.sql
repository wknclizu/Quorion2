create or replace TEMP view semiUp7307044169844578374 as select person_id as v14, movie_id as v23 from cast_info AS ci where (person_id) in (select id from name AS n where (name LIKE '%Downey%Robert%'));
create or replace TEMP view semiUp2886958149989493747 as select v14, v23 from semiUp7307044169844578374 where (v23) in (select id from title AS t where (production_year > 2000));
create or replace TEMP view semiUp2579930070741799419 as select movie_id as v23, keyword_id as v8 from movie_keyword AS mk where (keyword_id) in (select id from keyword AS k where (keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence')));
create or replace TEMP view semiUp3637917710651139947 as select v14, v23 from semiUp2886958149989493747 where (v23) in (select v23 from semiUp2579930070741799419);
create or replace TEMP view semiDown7040880805240973622 as select id as v14, name as v15 from name AS n where (id) in (select v14 from semiUp3637917710651139947) and (name LIKE '%Downey%Robert%');
create or replace TEMP view semiDown5200743911714151649 as select id as v23, title as v24 from title AS t where (id) in (select v23 from semiUp3637917710651139947) and (production_year > 2000);
create or replace TEMP view semiDown8172821713591849782 as select v23, v8 from semiUp2579930070741799419 where (v23) in (select v23 from semiUp3637917710651139947);
create or replace TEMP view semiDown3497211457718420577 as select id as v8, keyword as v9 from keyword AS k where (id) in (select v8 from semiDown8172821713591849782) and (keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence'));
create or replace TEMP view aggView2485556995676725214 as select v8, v9 as v35 from semiDown3497211457718420577;
create or replace TEMP view aggJoin4263886415324308950 as select v23, v35 from semiDown8172821713591849782 join aggView2485556995676725214 using(v8);
create or replace TEMP view aggView8196244904763732442 as select v23, v24 as v37 from semiDown5200743911714151649;
create or replace TEMP view aggJoin5803599651546312461 as select v14, v23, v37 from semiUp3637917710651139947 join aggView8196244904763732442 using(v23);
create or replace TEMP view aggView5630517846451962811 as select v14, v15 as v36 from semiDown7040880805240973622;
create or replace TEMP view aggJoin3497661675701291338 as select v23, v37, v36 from aggJoin5803599651546312461 join aggView5630517846451962811 using(v14);
create or replace TEMP view aggView2585050455511764398 as select v23, MIN(v35) as v35 from aggJoin4263886415324308950 group by v23,v35;
create or replace TEMP view aggJoin7204422089405752244 as select v37 as v37, v36 as v36, v35 from aggJoin3497661675701291338 join aggView2585050455511764398 using(v23);
create or replace TEMP view res as select MIN(v35) as v35, MIN(v36) as v36, MIN(v37) as v37 from aggJoin7204422089405752244;
select sum(v35+v36+v37) from res;
