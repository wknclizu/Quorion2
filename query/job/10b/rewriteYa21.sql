create or replace TEMP view semiUp2806498899606576557 as select movie_id as v31, company_id as v15, company_type_id as v22 from movie_companies AS mc where (movie_id) in (select id from title AS t where (production_year > 2010));
create or replace TEMP view semiUp8308182310944136270 as select v31, v15, v22 from semiUp2806498899606576557 where (v15) in (select id from company_name AS cn where (country_code = '[ru]'));
create or replace TEMP view semiUp4061233194636321567 as select v31, v15, v22 from semiUp8308182310944136270 where (v22) in (select id from company_type AS ct);
create or replace TEMP view semiUp4155422141254619334 as select movie_id as v31, person_role_id as v1, role_id as v29 from cast_info AS ci where (person_role_id) in (select id from char_name AS chn) and (note LIKE '%(producer)%');
create or replace TEMP view semiUp1715972409401109925 as select v31, v1, v29 from semiUp4155422141254619334 where (v29) in (select id from role_type AS rt where (role = 'actor'));
create or replace TEMP view semiUp5629950464552832172 as select v31, v15, v22 from semiUp4061233194636321567 where (v31) in (select v31 from semiUp1715972409401109925);
create or replace TEMP view semiDown1166084996840372123 as select id as v22 from company_type AS ct where (id) in (select v22 from semiUp5629950464552832172);
create or replace TEMP view semiDown7336759896388685619 as select id as v15 from company_name AS cn where (id) in (select v15 from semiUp5629950464552832172) and (country_code = '[ru]');
create or replace TEMP view semiDown2230748194864742307 as select id as v31, title as v32 from title AS t where (id) in (select v31 from semiUp5629950464552832172) and (production_year > 2010);
create or replace TEMP view semiDown5256186496036085559 as select v31, v1, v29 from semiUp1715972409401109925 where (v31) in (select v31 from semiUp5629950464552832172);
create or replace TEMP view semiDown5862701706774502688 as select id as v29 from role_type AS rt where (id) in (select v29 from semiDown5256186496036085559) and (role = 'actor');
create or replace TEMP view semiDown2374708020121132740 as select id as v1, name as v2 from char_name AS chn where (id) in (select v1 from semiDown5256186496036085559);
create or replace TEMP view aggView4728817697594079909 as select v1, v2 as v43 from semiDown2374708020121132740;
create or replace TEMP view aggJoin3750748318943006707 as select v31, v29, v43 from semiDown5256186496036085559 join aggView4728817697594079909 using(v1);
create or replace TEMP view aggView7119191052275884831 as select v29 from semiDown5862701706774502688;
create or replace TEMP view aggJoin7490275783944323677 as select v31, v43 from aggJoin3750748318943006707 join aggView7119191052275884831 using(v29);
create or replace TEMP view aggView5975730171162976497 as select v31, MIN(v43) as v43 from aggJoin7490275783944323677 group by v31,v43;
create or replace TEMP view aggJoin2841579266479711249 as select v31, v15, v22, v43 from semiUp5629950464552832172 join aggView5975730171162976497 using(v31);
create or replace TEMP view aggView979594791345397340 as select v31, v32 as v44 from semiDown2230748194864742307;
create or replace TEMP view aggJoin6106959483509351293 as select v15, v22, v43, v44 from aggJoin2841579266479711249 join aggView979594791345397340 using(v31);
create or replace TEMP view aggView2475153090485608199 as select v22 from semiDown1166084996840372123;
create or replace TEMP view aggJoin4274528522425047687 as select v15, v43, v44 from aggJoin6106959483509351293 join aggView2475153090485608199 using(v22);
create or replace TEMP view aggView820619805673161273 as select v15 from semiDown7336759896388685619;
create or replace TEMP view aggJoin8022759367444759180 as select v43, v44 from aggJoin4274528522425047687 join aggView820619805673161273 using(v15);
create or replace TEMP view res as select MIN(v43) as v43, MIN(v44) as v44 from aggJoin8022759367444759180;
select sum(v43+v44) from res;
