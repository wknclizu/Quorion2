create or replace TEMP view aggView5424196039000588154 as select id as v31, title as v44 from title as t where (production_year > 2010);
create or replace TEMP view aggJoin4598426604202310596 as select movie_id as v31, company_id as v15, company_type_id as v22, v44 from movie_companies as mc, aggView5424196039000588154 where mc.movie_id=aggView5424196039000588154.v31;
create or replace TEMP view aggView6030799055369795613 as select id as v22 from company_type as ct;
create or replace TEMP view aggJoin6436113683225867319 as select v31, v15, v44 from aggJoin4598426604202310596 join aggView6030799055369795613 using(v22);
create or replace TEMP view aggView4580371592825541177 as select id as v1, name as v43 from char_name as chn;
create or replace TEMP view aggJoin4810631687121073930 as select movie_id as v31, note as v12, role_id as v29, v43 from cast_info as ci, aggView4580371592825541177 where ci.person_role_id=aggView4580371592825541177.v1 and (note LIKE '%(producer)%');
create or replace TEMP view aggView7636203988368772062 as select id as v15 from company_name as cn where (country_code = '[ru]');
create or replace TEMP view aggJoin8655541049748919342 as select v31, v44 from aggJoin6436113683225867319 join aggView7636203988368772062 using(v15);
create or replace TEMP view aggView1091253079639635196 as select v31, MIN(v44) as v44, COUNT(*) as annot from aggJoin8655541049748919342 group by v31;
create or replace TEMP view aggJoin5653898653797930466 as select v12, v29, v43 as v43, v44, annot from aggJoin4810631687121073930 join aggView1091253079639635196 using(v31);
create or replace TEMP view aggView7401783183564121284 as select v29, MIN(v43) as v43, MIN(v44) as v44, SUM(annot) as annot from aggJoin5653898653797930466 group by v29;
create or replace TEMP view aggJoin467864388926423270 as select role as v30, v43, v44, annot from role_type as rt, aggView7401783183564121284 where rt.id=aggView7401783183564121284.v29 and (role = 'actor');
create or replace TEMP view res as select MIN(v43) as v43, MIN(v44) as v44 from aggJoin467864388926423270;
select sum(v43+v44) from res;