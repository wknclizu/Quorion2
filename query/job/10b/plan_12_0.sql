create or replace TEMP view aggView1714736825835466861 as select id as v31, title as v44 from title as t where (production_year > 2010);
create or replace TEMP view aggJoin5741056681734834327 as select movie_id as v31, company_id as v15, company_type_id as v22, v44 from movie_companies as mc, aggView1714736825835466861 where mc.movie_id=aggView1714736825835466861.v31;
create or replace TEMP view aggView6271658418053937467 as select id as v22 from company_type as ct;
create or replace TEMP view aggJoin4780027193450126699 as select v31, v15, v44 from aggJoin5741056681734834327 join aggView6271658418053937467 using(v22);
create or replace TEMP view aggView1501207115627154700 as select id as v1, name as v43 from char_name as chn;
create or replace TEMP view aggJoin653848092068905287 as select movie_id as v31, note as v12, role_id as v29, v43 from cast_info as ci, aggView1501207115627154700 where ci.person_role_id=aggView1501207115627154700.v1 and (note LIKE '%(producer)%');
create or replace TEMP view aggView7045200711336707437 as select id as v15 from company_name as cn where (country_code = '[ru]');
create or replace TEMP view aggJoin8090982091738742981 as select v31, v44 from aggJoin4780027193450126699 join aggView7045200711336707437 using(v15);
create or replace TEMP view aggView8827510733250366703 as select v31, MIN(v44) as v44, COUNT(*) as annot from aggJoin8090982091738742981 group by v31;
create or replace TEMP view aggJoin4268561534450441626 as select v12, v29, v43 as v43, v44, annot from aggJoin653848092068905287 join aggView8827510733250366703 using(v31);
create or replace TEMP view aggView3072535436310673798 as select v29, MIN(v43) as v43, MIN(v44) as v44, SUM(annot) as annot from aggJoin4268561534450441626 group by v29;
create or replace TEMP view aggJoin3114620961576639080 as select role as v30, v43, v44, annot from role_type as rt, aggView3072535436310673798 where rt.id=aggView3072535436310673798.v29 and (role = 'actor');
create or replace TEMP view res as select MIN(v43) as v43, MIN(v44) as v44 from aggJoin3114620961576639080;
select sum(v43+v44) from res;