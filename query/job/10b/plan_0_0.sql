create or replace TEMP view aggView3482185236922669997 as select id as v22 from company_type as ct;
create or replace TEMP view aggJoin3486781676902012159 as select movie_id as v31, company_id as v15 from movie_companies as mc, aggView3482185236922669997 where mc.company_type_id=aggView3482185236922669997.v22;
create or replace TEMP view aggView2171316404250984743 as select id as v31, title as v44 from title as t where (production_year > 2010);
create or replace TEMP view aggJoin3172065449444742535 as select movie_id as v31, person_role_id as v1, note as v12, role_id as v29, v44 from cast_info as ci, aggView2171316404250984743 where ci.movie_id=aggView2171316404250984743.v31 and (note LIKE '%(producer)%');
create or replace TEMP view aggView1328201937999366017 as select id as v15 from company_name as cn where (country_code = '[ru]');
create or replace TEMP view aggJoin8444400317184087737 as select v31 from aggJoin3486781676902012159 join aggView1328201937999366017 using(v15);
create or replace TEMP view aggView2387310722769717754 as select id as v29 from role_type as rt where (role = 'actor');
create or replace TEMP view aggJoin9206903162955087802 as select v31, v1, v12, v44 from aggJoin3172065449444742535 join aggView2387310722769717754 using(v29);
create or replace TEMP view aggView2697114053995917548 as select v31, COUNT(*) as annot from aggJoin8444400317184087737 group by v31;
create or replace TEMP view aggJoin262200669168657932 as select v1, v12, v44 as v44, annot from aggJoin9206903162955087802 join aggView2697114053995917548 using(v31);
create or replace TEMP view aggView4688898879747096076 as select v1, MIN(v44) as v44, SUM(annot) as annot from aggJoin262200669168657932 group by v1;
create or replace TEMP view aggJoin7182106669008352136 as select name as v2, v44, annot from char_name as chn, aggView4688898879747096076 where chn.id=aggView4688898879747096076.v1;
create or replace TEMP view res as select MIN(v2) as v43, MIN(v44) as v44 from aggJoin7182106669008352136;
select sum(v43+v44) from res;