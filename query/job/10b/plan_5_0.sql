create or replace TEMP view aggView6377684233630707428 as select id as v22 from company_type as ct;
create or replace TEMP view aggJoin5744426304182314425 as select movie_id as v31, company_id as v15 from movie_companies as mc, aggView6377684233630707428 where mc.company_type_id=aggView6377684233630707428.v22;
create or replace TEMP view aggView5403093300424839641 as select id as v31, title as v44 from title as t where (production_year > 2010);
create or replace TEMP view aggJoin7114282914712384480 as select movie_id as v31, person_role_id as v1, note as v12, role_id as v29, v44 from cast_info as ci, aggView5403093300424839641 where ci.movie_id=aggView5403093300424839641.v31 and (note LIKE '%(producer)%');
create or replace TEMP view aggView780787607163547021 as select id as v15 from company_name as cn where (country_code = '[ru]');
create or replace TEMP view aggJoin348273676254631826 as select v31 from aggJoin5744426304182314425 join aggView780787607163547021 using(v15);
create or replace TEMP view aggView2751354191715723857 as select v31, COUNT(*) as annot from aggJoin348273676254631826 group by v31;
create or replace TEMP view aggJoin5889497743693671220 as select v1, v12, v29, v44 as v44, annot from aggJoin7114282914712384480 join aggView2751354191715723857 using(v31);
create or replace TEMP view aggView2661467232191525011 as select id as v1, name as v43 from char_name as chn;
create or replace TEMP view aggJoin2778490076992750539 as select v12, v29, v44, annot, v43 as v43 from aggJoin5889497743693671220 join aggView2661467232191525011 using(v1);
create or replace TEMP view aggView828388998401837584 as select v29, MIN(v44) as v44, MIN(v43) as v43, SUM(annot) as annot from aggJoin2778490076992750539 group by v29;
create or replace TEMP view aggJoin7465712307876443663 as select role as v30, v44, v43, annot from role_type as rt, aggView828388998401837584 where rt.id=aggView828388998401837584.v29 and (role = 'actor');
create or replace TEMP view res as select MIN(v43) as v43, MIN(v44) as v44 from aggJoin7465712307876443663;
select sum(v43+v44) from res;