create or replace TEMP view semiUp3840570702635725573 as select movie_id as v31, company_id as v15, company_type_id as v22 from movie_companies AS mc where (company_id) in (select id from company_name AS cn where (country_code = '[ru]'));
create or replace TEMP view semiUp7268285688066527025 as select movie_id as v31, person_role_id as v1, role_id as v29 from cast_info AS ci where (role_id) in (select id from role_type AS rt where (role = 'actor')) and (note LIKE '%(producer)%');
create or replace TEMP view semiUp4718258369501154367 as select v31, v1, v29 from semiUp7268285688066527025 where (v1) in (select id from char_name AS chn);
create or replace TEMP view semiUp4998212267670580478 as select v31, v15, v22 from semiUp3840570702635725573 where (v22) in (select id from company_type AS ct);
create or replace TEMP view semiUp48323536332818411 as select id as v31, title as v32 from title AS t where (id) in (select v31 from semiUp4998212267670580478) and (production_year > 2010);
create or replace TEMP view semiUp460468256708983256 as select v31, v1, v29 from semiUp4718258369501154367 where (v31) in (select v31 from semiUp48323536332818411);
create or replace TEMP view semiDown2030772977073450584 as select id as v29 from role_type AS rt where (id) in (select v29 from semiUp460468256708983256) and (role = 'actor');
create or replace TEMP view semiDown8982491390644764145 as select v31, v32 from semiUp48323536332818411 where (v31) in (select v31 from semiUp460468256708983256);
create or replace TEMP view semiDown3894518131954306851 as select id as v1, name as v2 from char_name AS chn where (id) in (select v1 from semiUp460468256708983256);
create or replace TEMP view semiDown5177818379634809513 as select v31, v15, v22 from semiUp4998212267670580478 where (v31) in (select v31 from semiDown8982491390644764145);
create or replace TEMP view semiDown2089299714033240692 as select id as v22 from company_type AS ct where (id) in (select v22 from semiDown5177818379634809513);
create or replace TEMP view semiDown3498721414262285525 as select id as v15 from company_name AS cn where (id) in (select v15 from semiDown5177818379634809513) and (country_code = '[ru]');
create or replace TEMP view aggView7952192883275773925 as select v22 from semiDown2089299714033240692;
create or replace TEMP view aggJoin3382766573024985122 as select v31, v15 from semiDown5177818379634809513 join aggView7952192883275773925 using(v22);
create or replace TEMP view aggView3060952584102161118 as select v15 from semiDown3498721414262285525;
create or replace TEMP view aggJoin1144343223244168390 as select v31 from aggJoin3382766573024985122 join aggView3060952584102161118 using(v15);
create or replace TEMP view aggView1986405063118750969 as select v31 from aggJoin1144343223244168390 group by v31;
create or replace TEMP view aggJoin7584790408104396779 as select v31, v32 from semiDown8982491390644764145 join aggView1986405063118750969 using(v31);
create or replace TEMP view aggView7443870154349984894 as select v31, MIN(v32) as v44 from aggJoin7584790408104396779 group by v31;
create or replace TEMP view aggJoin6130338919355740778 as select v1, v29, v44 from semiUp460468256708983256 join aggView7443870154349984894 using(v31);
create or replace TEMP view aggView8305389155584129040 as select v29 from semiDown2030772977073450584;
create or replace TEMP view aggJoin8019784113168379763 as select v1, v44 from aggJoin6130338919355740778 join aggView8305389155584129040 using(v29);
create or replace TEMP view aggView3015498213887280463 as select v1, v2 as v43 from semiDown3894518131954306851;
create or replace TEMP view aggJoin2631983680747184142 as select v44, v43 from aggJoin8019784113168379763 join aggView3015498213887280463 using(v1);
create or replace TEMP view res as select MIN(v43) as v43, MIN(v44) as v44 from aggJoin2631983680747184142;
select sum(v43+v44) from res;
