create or replace TEMP view aggView6459653337702545922 as select id as v31, title as v44 from title as t where (production_year > 2010);
create or replace TEMP view aggJoin9093591901171076550 as select movie_id as v31, person_role_id as v1, note as v12, role_id as v29, v44 from cast_info as ci, aggView6459653337702545922 where ci.movie_id=aggView6459653337702545922.v31 and (note LIKE '%(producer)%');
create or replace TEMP view aggView2736326059689064260 as select id as v22 from company_type as ct;
create or replace TEMP view aggJoin3643302564479600800 as select movie_id as v31, company_id as v15 from movie_companies as mc, aggView2736326059689064260 where mc.company_type_id=aggView2736326059689064260.v22;
create or replace TEMP view aggView865607482602830232 as select id as v29 from role_type as rt where (role = 'actor');
create or replace TEMP view aggJoin2723225098680029499 as select v31, v1, v12, v44 from aggJoin9093591901171076550 join aggView865607482602830232 using(v29);
create or replace TEMP view aggView6041446665815192874 as select id as v15 from company_name as cn where (country_code = '[ru]');
create or replace TEMP view aggJoin3967014130739678542 as select v31 from aggJoin3643302564479600800 join aggView6041446665815192874 using(v15);
create or replace TEMP view aggView5275644686890884505 as select id as v1, name as v43 from char_name as chn;
create or replace TEMP view aggJoin1855461127837239031 as select v31, v12, v44, v43 from aggJoin2723225098680029499 join aggView5275644686890884505 using(v1);
create or replace TEMP view aggView6050764673384142658 as select v31, MIN(v44) as v44, MIN(v43) as v43, COUNT(*) as annot from aggJoin1855461127837239031 group by v31;
create or replace TEMP view aggJoin6791274731490953371 as select v44, v43, annot from aggJoin3967014130739678542 join aggView6050764673384142658 using(v31);
create or replace TEMP view res as select MIN(v43) as v43, MIN(v44) as v44 from aggJoin6791274731490953371;
select sum(v43+v44) from res;