create or replace TEMP view semiUp604934260384388370 as select movie_id as v31, company_id as v15, company_type_id as v22 from movie_companies AS mc where (movie_id) in (select id from title AS t where (production_year > 2010));
create or replace TEMP view semiUp6643664177480321618 as select v31, v15, v22 from semiUp604934260384388370 where (v22) in (select id from company_type AS ct);
create or replace TEMP view semiUp3921563297678479660 as select movie_id as v31, person_role_id as v1, role_id as v29 from cast_info AS ci where (person_role_id) in (select id from char_name AS chn) and (note LIKE '%(producer)%');
create or replace TEMP view semiUp4673904421549987283 as select v31, v15, v22 from semiUp6643664177480321618 where (v15) in (select id from company_name AS cn where (country_code = '[ru]'));
create or replace TEMP view semiUp7034332812322166631 as select v31, v1, v29 from semiUp3921563297678479660 where (v29) in (select id from role_type AS rt where (role = 'actor'));
create or replace TEMP view semiUp9074883624899090085 as select v31, v15, v22 from semiUp4673904421549987283 where (v31) in (select v31 from semiUp7034332812322166631);
create or replace TEMP view semiDown499889442097433685 as select id as v22 from company_type AS ct where (id) in (select v22 from semiUp9074883624899090085);
create or replace TEMP view semiDown6926405665247692348 as select id as v15 from company_name AS cn where (id) in (select v15 from semiUp9074883624899090085) and (country_code = '[ru]');
create or replace TEMP view semiDown7472595961624997039 as select id as v31, title as v32 from title AS t where (id) in (select v31 from semiUp9074883624899090085) and (production_year > 2010);
create or replace TEMP view semiDown8714340912364558663 as select v31, v1, v29 from semiUp7034332812322166631 where (v31) in (select v31 from semiUp9074883624899090085);
create or replace TEMP view semiDown141932125202084172 as select id as v29 from role_type AS rt where (id) in (select v29 from semiDown8714340912364558663) and (role = 'actor');
create or replace TEMP view semiDown6277160725829014649 as select id as v1, name as v2 from char_name AS chn where (id) in (select v1 from semiDown8714340912364558663);
create or replace TEMP view aggView7846840277531570177 as select v29 from semiDown141932125202084172;
create or replace TEMP view aggJoin678518806036117445 as select v31, v1 from semiDown8714340912364558663 join aggView7846840277531570177 using(v29);
create or replace TEMP view aggView3525354896673303848 as select v31, v32 as v44 from semiDown7472595961624997039;
create or replace TEMP view aggJoin9072375364929506745 as select v31, v15, v22, v44 from semiUp9074883624899090085 join aggView3525354896673303848 using(v31);
create or replace TEMP view aggView9018719861699734743 as select v1, v2 as v43 from semiDown6277160725829014649;
create or replace TEMP view aggJoin4275141515818770822 as select v31, v43 from aggJoin678518806036117445 join aggView9018719861699734743 using(v1);
create or replace TEMP view aggView5179249052932031031 as select v22 from semiDown499889442097433685;
create or replace TEMP view aggJoin5703760360732484113 as select v31, v15, v44 from aggJoin9072375364929506745 join aggView5179249052932031031 using(v22);
create or replace TEMP view aggView8160731615557274920 as select v15 from semiDown6926405665247692348;
create or replace TEMP view aggJoin4255566368537709363 as select v31, v44 from aggJoin5703760360732484113 join aggView8160731615557274920 using(v15);
create or replace TEMP view aggView202530354438770624 as select v31, MIN(v43) as v43 from aggJoin4275141515818770822 group by v31,v43;
create or replace TEMP view aggJoin2035461620338183096 as select v44 as v44, v43 from aggJoin4255566368537709363 join aggView202530354438770624 using(v31);
create or replace TEMP view res as select MIN(v43) as v43, MIN(v44) as v44 from aggJoin2035461620338183096;
select sum(v43+v44) from res;
