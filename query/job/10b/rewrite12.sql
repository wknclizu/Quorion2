create or replace TEMP view aggView5302901783235507277 as select id as v22 from company_type as ct;
create or replace TEMP view aggJoin310398481372691749 as select movie_id as v31, company_id as v15 from movie_companies as mc, aggView5302901783235507277 where mc.company_type_id=aggView5302901783235507277.v22;
create or replace TEMP view aggView4574087433945673440 as select id as v15 from company_name as cn where (country_code = '[ru]');
create or replace TEMP view aggJoin5518183195994466989 as select v31 from aggJoin310398481372691749 join aggView4574087433945673440 using(v15);
create or replace TEMP view aggView742160314081659403 as select id as v31, title as v44 from title as t where (production_year > 2010);
create or replace TEMP view aggJoin1243401767449641764 as select v31, v44 from aggJoin5518183195994466989 join aggView742160314081659403 using(v31);
create or replace TEMP view aggView6046393726829304669 as select v31, MIN(v44) as v44, COUNT(*) as annot from aggJoin1243401767449641764 group by v31;
create or replace TEMP view aggJoin6431072537417647865 as select person_role_id as v1, note as v12, role_id as v29, v44, annot from cast_info as ci, aggView6046393726829304669 where ci.movie_id=aggView6046393726829304669.v31 and (note LIKE '%(producer)%');
create or replace TEMP view aggView3138830352660627824 as select id as v1, name as v43 from char_name as chn;
create or replace TEMP view aggJoin8397418495781111963 as select v12, v29, v44, annot, v43 as v43 from aggJoin6431072537417647865 join aggView3138830352660627824 using(v1);
create or replace TEMP view aggView1010446519298962997 as select id as v29 from role_type as rt where (role = 'actor');
create or replace TEMP view aggJoin448553592583095855 as select v12, v44, annot, v43 from aggJoin8397418495781111963 join aggView1010446519298962997 using(v29);
create or replace TEMP view res as select MIN(v43) as v43, MIN(v44) as v44 from aggJoin448553592583095855;
select sum(v43+v44) from res;