create or replace TEMP view aggView8538142310222633222 as select id as v22 from company_type as ct;
create or replace TEMP view aggJoin9038933129993533699 as select movie_id as v31, company_id as v15 from movie_companies as mc, aggView8538142310222633222 where mc.company_type_id=aggView8538142310222633222.v22;
create or replace TEMP view aggView325644653584775250 as select id as v15 from company_name as cn where (country_code = '[ru]');
create or replace TEMP view aggJoin2354916834406438825 as select v31 from aggJoin9038933129993533699 join aggView325644653584775250 using(v15);
create or replace TEMP view aggView2321079386894272022 as select id as v31, title as v44 from title as t where (production_year > 2010);
create or replace TEMP view aggJoin8410458088597021907 as select movie_id as v31, person_role_id as v1, note as v12, role_id as v29, v44 from cast_info as ci, aggView2321079386894272022 where ci.movie_id=aggView2321079386894272022.v31 and (note LIKE '%(producer)%');
create or replace TEMP view aggView565578585146050952 as select v31, COUNT(*) as annot from aggJoin2354916834406438825 group by v31;
create or replace TEMP view aggJoin302640462759119555 as select v1, v12, v29, v44 as v44, annot from aggJoin8410458088597021907 join aggView565578585146050952 using(v31);
create or replace TEMP view aggView4075654395427128974 as select id as v1, name as v43 from char_name as chn;
create or replace TEMP view aggJoin2885840961944369320 as select v12, v29, v44, annot, v43 as v43 from aggJoin302640462759119555 join aggView4075654395427128974 using(v1);
create or replace TEMP view aggView6195271582767211991 as select id as v29 from role_type as rt where (role = 'actor');
create or replace TEMP view aggJoin885388254602409599 as select v12, v44, annot, v43 from aggJoin2885840961944369320 join aggView6195271582767211991 using(v29);
create or replace TEMP view res as select MIN(v43) as v43, MIN(v44) as v44 from aggJoin885388254602409599;
select sum(v43+v44) from res;