create or replace TEMP view aggView428983535212536278 as select id as v29 from role_type as rt where (role = 'actor');
create or replace TEMP view aggJoin5464773433167479 as select movie_id as v31, person_role_id as v1, note as v12 from cast_info as ci, aggView428983535212536278 where ci.role_id=aggView428983535212536278.v29 and (note LIKE '%(producer)%');
create or replace TEMP view aggView4437288332989692895 as select id as v31, title as v44 from title as t where (production_year > 2010);
create or replace TEMP view aggJoin3487751302296212704 as select movie_id as v31, company_id as v15, company_type_id as v22, v44 from movie_companies as mc, aggView4437288332989692895 where mc.movie_id=aggView4437288332989692895.v31;
create or replace TEMP view aggView1297505944978037394 as select id as v1, name as v43 from char_name as chn;
create or replace TEMP view aggJoin991350336919701719 as select v31, v12, v43 from aggJoin5464773433167479 join aggView1297505944978037394 using(v1);
create or replace TEMP view aggView1439839043567319946 as select id as v15 from company_name as cn where (country_code = '[ru]');
create or replace TEMP view aggJoin7180853285729788333 as select v31, v22, v44 from aggJoin3487751302296212704 join aggView1439839043567319946 using(v15);
create or replace TEMP view aggView4914962213805373221 as select v31, MIN(v43) as v43, COUNT(*) as annot from aggJoin991350336919701719 group by v31;
create or replace TEMP view aggJoin2101667905249750736 as select v22, v44 as v44, v43, annot from aggJoin7180853285729788333 join aggView4914962213805373221 using(v31);
create or replace TEMP view aggView4480314289808298232 as select v22, MIN(v44) as v44, MIN(v43) as v43, SUM(annot) as annot from aggJoin2101667905249750736 group by v22;
create or replace TEMP view aggJoin1375784908501127324 as select v44, v43, annot from company_type as ct, aggView4480314289808298232 where ct.id=aggView4480314289808298232.v22;
create or replace TEMP view res as select MIN(v43) as v43, MIN(v44) as v44 from aggJoin1375784908501127324;
select sum(v43+v44) from res;