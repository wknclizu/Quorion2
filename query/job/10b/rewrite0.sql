create or replace TEMP view aggView97112715143922576 as select id as v31, title as v44 from title as t where (production_year > 2010);
create or replace TEMP view aggJoin7390085119896563394 as select movie_id as v31, person_role_id as v1, note as v12, role_id as v29, v44 from cast_info as ci, aggView97112715143922576 where ci.movie_id=aggView97112715143922576.v31 and (note LIKE '%(producer)%');
create or replace TEMP view aggView7399495980791340307 as select id as v29 from role_type as rt where (role = 'actor');
create or replace TEMP view aggJoin3776929249383299849 as select v31, v1, v12, v44 from aggJoin7390085119896563394 join aggView7399495980791340307 using(v29);
create or replace TEMP view aggView2017080374555234272 as select id as v1, name as v43 from char_name as chn;
create or replace TEMP view aggJoin1682594737122413994 as select v31, v12, v44, v43 from aggJoin3776929249383299849 join aggView2017080374555234272 using(v1);
create or replace TEMP view aggView9125457335374349566 as select id as v22 from company_type as ct;
create or replace TEMP view aggJoin2387688597275181822 as select movie_id as v31, company_id as v15 from movie_companies as mc, aggView9125457335374349566 where mc.company_type_id=aggView9125457335374349566.v22;
create or replace TEMP view aggView2105985143223074241 as select id as v15 from company_name as cn where (country_code = '[ru]');
create or replace TEMP view aggJoin6982285790614985692 as select v31 from aggJoin2387688597275181822 join aggView2105985143223074241 using(v15);
create or replace TEMP view aggView4798483559234616991 as select v31, MIN(v44) as v44, MIN(v43) as v43, COUNT(*) as annot from aggJoin1682594737122413994 group by v31;
create or replace TEMP view aggJoin7226823467092252491 as select v44, v43, annot from aggJoin6982285790614985692 join aggView4798483559234616991 using(v31);
create or replace TEMP view res as select MIN(v43) as v43, MIN(v44) as v44 from aggJoin7226823467092252491;
select sum(v43+v44) from res;