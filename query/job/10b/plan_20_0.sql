create or replace TEMP view aggView4771643363149661281 as select id as v22 from company_type as ct;
create or replace TEMP view aggJoin8797293896327391043 as select movie_id as v31, company_id as v15 from movie_companies as mc, aggView4771643363149661281 where mc.company_type_id=aggView4771643363149661281.v22;
create or replace TEMP view aggView3603027936201934330 as select id as v29 from role_type as rt where (role = 'actor');
create or replace TEMP view aggJoin8175018300370888454 as select movie_id as v31, person_role_id as v1, note as v12 from cast_info as ci, aggView3603027936201934330 where ci.role_id=aggView3603027936201934330.v29 and (note LIKE '%(producer)%');
create or replace TEMP view aggView687936033194875758 as select id as v15 from company_name as cn where (country_code = '[ru]');
create or replace TEMP view aggJoin89375747481417281 as select v31 from aggJoin8797293896327391043 join aggView687936033194875758 using(v15);
create or replace TEMP view aggView8555725543408551669 as select v31, COUNT(*) as annot from aggJoin89375747481417281 group by v31;
create or replace TEMP view aggJoin5695906559132952220 as select id as v31, title as v32, production_year as v35, annot from title as t, aggView8555725543408551669 where t.id=aggView8555725543408551669.v31 and (production_year > 2010);
create or replace TEMP view aggView6564655720167169454 as select id as v1, name as v43 from char_name as chn;
create or replace TEMP view aggJoin4293600430674768872 as select v31, v12, v43 from aggJoin8175018300370888454 join aggView6564655720167169454 using(v1);
create or replace TEMP view aggView4452398727786564897 as select v31, MIN(v43) as v43, COUNT(*) as annot from aggJoin4293600430674768872 group by v31;
create or replace TEMP view aggJoin7554041008108032608 as select v32, v35, aggJoin5695906559132952220.annot * aggView4452398727786564897.annot as annot, v43 from aggJoin5695906559132952220 join aggView4452398727786564897 using(v31);
create or replace TEMP view res as select MIN(v43) as v43, MIN(v32) as v44 from aggJoin7554041008108032608;
select sum(v43+v44) from res;