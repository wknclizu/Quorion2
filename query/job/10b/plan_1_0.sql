create or replace TEMP view aggView6243873516322744476 as select id as v22 from company_type as ct;
create or replace TEMP view aggJoin7325657848279863849 as select movie_id as v31, company_id as v15 from movie_companies as mc, aggView6243873516322744476 where mc.company_type_id=aggView6243873516322744476.v22;
create or replace TEMP view aggView4547194065522008499 as select id as v31, title as v44 from title as t where (production_year > 2010);
create or replace TEMP view aggJoin7426812461190813213 as select movie_id as v31, person_role_id as v1, note as v12, role_id as v29, v44 from cast_info as ci, aggView4547194065522008499 where ci.movie_id=aggView4547194065522008499.v31 and (note LIKE '%(producer)%');
create or replace TEMP view aggView2537293274119457332 as select id as v15 from company_name as cn where (country_code = '[ru]');
create or replace TEMP view aggJoin7986282391994273468 as select v31 from aggJoin7325657848279863849 join aggView2537293274119457332 using(v15);
create or replace TEMP view aggView6048333561670433924 as select id as v29 from role_type as rt where (role = 'actor');
create or replace TEMP view aggJoin3403557659942103792 as select v31, v1, v12, v44 from aggJoin7426812461190813213 join aggView6048333561670433924 using(v29);
create or replace TEMP view aggView7159746237270733776 as select v31, COUNT(*) as annot from aggJoin7986282391994273468 group by v31;
create or replace TEMP view aggJoin5124617944540930935 as select v1, v12, v44 as v44, annot from aggJoin3403557659942103792 join aggView7159746237270733776 using(v31);
create or replace TEMP view aggView6309937020786554493 as select id as v1, name as v43 from char_name as chn;
create or replace TEMP view aggJoin8781873751407081675 as select v12, v44, annot, v43 as v43 from aggJoin5124617944540930935 join aggView6309937020786554493 using(v1);
create or replace TEMP view res as select MIN(v43) as v43, MIN(v44) as v44 from aggJoin8781873751407081675;
select sum(v43+v44) from res;