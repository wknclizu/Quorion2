create or replace TEMP view semiUp4447471903455788148 as select movie_id as v31, person_role_id as v1, role_id as v29 from cast_info AS ci where (person_role_id) in (select id from char_name AS chn) and (note LIKE '%(producer)%');
create or replace TEMP view semiUp3894027820849153933 as select movie_id as v31, company_id as v15, company_type_id as v22 from movie_companies AS mc where (company_id) in (select id from company_name AS cn where (country_code = '[ru]'));
create or replace TEMP view semiUp1087357128419778027 as select v31, v15, v22 from semiUp3894027820849153933 where (v31) in (select id from title AS t where (production_year > 2010));
create or replace TEMP view semiUp7471531974648062408 as select v31, v15, v22 from semiUp1087357128419778027 where (v22) in (select id from company_type AS ct);
create or replace TEMP view semiUp2676345254243439896 as select v31, v1, v29 from semiUp4447471903455788148 where (v31) in (select v31 from semiUp7471531974648062408);
create or replace TEMP view semiUp4718023940624162441 as select id as v29 from role_type AS rt where (id) in (select v29 from semiUp2676345254243439896) and (role = 'actor');
create or replace TEMP view semiDown8049494305417218543 as select v31, v1, v29 from semiUp2676345254243439896 where (v29) in (select v29 from semiUp4718023940624162441);
create or replace TEMP view semiDown7932766722037505913 as select v31, v15, v22 from semiUp7471531974648062408 where (v31) in (select v31 from semiDown8049494305417218543);
create or replace TEMP view semiDown8672021790428801259 as select id as v1, name as v2 from char_name AS chn where (id) in (select v1 from semiDown8049494305417218543);
create or replace TEMP view semiDown5081175259719224399 as select id as v22 from company_type AS ct where (id) in (select v22 from semiDown7932766722037505913);
create or replace TEMP view semiDown711676292015145732 as select id as v15 from company_name AS cn where (id) in (select v15 from semiDown7932766722037505913) and (country_code = '[ru]');
create or replace TEMP view semiDown801202215148081678 as select id as v31, title as v32 from title AS t where (id) in (select v31 from semiDown7932766722037505913) and (production_year > 2010);
create or replace TEMP view aggView1938722947065639881 as select v31, v32 as v44 from semiDown801202215148081678;
create or replace TEMP view aggJoin4879889529193216820 as select v31, v15, v22, v44 from semiDown7932766722037505913 join aggView1938722947065639881 using(v31);
create or replace TEMP view aggView4729295761144153503 as select v22 from semiDown5081175259719224399;
create or replace TEMP view aggJoin7176926633735019187 as select v31, v15, v44 from aggJoin4879889529193216820 join aggView4729295761144153503 using(v22);
create or replace TEMP view aggView6210792515374608716 as select v1, v2 as v43 from semiDown8672021790428801259;
create or replace TEMP view aggJoin2696131247407826503 as select v31, v29, v43 from semiDown8049494305417218543 join aggView6210792515374608716 using(v1);
create or replace TEMP view aggView2174204796576956360 as select v15 from semiDown711676292015145732;
create or replace TEMP view aggJoin9184535302284838549 as select v31, v44 from aggJoin7176926633735019187 join aggView2174204796576956360 using(v15);
create or replace TEMP view aggView5911070042953436827 as select v31, MIN(v44) as v44 from aggJoin9184535302284838549 group by v31,v44;
create or replace TEMP view aggJoin927663323510941063 as select v29, v43 as v43, v44 from aggJoin2696131247407826503 join aggView5911070042953436827 using(v31);
create or replace TEMP view aggView5930592331628300629 as select v29, MIN(v43) as v43, MIN(v44) as v44 from aggJoin927663323510941063 group by v29,v43,v44;
create or replace TEMP view aggJoin8765293349773306716 as select v43, v44 from semiUp4718023940624162441 join aggView5930592331628300629 using(v29);
create or replace TEMP view res as select MIN(v43) as v43, MIN(v44) as v44 from aggJoin8765293349773306716;
select sum(v43+v44) from res;
