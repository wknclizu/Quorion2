create or replace TEMP view semiUp7151177688293763347 as select movie_id as v31, company_id as v15, company_type_id as v22 from movie_companies AS mc where (company_type_id) in (select id from company_type AS ct);
create or replace TEMP view semiUp8278763047490469806 as select v31, v15, v22 from semiUp7151177688293763347 where (v15) in (select id from company_name AS cn where (country_code = '[ru]'));
create or replace TEMP view semiUp7495810830427539932 as select v31, v15, v22 from semiUp8278763047490469806 where (v31) in (select id from title AS t where (production_year > 2010));
create or replace TEMP view semiUp2899419493498233726 as select movie_id as v31, person_role_id as v1, role_id as v29 from cast_info AS ci where (movie_id) in (select v31 from semiUp7495810830427539932) and (note LIKE '%(producer)%');
create or replace TEMP view semiUp3771068039928224840 as select v31, v1, v29 from semiUp2899419493498233726 where (v1) in (select id from char_name AS chn);
create or replace TEMP view semiUp162211047820866952 as select id as v29 from role_type AS rt where (id) in (select v29 from semiUp3771068039928224840) and (role = 'actor');
create or replace TEMP view semiDown8098962921734336286 as select v31, v1, v29 from semiUp3771068039928224840 where (v29) in (select v29 from semiUp162211047820866952);
create or replace TEMP view semiDown6242617730691531120 as select v31, v15, v22 from semiUp7495810830427539932 where (v31) in (select v31 from semiDown8098962921734336286);
create or replace TEMP view semiDown7313762395220298837 as select id as v1, name as v2 from char_name AS chn where (id) in (select v1 from semiDown8098962921734336286);
create or replace TEMP view semiDown9036370551665815986 as select id as v22 from company_type AS ct where (id) in (select v22 from semiDown6242617730691531120);
create or replace TEMP view semiDown8932314808256541691 as select id as v15 from company_name AS cn where (id) in (select v15 from semiDown6242617730691531120) and (country_code = '[ru]');
create or replace TEMP view semiDown2238986627316457736 as select id as v31, title as v32 from title AS t where (id) in (select v31 from semiDown6242617730691531120) and (production_year > 2010);
create or replace TEMP view aggView1113053742147909733 as select v31, v32 as v44 from semiDown2238986627316457736;
create or replace TEMP view aggJoin4150712493501951129 as select v31, v15, v22, v44 from semiDown6242617730691531120 join aggView1113053742147909733 using(v31);
create or replace TEMP view aggView9216912297277394740 as select v22 from semiDown9036370551665815986;
create or replace TEMP view aggJoin8713561101860822068 as select v31, v15, v44 from aggJoin4150712493501951129 join aggView9216912297277394740 using(v22);
create or replace TEMP view aggView5793005682394820635 as select v1, v2 as v43 from semiDown7313762395220298837;
create or replace TEMP view aggJoin7146073201528154899 as select v31, v29, v43 from semiDown8098962921734336286 join aggView5793005682394820635 using(v1);
create or replace TEMP view aggView1917347229067571661 as select v15 from semiDown8932314808256541691;
create or replace TEMP view aggJoin2280744958139366292 as select v31, v44 from aggJoin8713561101860822068 join aggView1917347229067571661 using(v15);
create or replace TEMP view aggView8518245312880328057 as select v31, MIN(v44) as v44 from aggJoin2280744958139366292 group by v31,v44;
create or replace TEMP view aggJoin9112461981806179229 as select v29, v43 as v43, v44 from aggJoin7146073201528154899 join aggView8518245312880328057 using(v31);
create or replace TEMP view aggView747437375418533398 as select v29, MIN(v43) as v43, MIN(v44) as v44 from aggJoin9112461981806179229 group by v29,v44,v43;
create or replace TEMP view aggJoin6034553034602284470 as select v43, v44 from semiUp162211047820866952 join aggView747437375418533398 using(v29);
create or replace TEMP view res as select MIN(v43) as v43, MIN(v44) as v44 from aggJoin6034553034602284470;
select sum(v43+v44) from res;
