create or replace TEMP view aggView9132791439785630473 as select id as v22 from company_type as ct;
create or replace TEMP view aggJoin496899605464416839 as select movie_id as v31, company_id as v15 from movie_companies as mc, aggView9132791439785630473 where mc.company_type_id=aggView9132791439785630473.v22;
create or replace TEMP view aggView6512768884499129883 as select id as v15 from company_name as cn where (country_code = '[ru]');
create or replace TEMP view aggJoin5967021516197049496 as select v31 from aggJoin496899605464416839 join aggView6512768884499129883 using(v15);
create or replace TEMP view aggView4506871800361674702 as select v31, COUNT(*) as annot from aggJoin5967021516197049496 group by v31;
create or replace TEMP view aggJoin5891354941971289465 as select id as v31, title as v32, production_year as v35, annot from title as t, aggView4506871800361674702 where t.id=aggView4506871800361674702.v31 and (production_year > 2010);
create or replace TEMP view aggView4320383171343140135 as select v31, MIN(v32) as v44, SUM(annot) as annot from aggJoin5891354941971289465 group by v31;
create or replace TEMP view aggJoin6898096808149438139 as select person_role_id as v1, note as v12, role_id as v29, v44, annot from cast_info as ci, aggView4320383171343140135 where ci.movie_id=aggView4320383171343140135.v31 and (note LIKE '%(producer)%');
create or replace TEMP view aggView4970173076036765304 as select id as v29 from role_type as rt where (role = 'actor');
create or replace TEMP view aggJoin2646868295646043422 as select v1, v12, v44, annot from aggJoin6898096808149438139 join aggView4970173076036765304 using(v29);
create or replace TEMP view aggView6584323462049172362 as select id as v1, name as v43 from char_name as chn;
create or replace TEMP view aggJoin1108414876820555103 as select v12, v44, annot, v43 as v43 from aggJoin2646868295646043422 join aggView6584323462049172362 using(v1);
create or replace TEMP view res as select MIN(v43) as v43, MIN(v44) as v44 from aggJoin1108414876820555103;
select sum(v43+v44) from res;