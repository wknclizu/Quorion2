create or replace TEMP view semiUp2487926263486705643 as select movie_id as v31, company_id as v15, company_type_id as v22 from movie_companies AS mc where (company_id) in (select id from company_name AS cn where (country_code = '[ru]'));
create or replace TEMP view semiUp3413306720560210848 as select v31, v15, v22 from semiUp2487926263486705643 where (v22) in (select id from company_type AS ct);
create or replace TEMP view semiUp4530461491608563323 as select movie_id as v31, person_role_id as v1, role_id as v29 from cast_info AS ci where (movie_id) in (select id from title AS t where (production_year > 2010)) and (note LIKE '%(producer)%');
create or replace TEMP view semiUp7034107547188225818 as select v31, v1, v29 from semiUp4530461491608563323 where (v31) in (select v31 from semiUp3413306720560210848);
create or replace TEMP view semiUp597465216481135535 as select v31, v1, v29 from semiUp7034107547188225818 where (v29) in (select id from role_type AS rt where (role = 'actor'));
create or replace TEMP view semiUp7596596412500783947 as select id as v1, name as v2 from char_name AS chn where (id) in (select v1 from semiUp597465216481135535);
create or replace TEMP view semiDown6879130702454734278 as select v31, v1, v29 from semiUp597465216481135535 where (v1) in (select v1 from semiUp7596596412500783947);
create or replace TEMP view semiDown2420967890807913757 as select id as v29 from role_type AS rt where (id) in (select v29 from semiDown6879130702454734278) and (role = 'actor');
create or replace TEMP view semiDown351093312204769067 as select id as v31, title as v32 from title AS t where (id) in (select v31 from semiDown6879130702454734278) and (production_year > 2010);
create or replace TEMP view semiDown7673248422207527187 as select v31, v15, v22 from semiUp3413306720560210848 where (v31) in (select v31 from semiDown6879130702454734278);
create or replace TEMP view semiDown7343582011190626121 as select id as v22 from company_type AS ct where (id) in (select v22 from semiDown7673248422207527187);
create or replace TEMP view semiDown8118618665248713511 as select id as v15 from company_name AS cn where (id) in (select v15 from semiDown7673248422207527187) and (country_code = '[ru]');
create or replace TEMP view aggView6334745290235087427 as select v22 from semiDown7343582011190626121;
create or replace TEMP view aggJoin2217187075983139325 as select v31, v15 from semiDown7673248422207527187 join aggView6334745290235087427 using(v22);
create or replace TEMP view aggView3597777734006256557 as select v31, v32 as v44 from semiDown351093312204769067;
create or replace TEMP view aggJoin6099030526412187842 as select v31, v1, v29, v44 from semiDown6879130702454734278 join aggView3597777734006256557 using(v31);
create or replace TEMP view aggView1469836752293526716 as select v15 from semiDown8118618665248713511;
create or replace TEMP view aggJoin1012085807195030716 as select v31 from aggJoin2217187075983139325 join aggView1469836752293526716 using(v15);
create or replace TEMP view aggView6453796183794701735 as select v29 from semiDown2420967890807913757;
create or replace TEMP view aggJoin4011843438655175893 as select v31, v1, v44 from aggJoin6099030526412187842 join aggView6453796183794701735 using(v29);
create or replace TEMP view aggView370611658601307823 as select v31 from aggJoin1012085807195030716 group by v31;
create or replace TEMP view aggJoin6491693944713808899 as select v1, v44 as v44 from aggJoin4011843438655175893 join aggView370611658601307823 using(v31);
create or replace TEMP view aggView8484727031489818713 as select v1, MIN(v44) as v44 from aggJoin6491693944713808899 group by v1,v44;
create or replace TEMP view aggJoin2864798848659070214 as select v2, v44 from semiUp7596596412500783947 join aggView8484727031489818713 using(v1);
create or replace TEMP view res as select MIN(v2) as v43, MIN(v44) as v44 from aggJoin2864798848659070214;
select sum(v43+v44) from res;
