create or replace TEMP view aggView7500490529794311165 as select id as v22 from company_type as ct;
create or replace TEMP view aggJoin4844421928810218579 as select movie_id as v31, company_id as v15 from movie_companies as mc, aggView7500490529794311165 where mc.company_type_id=aggView7500490529794311165.v22;
create or replace TEMP view aggView6221924400681926968 as select id as v29 from role_type as rt where (role = 'actor');
create or replace TEMP view aggJoin2531543764159274426 as select movie_id as v31, person_role_id as v1, note as v12 from cast_info as ci, aggView6221924400681926968 where ci.role_id=aggView6221924400681926968.v29 and (note LIKE '%(producer)%');
create or replace TEMP view aggView2405423920873643582 as select id as v15 from company_name as cn where (country_code = '[ru]');
create or replace TEMP view aggJoin8333842855089165858 as select v31 from aggJoin4844421928810218579 join aggView2405423920873643582 using(v15);
create or replace TEMP view aggView1237934706304524975 as select v31, COUNT(*) as annot from aggJoin8333842855089165858 group by v31;
create or replace TEMP view aggJoin8514596010387631456 as select v31, v1, v12, annot from aggJoin2531543764159274426 join aggView1237934706304524975 using(v31);
create or replace TEMP view aggView5257652629204206714 as select id as v1, name as v43 from char_name as chn;
create or replace TEMP view aggJoin8829443105707185892 as select v31, v12, annot, v43 as v43 from aggJoin8514596010387631456 join aggView5257652629204206714 using(v1);
create or replace TEMP view aggView5416515142710499087 as select v31, MIN(v43) as v43, SUM(annot) as annot from aggJoin8829443105707185892 group by v31;
create or replace TEMP view aggJoin5533287710447548672 as select title as v32, production_year as v35, v43, annot from title as t, aggView5416515142710499087 where t.id=aggView5416515142710499087.v31 and (production_year > 2010);
create or replace TEMP view res as select MIN(v43) as v43, MIN(v32) as v44 from aggJoin5533287710447548672;
select sum(v43+v44) from res;