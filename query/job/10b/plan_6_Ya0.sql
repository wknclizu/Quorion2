create or replace TEMP view semiUp7791248382435323610 as select movie_id as v31, company_id as v15, company_type_id as v22 from movie_companies AS mc where (company_type_id) in (select id from company_type AS ct);
create or replace TEMP view semiUp1565277022329973446 as select v31, v15, v22 from semiUp7791248382435323610 where (v15) in (select id from company_name AS cn where (country_code = '[ru]'));
create or replace TEMP view semiUp8558069891452089448 as select movie_id as v31, person_role_id as v1, role_id as v29 from cast_info AS ci where (person_role_id) in (select id from char_name AS chn) and (note LIKE '%(producer)%');
create or replace TEMP view semiUp2555914977634876810 as select v31, v1, v29 from semiUp8558069891452089448 where (v31) in (select v31 from semiUp1565277022329973446);
create or replace TEMP view semiUp7895889497567665140 as select v31, v1, v29 from semiUp2555914977634876810 where (v29) in (select id from role_type AS rt where (role = 'actor'));
create or replace TEMP view semiUp4646932118636685218 as select id as v31, title as v32 from title AS t where (id) in (select v31 from semiUp7895889497567665140) and (production_year > 2010);
create or replace TEMP view semiDown183258700536075988 as select v31, v1, v29 from semiUp7895889497567665140 where (v31) in (select v31 from semiUp4646932118636685218);
create or replace TEMP view semiDown628792155001928964 as select id as v29 from role_type AS rt where (id) in (select v29 from semiDown183258700536075988) and (role = 'actor');
create or replace TEMP view semiDown4129728700812533358 as select v31, v15, v22 from semiUp1565277022329973446 where (v31) in (select v31 from semiDown183258700536075988);
create or replace TEMP view semiDown1995305056326348905 as select id as v1, name as v2 from char_name AS chn where (id) in (select v1 from semiDown183258700536075988);
create or replace TEMP view semiDown2400565448000493435 as select id as v22 from company_type AS ct where (id) in (select v22 from semiDown4129728700812533358);
create or replace TEMP view semiDown271423529283398501 as select id as v15 from company_name AS cn where (id) in (select v15 from semiDown4129728700812533358) and (country_code = '[ru]');
create or replace TEMP view aggView5158606604365729453 as select v22 from semiDown2400565448000493435;
create or replace TEMP view aggJoin6013905915813878852 as select v31, v15 from semiDown4129728700812533358 join aggView5158606604365729453 using(v22);
create or replace TEMP view aggView8783692077739783026 as select v29 from semiDown628792155001928964;
create or replace TEMP view aggJoin986234910145942475 as select v31, v1 from semiDown183258700536075988 join aggView8783692077739783026 using(v29);
create or replace TEMP view aggView677682354905848696 as select v15 from semiDown271423529283398501;
create or replace TEMP view aggJoin3921379427779101145 as select v31 from aggJoin6013905915813878852 join aggView677682354905848696 using(v15);
create or replace TEMP view aggView1376427007745974730 as select v31 from aggJoin3921379427779101145 group by v31;
create or replace TEMP view aggJoin6670522888684644906 as select v31, v1 from aggJoin986234910145942475 join aggView1376427007745974730 using(v31);
create or replace TEMP view aggView2345904160035372707 as select v1, v2 as v43 from semiDown1995305056326348905;
create or replace TEMP view aggJoin1259534864736003372 as select v31, v43 from aggJoin6670522888684644906 join aggView2345904160035372707 using(v1);
create or replace TEMP view aggView7880373461490673260 as select v31, MIN(v43) as v43 from aggJoin1259534864736003372 group by v31,v43;
create or replace TEMP view aggJoin3763383510602146110 as select v32, v43 from semiUp4646932118636685218 join aggView7880373461490673260 using(v31);
create or replace TEMP view res as select MIN(v43) as v43, MIN(v32) as v44 from aggJoin3763383510602146110;
select sum(v43+v44) from res;
