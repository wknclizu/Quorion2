create or replace TEMP view aggView5553524804051907924 as select id as v22 from company_type as ct;
create or replace TEMP view aggJoin1851024150266180200 as select movie_id as v31, company_id as v15 from movie_companies as mc, aggView5553524804051907924 where mc.company_type_id=aggView5553524804051907924.v22;
create or replace TEMP view aggView5303678011986087905 as select id as v15 from company_name as cn where (country_code = '[ru]');
create or replace TEMP view aggJoin2486137820649011702 as select v31 from aggJoin1851024150266180200 join aggView5303678011986087905 using(v15);
create or replace TEMP view aggView7322963724055611934 as select v31, COUNT(*) as annot from aggJoin2486137820649011702 group by v31;
create or replace TEMP view aggJoin1199166911752984974 as select id as v31, title as v32, production_year as v35, annot from title as t, aggView7322963724055611934 where t.id=aggView7322963724055611934.v31 and (production_year > 2010);
create or replace TEMP view aggView6643022495718564626 as select v31, MIN(v32) as v44, SUM(annot) as annot from aggJoin1199166911752984974 group by v31;
create or replace TEMP view aggJoin3538259539474522200 as select person_role_id as v1, note as v12, role_id as v29, v44, annot from cast_info as ci, aggView6643022495718564626 where ci.movie_id=aggView6643022495718564626.v31 and (note LIKE '%(producer)%');
create or replace TEMP view aggView7294040748926933375 as select id as v29 from role_type as rt where (role = 'actor');
create or replace TEMP view aggJoin8223862879879371860 as select v1, v12, v44, annot from aggJoin3538259539474522200 join aggView7294040748926933375 using(v29);
create or replace TEMP view aggView1456007453674603309 as select v1, MIN(v44) as v44, SUM(annot) as annot from aggJoin8223862879879371860 group by v1;
create or replace TEMP view aggJoin2452409311943303394 as select name as v2, v44, annot from char_name as chn, aggView1456007453674603309 where chn.id=aggView1456007453674603309.v1;
create or replace TEMP view res as select MIN(v2) as v43, MIN(v44) as v44 from aggJoin2452409311943303394;
select sum(v43+v44) from res;