create or replace TEMP view semiUp568439036488260284 as select movie_id as v31, company_id as v15, company_type_id as v22 from movie_companies AS mc where (company_type_id) in (select id from company_type AS ct);
create or replace TEMP view semiUp8942574441129531628 as select movie_id as v31, person_role_id as v1, role_id as v29 from cast_info AS ci where (role_id) in (select id from role_type AS rt where (role = 'actor')) and (note LIKE '%(producer)%');
create or replace TEMP view semiUp2403055157047948478 as select v31, v1, v29 from semiUp8942574441129531628 where (v1) in (select id from char_name AS chn);
create or replace TEMP view semiUp396861255088388832 as select v31, v15, v22 from semiUp568439036488260284 where (v31) in (select v31 from semiUp2403055157047948478);
create or replace TEMP view semiUp1276028827337642128 as select v31, v15, v22 from semiUp396861255088388832 where (v31) in (select id from title AS t where (production_year > 2010));
create or replace TEMP view semiUp87493692262056027 as select id as v15 from company_name AS cn where (id) in (select v15 from semiUp1276028827337642128) and (country_code = '[ru]');
create or replace TEMP view semiDown1527846966025520035 as select v31, v15, v22 from semiUp1276028827337642128 where (v15) in (select v15 from semiUp87493692262056027);
create or replace TEMP view semiDown6445749642727116772 as select id as v22 from company_type AS ct where (id) in (select v22 from semiDown1527846966025520035);
create or replace TEMP view semiDown2442727666140383435 as select id as v31, title as v32 from title AS t where (id) in (select v31 from semiDown1527846966025520035) and (production_year > 2010);
create or replace TEMP view semiDown8208005420430567202 as select v31, v1, v29 from semiUp2403055157047948478 where (v31) in (select v31 from semiDown1527846966025520035);
create or replace TEMP view semiDown4001101301997991764 as select id as v29 from role_type AS rt where (id) in (select v29 from semiDown8208005420430567202) and (role = 'actor');
create or replace TEMP view semiDown6282275306003492482 as select id as v1, name as v2 from char_name AS chn where (id) in (select v1 from semiDown8208005420430567202);
create or replace TEMP view aggView106540999703701995 as select v29 from semiDown4001101301997991764;
create or replace TEMP view aggJoin1835095111375078991 as select v31, v1 from semiDown8208005420430567202 join aggView106540999703701995 using(v29);
create or replace TEMP view aggView4584170525824604285 as select v31, v32 as v44 from semiDown2442727666140383435;
create or replace TEMP view aggJoin6873467835095354965 as select v31, v15, v22, v44 from semiDown1527846966025520035 join aggView4584170525824604285 using(v31);
create or replace TEMP view aggView6609236318947762840 as select v1, v2 as v43 from semiDown6282275306003492482;
create or replace TEMP view aggJoin7401360926556852292 as select v31, v43 from aggJoin1835095111375078991 join aggView6609236318947762840 using(v1);
create or replace TEMP view aggView2355877388663260933 as select v22 from semiDown6445749642727116772;
create or replace TEMP view aggJoin3918662472580754815 as select v31, v15, v44 from aggJoin6873467835095354965 join aggView2355877388663260933 using(v22);
create or replace TEMP view aggView7544518504776114363 as select v31, MIN(v43) as v43 from aggJoin7401360926556852292 group by v31,v43;
create or replace TEMP view aggJoin3409531439099453384 as select v15, v44 as v44, v43 from aggJoin3918662472580754815 join aggView7544518504776114363 using(v31);
create or replace TEMP view aggView1908286433604110448 as select v15, MIN(v44) as v44, MIN(v43) as v43 from aggJoin3409531439099453384 group by v15,v44,v43;
create or replace TEMP view aggJoin1349950288069130049 as select v44, v43 from semiUp87493692262056027 join aggView1908286433604110448 using(v15);
create or replace TEMP view res as select MIN(v43) as v43, MIN(v44) as v44 from aggJoin1349950288069130049;
select sum(v43+v44) from res;
