create or replace TEMP view aggView7867901398804012541 as select id as v29 from role_type as rt where (role = 'actor');
create or replace TEMP view aggJoin2285447576838957194 as select movie_id as v31, person_role_id as v1, note as v12 from cast_info as ci, aggView7867901398804012541 where ci.role_id=aggView7867901398804012541.v29 and (note LIKE '%(producer)%');
create or replace TEMP view aggView2419820927902950681 as select id as v31, title as v44 from title as t where (production_year > 2010);
create or replace TEMP view aggJoin2946872368508919489 as select movie_id as v31, company_id as v15, company_type_id as v22, v44 from movie_companies as mc, aggView2419820927902950681 where mc.movie_id=aggView2419820927902950681.v31;
create or replace TEMP view aggView2042810796610094939 as select id as v1, name as v43 from char_name as chn;
create or replace TEMP view aggJoin8682802339373343690 as select v31, v12, v43 from aggJoin2285447576838957194 join aggView2042810796610094939 using(v1);
create or replace TEMP view aggView8059993127451616027 as select id as v22 from company_type as ct;
create or replace TEMP view aggJoin803689663532753382 as select v31, v15, v44 from aggJoin2946872368508919489 join aggView8059993127451616027 using(v22);
create or replace TEMP view aggView303646181966538708 as select id as v15 from company_name as cn where (country_code = '[ru]');
create or replace TEMP view aggJoin8145101502948113398 as select v31, v44 from aggJoin803689663532753382 join aggView303646181966538708 using(v15);
create or replace TEMP view aggView8324997034145376227 as select v31, MIN(v43) as v43, COUNT(*) as annot from aggJoin8682802339373343690 group by v31;
create or replace TEMP view aggJoin517226525802221193 as select v44 as v44, v43, annot from aggJoin8145101502948113398 join aggView8324997034145376227 using(v31);
create or replace TEMP view res as select MIN(v43) as v43, MIN(v44) as v44 from aggJoin517226525802221193;
select sum(v43+v44) from res;