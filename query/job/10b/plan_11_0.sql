create or replace TEMP view aggView1821989697677303193 as select id as v29 from role_type as rt where (role = 'actor');
create or replace TEMP view aggJoin2875749148633698198 as select movie_id as v31, person_role_id as v1, note as v12 from cast_info as ci, aggView1821989697677303193 where ci.role_id=aggView1821989697677303193.v29 and (note LIKE '%(producer)%');
create or replace TEMP view aggView9018545094254833899 as select id as v31, title as v44 from title as t where (production_year > 2010);
create or replace TEMP view aggJoin99351383012457026 as select movie_id as v31, company_id as v15, company_type_id as v22, v44 from movie_companies as mc, aggView9018545094254833899 where mc.movie_id=aggView9018545094254833899.v31;
create or replace TEMP view aggView625454789320070559 as select id as v1, name as v43 from char_name as chn;
create or replace TEMP view aggJoin3397601355358827359 as select v31, v12, v43 from aggJoin2875749148633698198 join aggView625454789320070559 using(v1);
create or replace TEMP view aggView6083398494355449449 as select id as v22 from company_type as ct;
create or replace TEMP view aggJoin1550923566086081642 as select v31, v15, v44 from aggJoin99351383012457026 join aggView6083398494355449449 using(v22);
create or replace TEMP view aggView8127896386419495526 as select id as v15 from company_name as cn where (country_code = '[ru]');
create or replace TEMP view aggJoin706320629528588288 as select v31, v44 from aggJoin1550923566086081642 join aggView8127896386419495526 using(v15);
create or replace TEMP view aggView510835207217561120 as select v31, MIN(v43) as v43, COUNT(*) as annot from aggJoin3397601355358827359 group by v31;
create or replace TEMP view aggJoin6521592142099899203 as select v44 as v44, v43, annot from aggJoin706320629528588288 join aggView510835207217561120 using(v31);
create or replace TEMP view res as select MIN(v43) as v43, MIN(v44) as v44 from aggJoin6521592142099899203;
select sum(v43+v44) from res;