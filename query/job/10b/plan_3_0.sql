create or replace TEMP view aggView5241427845041989443 as select id as v31, title as v44 from title as t where (production_year > 2010);
create or replace TEMP view aggJoin4012695832086797149 as select movie_id as v31, person_role_id as v1, note as v12, role_id as v29, v44 from cast_info as ci, aggView5241427845041989443 where ci.movie_id=aggView5241427845041989443.v31 and (note LIKE '%(producer)%');
create or replace TEMP view aggView1636147142366180055 as select id as v15 from company_name as cn where (country_code = '[ru]');
create or replace TEMP view aggJoin149412860982541410 as select movie_id as v31, company_type_id as v22 from movie_companies as mc, aggView1636147142366180055 where mc.company_id=aggView1636147142366180055.v15;
create or replace TEMP view aggView2915319835272391941 as select id as v29 from role_type as rt where (role = 'actor');
create or replace TEMP view aggJoin5701138609797922583 as select v31, v1, v12, v44 from aggJoin4012695832086797149 join aggView2915319835272391941 using(v29);
create or replace TEMP view aggView7369064443312373583 as select id as v1, name as v43 from char_name as chn;
create or replace TEMP view aggJoin1980083549277587647 as select v31, v12, v44, v43 from aggJoin5701138609797922583 join aggView7369064443312373583 using(v1);
create or replace TEMP view aggView8727606574971167185 as select v31, MIN(v44) as v44, MIN(v43) as v43, COUNT(*) as annot from aggJoin1980083549277587647 group by v31;
create or replace TEMP view aggJoin8962180433762400035 as select v22, v44, v43, annot from aggJoin149412860982541410 join aggView8727606574971167185 using(v31);
create or replace TEMP view aggView6542854737233977701 as select v22, MIN(v44) as v44, MIN(v43) as v43, SUM(annot) as annot from aggJoin8962180433762400035 group by v22;
create or replace TEMP view aggJoin8405021799018801291 as select v44, v43, annot from company_type as ct, aggView6542854737233977701 where ct.id=aggView6542854737233977701.v22;
create or replace TEMP view res as select MIN(v43) as v43, MIN(v44) as v44 from aggJoin8405021799018801291;
select sum(v43+v44) from res;