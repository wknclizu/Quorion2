create or replace TEMP view semiUp7489172136156072720 as select movie_id as v31, person_role_id as v1, role_id as v29 from cast_info AS ci where (role_id) in (select id from role_type AS rt where (role = 'actor')) and (note LIKE '%(producer)%');
create or replace TEMP view semiUp6183992450439087563 as select v31, v1, v29 from semiUp7489172136156072720 where (v1) in (select id from char_name AS chn);
create or replace TEMP view semiUp1692700595804578124 as select movie_id as v31, company_id as v15, company_type_id as v22 from movie_companies AS mc where (company_type_id) in (select id from company_type AS ct);
create or replace TEMP view semiUp6659302643334771691 as select v31, v15, v22 from semiUp1692700595804578124 where (v15) in (select id from company_name AS cn where (country_code = '[ru]'));
create or replace TEMP view semiUp3288706085980998061 as select v31, v15, v22 from semiUp6659302643334771691 where (v31) in (select v31 from semiUp6183992450439087563);
create or replace TEMP view semiUp7071846403481227458 as select id as v31, title as v32 from title AS t where (id) in (select v31 from semiUp3288706085980998061) and (production_year > 2010);
create or replace TEMP view semiDown6442719742114577461 as select v31, v15, v22 from semiUp3288706085980998061 where (v31) in (select v31 from semiUp7071846403481227458);
create or replace TEMP view semiDown8638306583845096497 as select id as v22 from company_type AS ct where (id) in (select v22 from semiDown6442719742114577461);
create or replace TEMP view semiDown3557571952519190417 as select id as v15 from company_name AS cn where (id) in (select v15 from semiDown6442719742114577461) and (country_code = '[ru]');
create or replace TEMP view semiDown3610707310958345759 as select v31, v1, v29 from semiUp6183992450439087563 where (v31) in (select v31 from semiDown6442719742114577461);
create or replace TEMP view semiDown812372018878680028 as select id as v29 from role_type AS rt where (id) in (select v29 from semiDown3610707310958345759) and (role = 'actor');
create or replace TEMP view semiDown2058585207381345734 as select id as v1, name as v2 from char_name AS chn where (id) in (select v1 from semiDown3610707310958345759);
create or replace TEMP view aggView7455218057077861629 as select v1, v2 as v43 from semiDown2058585207381345734;
create or replace TEMP view aggJoin5639620551856108583 as select v31, v29, v43 from semiDown3610707310958345759 join aggView7455218057077861629 using(v1);
create or replace TEMP view aggView6556893787910587026 as select v29 from semiDown812372018878680028;
create or replace TEMP view aggJoin3337845837363015459 as select v31, v43 from aggJoin5639620551856108583 join aggView6556893787910587026 using(v29);
create or replace TEMP view aggView6097868165171730694 as select v31, MIN(v43) as v43 from aggJoin3337845837363015459 group by v31,v43;
create or replace TEMP view aggJoin1623528172705434561 as select v31, v15, v22, v43 from semiDown6442719742114577461 join aggView6097868165171730694 using(v31);
create or replace TEMP view aggView3340468000272709886 as select v22 from semiDown8638306583845096497;
create or replace TEMP view aggJoin1472971083665735663 as select v31, v15, v43 from aggJoin1623528172705434561 join aggView3340468000272709886 using(v22);
create or replace TEMP view aggView947568684470907924 as select v15 from semiDown3557571952519190417;
create or replace TEMP view aggJoin1422372826922791415 as select v31, v43 from aggJoin1472971083665735663 join aggView947568684470907924 using(v15);
create or replace TEMP view aggView3230457400087627456 as select v31, MIN(v43) as v43 from aggJoin1422372826922791415 group by v31,v43;
create or replace TEMP view aggJoin6514014707753556823 as select v32, v43 from semiUp7071846403481227458 join aggView3230457400087627456 using(v31);
create or replace TEMP view res as select MIN(v43) as v43, MIN(v32) as v44 from aggJoin6514014707753556823;
select sum(v43+v44) from res;
