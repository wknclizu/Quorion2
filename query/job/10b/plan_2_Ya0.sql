create or replace TEMP view semiUp2578405745497711494 as select movie_id as v31, person_role_id as v1, role_id as v29 from cast_info AS ci where (person_role_id) in (select id from char_name AS chn) and (note LIKE '%(producer)%');
create or replace TEMP view semiUp8915228525386370610 as select v31, v1, v29 from semiUp2578405745497711494 where (v29) in (select id from role_type AS rt where (role = 'actor'));
create or replace TEMP view semiUp6826074351425109035 as select movie_id as v31, company_id as v15, company_type_id as v22 from movie_companies AS mc where (company_type_id) in (select id from company_type AS ct);
create or replace TEMP view semiUp4774024456972062453 as select v31, v1, v29 from semiUp8915228525386370610 where (v31) in (select id from title AS t where (production_year > 2010));
create or replace TEMP view semiUp7547492693050335711 as select v31, v15, v22 from semiUp6826074351425109035 where (v31) in (select v31 from semiUp4774024456972062453);
create or replace TEMP view semiUp174182160903094000 as select id as v15 from company_name AS cn where (id) in (select v15 from semiUp7547492693050335711) and (country_code = '[ru]');
create or replace TEMP view semiDown786048414486882498 as select v31, v15, v22 from semiUp7547492693050335711 where (v15) in (select v15 from semiUp174182160903094000);
create or replace TEMP view semiDown386794989738266867 as select id as v22 from company_type AS ct where (id) in (select v22 from semiDown786048414486882498);
create or replace TEMP view semiDown7813702255774315730 as select v31, v1, v29 from semiUp4774024456972062453 where (v31) in (select v31 from semiDown786048414486882498);
create or replace TEMP view semiDown9001321509343779961 as select id as v29 from role_type AS rt where (id) in (select v29 from semiDown7813702255774315730) and (role = 'actor');
create or replace TEMP view semiDown8400941736447901170 as select id as v31, title as v32 from title AS t where (id) in (select v31 from semiDown7813702255774315730) and (production_year > 2010);
create or replace TEMP view semiDown2347837987474876420 as select id as v1, name as v2 from char_name AS chn where (id) in (select v1 from semiDown7813702255774315730);
create or replace TEMP view aggView2006842900839051387 as select v31, v32 as v44 from semiDown8400941736447901170;
create or replace TEMP view aggJoin659598325577938418 as select v31, v1, v29, v44 from semiDown7813702255774315730 join aggView2006842900839051387 using(v31);
create or replace TEMP view aggView7846899870893952513 as select v22 from semiDown386794989738266867;
create or replace TEMP view aggJoin2135487209390047462 as select v31, v15 from semiDown786048414486882498 join aggView7846899870893952513 using(v22);
create or replace TEMP view aggView4569198079785241580 as select v29 from semiDown9001321509343779961;
create or replace TEMP view aggJoin1337575751980289938 as select v31, v1, v44 from aggJoin659598325577938418 join aggView4569198079785241580 using(v29);
create or replace TEMP view aggView7005214666476005384 as select v1, v2 as v43 from semiDown2347837987474876420;
create or replace TEMP view aggJoin4898507375533638873 as select v31, v44, v43 from aggJoin1337575751980289938 join aggView7005214666476005384 using(v1);
create or replace TEMP view aggView5256454851841009809 as select v31, MIN(v44) as v44, MIN(v43) as v43 from aggJoin4898507375533638873 group by v31,v44,v43;
create or replace TEMP view aggJoin8293444580748897462 as select v15, v44, v43 from aggJoin2135487209390047462 join aggView5256454851841009809 using(v31);
create or replace TEMP view aggView2933953456057132644 as select v15, MIN(v44) as v44, MIN(v43) as v43 from aggJoin8293444580748897462 group by v15,v44,v43;
create or replace TEMP view aggJoin7046807098586659161 as select v44, v43 from semiUp174182160903094000 join aggView2933953456057132644 using(v15);
create or replace TEMP view res as select MIN(v43) as v43, MIN(v44) as v44 from aggJoin7046807098586659161;
select sum(v43+v44) from res;
