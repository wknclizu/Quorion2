create or replace TEMP view aggView5394154498614298545 as select id as v29 from role_type as rt where (role = 'actor');
create or replace TEMP view aggJoin6354082069070326460 as select movie_id as v31, person_role_id as v1, note as v12 from cast_info as ci, aggView5394154498614298545 where ci.role_id=aggView5394154498614298545.v29 and (note LIKE '%(producer)%');
create or replace TEMP view aggView4344636270866508942 as select id as v1, name as v43 from char_name as chn;
create or replace TEMP view aggJoin2012709732981423221 as select v31, v12, v43 from aggJoin6354082069070326460 join aggView4344636270866508942 using(v1);
create or replace TEMP view aggView2054542875713951109 as select v31, MIN(v43) as v43, COUNT(*) as annot from aggJoin2012709732981423221 group by v31;
create or replace TEMP view aggJoin5140502877284100191 as select id as v31, title as v32, production_year as v35, v43, annot from title as t, aggView2054542875713951109 where t.id=aggView2054542875713951109.v31 and (production_year > 2010);
create or replace TEMP view aggView5639391198914222683 as select v31, MIN(v43) as v43, MIN(v32) as v44, SUM(annot) as annot from aggJoin5140502877284100191 group by v31;
create or replace TEMP view aggJoin1101394643971661011 as select company_id as v15, company_type_id as v22, v43, v44, annot from movie_companies as mc, aggView5639391198914222683 where mc.movie_id=aggView5639391198914222683.v31;
create or replace TEMP view aggView3745275756081089271 as select id as v22 from company_type as ct;
create or replace TEMP view aggJoin5994260724601792661 as select v15, v43, v44, annot from aggJoin1101394643971661011 join aggView3745275756081089271 using(v22);
create or replace TEMP view aggView4760064225316364179 as select v15, MIN(v43) as v43, MIN(v44) as v44, SUM(annot) as annot from aggJoin5994260724601792661 group by v15;
create or replace TEMP view aggJoin852677594023969469 as select country_code as v17, v43, v44, annot from company_name as cn, aggView4760064225316364179 where cn.id=aggView4760064225316364179.v15 and (country_code = '[ru]');
create or replace TEMP view res as select MIN(v43) as v43, MIN(v44) as v44 from aggJoin852677594023969469;
select sum(v43+v44) from res;