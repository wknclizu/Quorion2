create or replace TEMP view aggView1205399599103478234 as select id as v22 from company_type as ct;
create or replace TEMP view aggJoin41350246569081784 as select movie_id as v31, company_id as v15 from movie_companies as mc, aggView1205399599103478234 where mc.company_type_id=aggView1205399599103478234.v22;
create or replace TEMP view aggView7360958056756069998 as select id as v15 from company_name as cn where (country_code = '[ru]');
create or replace TEMP view aggJoin5811130838422083946 as select v31 from aggJoin41350246569081784 join aggView7360958056756069998 using(v15);
create or replace TEMP view aggView5798284662785173749 as select v31, COUNT(*) as annot from aggJoin5811130838422083946 group by v31;
create or replace TEMP view aggJoin1539070586169536516 as select id as v31, title as v32, production_year as v35, annot from title as t, aggView5798284662785173749 where t.id=aggView5798284662785173749.v31 and (production_year > 2010);
create or replace TEMP view aggView4022982833328727087 as select v31, MIN(v32) as v44, SUM(annot) as annot from aggJoin1539070586169536516 group by v31;
create or replace TEMP view aggJoin203654622379814121 as select person_role_id as v1, note as v12, role_id as v29, v44, annot from cast_info as ci, aggView4022982833328727087 where ci.movie_id=aggView4022982833328727087.v31 and (note LIKE '%(producer)%');
create or replace TEMP view aggView1337819927755106495 as select id as v1, name as v43 from char_name as chn;
create or replace TEMP view aggJoin1556453826261970028 as select v12, v29, v44, annot, v43 as v43 from aggJoin203654622379814121 join aggView1337819927755106495 using(v1);
create or replace TEMP view aggView4906301314854491510 as select v29, MIN(v44) as v44, MIN(v43) as v43, SUM(annot) as annot from aggJoin1556453826261970028 group by v29;
create or replace TEMP view aggJoin6040662046005027934 as select role as v30, v44, v43, annot from role_type as rt, aggView4906301314854491510 where rt.id=aggView4906301314854491510.v29 and (role = 'actor');
create or replace TEMP view res as select MIN(v43) as v43, MIN(v44) as v44 from aggJoin6040662046005027934;
select sum(v43+v44) from res;