create or replace TEMP view semiUp5327742649400438837 as select movie_id as v31, person_role_id as v1, role_id as v29 from cast_info AS ci where (person_role_id) in (select id from char_name AS chn) and (note LIKE '%(producer)%');
create or replace TEMP view semiUp7472482912528130858 as select movie_id as v31, company_id as v15, company_type_id as v22 from movie_companies AS mc where (company_type_id) in (select id from company_type AS ct);
create or replace TEMP view semiUp5709235262541212139 as select v31, v1, v29 from semiUp5327742649400438837 where (v29) in (select id from role_type AS rt where (role = 'actor'));
create or replace TEMP view semiUp5258766522323311604 as select id as v31, title as v32 from title AS t where (id) in (select v31 from semiUp5709235262541212139) and (production_year > 2010);
create or replace TEMP view semiUp3077920279802035997 as select v31, v15, v22 from semiUp7472482912528130858 where (v31) in (select v31 from semiUp5258766522323311604);
create or replace TEMP view semiUp7184168621842707806 as select id as v15 from company_name AS cn where (id) in (select v15 from semiUp3077920279802035997) and (country_code = '[ru]');
create or replace TEMP view semiDown5538448655143112374 as select v31, v15, v22 from semiUp3077920279802035997 where (v15) in (select v15 from semiUp7184168621842707806);
create or replace TEMP view semiDown1308276882232862991 as select id as v22 from company_type AS ct where (id) in (select v22 from semiDown5538448655143112374);
create or replace TEMP view semiDown4428713939454153514 as select v31, v32 from semiUp5258766522323311604 where (v31) in (select v31 from semiDown5538448655143112374);
create or replace TEMP view semiDown925927974805695491 as select v31, v1, v29 from semiUp5709235262541212139 where (v31) in (select v31 from semiDown4428713939454153514);
create or replace TEMP view semiDown8521028708728539588 as select id as v29 from role_type AS rt where (id) in (select v29 from semiDown925927974805695491) and (role = 'actor');
create or replace TEMP view semiDown826375745529338655 as select id as v1, name as v2 from char_name AS chn where (id) in (select v1 from semiDown925927974805695491);
create or replace TEMP view aggView1866856653736243949 as select v29 from semiDown8521028708728539588;
create or replace TEMP view aggJoin5762277930925037913 as select v31, v1 from semiDown925927974805695491 join aggView1866856653736243949 using(v29);
create or replace TEMP view aggView3203567011646765281 as select v1, v2 as v43 from semiDown826375745529338655;
create or replace TEMP view aggJoin633002907293244707 as select v31, v43 from aggJoin5762277930925037913 join aggView3203567011646765281 using(v1);
create or replace TEMP view aggView928153582001219119 as select v31, MIN(v43) as v43 from aggJoin633002907293244707 group by v31,v43;
create or replace TEMP view aggJoin6042193883164309110 as select v31, v32, v43 from semiDown4428713939454153514 join aggView928153582001219119 using(v31);
create or replace TEMP view aggView1578352184945297818 as select v31, MIN(v43) as v43, MIN(v32) as v44 from aggJoin6042193883164309110 group by v31,v43;
create or replace TEMP view aggJoin703624605421959593 as select v15, v22, v43, v44 from semiDown5538448655143112374 join aggView1578352184945297818 using(v31);
create or replace TEMP view aggView3720284871211879275 as select v22 from semiDown1308276882232862991;
create or replace TEMP view aggJoin791018527477390787 as select v15, v43, v44 from aggJoin703624605421959593 join aggView3720284871211879275 using(v22);
create or replace TEMP view aggView8004305524055226364 as select v15, MIN(v43) as v43, MIN(v44) as v44 from aggJoin791018527477390787 group by v15,v44,v43;
create or replace TEMP view aggJoin8738947202775347680 as select v43, v44 from semiUp7184168621842707806 join aggView8004305524055226364 using(v15);
create or replace TEMP view res as select MIN(v43) as v43, MIN(v44) as v44 from aggJoin8738947202775347680;
select sum(v43+v44) from res;
