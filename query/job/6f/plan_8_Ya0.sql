create or replace TEMP view semiUp5440555457120465082 as select person_id as v14, movie_id as v23 from cast_info AS ci where (movie_id) in (select id from title AS t where (production_year > 2000));
create or replace TEMP view semiUp1056695586508111040 as select movie_id as v23, keyword_id as v8 from movie_keyword AS mk where (keyword_id) in (select id from keyword AS k where (keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence')));
create or replace TEMP view semiUp7505638949991299824 as select v14, v23 from semiUp5440555457120465082 where (v23) in (select v23 from semiUp1056695586508111040);
create or replace TEMP view semiUp4436911397304675651 as select id as v14, name as v15 from name AS n where (id) in (select v14 from semiUp7505638949991299824);
create or replace TEMP view semiDown1074336039636613923 as select v14, v23 from semiUp7505638949991299824 where (v14) in (select v14 from semiUp4436911397304675651);
create or replace TEMP view semiDown67371893953442163 as select id as v23, title as v24 from title AS t where (id) in (select v23 from semiDown1074336039636613923) and (production_year > 2000);
create or replace TEMP view semiDown2206962685313246070 as select v23, v8 from semiUp1056695586508111040 where (v23) in (select v23 from semiDown1074336039636613923);
create or replace TEMP view semiDown2002958801190607616 as select id as v8, keyword as v9 from keyword AS k where (id) in (select v8 from semiDown2206962685313246070) and (keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence'));
create or replace TEMP view aggView6165816872646225288 as select v8, v9 as v35 from semiDown2002958801190607616;
create or replace TEMP view aggJoin4827355512809665136 as select v23, v35 from semiDown2206962685313246070 join aggView6165816872646225288 using(v8);
create or replace TEMP view aggView1573961895885851013 as select v23, v24 as v37 from semiDown67371893953442163;
create or replace TEMP view aggJoin197570321343105476 as select v14, v23, v37 from semiDown1074336039636613923 join aggView1573961895885851013 using(v23);
create or replace TEMP view aggView8307929908453987471 as select v23, MIN(v35) as v35 from aggJoin4827355512809665136 group by v23,v35;
create or replace TEMP view aggJoin857012608978254191 as select v14, v37 as v37, v35 from aggJoin197570321343105476 join aggView8307929908453987471 using(v23);
create or replace TEMP view aggView5482337761486488446 as select v14, MIN(v37) as v37, MIN(v35) as v35 from aggJoin857012608978254191 group by v14,v37,v35;
create or replace TEMP view aggJoin6596284222023548933 as select v15, v37, v35 from semiUp4436911397304675651 join aggView5482337761486488446 using(v14);
create or replace TEMP view res as select MIN(v35) as v35, MIN(v15) as v36, MIN(v37) as v37 from aggJoin6596284222023548933;
select sum(v35+v36+v37) from res;
