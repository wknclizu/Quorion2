create or replace TEMP view semiUp6556788236998617569 as select movie_id as v23, keyword_id as v8 from movie_keyword AS mk where (keyword_id) in (select id from keyword AS k where (keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence')));
create or replace TEMP view semiUp7815967469505522031 as select id as v23, title as v24 from title AS t where (id) in (select v23 from semiUp6556788236998617569) and (production_year > 2000);
create or replace TEMP view semiUp4053946939405661869 as select person_id as v14, movie_id as v23 from cast_info AS ci where (movie_id) in (select v23 from semiUp7815967469505522031);
create or replace TEMP view semiUp708577133921582327 as select id as v14, name as v15 from name AS n where (id) in (select v14 from semiUp4053946939405661869);
create or replace TEMP view semiDown1219173625147300628 as select v14, v23 from semiUp4053946939405661869 where (v14) in (select v14 from semiUp708577133921582327);
create or replace TEMP view semiDown8940749759783239002 as select v23, v24 from semiUp7815967469505522031 where (v23) in (select v23 from semiDown1219173625147300628);
create or replace TEMP view semiDown1761832456770472486 as select v23, v8 from semiUp6556788236998617569 where (v23) in (select v23 from semiDown8940749759783239002);
create or replace TEMP view semiDown8024374220943771103 as select id as v8, keyword as v9 from keyword AS k where (id) in (select v8 from semiDown1761832456770472486) and (keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence'));
create or replace TEMP view aggView4833538540759350503 as select v8, v9 as v35 from semiDown8024374220943771103;
create or replace TEMP view aggJoin1166012167338241458 as select v23, v35 from semiDown1761832456770472486 join aggView4833538540759350503 using(v8);
create or replace TEMP view aggView8104820512235136380 as select v23, MIN(v35) as v35 from aggJoin1166012167338241458 group by v23,v35;
create or replace TEMP view aggJoin7521699638866775191 as select v23, v24, v35 from semiDown8940749759783239002 join aggView8104820512235136380 using(v23);
create or replace TEMP view aggView2726042450561356224 as select v23, MIN(v35) as v35, MIN(v24) as v37 from aggJoin7521699638866775191 group by v23,v35;
create or replace TEMP view aggJoin8179754113873568544 as select v14, v35, v37 from semiDown1219173625147300628 join aggView2726042450561356224 using(v23);
create or replace TEMP view aggView1364172013378234499 as select v14, MIN(v35) as v35, MIN(v37) as v37 from aggJoin8179754113873568544 group by v14,v37,v35;
create or replace TEMP view aggJoin3666206323501383120 as select v15, v35, v37 from semiUp708577133921582327 join aggView1364172013378234499 using(v14);
create or replace TEMP view res as select MIN(v35) as v35, MIN(v15) as v36, MIN(v37) as v37 from aggJoin3666206323501383120;
select sum(v35+v36+v37) from res;
