create or replace TEMP view semiUp8477602381462173888 as select movie_id as v23, keyword_id as v8 from movie_keyword AS mk where (keyword_id) in (select id from keyword AS k where (keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence')));
create or replace TEMP view semiUp8886790823955904406 as select id as v23, title as v24 from title AS t where (id) in (select v23 from semiUp8477602381462173888) and (production_year > 2000);
create or replace TEMP view semiUp3070964356423856570 as select person_id as v14, movie_id as v23 from cast_info AS ci where (movie_id) in (select v23 from semiUp8886790823955904406);
create or replace TEMP view semiUp1776634577751296558 as select id as v14, name as v15 from name AS n where (id) in (select v14 from semiUp3070964356423856570);
create or replace TEMP view semiDown5936920657841163839 as select v14, v23 from semiUp3070964356423856570 where (v14) in (select v14 from semiUp1776634577751296558);
create or replace TEMP view semiDown3314359672483052772 as select v23, v24 from semiUp8886790823955904406 where (v23) in (select v23 from semiDown5936920657841163839);
create or replace TEMP view semiDown8135325573952225125 as select v23, v8 from semiUp8477602381462173888 where (v23) in (select v23 from semiDown3314359672483052772);
create or replace TEMP view semiDown8919751486667100525 as select id as v8, keyword as v9 from keyword AS k where (id) in (select v8 from semiDown8135325573952225125) and (keyword IN ('superhero','sequel','second-part','marvel-comics','based-on-comic','tv-special','fight','violence'));
create or replace TEMP view aggView2884472336649919352 as select v8, v9 as v35 from semiDown8919751486667100525;
create or replace TEMP view aggJoin4039540986866268790 as select v23, v35 from semiDown8135325573952225125 join aggView2884472336649919352 using(v8);
create or replace TEMP view aggView5225185290716326944 as select v23, MIN(v35) as v35 from aggJoin4039540986866268790 group by v23,v35;
create or replace TEMP view aggJoin1060853173865016830 as select v23, v24, v35 from semiDown3314359672483052772 join aggView5225185290716326944 using(v23);
create or replace TEMP view aggView6430042453664417743 as select v23, MIN(v35) as v35, MIN(v24) as v37 from aggJoin1060853173865016830 group by v23,v35;
create or replace TEMP view aggJoin4508645919661630910 as select v14, v35, v37 from semiDown5936920657841163839 join aggView6430042453664417743 using(v23);
create or replace TEMP view aggView5731301678087544499 as select v14, MIN(v35) as v35, MIN(v37) as v37 from aggJoin4508645919661630910 group by v14,v37,v35;
create or replace TEMP view aggJoin434649045597830799 as select v15, v35, v37 from semiUp1776634577751296558 join aggView5731301678087544499 using(v14);
create or replace TEMP view res as select MIN(v35) as v35, MIN(v15) as v36, MIN(v37) as v37 from aggJoin434649045597830799;
select sum(v35+v36+v37) from res;
