create or replace TEMP view aggView6514003571076331518 as select id as v22 from company_type as ct;
create or replace TEMP view aggJoin173476550115588487 as select movie_id as v31, company_id as v15 from movie_companies as mc, aggView6514003571076331518 where mc.company_type_id=aggView6514003571076331518.v22;
create or replace TEMP view aggView59799527097397457 as select id as v31, title as v44 from title as t where (production_year > 1990);
create or replace TEMP view aggJoin4922595590929375573 as select movie_id as v31, person_role_id as v1, note as v12, role_id as v29, v44 from cast_info as ci, aggView59799527097397457 where ci.movie_id=aggView59799527097397457.v31 and (note LIKE '%(producer)%');
create or replace TEMP view aggView6261443442369381764 as select id as v15 from company_name as cn where (country_code = '[us]');
create or replace TEMP view aggJoin7406123058918088075 as select v31 from aggJoin173476550115588487 join aggView6261443442369381764 using(v15);
create or replace TEMP view aggView8519276480470218887 as select v31, COUNT(*) as annot from aggJoin7406123058918088075 group by v31;
create or replace TEMP view aggJoin3370775385346551147 as select v1, v12, v29, v44 as v44, annot from aggJoin4922595590929375573 join aggView8519276480470218887 using(v31);
create or replace TEMP view aggView4942880946977007791 as select id as v1, name as v43 from char_name as chn;
create or replace TEMP view aggJoin5527195497656350306 as select v12, v29, v44, annot, v43 as v43 from aggJoin3370775385346551147 join aggView4942880946977007791 using(v1);
create or replace TEMP view aggView761972243116462855 as select v29, MIN(v44) as v44, MIN(v43) as v43, SUM(annot) as annot from aggJoin5527195497656350306 group by v29;
create or replace TEMP view aggJoin1710926705607775061 as select v44, v43, annot from role_type as rt, aggView761972243116462855 where rt.id=aggView761972243116462855.v29;
create or replace TEMP view res as select MIN(v43) as v43, MIN(v44) as v44 from aggJoin1710926705607775061;
select sum(v43+v44) from res;