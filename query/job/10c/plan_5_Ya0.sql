create or replace TEMP view semiUp8681191600598949313 as select movie_id as v31, person_role_id as v1, role_id as v29 from cast_info AS ci where (movie_id) in (select id from title AS t where (production_year > 1990)) and (note LIKE '%(producer)%');
create or replace TEMP view semiUp2400125400705635158 as select v31, v1, v29 from semiUp8681191600598949313 where (v1) in (select id from char_name AS chn);
create or replace TEMP view semiUp4561907385036618352 as select movie_id as v31, company_id as v15, company_type_id as v22 from movie_companies AS mc where (company_type_id) in (select id from company_type AS ct);
create or replace TEMP view semiUp7258986612307859065 as select v31, v15, v22 from semiUp4561907385036618352 where (v15) in (select id from company_name AS cn where (country_code = '[us]'));
create or replace TEMP view semiUp51582327664009520 as select v31, v1, v29 from semiUp2400125400705635158 where (v31) in (select v31 from semiUp7258986612307859065);
create or replace TEMP view semiUp3450187866750704976 as select id as v29 from role_type AS rt where (id) in (select v29 from semiUp51582327664009520);
create or replace TEMP view semiDown7656168687385440159 as select v31, v1, v29 from semiUp51582327664009520 where (v29) in (select v29 from semiUp3450187866750704976);
create or replace TEMP view semiDown7880998932763826025 as select id as v31, title as v32 from title AS t where (id) in (select v31 from semiDown7656168687385440159) and (production_year > 1990);
create or replace TEMP view semiDown7769893748995623689 as select v31, v15, v22 from semiUp7258986612307859065 where (v31) in (select v31 from semiDown7656168687385440159);
create or replace TEMP view semiDown6437501077816345477 as select id as v1, name as v2 from char_name AS chn where (id) in (select v1 from semiDown7656168687385440159);
create or replace TEMP view semiDown2514018641624443266 as select id as v22 from company_type AS ct where (id) in (select v22 from semiDown7769893748995623689);
create or replace TEMP view semiDown6133218784702308186 as select id as v15 from company_name AS cn where (id) in (select v15 from semiDown7769893748995623689) and (country_code = '[us]');
create or replace TEMP view aggView6339905843619220804 as select v22 from semiDown2514018641624443266;
create or replace TEMP view aggJoin1848320359966964773 as select v31, v15 from semiDown7769893748995623689 join aggView6339905843619220804 using(v22);
create or replace TEMP view aggView2792322406658591096 as select v31, v32 as v44 from semiDown7880998932763826025;
create or replace TEMP view aggJoin6774921295261050165 as select v31, v1, v29, v44 from semiDown7656168687385440159 join aggView2792322406658591096 using(v31);
create or replace TEMP view aggView6717940932230787563 as select v15 from semiDown6133218784702308186;
create or replace TEMP view aggJoin8916448807629904077 as select v31 from aggJoin1848320359966964773 join aggView6717940932230787563 using(v15);
create or replace TEMP view aggView791458467944179526 as select v31 from aggJoin8916448807629904077 group by v31;
create or replace TEMP view aggJoin191398361439419995 as select v1, v29, v44 as v44 from aggJoin6774921295261050165 join aggView791458467944179526 using(v31);
create or replace TEMP view aggView1661287439142355028 as select v1, v2 as v43 from semiDown6437501077816345477;
create or replace TEMP view aggJoin5637161803180918614 as select v29, v44, v43 from aggJoin191398361439419995 join aggView1661287439142355028 using(v1);
create or replace TEMP view aggView7390862172945752449 as select v29, MIN(v44) as v44, MIN(v43) as v43 from aggJoin5637161803180918614 group by v29,v44,v43;
create or replace TEMP view aggJoin6226710491528598259 as select v44, v43 from semiUp3450187866750704976 join aggView7390862172945752449 using(v29);
create or replace TEMP view res as select MIN(v43) as v43, MIN(v44) as v44 from aggJoin6226710491528598259;
select sum(v43+v44) from res;
