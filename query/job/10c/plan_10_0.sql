create or replace TEMP view aggView615584395264004558 as select id as v29 from role_type as rt;
create or replace TEMP view aggJoin6202708935333934809 as select movie_id as v31, person_role_id as v1, note as v12 from cast_info as ci, aggView615584395264004558 where ci.role_id=aggView615584395264004558.v29 and (note LIKE '%(producer)%');
create or replace TEMP view aggView1121597564832482820 as select id as v31, title as v44 from title as t where (production_year > 1990);
create or replace TEMP view aggJoin22275579985459736 as select movie_id as v31, company_id as v15, company_type_id as v22, v44 from movie_companies as mc, aggView1121597564832482820 where mc.movie_id=aggView1121597564832482820.v31;
create or replace TEMP view aggView7310845205983381348 as select id as v1, name as v43 from char_name as chn;
create or replace TEMP view aggJoin3376104682026352676 as select v31, v12, v43 from aggJoin6202708935333934809 join aggView7310845205983381348 using(v1);
create or replace TEMP view aggView5460609422983493400 as select id as v15 from company_name as cn where (country_code = '[us]');
create or replace TEMP view aggJoin8307128760777247784 as select v31, v22, v44 from aggJoin22275579985459736 join aggView5460609422983493400 using(v15);
create or replace TEMP view aggView31320659022316555 as select v31, MIN(v43) as v43, COUNT(*) as annot from aggJoin3376104682026352676 group by v31;
create or replace TEMP view aggJoin1947007450268614650 as select v22, v44 as v44, v43, annot from aggJoin8307128760777247784 join aggView31320659022316555 using(v31);
create or replace TEMP view aggView76612625917647310 as select v22, MIN(v44) as v44, MIN(v43) as v43, SUM(annot) as annot from aggJoin1947007450268614650 group by v22;
create or replace TEMP view aggJoin2748747395194239384 as select v44, v43, annot from company_type as ct, aggView76612625917647310 where ct.id=aggView76612625917647310.v22;
create or replace TEMP view res as select MIN(v43) as v43, MIN(v44) as v44 from aggJoin2748747395194239384;
select sum(v43+v44) from res;