create or replace TEMP view aggView5773275779116178836 as select id as v29 from role_type as rt;
create or replace TEMP view aggJoin4957460398859986065 as select movie_id as v31, person_role_id as v1, note as v12 from cast_info as ci, aggView5773275779116178836 where ci.role_id=aggView5773275779116178836.v29 and (note LIKE '%(producer)%');
create or replace TEMP view aggView5481179759311858776 as select id as v31, title as v44 from title as t where (production_year > 1990);
create or replace TEMP view aggJoin2490439105379175641 as select movie_id as v31, company_id as v15, company_type_id as v22, v44 from movie_companies as mc, aggView5481179759311858776 where mc.movie_id=aggView5481179759311858776.v31;
create or replace TEMP view aggView4324593725377801618 as select id as v1, name as v43 from char_name as chn;
create or replace TEMP view aggJoin2746104724612224635 as select v31, v12, v43 from aggJoin4957460398859986065 join aggView4324593725377801618 using(v1);
create or replace TEMP view aggView1209664902748123650 as select id as v15 from company_name as cn where (country_code = '[us]');
create or replace TEMP view aggJoin754793244407825114 as select v31, v22, v44 from aggJoin2490439105379175641 join aggView1209664902748123650 using(v15);
create or replace TEMP view aggView1192893405342596947 as select v31, MIN(v43) as v43, COUNT(*) as annot from aggJoin2746104724612224635 group by v31;
create or replace TEMP view aggJoin7772709041410136140 as select v22, v44 as v44, v43, annot from aggJoin754793244407825114 join aggView1192893405342596947 using(v31);
create or replace TEMP view aggView3604220160010081473 as select v22, MIN(v44) as v44, MIN(v43) as v43, SUM(annot) as annot from aggJoin7772709041410136140 group by v22;
create or replace TEMP view aggJoin8982684926593527514 as select v44, v43, annot from company_type as ct, aggView3604220160010081473 where ct.id=aggView3604220160010081473.v22;
create or replace TEMP view res as select MIN(v43) as v43, MIN(v44) as v44 from aggJoin8982684926593527514;
select sum(v43+v44) from res;