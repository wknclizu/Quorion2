create or replace TEMP view semiUp1678193272996972722 as select movie_id as v31, company_id as v15, company_type_id as v22 from movie_companies AS mc where (company_type_id) in (select id from company_type AS ct);
create or replace TEMP view semiUp4332322527632792864 as select v31, v15, v22 from semiUp1678193272996972722 where (v15) in (select id from company_name AS cn where (country_code = '[us]'));
create or replace TEMP view semiUp4151955681400268954 as select movie_id as v31, person_role_id as v1, role_id as v29 from cast_info AS ci where (person_role_id) in (select id from char_name AS chn) and (note LIKE '%(producer)%');
create or replace TEMP view semiUp7582684581101881412 as select v31, v1, v29 from semiUp4151955681400268954 where (v29) in (select id from role_type AS rt);
create or replace TEMP view semiUp1004095578228897021 as select v31, v1, v29 from semiUp7582684581101881412 where (v31) in (select id from title AS t where (production_year > 1990));
create or replace TEMP view semiUp4170874063238328785 as select v31, v15, v22 from semiUp4332322527632792864 where (v31) in (select v31 from semiUp1004095578228897021);
create or replace TEMP view semiDown2475385059665281490 as select id as v22 from company_type AS ct where (id) in (select v22 from semiUp4170874063238328785);
create or replace TEMP view semiDown3475952364117677185 as select id as v15 from company_name AS cn where (id) in (select v15 from semiUp4170874063238328785) and (country_code = '[us]');
create or replace TEMP view semiDown525152917581260215 as select v31, v1, v29 from semiUp1004095578228897021 where (v31) in (select v31 from semiUp4170874063238328785);
create or replace TEMP view semiDown4494362592591792614 as select id as v29 from role_type AS rt where (id) in (select v29 from semiDown525152917581260215);
create or replace TEMP view semiDown3897587879135326313 as select id as v31, title as v32 from title AS t where (id) in (select v31 from semiDown525152917581260215) and (production_year > 1990);
create or replace TEMP view semiDown8876109385767388452 as select id as v1, name as v2 from char_name AS chn where (id) in (select v1 from semiDown525152917581260215);
create or replace TEMP view aggView6328295697254571046 as select v1, v2 as v43 from semiDown8876109385767388452;
create or replace TEMP view aggJoin8297700465924481616 as select v31, v29, v43 from semiDown525152917581260215 join aggView6328295697254571046 using(v1);
create or replace TEMP view aggView1269277063719139375 as select v29 from semiDown4494362592591792614;
create or replace TEMP view aggJoin7215646243272197819 as select v31, v43 from aggJoin8297700465924481616 join aggView1269277063719139375 using(v29);
create or replace TEMP view aggView3266518707303822098 as select v31, v32 as v44 from semiDown3897587879135326313;
create or replace TEMP view aggJoin862237902378867951 as select v31, v43, v44 from aggJoin7215646243272197819 join aggView3266518707303822098 using(v31);
create or replace TEMP view aggView8444178028841614988 as select v31, MIN(v43) as v43, MIN(v44) as v44 from aggJoin862237902378867951 group by v31,v44,v43;
create or replace TEMP view aggJoin8395132160699374958 as select v15, v22, v43, v44 from semiUp4170874063238328785 join aggView8444178028841614988 using(v31);
create or replace TEMP view aggView4362513975514099833 as select v15 from semiDown3475952364117677185;
create or replace TEMP view aggJoin5362547138244859989 as select v22, v43, v44 from aggJoin8395132160699374958 join aggView4362513975514099833 using(v15);
create or replace TEMP view aggView9089255500697443079 as select v22 from semiDown2475385059665281490;
create or replace TEMP view aggJoin4051311249551359169 as select v43, v44 from aggJoin5362547138244859989 join aggView9089255500697443079 using(v22);
create or replace TEMP view res as select MIN(v43) as v43, MIN(v44) as v44 from aggJoin4051311249551359169;
select sum(v43+v44) from res;
