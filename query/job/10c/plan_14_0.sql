create or replace TEMP view aggView3154997949866710533 as select id as v22 from company_type as ct;
create or replace TEMP view aggJoin1106380550136089796 as select movie_id as v31, company_id as v15 from movie_companies as mc, aggView3154997949866710533 where mc.company_type_id=aggView3154997949866710533.v22;
create or replace TEMP view aggView4119568090866249992 as select id as v15 from company_name as cn where (country_code = '[us]');
create or replace TEMP view aggJoin5091249026022533267 as select v31 from aggJoin1106380550136089796 join aggView4119568090866249992 using(v15);
create or replace TEMP view aggView2704835909306900494 as select v31, COUNT(*) as annot from aggJoin5091249026022533267 group by v31;
create or replace TEMP view aggJoin2757573043807165169 as select id as v31, title as v32, production_year as v35, annot from title as t, aggView2704835909306900494 where t.id=aggView2704835909306900494.v31 and (production_year > 1990);
create or replace TEMP view aggView1454107681927832360 as select v31, MIN(v32) as v44, SUM(annot) as annot from aggJoin2757573043807165169 group by v31;
create or replace TEMP view aggJoin6082624259484365780 as select person_role_id as v1, note as v12, role_id as v29, v44, annot from cast_info as ci, aggView1454107681927832360 where ci.movie_id=aggView1454107681927832360.v31 and (note LIKE '%(producer)%');
create or replace TEMP view aggView1058820224310511738 as select id as v29 from role_type as rt;
create or replace TEMP view aggJoin3390760532129029970 as select v1, v12, v44, annot from aggJoin6082624259484365780 join aggView1058820224310511738 using(v29);
create or replace TEMP view aggView1443989668674333858 as select v1, MIN(v44) as v44, SUM(annot) as annot from aggJoin3390760532129029970 group by v1;
create or replace TEMP view aggJoin3987078031545669485 as select name as v2, v44, annot from char_name as chn, aggView1443989668674333858 where chn.id=aggView1443989668674333858.v1;
create or replace TEMP view res as select MIN(v2) as v43, MIN(v44) as v44 from aggJoin3987078031545669485;
select sum(v43+v44) from res;