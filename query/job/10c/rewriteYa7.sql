create or replace TEMP view semiUp4307058494502158449 as select movie_id as v31, person_role_id as v1, role_id as v29 from cast_info AS ci where (role_id) in (select id from role_type AS rt) and (note LIKE '%(producer)%');
create or replace TEMP view semiUp2669523703855573566 as select v31, v1, v29 from semiUp4307058494502158449 where (v1) in (select id from char_name AS chn);
create or replace TEMP view semiUp228256111456751316 as select v31, v1, v29 from semiUp2669523703855573566 where (v31) in (select id from title AS t where (production_year > 1990));
create or replace TEMP view semiUp4486936004355035364 as select movie_id as v31, company_id as v15, company_type_id as v22 from movie_companies AS mc where (movie_id) in (select v31 from semiUp228256111456751316);
create or replace TEMP view semiUp3159784990688034149 as select v31, v15, v22 from semiUp4486936004355035364 where (v15) in (select id from company_name AS cn where (country_code = '[us]'));
create or replace TEMP view semiUp7611306144260214894 as select v31, v15, v22 from semiUp3159784990688034149 where (v22) in (select id from company_type AS ct);
create or replace TEMP view semiDown5051145225195078273 as select id as v22 from company_type AS ct where (id) in (select v22 from semiUp7611306144260214894);
create or replace TEMP view semiDown5579786605288058351 as select id as v15 from company_name AS cn where (id) in (select v15 from semiUp7611306144260214894) and (country_code = '[us]');
create or replace TEMP view semiDown1117298000685893317 as select v31, v1, v29 from semiUp228256111456751316 where (v31) in (select v31 from semiUp7611306144260214894);
create or replace TEMP view semiDown3400309116108407572 as select id as v29 from role_type AS rt where (id) in (select v29 from semiDown1117298000685893317);
create or replace TEMP view semiDown7655921461357197746 as select id as v31, title as v32 from title AS t where (id) in (select v31 from semiDown1117298000685893317) and (production_year > 1990);
create or replace TEMP view semiDown6801613738863740755 as select id as v1, name as v2 from char_name AS chn where (id) in (select v1 from semiDown1117298000685893317);
create or replace TEMP view aggView6189395285136946306 as select v1, v2 as v43 from semiDown6801613738863740755;
create or replace TEMP view aggJoin7633990233538150840 as select v31, v29, v43 from semiDown1117298000685893317 join aggView6189395285136946306 using(v1);
create or replace TEMP view aggView2508694841296523409 as select v29 from semiDown3400309116108407572;
create or replace TEMP view aggJoin7489424677006632417 as select v31, v43 from aggJoin7633990233538150840 join aggView2508694841296523409 using(v29);
create or replace TEMP view aggView6707281628430101945 as select v31, v32 as v44 from semiDown7655921461357197746;
create or replace TEMP view aggJoin6638377456007231949 as select v31, v43, v44 from aggJoin7489424677006632417 join aggView6707281628430101945 using(v31);
create or replace TEMP view aggView4624051023119562225 as select v31, MIN(v43) as v43, MIN(v44) as v44 from aggJoin6638377456007231949 group by v31,v44,v43;
create or replace TEMP view aggJoin2210889767706024592 as select v15, v22, v43, v44 from semiUp7611306144260214894 join aggView4624051023119562225 using(v31);
create or replace TEMP view aggView7539251644503069515 as select v15 from semiDown5579786605288058351;
create or replace TEMP view aggJoin8408971031538444089 as select v22, v43, v44 from aggJoin2210889767706024592 join aggView7539251644503069515 using(v15);
create or replace TEMP view aggView3899945764406191747 as select v22 from semiDown5051145225195078273;
create or replace TEMP view aggJoin2246560374494571645 as select v43, v44 from aggJoin8408971031538444089 join aggView3899945764406191747 using(v22);
create or replace TEMP view res as select MIN(v43) as v43, MIN(v44) as v44 from aggJoin2246560374494571645;
select sum(v43+v44) from res;
