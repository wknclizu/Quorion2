create or replace TEMP view aggView8090204041021240022 as select id as v22 from company_type as ct;
create or replace TEMP view aggJoin3643827389361927169 as select movie_id as v31, company_id as v15 from movie_companies as mc, aggView8090204041021240022 where mc.company_type_id=aggView8090204041021240022.v22;
create or replace TEMP view aggView6764010419105334565 as select id as v31, title as v44 from title as t where (production_year > 1990);
create or replace TEMP view aggJoin2138964360019086612 as select movie_id as v31, person_role_id as v1, note as v12, role_id as v29, v44 from cast_info as ci, aggView6764010419105334565 where ci.movie_id=aggView6764010419105334565.v31 and (note LIKE '%(producer)%');
create or replace TEMP view aggView2806476531306339664 as select id as v15 from company_name as cn where (country_code = '[us]');
create or replace TEMP view aggJoin7755186240066866750 as select v31 from aggJoin3643827389361927169 join aggView2806476531306339664 using(v15);
create or replace TEMP view aggView210615548996055655 as select id as v29 from role_type as rt;
create or replace TEMP view aggJoin7309418559148009008 as select v31, v1, v12, v44 from aggJoin2138964360019086612 join aggView210615548996055655 using(v29);
create or replace TEMP view aggView8313014220492729982 as select v31, COUNT(*) as annot from aggJoin7755186240066866750 group by v31;
create or replace TEMP view aggJoin4547727065505791508 as select v1, v12, v44 as v44, annot from aggJoin7309418559148009008 join aggView8313014220492729982 using(v31);
create or replace TEMP view aggView998091117375765452 as select v1, MIN(v44) as v44, SUM(annot) as annot from aggJoin4547727065505791508 group by v1;
create or replace TEMP view aggJoin4422965029138513543 as select name as v2, v44, annot from char_name as chn, aggView998091117375765452 where chn.id=aggView998091117375765452.v1;
create or replace TEMP view res as select MIN(v2) as v43, MIN(v44) as v44 from aggJoin4422965029138513543;
select sum(v43+v44) from res;