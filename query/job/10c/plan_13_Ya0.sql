create or replace TEMP view semiUp1277548397605040379 as select movie_id as v31, company_id as v15, company_type_id as v22 from movie_companies AS mc where (company_type_id) in (select id from company_type AS ct);
create or replace TEMP view semiUp6237783800115809623 as select v31, v15, v22 from semiUp1277548397605040379 where (v15) in (select id from company_name AS cn where (country_code = '[us]'));
create or replace TEMP view semiUp6665477708022378773 as select movie_id as v31, person_role_id as v1, role_id as v29 from cast_info AS ci where (role_id) in (select id from role_type AS rt) and (note LIKE '%(producer)%');
create or replace TEMP view semiUp7655714471363129349 as select v31, v1, v29 from semiUp6665477708022378773 where (v1) in (select id from char_name AS chn);
create or replace TEMP view semiUp7688641172930425947 as select v31, v15, v22 from semiUp6237783800115809623 where (v31) in (select v31 from semiUp7655714471363129349);
create or replace TEMP view semiUp5373010414041216767 as select id as v31, title as v32 from title AS t where (id) in (select v31 from semiUp7688641172930425947) and (production_year > 1990);
create or replace TEMP view semiDown7593550641140840185 as select v31, v15, v22 from semiUp7688641172930425947 where (v31) in (select v31 from semiUp5373010414041216767);
create or replace TEMP view semiDown1527594599309206932 as select id as v22 from company_type AS ct where (id) in (select v22 from semiDown7593550641140840185);
create or replace TEMP view semiDown2924575613901279410 as select id as v15 from company_name AS cn where (id) in (select v15 from semiDown7593550641140840185) and (country_code = '[us]');
create or replace TEMP view semiDown8396279206991823682 as select v31, v1, v29 from semiUp7655714471363129349 where (v31) in (select v31 from semiDown7593550641140840185);
create or replace TEMP view semiDown696138165987669546 as select id as v29 from role_type AS rt where (id) in (select v29 from semiDown8396279206991823682);
create or replace TEMP view semiDown665845554091096572 as select id as v1, name as v2 from char_name AS chn where (id) in (select v1 from semiDown8396279206991823682);
create or replace TEMP view aggView1420828103766604110 as select v29 from semiDown696138165987669546;
create or replace TEMP view aggJoin1338019030284135303 as select v31, v1 from semiDown8396279206991823682 join aggView1420828103766604110 using(v29);
create or replace TEMP view aggView929256719086006371 as select v22 from semiDown1527594599309206932;
create or replace TEMP view aggJoin3954981649167467981 as select v31, v15 from semiDown7593550641140840185 join aggView929256719086006371 using(v22);
create or replace TEMP view aggView5609647562692789471 as select v1, v2 as v43 from semiDown665845554091096572;
create or replace TEMP view aggJoin8667976757573411046 as select v31, v43 from aggJoin1338019030284135303 join aggView5609647562692789471 using(v1);
create or replace TEMP view aggView5947808154918820467 as select v15 from semiDown2924575613901279410;
create or replace TEMP view aggJoin3640190356042343105 as select v31 from aggJoin3954981649167467981 join aggView5947808154918820467 using(v15);
create or replace TEMP view aggView1045642655196352686 as select v31, MIN(v43) as v43 from aggJoin8667976757573411046 group by v31,v43;
create or replace TEMP view aggJoin2167128273311118986 as select v31, v43 from aggJoin3640190356042343105 join aggView1045642655196352686 using(v31);
create or replace TEMP view aggView8333255894760040824 as select v31, MIN(v43) as v43 from aggJoin2167128273311118986 group by v31,v43;
create or replace TEMP view aggJoin3648119488389185010 as select v32, v43 from semiUp5373010414041216767 join aggView8333255894760040824 using(v31);
create or replace TEMP view res as select MIN(v43) as v43, MIN(v32) as v44 from aggJoin3648119488389185010;
select sum(v43+v44) from res;
