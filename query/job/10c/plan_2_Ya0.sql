create or replace TEMP view semiUp4217233940943559881 as select movie_id as v31, company_id as v15, company_type_id as v22 from movie_companies AS mc where (company_type_id) in (select id from company_type AS ct);
create or replace TEMP view semiUp2033602667882741158 as select movie_id as v31, person_role_id as v1, role_id as v29 from cast_info AS ci where (movie_id) in (select id from title AS t where (production_year > 1990)) and (note LIKE '%(producer)%');
create or replace TEMP view semiUp837909399495650603 as select v31, v1, v29 from semiUp2033602667882741158 where (v1) in (select id from char_name AS chn);
create or replace TEMP view semiUp4315847805031746598 as select v31, v1, v29 from semiUp837909399495650603 where (v29) in (select id from role_type AS rt);
create or replace TEMP view semiUp1799821793951102529 as select v31, v15, v22 from semiUp4217233940943559881 where (v31) in (select v31 from semiUp4315847805031746598);
create or replace TEMP view semiUp2423057245742554737 as select id as v15 from company_name AS cn where (id) in (select v15 from semiUp1799821793951102529) and (country_code = '[us]');
create or replace TEMP view semiDown7494317138249982300 as select v31, v15, v22 from semiUp1799821793951102529 where (v15) in (select v15 from semiUp2423057245742554737);
create or replace TEMP view semiDown2664713588538389030 as select id as v22 from company_type AS ct where (id) in (select v22 from semiDown7494317138249982300);
create or replace TEMP view semiDown3394588234406087249 as select v31, v1, v29 from semiUp4315847805031746598 where (v31) in (select v31 from semiDown7494317138249982300);
create or replace TEMP view semiDown8548797740789281002 as select id as v29 from role_type AS rt where (id) in (select v29 from semiDown3394588234406087249);
create or replace TEMP view semiDown6059936584737529549 as select id as v31, title as v32 from title AS t where (id) in (select v31 from semiDown3394588234406087249) and (production_year > 1990);
create or replace TEMP view semiDown6054937463534965717 as select id as v1, name as v2 from char_name AS chn where (id) in (select v1 from semiDown3394588234406087249);
create or replace TEMP view aggView7617455302313474844 as select v31, v32 as v44 from semiDown6059936584737529549;
create or replace TEMP view aggJoin6212874727412109900 as select v31, v1, v29, v44 from semiDown3394588234406087249 join aggView7617455302313474844 using(v31);
create or replace TEMP view aggView6255206818574916961 as select v22 from semiDown2664713588538389030;
create or replace TEMP view aggJoin3194629838642412900 as select v31, v15 from semiDown7494317138249982300 join aggView6255206818574916961 using(v22);
create or replace TEMP view aggView3333281589384161636 as select v29 from semiDown8548797740789281002;
create or replace TEMP view aggJoin4996323399317245503 as select v31, v1, v44 from aggJoin6212874727412109900 join aggView3333281589384161636 using(v29);
create or replace TEMP view aggView2159490633640178021 as select v1, v2 as v43 from semiDown6054937463534965717;
create or replace TEMP view aggJoin8303682777322502841 as select v31, v44, v43 from aggJoin4996323399317245503 join aggView2159490633640178021 using(v1);
create or replace TEMP view aggView7831801028058669783 as select v31, MIN(v44) as v44, MIN(v43) as v43 from aggJoin8303682777322502841 group by v31,v44,v43;
create or replace TEMP view aggJoin7954105151651900407 as select v15, v44, v43 from aggJoin3194629838642412900 join aggView7831801028058669783 using(v31);
create or replace TEMP view aggView213908385313920255 as select v15, MIN(v44) as v44, MIN(v43) as v43 from aggJoin7954105151651900407 group by v15,v44,v43;
create or replace TEMP view aggJoin9084448388146913599 as select v44, v43 from semiUp2423057245742554737 join aggView213908385313920255 using(v15);
create or replace TEMP view res as select MIN(v43) as v43, MIN(v44) as v44 from aggJoin9084448388146913599;
select sum(v43+v44) from res;
