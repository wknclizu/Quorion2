create or replace TEMP view semiUp4042578185444431137 as select movie_id as v31, company_id as v15, company_type_id as v22 from movie_companies AS mc where (company_id) in (select id from company_name AS cn where (country_code = '[us]'));
create or replace TEMP view semiUp4622575335045036077 as select movie_id as v31, person_role_id as v1, role_id as v29 from cast_info AS ci where (person_role_id) in (select id from char_name AS chn) and (note LIKE '%(producer)%');
create or replace TEMP view semiUp7561830542721342965 as select v31, v15, v22 from semiUp4042578185444431137 where (v31) in (select id from title AS t where (production_year > 1990));
create or replace TEMP view semiUp5759757625163028891 as select v31, v1, v29 from semiUp4622575335045036077 where (v29) in (select id from role_type AS rt);
create or replace TEMP view semiUp9141272440536675923 as select v31, v15, v22 from semiUp7561830542721342965 where (v31) in (select v31 from semiUp5759757625163028891);
create or replace TEMP view semiUp7456345937220132629 as select id as v22 from company_type AS ct where (id) in (select v22 from semiUp9141272440536675923);
create or replace TEMP view semiDown925510460513429773 as select v31, v15, v22 from semiUp9141272440536675923 where (v22) in (select v22 from semiUp7456345937220132629);
create or replace TEMP view semiDown7484238311256472882 as select id as v15 from company_name AS cn where (id) in (select v15 from semiDown925510460513429773) and (country_code = '[us]');
create or replace TEMP view semiDown7554202796330083822 as select v31, v1, v29 from semiUp5759757625163028891 where (v31) in (select v31 from semiDown925510460513429773);
create or replace TEMP view semiDown2017501353077845418 as select id as v31, title as v32 from title AS t where (id) in (select v31 from semiDown925510460513429773) and (production_year > 1990);
create or replace TEMP view semiDown1189048394744613416 as select id as v29 from role_type AS rt where (id) in (select v29 from semiDown7554202796330083822);
create or replace TEMP view semiDown3952505275473063777 as select id as v1, name as v2 from char_name AS chn where (id) in (select v1 from semiDown7554202796330083822);
create or replace TEMP view aggView7752478855127694221 as select v29 from semiDown1189048394744613416;
create or replace TEMP view aggJoin850038048749050771 as select v31, v1 from semiDown7554202796330083822 join aggView7752478855127694221 using(v29);
create or replace TEMP view aggView668397124109445496 as select v31, v32 as v44 from semiDown2017501353077845418;
create or replace TEMP view aggJoin8546202055263058743 as select v31, v15, v22, v44 from semiDown925510460513429773 join aggView668397124109445496 using(v31);
create or replace TEMP view aggView3826562066640981231 as select v1, v2 as v43 from semiDown3952505275473063777;
create or replace TEMP view aggJoin1333087254515643812 as select v31, v43 from aggJoin850038048749050771 join aggView3826562066640981231 using(v1);
create or replace TEMP view aggView8029183993161517836 as select v15 from semiDown7484238311256472882;
create or replace TEMP view aggJoin3004373645533678293 as select v31, v22, v44 from aggJoin8546202055263058743 join aggView8029183993161517836 using(v15);
create or replace TEMP view aggView6840646860183302807 as select v31, MIN(v43) as v43 from aggJoin1333087254515643812 group by v31,v43;
create or replace TEMP view aggJoin7769239189062087216 as select v22, v44 as v44, v43 from aggJoin3004373645533678293 join aggView6840646860183302807 using(v31);
create or replace TEMP view aggView6648002813352236872 as select v22, MIN(v44) as v44, MIN(v43) as v43 from aggJoin7769239189062087216 group by v22,v43,v44;
create or replace TEMP view aggJoin2292476705762864938 as select v44, v43 from semiUp7456345937220132629 join aggView6648002813352236872 using(v22);
create or replace TEMP view res as select MIN(v43) as v43, MIN(v44) as v44 from aggJoin2292476705762864938;
select sum(v43+v44) from res;
