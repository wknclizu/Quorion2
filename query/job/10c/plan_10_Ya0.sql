create or replace TEMP view semiUp6889193792590211769 as select movie_id as v31, company_id as v15, company_type_id as v22 from movie_companies AS mc where (company_id) in (select id from company_name AS cn where (country_code = '[us]'));
create or replace TEMP view semiUp5659831337148513596 as select movie_id as v31, person_role_id as v1, role_id as v29 from cast_info AS ci where (person_role_id) in (select id from char_name AS chn) and (note LIKE '%(producer)%');
create or replace TEMP view semiUp6293691336576770178 as select v31, v15, v22 from semiUp6889193792590211769 where (v31) in (select id from title AS t where (production_year > 1990));
create or replace TEMP view semiUp7244358063189553525 as select v31, v1, v29 from semiUp5659831337148513596 where (v29) in (select id from role_type AS rt);
create or replace TEMP view semiUp6241432745276045044 as select v31, v15, v22 from semiUp6293691336576770178 where (v31) in (select v31 from semiUp7244358063189553525);
create or replace TEMP view semiUp9059950590197637633 as select id as v22 from company_type AS ct where (id) in (select v22 from semiUp6241432745276045044);
create or replace TEMP view semiDown5084823620341556686 as select v31, v15, v22 from semiUp6241432745276045044 where (v22) in (select v22 from semiUp9059950590197637633);
create or replace TEMP view semiDown4301004212411286943 as select id as v15 from company_name AS cn where (id) in (select v15 from semiDown5084823620341556686) and (country_code = '[us]');
create or replace TEMP view semiDown5692653250509469655 as select v31, v1, v29 from semiUp7244358063189553525 where (v31) in (select v31 from semiDown5084823620341556686);
create or replace TEMP view semiDown5179954778125572617 as select id as v31, title as v32 from title AS t where (id) in (select v31 from semiDown5084823620341556686) and (production_year > 1990);
create or replace TEMP view semiDown8098022859360633832 as select id as v29 from role_type AS rt where (id) in (select v29 from semiDown5692653250509469655);
create or replace TEMP view semiDown8224995590234860475 as select id as v1, name as v2 from char_name AS chn where (id) in (select v1 from semiDown5692653250509469655);
create or replace TEMP view aggView12109819915314934 as select v29 from semiDown8098022859360633832;
create or replace TEMP view aggJoin6532735529451177383 as select v31, v1 from semiDown5692653250509469655 join aggView12109819915314934 using(v29);
create or replace TEMP view aggView2261304339456443859 as select v31, v32 as v44 from semiDown5179954778125572617;
create or replace TEMP view aggJoin5890729475189211088 as select v31, v15, v22, v44 from semiDown5084823620341556686 join aggView2261304339456443859 using(v31);
create or replace TEMP view aggView7660315324160237522 as select v1, v2 as v43 from semiDown8224995590234860475;
create or replace TEMP view aggJoin2168481285198149796 as select v31, v43 from aggJoin6532735529451177383 join aggView7660315324160237522 using(v1);
create or replace TEMP view aggView1072377266789526437 as select v15 from semiDown4301004212411286943;
create or replace TEMP view aggJoin4524123950635444149 as select v31, v22, v44 from aggJoin5890729475189211088 join aggView1072377266789526437 using(v15);
create or replace TEMP view aggView8156539760330069382 as select v31, MIN(v43) as v43 from aggJoin2168481285198149796 group by v31,v43;
create or replace TEMP view aggJoin4125893943356556901 as select v22, v44 as v44, v43 from aggJoin4524123950635444149 join aggView8156539760330069382 using(v31);
create or replace TEMP view aggView2721366709124321097 as select v22, MIN(v44) as v44, MIN(v43) as v43 from aggJoin4125893943356556901 group by v22,v44,v43;
create or replace TEMP view aggJoin7682647674160845560 as select v44, v43 from semiUp9059950590197637633 join aggView2721366709124321097 using(v22);
create or replace TEMP view res as select MIN(v43) as v43, MIN(v44) as v44 from aggJoin7682647674160845560;
select sum(v43+v44) from res;
