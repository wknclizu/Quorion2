create or replace TEMP view semiUp5785938066335488219 as select movie_id as v31, person_role_id as v1, role_id as v29 from cast_info AS ci where (person_role_id) in (select id from char_name AS chn) and (note LIKE '%(producer)%');
create or replace TEMP view semiUp7441837680729911507 as select movie_id as v31, company_id as v15, company_type_id as v22 from movie_companies AS mc where (company_type_id) in (select id from company_type AS ct);
create or replace TEMP view semiUp5750693138830778743 as select v31, v15, v22 from semiUp7441837680729911507 where (v15) in (select id from company_name AS cn where (country_code = '[us]'));
create or replace TEMP view semiUp3501843381586782216 as select id as v31, title as v32 from title AS t where (id) in (select v31 from semiUp5750693138830778743) and (production_year > 1990);
create or replace TEMP view semiUp8041504000710556253 as select v31, v1, v29 from semiUp5785938066335488219 where (v31) in (select v31 from semiUp3501843381586782216);
create or replace TEMP view semiUp7017801871065322054 as select id as v29 from role_type AS rt where (id) in (select v29 from semiUp8041504000710556253);
create or replace TEMP view semiDown2042745206836582799 as select v31, v1, v29 from semiUp8041504000710556253 where (v29) in (select v29 from semiUp7017801871065322054);
create or replace TEMP view semiDown3217001430185082249 as select v31, v32 from semiUp3501843381586782216 where (v31) in (select v31 from semiDown2042745206836582799);
create or replace TEMP view semiDown4783903973498394846 as select id as v1, name as v2 from char_name AS chn where (id) in (select v1 from semiDown2042745206836582799);
create or replace TEMP view semiDown1841084216282367797 as select v31, v15, v22 from semiUp5750693138830778743 where (v31) in (select v31 from semiDown3217001430185082249);
create or replace TEMP view semiDown2128569700552002082 as select id as v22 from company_type AS ct where (id) in (select v22 from semiDown1841084216282367797);
create or replace TEMP view semiDown1542255082934682991 as select id as v15 from company_name AS cn where (id) in (select v15 from semiDown1841084216282367797) and (country_code = '[us]');
create or replace TEMP view aggView7842844417419871211 as select v22 from semiDown2128569700552002082;
create or replace TEMP view aggJoin8980413058942095134 as select v31, v15 from semiDown1841084216282367797 join aggView7842844417419871211 using(v22);
create or replace TEMP view aggView6231822505846737 as select v15 from semiDown1542255082934682991;
create or replace TEMP view aggJoin2758895990156064360 as select v31 from aggJoin8980413058942095134 join aggView6231822505846737 using(v15);
create or replace TEMP view aggView9131294910901277298 as select v31 from aggJoin2758895990156064360 group by v31;
create or replace TEMP view aggJoin1054120480092491276 as select v31, v32 from semiDown3217001430185082249 join aggView9131294910901277298 using(v31);
create or replace TEMP view aggView7814514276914362903 as select v31, MIN(v32) as v44 from aggJoin1054120480092491276 group by v31;
create or replace TEMP view aggJoin1332434236587626853 as select v1, v29, v44 from semiDown2042745206836582799 join aggView7814514276914362903 using(v31);
create or replace TEMP view aggView1672875646404412626 as select v1, v2 as v43 from semiDown4783903973498394846;
create or replace TEMP view aggJoin5905436352098263231 as select v29, v44, v43 from aggJoin1332434236587626853 join aggView1672875646404412626 using(v1);
create or replace TEMP view aggView1955540785795842778 as select v29, MIN(v44) as v44, MIN(v43) as v43 from aggJoin5905436352098263231 group by v29,v43,v44;
create or replace TEMP view aggJoin1931929338801210314 as select v44, v43 from semiUp7017801871065322054 join aggView1955540785795842778 using(v29);
create or replace TEMP view res as select MIN(v43) as v43, MIN(v44) as v44 from aggJoin1931929338801210314;
select sum(v43+v44) from res;
