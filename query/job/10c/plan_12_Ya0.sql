create or replace TEMP view semiUp7426849788761785648 as select movie_id as v31, company_id as v15, company_type_id as v22 from movie_companies AS mc where (company_id) in (select id from company_name AS cn where (country_code = '[us]'));
create or replace TEMP view semiUp7046560699330860839 as select movie_id as v31, person_role_id as v1, role_id as v29 from cast_info AS ci where (person_role_id) in (select id from char_name AS chn) and (note LIKE '%(producer)%');
create or replace TEMP view semiUp1476696158191706598 as select v31, v15, v22 from semiUp7426849788761785648 where (v31) in (select id from title AS t where (production_year > 1990));
create or replace TEMP view semiUp1380156045481791499 as select v31, v15, v22 from semiUp1476696158191706598 where (v22) in (select id from company_type AS ct);
create or replace TEMP view semiUp6798245851050258609 as select v31, v1, v29 from semiUp7046560699330860839 where (v31) in (select v31 from semiUp1380156045481791499);
create or replace TEMP view semiUp5212530893415836696 as select id as v29 from role_type AS rt where (id) in (select v29 from semiUp6798245851050258609);
create or replace TEMP view semiDown1814047905705484771 as select v31, v1, v29 from semiUp6798245851050258609 where (v29) in (select v29 from semiUp5212530893415836696);
create or replace TEMP view semiDown6296256752423913027 as select v31, v15, v22 from semiUp1380156045481791499 where (v31) in (select v31 from semiDown1814047905705484771);
create or replace TEMP view semiDown5297834317152103822 as select id as v1, name as v2 from char_name AS chn where (id) in (select v1 from semiDown1814047905705484771);
create or replace TEMP view semiDown288437924911387009 as select id as v22 from company_type AS ct where (id) in (select v22 from semiDown6296256752423913027);
create or replace TEMP view semiDown8132719875603639294 as select id as v15 from company_name AS cn where (id) in (select v15 from semiDown6296256752423913027) and (country_code = '[us]');
create or replace TEMP view semiDown6942669471835100376 as select id as v31, title as v32 from title AS t where (id) in (select v31 from semiDown6296256752423913027) and (production_year > 1990);
create or replace TEMP view aggView7921657185449391132 as select v31, v32 as v44 from semiDown6942669471835100376;
create or replace TEMP view aggJoin2843240469632363686 as select v31, v15, v22, v44 from semiDown6296256752423913027 join aggView7921657185449391132 using(v31);
create or replace TEMP view aggView4228727422904646982 as select v22 from semiDown288437924911387009;
create or replace TEMP view aggJoin6026465956270943389 as select v31, v15, v44 from aggJoin2843240469632363686 join aggView4228727422904646982 using(v22);
create or replace TEMP view aggView7097067692722768779 as select v1, v2 as v43 from semiDown5297834317152103822;
create or replace TEMP view aggJoin6486868664903658160 as select v31, v29, v43 from semiDown1814047905705484771 join aggView7097067692722768779 using(v1);
create or replace TEMP view aggView7624665872730119082 as select v15 from semiDown8132719875603639294;
create or replace TEMP view aggJoin6509940917303470601 as select v31, v44 from aggJoin6026465956270943389 join aggView7624665872730119082 using(v15);
create or replace TEMP view aggView1029302608915572036 as select v31, MIN(v44) as v44 from aggJoin6509940917303470601 group by v31,v44;
create or replace TEMP view aggJoin1628606344261642802 as select v29, v43 as v43, v44 from aggJoin6486868664903658160 join aggView1029302608915572036 using(v31);
create or replace TEMP view aggView3699469475569916601 as select v29, MIN(v43) as v43, MIN(v44) as v44 from aggJoin1628606344261642802 group by v29,v44,v43;
create or replace TEMP view aggJoin6564557224344211134 as select v43, v44 from semiUp5212530893415836696 join aggView3699469475569916601 using(v29);
create or replace TEMP view res as select MIN(v43) as v43, MIN(v44) as v44 from aggJoin6564557224344211134;
select sum(v43+v44) from res;
