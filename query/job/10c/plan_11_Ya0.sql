create or replace TEMP view semiUp8596411831038486492 as select movie_id as v31, company_id as v15, company_type_id as v22 from movie_companies AS mc where (company_id) in (select id from company_name AS cn where (country_code = '[us]'));
create or replace TEMP view semiUp828090609378243926 as select v31, v15, v22 from semiUp8596411831038486492 where (v31) in (select id from title AS t where (production_year > 1990));
create or replace TEMP view semiUp3947791788393654974 as select movie_id as v31, person_role_id as v1, role_id as v29 from cast_info AS ci where (person_role_id) in (select id from char_name AS chn) and (note LIKE '%(producer)%');
create or replace TEMP view semiUp2291761253558920672 as select v31, v1, v29 from semiUp3947791788393654974 where (v29) in (select id from role_type AS rt);
create or replace TEMP view semiUp2608362020515382074 as select v31, v15, v22 from semiUp828090609378243926 where (v22) in (select id from company_type AS ct);
create or replace TEMP view semiUp3606257064731633744 as select v31, v15, v22 from semiUp2608362020515382074 where (v31) in (select v31 from semiUp2291761253558920672);
create or replace TEMP view semiDown174230869581981234 as select id as v22 from company_type AS ct where (id) in (select v22 from semiUp3606257064731633744);
create or replace TEMP view semiDown4480681111818261916 as select id as v15 from company_name AS cn where (id) in (select v15 from semiUp3606257064731633744) and (country_code = '[us]');
create or replace TEMP view semiDown8801305610248089047 as select v31, v1, v29 from semiUp2291761253558920672 where (v31) in (select v31 from semiUp3606257064731633744);
create or replace TEMP view semiDown3603806306688161558 as select id as v31, title as v32 from title AS t where (id) in (select v31 from semiUp3606257064731633744) and (production_year > 1990);
create or replace TEMP view semiDown5114234238480370259 as select id as v29 from role_type AS rt where (id) in (select v29 from semiDown8801305610248089047);
create or replace TEMP view semiDown681749461556111207 as select id as v1, name as v2 from char_name AS chn where (id) in (select v1 from semiDown8801305610248089047);
create or replace TEMP view aggView2760429304910454510 as select v29 from semiDown5114234238480370259;
create or replace TEMP view aggJoin4842584031226098949 as select v31, v1 from semiDown8801305610248089047 join aggView2760429304910454510 using(v29);
create or replace TEMP view aggView7690105583284974687 as select v31, v32 as v44 from semiDown3603806306688161558;
create or replace TEMP view aggJoin3129778236252120231 as select v31, v15, v22, v44 from semiUp3606257064731633744 join aggView7690105583284974687 using(v31);
create or replace TEMP view aggView5237004125435934981 as select v1, v2 as v43 from semiDown681749461556111207;
create or replace TEMP view aggJoin3054972718591978783 as select v31, v43 from aggJoin4842584031226098949 join aggView5237004125435934981 using(v1);
create or replace TEMP view aggView4980115678524205893 as select v22 from semiDown174230869581981234;
create or replace TEMP view aggJoin3338685502098384303 as select v31, v15, v44 from aggJoin3129778236252120231 join aggView4980115678524205893 using(v22);
create or replace TEMP view aggView2117000528137635010 as select v15 from semiDown4480681111818261916;
create or replace TEMP view aggJoin3956049697350677243 as select v31, v44 from aggJoin3338685502098384303 join aggView2117000528137635010 using(v15);
create or replace TEMP view aggView1663966743521115689 as select v31, MIN(v43) as v43 from aggJoin3054972718591978783 group by v31,v43;
create or replace TEMP view aggJoin6704918745456558096 as select v44 as v44, v43 from aggJoin3956049697350677243 join aggView1663966743521115689 using(v31);
create or replace TEMP view res as select MIN(v43) as v43, MIN(v44) as v44 from aggJoin6704918745456558096;
select sum(v43+v44) from res;
