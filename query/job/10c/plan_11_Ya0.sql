create or replace TEMP view semiUp5272922581596102533 as select movie_id as v31, company_id as v15, company_type_id as v22 from movie_companies AS mc where (company_type_id) in (select id from company_type AS ct);
create or replace TEMP view semiUp713808610365456986 as select movie_id as v31, person_role_id as v1, role_id as v29 from cast_info AS ci where (person_role_id) in (select id from char_name AS chn) and (note LIKE '%(producer)%');
create or replace TEMP view semiUp7844102433422548090 as select v31, v1, v29 from semiUp713808610365456986 where (v29) in (select id from role_type AS rt);
create or replace TEMP view semiUp6865820424828607103 as select v31, v15, v22 from semiUp5272922581596102533 where (v15) in (select id from company_name AS cn where (country_code = '[us]'));
create or replace TEMP view semiUp5642610954175567030 as select v31, v15, v22 from semiUp6865820424828607103 where (v31) in (select v31 from semiUp7844102433422548090);
create or replace TEMP view semiUp2602570267498718597 as select v31, v15, v22 from semiUp5642610954175567030 where (v31) in (select id from title AS t where (production_year > 1990));
create or replace TEMP view semiDown1986424264691765432 as select id as v22 from company_type AS ct where (id) in (select v22 from semiUp2602570267498718597);
create or replace TEMP view semiDown5922025469883548078 as select id as v15 from company_name AS cn where (id) in (select v15 from semiUp2602570267498718597) and (country_code = '[us]');
create or replace TEMP view semiDown2266490645877306145 as select v31, v1, v29 from semiUp7844102433422548090 where (v31) in (select v31 from semiUp2602570267498718597);
create or replace TEMP view semiDown4460881553898829851 as select id as v31, title as v32 from title AS t where (id) in (select v31 from semiUp2602570267498718597) and (production_year > 1990);
create or replace TEMP view semiDown2955892913803972800 as select id as v29 from role_type AS rt where (id) in (select v29 from semiDown2266490645877306145);
create or replace TEMP view semiDown7358552402441242830 as select id as v1, name as v2 from char_name AS chn where (id) in (select v1 from semiDown2266490645877306145);
create or replace TEMP view aggView2388088030635958828 as select v29 from semiDown2955892913803972800;
create or replace TEMP view aggJoin2856767615457382017 as select v31, v1 from semiDown2266490645877306145 join aggView2388088030635958828 using(v29);
create or replace TEMP view aggView7213227353726895067 as select v31, v32 as v44 from semiDown4460881553898829851;
create or replace TEMP view aggJoin1550532615503906258 as select v31, v15, v22, v44 from semiUp2602570267498718597 join aggView7213227353726895067 using(v31);
create or replace TEMP view aggView6065669796839465853 as select v1, v2 as v43 from semiDown7358552402441242830;
create or replace TEMP view aggJoin6282576713493107502 as select v31, v43 from aggJoin2856767615457382017 join aggView6065669796839465853 using(v1);
create or replace TEMP view aggView7953974615624022873 as select v22 from semiDown1986424264691765432;
create or replace TEMP view aggJoin601819893539246969 as select v31, v15, v44 from aggJoin1550532615503906258 join aggView7953974615624022873 using(v22);
create or replace TEMP view aggView2571353886109767779 as select v15 from semiDown5922025469883548078;
create or replace TEMP view aggJoin7193716751839582868 as select v31, v44 from aggJoin601819893539246969 join aggView2571353886109767779 using(v15);
create or replace TEMP view aggView8462814754470665313 as select v31, MIN(v43) as v43 from aggJoin6282576713493107502 group by v31,v43;
create or replace TEMP view aggJoin3344110865334188460 as select v44 as v44, v43 from aggJoin7193716751839582868 join aggView8462814754470665313 using(v31);
create or replace TEMP view res as select MIN(v43) as v43, MIN(v44) as v44 from aggJoin3344110865334188460;
select sum(v43+v44) from res;
