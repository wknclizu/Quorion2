create or replace TEMP view semiUp7641902000110143138 as select movie_id as v31, person_role_id as v1, role_id as v29 from cast_info AS ci where (role_id) in (select id from role_type AS rt) and (note LIKE '%(producer)%');
create or replace TEMP view semiUp8074488997478944741 as select movie_id as v31, company_id as v15, company_type_id as v22 from movie_companies AS mc where (company_id) in (select id from company_name AS cn where (country_code = '[us]'));
create or replace TEMP view semiUp4812408819448695588 as select v31, v1, v29 from semiUp7641902000110143138 where (v31) in (select id from title AS t where (production_year > 1990));
create or replace TEMP view semiUp2168632523305875677 as select v31, v15, v22 from semiUp8074488997478944741 where (v22) in (select id from company_type AS ct);
create or replace TEMP view semiUp2026554772549862219 as select v31, v1, v29 from semiUp4812408819448695588 where (v31) in (select v31 from semiUp2168632523305875677);
create or replace TEMP view semiUp6397658033993848634 as select id as v1, name as v2 from char_name AS chn where (id) in (select v1 from semiUp2026554772549862219);
create or replace TEMP view semiDown1761732697494708649 as select v31, v1, v29 from semiUp2026554772549862219 where (v1) in (select v1 from semiUp6397658033993848634);
create or replace TEMP view semiDown2308169862196911731 as select id as v29 from role_type AS rt where (id) in (select v29 from semiDown1761732697494708649);
create or replace TEMP view semiDown5625740224054600445 as select id as v31, title as v32 from title AS t where (id) in (select v31 from semiDown1761732697494708649) and (production_year > 1990);
create or replace TEMP view semiDown4099598489799465766 as select v31, v15, v22 from semiUp2168632523305875677 where (v31) in (select v31 from semiDown1761732697494708649);
create or replace TEMP view semiDown2457753870108202958 as select id as v22 from company_type AS ct where (id) in (select v22 from semiDown4099598489799465766);
create or replace TEMP view semiDown5477886481440566865 as select id as v15 from company_name AS cn where (id) in (select v15 from semiDown4099598489799465766) and (country_code = '[us]');
create or replace TEMP view aggView6648503073489087291 as select v22 from semiDown2457753870108202958;
create or replace TEMP view aggJoin3674307596350085774 as select v31, v15 from semiDown4099598489799465766 join aggView6648503073489087291 using(v22);
create or replace TEMP view aggView1419438530922707584 as select v31, v32 as v44 from semiDown5625740224054600445;
create or replace TEMP view aggJoin3315369579306486724 as select v31, v1, v29, v44 from semiDown1761732697494708649 join aggView1419438530922707584 using(v31);
create or replace TEMP view aggView8175631481355255830 as select v15 from semiDown5477886481440566865;
create or replace TEMP view aggJoin6992867367800769173 as select v31 from aggJoin3674307596350085774 join aggView8175631481355255830 using(v15);
create or replace TEMP view aggView6284910429611189416 as select v29 from semiDown2308169862196911731;
create or replace TEMP view aggJoin8748970621696832399 as select v31, v1, v44 from aggJoin3315369579306486724 join aggView6284910429611189416 using(v29);
create or replace TEMP view aggView8642780497960797025 as select v31 from aggJoin6992867367800769173 group by v31;
create or replace TEMP view aggJoin1691563173865061246 as select v1, v44 as v44 from aggJoin8748970621696832399 join aggView8642780497960797025 using(v31);
create or replace TEMP view aggView7529085968898130939 as select v1, MIN(v44) as v44 from aggJoin1691563173865061246 group by v1,v44;
create or replace TEMP view aggJoin4194042980098347064 as select v2, v44 from semiUp6397658033993848634 join aggView7529085968898130939 using(v1);
create or replace TEMP view res as select MIN(v2) as v43, MIN(v44) as v44 from aggJoin4194042980098347064;
select sum(v43+v44) from res;
