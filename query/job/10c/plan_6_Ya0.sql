create or replace TEMP view semiUp4221797699210491096 as select movie_id as v31, person_role_id as v1, role_id as v29 from cast_info AS ci where (role_id) in (select id from role_type AS rt) and (note LIKE '%(producer)%');
create or replace TEMP view semiUp5318751245681082588 as select movie_id as v31, company_id as v15, company_type_id as v22 from movie_companies AS mc where (company_id) in (select id from company_name AS cn where (country_code = '[us]'));
create or replace TEMP view semiUp8218512087260890231 as select v31, v1, v29 from semiUp4221797699210491096 where (v1) in (select id from char_name AS chn);
create or replace TEMP view semiUp1907428424034044230 as select v31, v15, v22 from semiUp5318751245681082588 where (v22) in (select id from company_type AS ct);
create or replace TEMP view semiUp153843189651837376 as select v31, v1, v29 from semiUp8218512087260890231 where (v31) in (select v31 from semiUp1907428424034044230);
create or replace TEMP view semiUp8912318919127185140 as select id as v31, title as v32 from title AS t where (id) in (select v31 from semiUp153843189651837376) and (production_year > 1990);
create or replace TEMP view semiDown7457939410276650873 as select v31, v1, v29 from semiUp153843189651837376 where (v31) in (select v31 from semiUp8912318919127185140);
create or replace TEMP view semiDown3122940695992800817 as select id as v29 from role_type AS rt where (id) in (select v29 from semiDown7457939410276650873);
create or replace TEMP view semiDown2251160615519838262 as select v31, v15, v22 from semiUp1907428424034044230 where (v31) in (select v31 from semiDown7457939410276650873);
create or replace TEMP view semiDown4131393477213021258 as select id as v1, name as v2 from char_name AS chn where (id) in (select v1 from semiDown7457939410276650873);
create or replace TEMP view semiDown7955554669785634366 as select id as v22 from company_type AS ct where (id) in (select v22 from semiDown2251160615519838262);
create or replace TEMP view semiDown2008730313339315191 as select id as v15 from company_name AS cn where (id) in (select v15 from semiDown2251160615519838262) and (country_code = '[us]');
create or replace TEMP view aggView2903207588406149719 as select v22 from semiDown7955554669785634366;
create or replace TEMP view aggJoin6763670138087028442 as select v31, v15 from semiDown2251160615519838262 join aggView2903207588406149719 using(v22);
create or replace TEMP view aggView3110348460717193858 as select v29 from semiDown3122940695992800817;
create or replace TEMP view aggJoin3115753456644598390 as select v31, v1 from semiDown7457939410276650873 join aggView3110348460717193858 using(v29);
create or replace TEMP view aggView1038793480430088894 as select v15 from semiDown2008730313339315191;
create or replace TEMP view aggJoin3135059910381973758 as select v31 from aggJoin6763670138087028442 join aggView1038793480430088894 using(v15);
create or replace TEMP view aggView7777744608393519950 as select v31 from aggJoin3135059910381973758 group by v31;
create or replace TEMP view aggJoin3151592968529799154 as select v31, v1 from aggJoin3115753456644598390 join aggView7777744608393519950 using(v31);
create or replace TEMP view aggView7635337998104626383 as select v1, v2 as v43 from semiDown4131393477213021258;
create or replace TEMP view aggJoin7121946008168515280 as select v31, v43 from aggJoin3151592968529799154 join aggView7635337998104626383 using(v1);
create or replace TEMP view aggView8449040573325246437 as select v31, MIN(v43) as v43 from aggJoin7121946008168515280 group by v31,v43;
create or replace TEMP view aggJoin5322505065124244210 as select v32, v43 from semiUp8912318919127185140 join aggView8449040573325246437 using(v31);
create or replace TEMP view res as select MIN(v43) as v43, MIN(v32) as v44 from aggJoin5322505065124244210;
select sum(v43+v44) from res;
