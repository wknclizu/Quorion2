create or replace TEMP view semiUp8405749755953283161 as select movie_id as v31, company_id as v15, company_type_id as v22 from movie_companies AS mc where (company_id) in (select id from company_name AS cn where (country_code = '[us]'));
create or replace TEMP view semiUp1171491475164971514 as select v31, v15, v22 from semiUp8405749755953283161 where (v22) in (select id from company_type AS ct);
create or replace TEMP view semiUp6357238431808072554 as select id as v31, title as v32 from title AS t where (id) in (select v31 from semiUp1171491475164971514) and (production_year > 1990);
create or replace TEMP view semiUp2951336652590276264 as select movie_id as v31, person_role_id as v1, role_id as v29 from cast_info AS ci where (role_id) in (select id from role_type AS rt) and (note LIKE '%(producer)%');
create or replace TEMP view semiUp402254820047074836 as select v31, v1, v29 from semiUp2951336652590276264 where (v1) in (select id from char_name AS chn);
create or replace TEMP view semiUp5555106477886238169 as select v31, v1, v29 from semiUp402254820047074836 where (v31) in (select v31 from semiUp6357238431808072554);
create or replace TEMP view semiDown1148020930021884205 as select id as v29 from role_type AS rt where (id) in (select v29 from semiUp5555106477886238169);
create or replace TEMP view semiDown271261474474801316 as select v31, v32 from semiUp6357238431808072554 where (v31) in (select v31 from semiUp5555106477886238169);
create or replace TEMP view semiDown3721735275424384042 as select id as v1, name as v2 from char_name AS chn where (id) in (select v1 from semiUp5555106477886238169);
create or replace TEMP view semiDown8481150040317935587 as select v31, v15, v22 from semiUp1171491475164971514 where (v31) in (select v31 from semiDown271261474474801316);
create or replace TEMP view semiDown1387759054199492432 as select id as v22 from company_type AS ct where (id) in (select v22 from semiDown8481150040317935587);
create or replace TEMP view semiDown6616388887099251790 as select id as v15 from company_name AS cn where (id) in (select v15 from semiDown8481150040317935587) and (country_code = '[us]');
create or replace TEMP view aggView389427176118093997 as select v22 from semiDown1387759054199492432;
create or replace TEMP view aggJoin1099319430676543477 as select v31, v15 from semiDown8481150040317935587 join aggView389427176118093997 using(v22);
create or replace TEMP view aggView3543464952068511907 as select v15 from semiDown6616388887099251790;
create or replace TEMP view aggJoin2341890098187432232 as select v31 from aggJoin1099319430676543477 join aggView3543464952068511907 using(v15);
create or replace TEMP view aggView5344662074422013142 as select v31 from aggJoin2341890098187432232 group by v31;
create or replace TEMP view aggJoin7735030389262266458 as select v31, v32 from semiDown271261474474801316 join aggView5344662074422013142 using(v31);
create or replace TEMP view aggView5600808715109770039 as select v31, MIN(v32) as v44 from aggJoin7735030389262266458 group by v31;
create or replace TEMP view aggJoin5164286512051037499 as select v1, v29, v44 from semiUp5555106477886238169 join aggView5600808715109770039 using(v31);
create or replace TEMP view aggView416660595286224964 as select v29 from semiDown1148020930021884205;
create or replace TEMP view aggJoin1263499476037668394 as select v1, v44 from aggJoin5164286512051037499 join aggView416660595286224964 using(v29);
create or replace TEMP view aggView5532465726315622650 as select v1, v2 as v43 from semiDown3721735275424384042;
create or replace TEMP view aggJoin7069182620797544328 as select v44, v43 from aggJoin1263499476037668394 join aggView5532465726315622650 using(v1);
create or replace TEMP view res as select MIN(v43) as v43, MIN(v44) as v44 from aggJoin7069182620797544328;
select sum(v43+v44) from res;
