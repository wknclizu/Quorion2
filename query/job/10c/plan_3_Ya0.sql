create or replace TEMP view semiUp894006088243522928 as select movie_id as v31, company_id as v15, company_type_id as v22 from movie_companies AS mc where (company_id) in (select id from company_name AS cn where (country_code = '[us]'));
create or replace TEMP view semiUp712023892170271805 as select movie_id as v31, person_role_id as v1, role_id as v29 from cast_info AS ci where (role_id) in (select id from role_type AS rt) and (note LIKE '%(producer)%');
create or replace TEMP view semiUp7743357336345660071 as select v31, v1, v29 from semiUp712023892170271805 where (v1) in (select id from char_name AS chn);
create or replace TEMP view semiUp8786844140399042963 as select v31, v1, v29 from semiUp7743357336345660071 where (v31) in (select id from title AS t where (production_year > 1990));
create or replace TEMP view semiUp4446262985981543085 as select v31, v15, v22 from semiUp894006088243522928 where (v31) in (select v31 from semiUp8786844140399042963);
create or replace TEMP view semiUp5828246426987345198 as select id as v22 from company_type AS ct where (id) in (select v22 from semiUp4446262985981543085);
create or replace TEMP view semiDown6007486835180484893 as select v31, v15, v22 from semiUp4446262985981543085 where (v22) in (select v22 from semiUp5828246426987345198);
create or replace TEMP view semiDown9193571188599903789 as select id as v15 from company_name AS cn where (id) in (select v15 from semiDown6007486835180484893) and (country_code = '[us]');
create or replace TEMP view semiDown682922950694700819 as select v31, v1, v29 from semiUp8786844140399042963 where (v31) in (select v31 from semiDown6007486835180484893);
create or replace TEMP view semiDown8691888166669300071 as select id as v29 from role_type AS rt where (id) in (select v29 from semiDown682922950694700819);
create or replace TEMP view semiDown4331097213693752917 as select id as v31, title as v32 from title AS t where (id) in (select v31 from semiDown682922950694700819) and (production_year > 1990);
create or replace TEMP view semiDown2873722640615761004 as select id as v1, name as v2 from char_name AS chn where (id) in (select v1 from semiDown682922950694700819);
create or replace TEMP view aggView2895998703656451810 as select v31, v32 as v44 from semiDown4331097213693752917;
create or replace TEMP view aggJoin2393242406210911189 as select v31, v1, v29, v44 from semiDown682922950694700819 join aggView2895998703656451810 using(v31);
create or replace TEMP view aggView2759271653808678017 as select v15 from semiDown9193571188599903789;
create or replace TEMP view aggJoin6896777259939916797 as select v31, v22 from semiDown6007486835180484893 join aggView2759271653808678017 using(v15);
create or replace TEMP view aggView6024899745235249871 as select v29 from semiDown8691888166669300071;
create or replace TEMP view aggJoin5861059890186460679 as select v31, v1, v44 from aggJoin2393242406210911189 join aggView6024899745235249871 using(v29);
create or replace TEMP view aggView2160937450410934720 as select v1, v2 as v43 from semiDown2873722640615761004;
create or replace TEMP view aggJoin8404280847625628863 as select v31, v44, v43 from aggJoin5861059890186460679 join aggView2160937450410934720 using(v1);
create or replace TEMP view aggView3752836651084048704 as select v31, MIN(v44) as v44, MIN(v43) as v43 from aggJoin8404280847625628863 group by v31,v44,v43;
create or replace TEMP view aggJoin5573111481317597391 as select v22, v44, v43 from aggJoin6896777259939916797 join aggView3752836651084048704 using(v31);
create or replace TEMP view aggView4073471012974293331 as select v22, MIN(v44) as v44, MIN(v43) as v43 from aggJoin5573111481317597391 group by v22,v44,v43;
create or replace TEMP view aggJoin4576808058702812489 as select v44, v43 from semiUp5828246426987345198 join aggView4073471012974293331 using(v22);
create or replace TEMP view res as select MIN(v43) as v43, MIN(v44) as v44 from aggJoin4576808058702812489;
select sum(v43+v44) from res;
