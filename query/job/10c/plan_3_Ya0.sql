create or replace TEMP view semiUp3755431538134152319 as select movie_id as v31, person_role_id as v1, role_id as v29 from cast_info AS ci where (person_role_id) in (select id from char_name AS chn) and (note LIKE '%(producer)%');
create or replace TEMP view semiUp7805372100770380356 as select v31, v1, v29 from semiUp3755431538134152319 where (v31) in (select id from title AS t where (production_year > 1990));
create or replace TEMP view semiUp4228561328065702858 as select movie_id as v31, company_id as v15, company_type_id as v22 from movie_companies AS mc where (company_id) in (select id from company_name AS cn where (country_code = '[us]'));
create or replace TEMP view semiUp6620287146366496185 as select v31, v1, v29 from semiUp7805372100770380356 where (v29) in (select id from role_type AS rt);
create or replace TEMP view semiUp5743143517948698312 as select v31, v15, v22 from semiUp4228561328065702858 where (v31) in (select v31 from semiUp6620287146366496185);
create or replace TEMP view semiUp3484222658888430562 as select id as v22 from company_type AS ct where (id) in (select v22 from semiUp5743143517948698312);
create or replace TEMP view semiDown59592284135421545 as select v31, v15, v22 from semiUp5743143517948698312 where (v22) in (select v22 from semiUp3484222658888430562);
create or replace TEMP view semiDown1019727912273831598 as select id as v15 from company_name AS cn where (id) in (select v15 from semiDown59592284135421545) and (country_code = '[us]');
create or replace TEMP view semiDown3094247103517159786 as select v31, v1, v29 from semiUp6620287146366496185 where (v31) in (select v31 from semiDown59592284135421545);
create or replace TEMP view semiDown4064894881413936614 as select id as v29 from role_type AS rt where (id) in (select v29 from semiDown3094247103517159786);
create or replace TEMP view semiDown1898617772959836955 as select id as v31, title as v32 from title AS t where (id) in (select v31 from semiDown3094247103517159786) and (production_year > 1990);
create or replace TEMP view semiDown3314419259434175453 as select id as v1, name as v2 from char_name AS chn where (id) in (select v1 from semiDown3094247103517159786);
create or replace TEMP view aggView371421213079007015 as select v31, v32 as v44 from semiDown1898617772959836955;
create or replace TEMP view aggJoin1293299110931352215 as select v31, v1, v29, v44 from semiDown3094247103517159786 join aggView371421213079007015 using(v31);
create or replace TEMP view aggView2077647486605570621 as select v15 from semiDown1019727912273831598;
create or replace TEMP view aggJoin8314671835301645018 as select v31, v22 from semiDown59592284135421545 join aggView2077647486605570621 using(v15);
create or replace TEMP view aggView6175306810763468091 as select v29 from semiDown4064894881413936614;
create or replace TEMP view aggJoin5078918113940781936 as select v31, v1, v44 from aggJoin1293299110931352215 join aggView6175306810763468091 using(v29);
create or replace TEMP view aggView5694852055993547779 as select v1, v2 as v43 from semiDown3314419259434175453;
create or replace TEMP view aggJoin7679731861234572612 as select v31, v44, v43 from aggJoin5078918113940781936 join aggView5694852055993547779 using(v1);
create or replace TEMP view aggView3730974434249086295 as select v31, MIN(v44) as v44, MIN(v43) as v43 from aggJoin7679731861234572612 group by v31,v43,v44;
create or replace TEMP view aggJoin8651792183772807422 as select v22, v44, v43 from aggJoin8314671835301645018 join aggView3730974434249086295 using(v31);
create or replace TEMP view aggView1485995942412899184 as select v22, MIN(v44) as v44, MIN(v43) as v43 from aggJoin8651792183772807422 group by v22,v43,v44;
create or replace TEMP view aggJoin1072764359958351102 as select v44, v43 from semiUp3484222658888430562 join aggView1485995942412899184 using(v22);
create or replace TEMP view res as select MIN(v43) as v43, MIN(v44) as v44 from aggJoin1072764359958351102;
select sum(v43+v44) from res;
