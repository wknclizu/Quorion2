create or replace TEMP view semiUp6635044413259904712 as select movie_id as v31, person_role_id as v1, role_id as v29 from cast_info AS ci where (role_id) in (select id from role_type AS rt) and (note LIKE '%(producer)%');
create or replace TEMP view semiUp1908901982582340066 as select movie_id as v31, company_id as v15, company_type_id as v22 from movie_companies AS mc where (movie_id) in (select id from title AS t where (production_year > 1990));
create or replace TEMP view semiUp2780535567043404291 as select v31, v15, v22 from semiUp1908901982582340066 where (v22) in (select id from company_type AS ct);
create or replace TEMP view semiUp9091452923232694402 as select v31, v15, v22 from semiUp2780535567043404291 where (v15) in (select id from company_name AS cn where (country_code = '[us]'));
create or replace TEMP view semiUp6431106535212280912 as select v31, v1, v29 from semiUp6635044413259904712 where (v31) in (select v31 from semiUp9091452923232694402);
create or replace TEMP view semiUp5382540527212396310 as select id as v1, name as v2 from char_name AS chn where (id) in (select v1 from semiUp6431106535212280912);
create or replace TEMP view semiDown6090630930956426144 as select v31, v1, v29 from semiUp6431106535212280912 where (v1) in (select v1 from semiUp5382540527212396310);
create or replace TEMP view semiDown8617858216935597045 as select id as v29 from role_type AS rt where (id) in (select v29 from semiDown6090630930956426144);
create or replace TEMP view semiDown7977288610180356914 as select v31, v15, v22 from semiUp9091452923232694402 where (v31) in (select v31 from semiDown6090630930956426144);
create or replace TEMP view semiDown3522385922312130321 as select id as v22 from company_type AS ct where (id) in (select v22 from semiDown7977288610180356914);
create or replace TEMP view semiDown3793572638703375039 as select id as v15 from company_name AS cn where (id) in (select v15 from semiDown7977288610180356914) and (country_code = '[us]');
create or replace TEMP view semiDown1095860767176346909 as select id as v31, title as v32 from title AS t where (id) in (select v31 from semiDown7977288610180356914) and (production_year > 1990);
create or replace TEMP view aggView1099759375104521912 as select v31, v32 as v44 from semiDown1095860767176346909;
create or replace TEMP view aggJoin1750580209544528455 as select v31, v15, v22, v44 from semiDown7977288610180356914 join aggView1099759375104521912 using(v31);
create or replace TEMP view aggView8650729761102585156 as select v15 from semiDown3793572638703375039;
create or replace TEMP view aggJoin7109393263832513968 as select v31, v22, v44 from aggJoin1750580209544528455 join aggView8650729761102585156 using(v15);
create or replace TEMP view aggView2789308433844865712 as select v22 from semiDown3522385922312130321;
create or replace TEMP view aggJoin4306346708416337376 as select v31, v44 from aggJoin7109393263832513968 join aggView2789308433844865712 using(v22);
create or replace TEMP view aggView4912708081465929925 as select v31, MIN(v44) as v44 from aggJoin4306346708416337376 group by v31,v44;
create or replace TEMP view aggJoin3952340922933525363 as select v1, v29, v44 from semiDown6090630930956426144 join aggView4912708081465929925 using(v31);
create or replace TEMP view aggView8202395464840591965 as select v29 from semiDown8617858216935597045;
create or replace TEMP view aggJoin3456415413695278675 as select v1, v44 from aggJoin3952340922933525363 join aggView8202395464840591965 using(v29);
create or replace TEMP view aggView6632474523415113514 as select v1, MIN(v44) as v44 from aggJoin3456415413695278675 group by v1,v44;
create or replace TEMP view aggJoin7022347699996030754 as select v2, v44 from semiUp5382540527212396310 join aggView6632474523415113514 using(v1);
create or replace TEMP view res as select MIN(v2) as v43, MIN(v44) as v44 from aggJoin7022347699996030754;
select sum(v43+v44) from res;
