create or replace TEMP view semiUp1621701437025080350 as select movie_id as v31, person_role_id as v1, role_id as v29 from cast_info AS ci where (role_id) in (select id from role_type AS rt) and (note LIKE '%(producer)%');
create or replace TEMP view semiUp4212371266250534030 as select movie_id as v31, company_id as v15, company_type_id as v22 from movie_companies AS mc where (company_id) in (select id from company_name AS cn where (country_code = '[us]'));
create or replace TEMP view semiUp5721747903233679234 as select v31, v15, v22 from semiUp4212371266250534030 where (v22) in (select id from company_type AS ct);
create or replace TEMP view semiUp8593484400809733326 as select v31, v1, v29 from semiUp1621701437025080350 where (v31) in (select v31 from semiUp5721747903233679234);
create or replace TEMP view semiUp8587417846392371156 as select v31, v1, v29 from semiUp8593484400809733326 where (v1) in (select id from char_name AS chn);
create or replace TEMP view semiUp7214666350632610339 as select id as v31, title as v32 from title AS t where (id) in (select v31 from semiUp8587417846392371156) and (production_year > 1990);
create or replace TEMP view semiDown237533432218177089 as select v31, v1, v29 from semiUp8587417846392371156 where (v31) in (select v31 from semiUp7214666350632610339);
create or replace TEMP view semiDown5081027999575935466 as select id as v29 from role_type AS rt where (id) in (select v29 from semiDown237533432218177089);
create or replace TEMP view semiDown4091207065563727196 as select v31, v15, v22 from semiUp5721747903233679234 where (v31) in (select v31 from semiDown237533432218177089);
create or replace TEMP view semiDown3330444313181738536 as select id as v1, name as v2 from char_name AS chn where (id) in (select v1 from semiDown237533432218177089);
create or replace TEMP view semiDown1113440817144041923 as select id as v22 from company_type AS ct where (id) in (select v22 from semiDown4091207065563727196);
create or replace TEMP view semiDown8098357836796201520 as select id as v15 from company_name AS cn where (id) in (select v15 from semiDown4091207065563727196) and (country_code = '[us]');
create or replace TEMP view aggView8482194733853239695 as select v15 from semiDown8098357836796201520;
create or replace TEMP view aggJoin7347366349488545396 as select v31, v22 from semiDown4091207065563727196 join aggView8482194733853239695 using(v15);
create or replace TEMP view aggView1761713771007505076 as select v22 from semiDown1113440817144041923;
create or replace TEMP view aggJoin7619391710649699647 as select v31 from aggJoin7347366349488545396 join aggView1761713771007505076 using(v22);
create or replace TEMP view aggView1776064746866448187 as select v31 from aggJoin7619391710649699647 group by v31;
create or replace TEMP view aggJoin5287455499416843318 as select v31, v1, v29 from semiDown237533432218177089 join aggView1776064746866448187 using(v31);
create or replace TEMP view aggView5205707041145074724 as select v1, v2 as v43 from semiDown3330444313181738536;
create or replace TEMP view aggJoin284441390401619453 as select v31, v29, v43 from aggJoin5287455499416843318 join aggView5205707041145074724 using(v1);
create or replace TEMP view aggView5356424726654089776 as select v29 from semiDown5081027999575935466;
create or replace TEMP view aggJoin940655074036170275 as select v31, v43 from aggJoin284441390401619453 join aggView5356424726654089776 using(v29);
create or replace TEMP view aggView7416377982412540403 as select v31, MIN(v43) as v43 from aggJoin940655074036170275 group by v31,v43;
create or replace TEMP view aggJoin7655508365173272167 as select v32, v43 from semiUp7214666350632610339 join aggView7416377982412540403 using(v31);
create or replace TEMP view res as select MIN(v43) as v43, MIN(v32) as v44 from aggJoin7655508365173272167;
select sum(v43+v44) from res;
