create or replace TEMP view semiUp3535439469357476718 as select movie_id as v31, person_role_id as v1, role_id as v29 from cast_info AS ci where (movie_id) in (select id from title AS t where (production_year > 1990)) and (note LIKE '%(producer)%');
create or replace TEMP view semiUp6131275593222966158 as select v31, v1, v29 from semiUp3535439469357476718 where (v1) in (select id from char_name AS chn);
create or replace TEMP view semiUp6160708545897296882 as select movie_id as v31, company_id as v15, company_type_id as v22 from movie_companies AS mc where (company_type_id) in (select id from company_type AS ct);
create or replace TEMP view semiUp5453507970523809773 as select v31, v15, v22 from semiUp6160708545897296882 where (v15) in (select id from company_name AS cn where (country_code = '[us]'));
create or replace TEMP view semiUp2756940797135157068 as select v31, v1, v29 from semiUp6131275593222966158 where (v29) in (select id from role_type AS rt);
create or replace TEMP view semiUp1437654104938301797 as select v31, v15, v22 from semiUp5453507970523809773 where (v31) in (select v31 from semiUp2756940797135157068);
create or replace TEMP view semiDown5093116494374660184 as select id as v22 from company_type AS ct where (id) in (select v22 from semiUp1437654104938301797);
create or replace TEMP view semiDown296771607380519320 as select id as v15 from company_name AS cn where (id) in (select v15 from semiUp1437654104938301797) and (country_code = '[us]');
create or replace TEMP view semiDown4709524062943119425 as select v31, v1, v29 from semiUp2756940797135157068 where (v31) in (select v31 from semiUp1437654104938301797);
create or replace TEMP view semiDown5849894003678126793 as select id as v29 from role_type AS rt where (id) in (select v29 from semiDown4709524062943119425);
create or replace TEMP view semiDown8569581457091970085 as select id as v31, title as v32 from title AS t where (id) in (select v31 from semiDown4709524062943119425) and (production_year > 1990);
create or replace TEMP view semiDown8376610313606308426 as select id as v1, name as v2 from char_name AS chn where (id) in (select v1 from semiDown4709524062943119425);
create or replace TEMP view aggView847060747257358853 as select v31, v32 as v44 from semiDown8569581457091970085;
create or replace TEMP view aggJoin8017024689343225384 as select v31, v1, v29, v44 from semiDown4709524062943119425 join aggView847060747257358853 using(v31);
create or replace TEMP view aggView6036198463201726407 as select v22 from semiDown5093116494374660184;
create or replace TEMP view aggJoin6901557351886422932 as select v31, v15 from semiUp1437654104938301797 join aggView6036198463201726407 using(v22);
create or replace TEMP view aggView4516654689273850760 as select v29 from semiDown5849894003678126793;
create or replace TEMP view aggJoin5995763744637186183 as select v31, v1, v44 from aggJoin8017024689343225384 join aggView4516654689273850760 using(v29);
create or replace TEMP view aggView5648728165576306397 as select v15 from semiDown296771607380519320;
create or replace TEMP view aggJoin5166951818487118441 as select v31 from aggJoin6901557351886422932 join aggView5648728165576306397 using(v15);
create or replace TEMP view aggView3999143508710549637 as select v1, v2 as v43 from semiDown8376610313606308426;
create or replace TEMP view aggJoin6303410192638816582 as select v31, v44, v43 from aggJoin5995763744637186183 join aggView3999143508710549637 using(v1);
create or replace TEMP view aggView4813211122840119804 as select v31, MIN(v44) as v44, MIN(v43) as v43 from aggJoin6303410192638816582 group by v31,v44,v43;
create or replace TEMP view aggJoin6622717044937976262 as select v44, v43 from aggJoin5166951818487118441 join aggView4813211122840119804 using(v31);
create or replace TEMP view res as select MIN(v43) as v43, MIN(v44) as v44 from aggJoin6622717044937976262;
select sum(v43+v44) from res;
