create or replace TEMP view semiUp4450109373382716177 as select movie_id as v31, person_role_id as v1, role_id as v29 from cast_info AS ci where (role_id) in (select id from role_type AS rt) and (note LIKE '%(producer)%');
create or replace TEMP view semiUp6850780967736497611 as select v31, v1, v29 from semiUp4450109373382716177 where (v1) in (select id from char_name AS chn);
create or replace TEMP view semiUp5952093324154889291 as select movie_id as v31, company_id as v15, company_type_id as v22 from movie_companies AS mc where (company_id) in (select id from company_name AS cn where (country_code = '[us]'));
create or replace TEMP view semiUp7934789938968803030 as select v31, v15, v22 from semiUp5952093324154889291 where (v22) in (select id from company_type AS ct);
create or replace TEMP view semiUp3177012701913986575 as select v31, v1, v29 from semiUp6850780967736497611 where (v31) in (select id from title AS t where (production_year > 1990));
create or replace TEMP view semiUp3391463714160793124 as select v31, v15, v22 from semiUp7934789938968803030 where (v31) in (select v31 from semiUp3177012701913986575);
create or replace TEMP view semiDown4572131476718813995 as select id as v22 from company_type AS ct where (id) in (select v22 from semiUp3391463714160793124);
create or replace TEMP view semiDown2702015399778543510 as select id as v15 from company_name AS cn where (id) in (select v15 from semiUp3391463714160793124) and (country_code = '[us]');
create or replace TEMP view semiDown770125958091711959 as select v31, v1, v29 from semiUp3177012701913986575 where (v31) in (select v31 from semiUp3391463714160793124);
create or replace TEMP view semiDown2641940235501950910 as select id as v29 from role_type AS rt where (id) in (select v29 from semiDown770125958091711959);
create or replace TEMP view semiDown2652861326636793426 as select id as v31, title as v32 from title AS t where (id) in (select v31 from semiDown770125958091711959) and (production_year > 1990);
create or replace TEMP view semiDown3293329207670316214 as select id as v1, name as v2 from char_name AS chn where (id) in (select v1 from semiDown770125958091711959);
create or replace TEMP view aggView7117818769746848214 as select v31, v32 as v44 from semiDown2652861326636793426;
create or replace TEMP view aggJoin5934719306141419382 as select v31, v1, v29, v44 from semiDown770125958091711959 join aggView7117818769746848214 using(v31);
create or replace TEMP view aggView1629818446243125060 as select v22 from semiDown4572131476718813995;
create or replace TEMP view aggJoin4135431706827668058 as select v31, v15 from semiUp3391463714160793124 join aggView1629818446243125060 using(v22);
create or replace TEMP view aggView5577454215106197959 as select v29 from semiDown2641940235501950910;
create or replace TEMP view aggJoin188420293612554298 as select v31, v1, v44 from aggJoin5934719306141419382 join aggView5577454215106197959 using(v29);
create or replace TEMP view aggView22168110331355156 as select v15 from semiDown2702015399778543510;
create or replace TEMP view aggJoin9037684900565612708 as select v31 from aggJoin4135431706827668058 join aggView22168110331355156 using(v15);
create or replace TEMP view aggView4573313166770304225 as select v1, v2 as v43 from semiDown3293329207670316214;
create or replace TEMP view aggJoin8995591946954471353 as select v31, v44, v43 from aggJoin188420293612554298 join aggView4573313166770304225 using(v1);
create or replace TEMP view aggView3180037055807617884 as select v31, MIN(v44) as v44, MIN(v43) as v43 from aggJoin8995591946954471353 group by v31,v43,v44;
create or replace TEMP view aggJoin4457570299558850341 as select v44, v43 from aggJoin9037684900565612708 join aggView3180037055807617884 using(v31);
create or replace TEMP view res as select MIN(v43) as v43, MIN(v44) as v44 from aggJoin4457570299558850341;
select sum(v43+v44) from res;
