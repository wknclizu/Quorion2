create or replace TEMP view semiUp5344022260420369659 as select movie_id as v31, person_role_id as v1, role_id as v29 from cast_info AS ci where (role_id) in (select id from role_type AS rt) and (note LIKE '%(producer)%');
create or replace TEMP view semiUp395137835579976817 as select movie_id as v31, company_id as v15, company_type_id as v22 from movie_companies AS mc where (company_id) in (select id from company_name AS cn where (country_code = '[us]'));
create or replace TEMP view semiUp4849089267933653785 as select v31, v1, v29 from semiUp5344022260420369659 where (v1) in (select id from char_name AS chn);
create or replace TEMP view semiUp8214338926217155074 as select v31, v15, v22 from semiUp395137835579976817 where (v22) in (select id from company_type AS ct);
create or replace TEMP view semiUp198580879931625330 as select v31, v1, v29 from semiUp4849089267933653785 where (v31) in (select v31 from semiUp8214338926217155074);
create or replace TEMP view semiUp4327529340976298700 as select v31, v1, v29 from semiUp198580879931625330 where (v31) in (select id from title AS t where (production_year > 1990));
create or replace TEMP view semiDown6764276017021482328 as select id as v29 from role_type AS rt where (id) in (select v29 from semiUp4327529340976298700);
create or replace TEMP view semiDown558156369484431700 as select id as v31, title as v32 from title AS t where (id) in (select v31 from semiUp4327529340976298700) and (production_year > 1990);
create or replace TEMP view semiDown4872292844188931056 as select v31, v15, v22 from semiUp8214338926217155074 where (v31) in (select v31 from semiUp4327529340976298700);
create or replace TEMP view semiDown986349560331835320 as select id as v1, name as v2 from char_name AS chn where (id) in (select v1 from semiUp4327529340976298700);
create or replace TEMP view semiDown6124001529513914236 as select id as v22 from company_type AS ct where (id) in (select v22 from semiDown4872292844188931056);
create or replace TEMP view semiDown8775107000739213156 as select id as v15 from company_name AS cn where (id) in (select v15 from semiDown4872292844188931056) and (country_code = '[us]');
create or replace TEMP view aggView1335604554011291796 as select v22 from semiDown6124001529513914236;
create or replace TEMP view aggJoin1299575890533857020 as select v31, v15 from semiDown4872292844188931056 join aggView1335604554011291796 using(v22);
create or replace TEMP view aggView5744629007649030865 as select v31, v32 as v44 from semiDown558156369484431700;
create or replace TEMP view aggJoin2369000488630799705 as select v31, v1, v29, v44 from semiUp4327529340976298700 join aggView5744629007649030865 using(v31);
create or replace TEMP view aggView2725211360058478576 as select v15 from semiDown8775107000739213156;
create or replace TEMP view aggJoin5554802527198945985 as select v31 from aggJoin1299575890533857020 join aggView2725211360058478576 using(v15);
create or replace TEMP view aggView7803751530235681650 as select v29 from semiDown6764276017021482328;
create or replace TEMP view aggJoin6829544584241406339 as select v31, v1, v44 from aggJoin2369000488630799705 join aggView7803751530235681650 using(v29);
create or replace TEMP view aggView1884707267514593938 as select v31 from aggJoin5554802527198945985 group by v31;
create or replace TEMP view aggJoin858027057989893822 as select v1, v44 as v44 from aggJoin6829544584241406339 join aggView1884707267514593938 using(v31);
create or replace TEMP view aggView226203037659712315 as select v1, v2 as v43 from semiDown986349560331835320;
create or replace TEMP view aggJoin8182239582222357854 as select v44, v43 from aggJoin858027057989893822 join aggView226203037659712315 using(v1);
create or replace TEMP view res as select MIN(v43) as v43, MIN(v44) as v44 from aggJoin8182239582222357854;
select sum(v43+v44) from res;
