create or replace TEMP view semiUp460537525960854419 as select movie_id as v31, person_role_id as v1, role_id as v29 from cast_info AS ci where (person_role_id) in (select id from char_name AS chn) and (note LIKE '%(producer)%');
create or replace TEMP view semiUp276279335954762364 as select movie_id as v31, company_id as v15, company_type_id as v22 from movie_companies AS mc where (company_type_id) in (select id from company_type AS ct);
create or replace TEMP view semiUp3434586323009786430 as select v31, v1, v29 from semiUp460537525960854419 where (v29) in (select id from role_type AS rt);
create or replace TEMP view semiUp8169524446146425682 as select v31, v15, v22 from semiUp276279335954762364 where (v15) in (select id from company_name AS cn where (country_code = '[us]'));
create or replace TEMP view semiUp1383657437671643477 as select v31, v15, v22 from semiUp8169524446146425682 where (v31) in (select id from title AS t where (production_year > 1990));
create or replace TEMP view semiUp8787610552626908237 as select v31, v1, v29 from semiUp3434586323009786430 where (v31) in (select v31 from semiUp1383657437671643477);
create or replace TEMP view semiDown5330243332858585321 as select id as v29 from role_type AS rt where (id) in (select v29 from semiUp8787610552626908237);
create or replace TEMP view semiDown510636448390255073 as select v31, v15, v22 from semiUp1383657437671643477 where (v31) in (select v31 from semiUp8787610552626908237);
create or replace TEMP view semiDown2574905884784405568 as select id as v1, name as v2 from char_name AS chn where (id) in (select v1 from semiUp8787610552626908237);
create or replace TEMP view semiDown3517895837310697691 as select id as v22 from company_type AS ct where (id) in (select v22 from semiDown510636448390255073);
create or replace TEMP view semiDown5545199174166322122 as select id as v15 from company_name AS cn where (id) in (select v15 from semiDown510636448390255073) and (country_code = '[us]');
create or replace TEMP view semiDown8518033984876286802 as select id as v31, title as v32 from title AS t where (id) in (select v31 from semiDown510636448390255073) and (production_year > 1990);
create or replace TEMP view aggView3463655325214742965 as select v31, v32 as v44 from semiDown8518033984876286802;
create or replace TEMP view aggJoin1418880781557696875 as select v31, v15, v22, v44 from semiDown510636448390255073 join aggView3463655325214742965 using(v31);
create or replace TEMP view aggView2568400946560210547 as select v15 from semiDown5545199174166322122;
create or replace TEMP view aggJoin8103879917448935734 as select v31, v22, v44 from aggJoin1418880781557696875 join aggView2568400946560210547 using(v15);
create or replace TEMP view aggView7723970491679340456 as select v22 from semiDown3517895837310697691;
create or replace TEMP view aggJoin5693625461698897629 as select v31, v44 from aggJoin8103879917448935734 join aggView7723970491679340456 using(v22);
create or replace TEMP view aggView715920828838344035 as select v1, v2 as v43 from semiDown2574905884784405568;
create or replace TEMP view aggJoin3711137974183859901 as select v31, v29, v43 from semiUp8787610552626908237 join aggView715920828838344035 using(v1);
create or replace TEMP view aggView9026341534662128209 as select v31, MIN(v44) as v44 from aggJoin5693625461698897629 group by v31,v44;
create or replace TEMP view aggJoin3829024925747371985 as select v29, v43 as v43, v44 from aggJoin3711137974183859901 join aggView9026341534662128209 using(v31);
create or replace TEMP view aggView8830103766749851100 as select v29 from semiDown5330243332858585321;
create or replace TEMP view aggJoin2332556252990815075 as select v43, v44 from aggJoin3829024925747371985 join aggView8830103766749851100 using(v29);
create or replace TEMP view res as select MIN(v43) as v43, MIN(v44) as v44 from aggJoin2332556252990815075;
select sum(v43+v44) from res;
