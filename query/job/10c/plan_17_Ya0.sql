create or replace TEMP view semiUp2977145491945427514 as select movie_id as v31, person_role_id as v1, role_id as v29 from cast_info AS ci where (person_role_id) in (select id from char_name AS chn) and (note LIKE '%(producer)%');
create or replace TEMP view semiUp6169261120612133854 as select movie_id as v31, company_id as v15, company_type_id as v22 from movie_companies AS mc where (company_id) in (select id from company_name AS cn where (country_code = '[us]'));
create or replace TEMP view semiUp3745615746500150722 as select v31, v1, v29 from semiUp2977145491945427514 where (v29) in (select id from role_type AS rt);
create or replace TEMP view semiUp8404102623123225226 as select id as v31, title as v32 from title AS t where (id) in (select v31 from semiUp3745615746500150722) and (production_year > 1990);
create or replace TEMP view semiUp8902145624485291900 as select v31, v15, v22 from semiUp6169261120612133854 where (v31) in (select v31 from semiUp8404102623123225226);
create or replace TEMP view semiUp3339965209079529273 as select id as v22 from company_type AS ct where (id) in (select v22 from semiUp8902145624485291900);
create or replace TEMP view semiDown8664678393054895612 as select v31, v15, v22 from semiUp8902145624485291900 where (v22) in (select v22 from semiUp3339965209079529273);
create or replace TEMP view semiDown1865485610592245017 as select id as v15 from company_name AS cn where (id) in (select v15 from semiDown8664678393054895612) and (country_code = '[us]');
create or replace TEMP view semiDown5261717187168717111 as select v31, v32 from semiUp8404102623123225226 where (v31) in (select v31 from semiDown8664678393054895612);
create or replace TEMP view semiDown8650815194764941473 as select v31, v1, v29 from semiUp3745615746500150722 where (v31) in (select v31 from semiDown5261717187168717111);
create or replace TEMP view semiDown9180210402942931286 as select id as v29 from role_type AS rt where (id) in (select v29 from semiDown8650815194764941473);
create or replace TEMP view semiDown4194130218885566853 as select id as v1, name as v2 from char_name AS chn where (id) in (select v1 from semiDown8650815194764941473);
create or replace TEMP view aggView6015113889015736911 as select v29 from semiDown9180210402942931286;
create or replace TEMP view aggJoin8048135641962424628 as select v31, v1 from semiDown8650815194764941473 join aggView6015113889015736911 using(v29);
create or replace TEMP view aggView1513365862745899162 as select v1, v2 as v43 from semiDown4194130218885566853;
create or replace TEMP view aggJoin2245484246745824331 as select v31, v43 from aggJoin8048135641962424628 join aggView1513365862745899162 using(v1);
create or replace TEMP view aggView1659878169110804616 as select v31, MIN(v43) as v43 from aggJoin2245484246745824331 group by v31,v43;
create or replace TEMP view aggJoin2354323310283498375 as select v31, v32, v43 from semiDown5261717187168717111 join aggView1659878169110804616 using(v31);
create or replace TEMP view aggView5197754792658956923 as select v31, MIN(v43) as v43, MIN(v32) as v44 from aggJoin2354323310283498375 group by v31,v43;
create or replace TEMP view aggJoin7501701290726450264 as select v15, v22, v43, v44 from semiDown8664678393054895612 join aggView5197754792658956923 using(v31);
create or replace TEMP view aggView2582437741533342039 as select v15 from semiDown1865485610592245017;
create or replace TEMP view aggJoin3520178418719511096 as select v22, v43, v44 from aggJoin7501701290726450264 join aggView2582437741533342039 using(v15);
create or replace TEMP view aggView4598160284856573116 as select v22, MIN(v43) as v43, MIN(v44) as v44 from aggJoin3520178418719511096 group by v22,v44,v43;
create or replace TEMP view aggJoin3584852785373644333 as select v43, v44 from semiUp3339965209079529273 join aggView4598160284856573116 using(v22);
create or replace TEMP view res as select MIN(v43) as v43, MIN(v44) as v44 from aggJoin3584852785373644333;
select sum(v43+v44) from res;
