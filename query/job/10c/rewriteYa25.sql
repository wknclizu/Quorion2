create or replace TEMP view semiUp764903566175649777 as select movie_id as v31, company_id as v15, company_type_id as v22 from movie_companies AS mc where (company_type_id) in (select id from company_type AS ct);
create or replace TEMP view semiUp3389859255161042549 as select movie_id as v31, person_role_id as v1, role_id as v29 from cast_info AS ci where (role_id) in (select id from role_type AS rt) and (note LIKE '%(producer)%');
create or replace TEMP view semiUp7843729377765688815 as select v31, v15, v22 from semiUp764903566175649777 where (v15) in (select id from company_name AS cn where (country_code = '[us]'));
create or replace TEMP view semiUp635955658497150024 as select id as v31, title as v32 from title AS t where (id) in (select v31 from semiUp7843729377765688815) and (production_year > 1990);
create or replace TEMP view semiUp6442417868286405165 as select v31, v1, v29 from semiUp3389859255161042549 where (v31) in (select v31 from semiUp635955658497150024);
create or replace TEMP view semiUp8593101362689830417 as select id as v1, name as v2 from char_name AS chn where (id) in (select v1 from semiUp6442417868286405165);
create or replace TEMP view semiDown1795162328309039520 as select v31, v1, v29 from semiUp6442417868286405165 where (v1) in (select v1 from semiUp8593101362689830417);
create or replace TEMP view semiDown8273773175839589449 as select id as v29 from role_type AS rt where (id) in (select v29 from semiDown1795162328309039520);
create or replace TEMP view semiDown6955996032794625009 as select v31, v32 from semiUp635955658497150024 where (v31) in (select v31 from semiDown1795162328309039520);
create or replace TEMP view semiDown5521606026883461471 as select v31, v15, v22 from semiUp7843729377765688815 where (v31) in (select v31 from semiDown6955996032794625009);
create or replace TEMP view semiDown2472627489964374321 as select id as v22 from company_type AS ct where (id) in (select v22 from semiDown5521606026883461471);
create or replace TEMP view semiDown4071919184749022218 as select id as v15 from company_name AS cn where (id) in (select v15 from semiDown5521606026883461471) and (country_code = '[us]');
create or replace TEMP view aggView757904610424187274 as select v15 from semiDown4071919184749022218;
create or replace TEMP view aggJoin5546141395426420014 as select v31, v22 from semiDown5521606026883461471 join aggView757904610424187274 using(v15);
create or replace TEMP view aggView4133766792754604412 as select v22 from semiDown2472627489964374321;
create or replace TEMP view aggJoin5680033512874697008 as select v31 from aggJoin5546141395426420014 join aggView4133766792754604412 using(v22);
create or replace TEMP view aggView5674082049882868310 as select v31 from aggJoin5680033512874697008 group by v31;
create or replace TEMP view aggJoin2538030143733628959 as select v31, v32 from semiDown6955996032794625009 join aggView5674082049882868310 using(v31);
create or replace TEMP view aggView2227576976643391666 as select v29 from semiDown8273773175839589449;
create or replace TEMP view aggJoin1796101323225495829 as select v31, v1 from semiDown1795162328309039520 join aggView2227576976643391666 using(v29);
create or replace TEMP view aggView8961367972373131997 as select v31, MIN(v32) as v44 from aggJoin2538030143733628959 group by v31;
create or replace TEMP view aggJoin6809570420476470696 as select v1, v44 from aggJoin1796101323225495829 join aggView8961367972373131997 using(v31);
create or replace TEMP view aggView1414572283364859741 as select v1, MIN(v44) as v44 from aggJoin6809570420476470696 group by v1,v44;
create or replace TEMP view aggJoin7715345506168936708 as select v2, v44 from semiUp8593101362689830417 join aggView1414572283364859741 using(v1);
create or replace TEMP view res as select MIN(v2) as v43, MIN(v44) as v44 from aggJoin7715345506168936708;
select sum(v43+v44) from res;
