create or replace TEMP view semiUp6643499241385139483 as select movie_id as v31, person_role_id as v1, role_id as v29 from cast_info AS ci where (person_role_id) in (select id from char_name AS chn) and (note LIKE '%(producer)%');
create or replace TEMP view semiUp1648216821171390960 as select movie_id as v31, company_id as v15, company_type_id as v22 from movie_companies AS mc where (company_id) in (select id from company_name AS cn where (country_code = '[us]'));
create or replace TEMP view semiUp1146523566981998530 as select v31, v1, v29 from semiUp6643499241385139483 where (v29) in (select id from role_type AS rt);
create or replace TEMP view semiUp2790680122228026903 as select v31, v1, v29 from semiUp1146523566981998530 where (v31) in (select id from title AS t where (production_year > 1990));
create or replace TEMP view semiUp5081212957897589258 as select v31, v15, v22 from semiUp1648216821171390960 where (v31) in (select v31 from semiUp2790680122228026903);
create or replace TEMP view semiUp1364070152357239819 as select v31, v15, v22 from semiUp5081212957897589258 where (v22) in (select id from company_type AS ct);
create or replace TEMP view semiDown6265427706778612542 as select id as v22 from company_type AS ct where (id) in (select v22 from semiUp1364070152357239819);
create or replace TEMP view semiDown1374936582426011864 as select id as v15 from company_name AS cn where (id) in (select v15 from semiUp1364070152357239819) and (country_code = '[us]');
create or replace TEMP view semiDown5896026318890832130 as select v31, v1, v29 from semiUp2790680122228026903 where (v31) in (select v31 from semiUp1364070152357239819);
create or replace TEMP view semiDown7136871508938988576 as select id as v29 from role_type AS rt where (id) in (select v29 from semiDown5896026318890832130);
create or replace TEMP view semiDown6561971681364380516 as select id as v31, title as v32 from title AS t where (id) in (select v31 from semiDown5896026318890832130) and (production_year > 1990);
create or replace TEMP view semiDown8974919610636725826 as select id as v1, name as v2 from char_name AS chn where (id) in (select v1 from semiDown5896026318890832130);
create or replace TEMP view aggView1609162154532279726 as select v1, v2 as v43 from semiDown8974919610636725826;
create or replace TEMP view aggJoin5799234413901178704 as select v31, v29, v43 from semiDown5896026318890832130 join aggView1609162154532279726 using(v1);
create or replace TEMP view aggView3654971953310246598 as select v31, v32 as v44 from semiDown6561971681364380516;
create or replace TEMP view aggJoin1028510033263155959 as select v31, v29, v43, v44 from aggJoin5799234413901178704 join aggView3654971953310246598 using(v31);
create or replace TEMP view aggView2673877940696769610 as select v29 from semiDown7136871508938988576;
create or replace TEMP view aggJoin12216438630492704 as select v31, v43, v44 from aggJoin1028510033263155959 join aggView2673877940696769610 using(v29);
create or replace TEMP view aggView1970112106654986764 as select v31, MIN(v43) as v43, MIN(v44) as v44 from aggJoin12216438630492704 group by v31,v44,v43;
create or replace TEMP view aggJoin7739112610290095508 as select v15, v22, v43, v44 from semiUp1364070152357239819 join aggView1970112106654986764 using(v31);
create or replace TEMP view aggView8757964912655492728 as select v15 from semiDown1374936582426011864;
create or replace TEMP view aggJoin7513490639250928941 as select v22, v43, v44 from aggJoin7739112610290095508 join aggView8757964912655492728 using(v15);
create or replace TEMP view aggView4349510710628737229 as select v22 from semiDown6265427706778612542;
create or replace TEMP view aggJoin4586015902517108794 as select v43, v44 from aggJoin7513490639250928941 join aggView4349510710628737229 using(v22);
create or replace TEMP view res as select MIN(v43) as v43, MIN(v44) as v44 from aggJoin4586015902517108794;
select sum(v43+v44) from res;
