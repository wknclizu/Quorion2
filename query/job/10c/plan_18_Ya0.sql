create or replace TEMP view semiUp6988624481514894156 as select movie_id as v31, company_id as v15, company_type_id as v22 from movie_companies AS mc where (company_type_id) in (select id from company_type AS ct);
create or replace TEMP view semiUp2752434422860961318 as select v31, v15, v22 from semiUp6988624481514894156 where (v15) in (select id from company_name AS cn where (country_code = '[us]'));
create or replace TEMP view semiUp8330774872059181509 as select movie_id as v31, person_role_id as v1, role_id as v29 from cast_info AS ci where (role_id) in (select id from role_type AS rt) and (note LIKE '%(producer)%');
create or replace TEMP view semiUp2998197420644718312 as select v31, v1, v29 from semiUp8330774872059181509 where (v1) in (select id from char_name AS chn);
create or replace TEMP view semiUp8221839154886774502 as select id as v31, title as v32 from title AS t where (id) in (select v31 from semiUp2998197420644718312) and (production_year > 1990);
create or replace TEMP view semiUp3985517328068827844 as select v31, v15, v22 from semiUp2752434422860961318 where (v31) in (select v31 from semiUp8221839154886774502);
create or replace TEMP view semiDown423945649371872532 as select id as v22 from company_type AS ct where (id) in (select v22 from semiUp3985517328068827844);
create or replace TEMP view semiDown5178665341875997927 as select id as v15 from company_name AS cn where (id) in (select v15 from semiUp3985517328068827844) and (country_code = '[us]');
create or replace TEMP view semiDown6934865490791862234 as select v31, v32 from semiUp8221839154886774502 where (v31) in (select v31 from semiUp3985517328068827844);
create or replace TEMP view semiDown2323313077542516195 as select v31, v1, v29 from semiUp2998197420644718312 where (v31) in (select v31 from semiDown6934865490791862234);
create or replace TEMP view semiDown435452191294833939 as select id as v29 from role_type AS rt where (id) in (select v29 from semiDown2323313077542516195);
create or replace TEMP view semiDown2277968110121818818 as select id as v1, name as v2 from char_name AS chn where (id) in (select v1 from semiDown2323313077542516195);
create or replace TEMP view aggView7079896942089659318 as select v29 from semiDown435452191294833939;
create or replace TEMP view aggJoin3090705510505668628 as select v31, v1 from semiDown2323313077542516195 join aggView7079896942089659318 using(v29);
create or replace TEMP view aggView6821544834249128658 as select v1, v2 as v43 from semiDown2277968110121818818;
create or replace TEMP view aggJoin7611132846549782440 as select v31, v43 from aggJoin3090705510505668628 join aggView6821544834249128658 using(v1);
create or replace TEMP view aggView3772749574937703416 as select v31, MIN(v43) as v43 from aggJoin7611132846549782440 group by v31,v43;
create or replace TEMP view aggJoin2905396922401442741 as select v31, v32, v43 from semiDown6934865490791862234 join aggView3772749574937703416 using(v31);
create or replace TEMP view aggView7042628316918057661 as select v31, MIN(v43) as v43, MIN(v32) as v44 from aggJoin2905396922401442741 group by v31,v43;
create or replace TEMP view aggJoin4695762557605101576 as select v15, v22, v43, v44 from semiUp3985517328068827844 join aggView7042628316918057661 using(v31);
create or replace TEMP view aggView150988511482549762 as select v22 from semiDown423945649371872532;
create or replace TEMP view aggJoin2590703948023417530 as select v15, v43, v44 from aggJoin4695762557605101576 join aggView150988511482549762 using(v22);
create or replace TEMP view aggView2625595120628941103 as select v15 from semiDown5178665341875997927;
create or replace TEMP view aggJoin5547589773451531218 as select v43, v44 from aggJoin2590703948023417530 join aggView2625595120628941103 using(v15);
create or replace TEMP view res as select MIN(v43) as v43, MIN(v44) as v44 from aggJoin5547589773451531218;
select sum(v43+v44) from res;
