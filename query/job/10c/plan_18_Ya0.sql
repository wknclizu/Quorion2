create or replace TEMP view semiUp2685932195910211640 as select movie_id as v31, company_id as v15, company_type_id as v22 from movie_companies AS mc where (company_id) in (select id from company_name AS cn where (country_code = '[us]'));
create or replace TEMP view semiUp6566502845535546434 as select movie_id as v31, person_role_id as v1, role_id as v29 from cast_info AS ci where (person_role_id) in (select id from char_name AS chn) and (note LIKE '%(producer)%');
create or replace TEMP view semiUp1058132314103688876 as select v31, v1, v29 from semiUp6566502845535546434 where (v29) in (select id from role_type AS rt);
create or replace TEMP view semiUp8544059917316023316 as select v31, v15, v22 from semiUp2685932195910211640 where (v22) in (select id from company_type AS ct);
create or replace TEMP view semiUp8155768717085235056 as select id as v31, title as v32 from title AS t where (id) in (select v31 from semiUp1058132314103688876) and (production_year > 1990);
create or replace TEMP view semiUp565288743017841514 as select v31, v15, v22 from semiUp8544059917316023316 where (v31) in (select v31 from semiUp8155768717085235056);
create or replace TEMP view semiDown6637049438591846918 as select id as v22 from company_type AS ct where (id) in (select v22 from semiUp565288743017841514);
create or replace TEMP view semiDown5579046365041482848 as select id as v15 from company_name AS cn where (id) in (select v15 from semiUp565288743017841514) and (country_code = '[us]');
create or replace TEMP view semiDown3797190472234786924 as select v31, v32 from semiUp8155768717085235056 where (v31) in (select v31 from semiUp565288743017841514);
create or replace TEMP view semiDown9010915862171509273 as select v31, v1, v29 from semiUp1058132314103688876 where (v31) in (select v31 from semiDown3797190472234786924);
create or replace TEMP view semiDown7738764061621217332 as select id as v29 from role_type AS rt where (id) in (select v29 from semiDown9010915862171509273);
create or replace TEMP view semiDown5427151054409493921 as select id as v1, name as v2 from char_name AS chn where (id) in (select v1 from semiDown9010915862171509273);
create or replace TEMP view aggView5843393971384617 as select v29 from semiDown7738764061621217332;
create or replace TEMP view aggJoin5567497332231985448 as select v31, v1 from semiDown9010915862171509273 join aggView5843393971384617 using(v29);
create or replace TEMP view aggView3852943102992316960 as select v1, v2 as v43 from semiDown5427151054409493921;
create or replace TEMP view aggJoin7827134702890940759 as select v31, v43 from aggJoin5567497332231985448 join aggView3852943102992316960 using(v1);
create or replace TEMP view aggView6504964662226933523 as select v31, MIN(v43) as v43 from aggJoin7827134702890940759 group by v31,v43;
create or replace TEMP view aggJoin8160524471777769583 as select v31, v32, v43 from semiDown3797190472234786924 join aggView6504964662226933523 using(v31);
create or replace TEMP view aggView7898778489795655092 as select v31, MIN(v43) as v43, MIN(v32) as v44 from aggJoin8160524471777769583 group by v31,v43;
create or replace TEMP view aggJoin160407744533855810 as select v15, v22, v43, v44 from semiUp565288743017841514 join aggView7898778489795655092 using(v31);
create or replace TEMP view aggView7635898995198984585 as select v22 from semiDown6637049438591846918;
create or replace TEMP view aggJoin6026334412175825217 as select v15, v43, v44 from aggJoin160407744533855810 join aggView7635898995198984585 using(v22);
create or replace TEMP view aggView4041159791766400890 as select v15 from semiDown5579046365041482848;
create or replace TEMP view aggJoin2844869275301687588 as select v43, v44 from aggJoin6026334412175825217 join aggView4041159791766400890 using(v15);
create or replace TEMP view res as select MIN(v43) as v43, MIN(v44) as v44 from aggJoin2844869275301687588;
select sum(v43+v44) from res;
