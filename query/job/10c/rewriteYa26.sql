create or replace TEMP view semiUp4047658549545203739 as select movie_id as v31, person_role_id as v1, role_id as v29 from cast_info AS ci where (role_id) in (select id from role_type AS rt) and (note LIKE '%(producer)%');
create or replace TEMP view semiUp9166284266691372442 as select movie_id as v31, company_id as v15, company_type_id as v22 from movie_companies AS mc where (company_type_id) in (select id from company_type AS ct);
create or replace TEMP view semiUp957417556812963170 as select v31, v1, v29 from semiUp4047658549545203739 where (v31) in (select id from title AS t where (production_year > 1990));
create or replace TEMP view semiUp2655703946978742051 as select v31, v15, v22 from semiUp9166284266691372442 where (v15) in (select id from company_name AS cn where (country_code = '[us]'));
create or replace TEMP view semiUp6324605998601589715 as select v31, v1, v29 from semiUp957417556812963170 where (v31) in (select v31 from semiUp2655703946978742051);
create or replace TEMP view semiUp7959620842194803477 as select id as v1, name as v2 from char_name AS chn where (id) in (select v1 from semiUp6324605998601589715);
create or replace TEMP view semiDown2977156333872859538 as select v31, v1, v29 from semiUp6324605998601589715 where (v1) in (select v1 from semiUp7959620842194803477);
create or replace TEMP view semiDown1692089288482397996 as select id as v29 from role_type AS rt where (id) in (select v29 from semiDown2977156333872859538);
create or replace TEMP view semiDown5522143491119536860 as select id as v31, title as v32 from title AS t where (id) in (select v31 from semiDown2977156333872859538) and (production_year > 1990);
create or replace TEMP view semiDown3366767369209356092 as select v31, v15, v22 from semiUp2655703946978742051 where (v31) in (select v31 from semiDown2977156333872859538);
create or replace TEMP view semiDown6565951694663801399 as select id as v22 from company_type AS ct where (id) in (select v22 from semiDown3366767369209356092);
create or replace TEMP view semiDown5104130094357314115 as select id as v15 from company_name AS cn where (id) in (select v15 from semiDown3366767369209356092) and (country_code = '[us]');
create or replace TEMP view aggView5050825698958656532 as select v15 from semiDown5104130094357314115;
create or replace TEMP view aggJoin5056867384867656586 as select v31, v22 from semiDown3366767369209356092 join aggView5050825698958656532 using(v15);
create or replace TEMP view aggView1795021932887788483 as select v22 from semiDown6565951694663801399;
create or replace TEMP view aggJoin1095560570448564586 as select v31 from aggJoin5056867384867656586 join aggView1795021932887788483 using(v22);
create or replace TEMP view aggView237126584558799358 as select v31 from aggJoin1095560570448564586 group by v31;
create or replace TEMP view aggJoin8080472079998482398 as select v31, v1, v29 from semiDown2977156333872859538 join aggView237126584558799358 using(v31);
create or replace TEMP view aggView6734571139357999088 as select v29 from semiDown1692089288482397996;
create or replace TEMP view aggJoin160075689205142082 as select v31, v1 from aggJoin8080472079998482398 join aggView6734571139357999088 using(v29);
create or replace TEMP view aggView6011881508980600188 as select v31, v32 as v44 from semiDown5522143491119536860;
create or replace TEMP view aggJoin2617353955093112625 as select v1, v44 from aggJoin160075689205142082 join aggView6011881508980600188 using(v31);
create or replace TEMP view aggView5175846022053657008 as select v1, MIN(v44) as v44 from aggJoin2617353955093112625 group by v1,v44;
create or replace TEMP view aggJoin1199809031505206611 as select v2, v44 from semiUp7959620842194803477 join aggView5175846022053657008 using(v1);
create or replace TEMP view res as select MIN(v2) as v43, MIN(v44) as v44 from aggJoin1199809031505206611;
select sum(v43+v44) from res;
