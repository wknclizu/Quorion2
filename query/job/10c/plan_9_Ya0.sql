create or replace TEMP view semiUp1727492289088003297 as select movie_id as v31, person_role_id as v1, role_id as v29 from cast_info AS ci where (person_role_id) in (select id from char_name AS chn) and (note LIKE '%(producer)%');
create or replace TEMP view semiUp4298101817563789561 as select v31, v1, v29 from semiUp1727492289088003297 where (v29) in (select id from role_type AS rt);
create or replace TEMP view semiUp857557220250471722 as select movie_id as v31, company_id as v15, company_type_id as v22 from movie_companies AS mc where (movie_id) in (select v31 from semiUp4298101817563789561);
create or replace TEMP view semiUp6731990669484334599 as select v31, v15, v22 from semiUp857557220250471722 where (v31) in (select id from title AS t where (production_year > 1990));
create or replace TEMP view semiUp4620681741896593196 as select v31, v15, v22 from semiUp6731990669484334599 where (v22) in (select id from company_type AS ct);
create or replace TEMP view semiUp841493048626282723 as select id as v15 from company_name AS cn where (id) in (select v15 from semiUp4620681741896593196) and (country_code = '[us]');
create or replace TEMP view semiDown2917513281166313237 as select v31, v15, v22 from semiUp4620681741896593196 where (v15) in (select v15 from semiUp841493048626282723);
create or replace TEMP view semiDown8689818683625373522 as select id as v22 from company_type AS ct where (id) in (select v22 from semiDown2917513281166313237);
create or replace TEMP view semiDown1455873857230785051 as select v31, v1, v29 from semiUp4298101817563789561 where (v31) in (select v31 from semiDown2917513281166313237);
create or replace TEMP view semiDown3308478081957869585 as select id as v31, title as v32 from title AS t where (id) in (select v31 from semiDown2917513281166313237) and (production_year > 1990);
create or replace TEMP view semiDown7095521119962153263 as select id as v29 from role_type AS rt where (id) in (select v29 from semiDown1455873857230785051);
create or replace TEMP view semiDown5437781856286939188 as select id as v1, name as v2 from char_name AS chn where (id) in (select v1 from semiDown1455873857230785051);
create or replace TEMP view aggView7443403022707174034 as select v29 from semiDown7095521119962153263;
create or replace TEMP view aggJoin8742205396801974736 as select v31, v1 from semiDown1455873857230785051 join aggView7443403022707174034 using(v29);
create or replace TEMP view aggView7005089089736708677 as select v31, v32 as v44 from semiDown3308478081957869585;
create or replace TEMP view aggJoin117443148530386531 as select v31, v15, v22, v44 from semiDown2917513281166313237 join aggView7005089089736708677 using(v31);
create or replace TEMP view aggView3562689770663227363 as select v1, v2 as v43 from semiDown5437781856286939188;
create or replace TEMP view aggJoin2121106245456032992 as select v31, v43 from aggJoin8742205396801974736 join aggView3562689770663227363 using(v1);
create or replace TEMP view aggView8105621358685395415 as select v22 from semiDown8689818683625373522;
create or replace TEMP view aggJoin1313968988847795861 as select v31, v15, v44 from aggJoin117443148530386531 join aggView8105621358685395415 using(v22);
create or replace TEMP view aggView5986312694412892319 as select v31, MIN(v43) as v43 from aggJoin2121106245456032992 group by v31,v43;
create or replace TEMP view aggJoin7113012998153646726 as select v15, v44 as v44, v43 from aggJoin1313968988847795861 join aggView5986312694412892319 using(v31);
create or replace TEMP view aggView7363306189598493761 as select v15, MIN(v44) as v44, MIN(v43) as v43 from aggJoin7113012998153646726 group by v15,v43,v44;
create or replace TEMP view aggJoin4615922994430019898 as select v44, v43 from semiUp841493048626282723 join aggView7363306189598493761 using(v15);
create or replace TEMP view res as select MIN(v43) as v43, MIN(v44) as v44 from aggJoin4615922994430019898;
select sum(v43+v44) from res;
