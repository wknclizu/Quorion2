create or replace TEMP view aggView7447143545696330271 as select id as v1 from company_type as ct where (kind = 'production companies');
create or replace TEMP view aggJoin1273133828386318956 as select movie_id as v15, note as v9 from movie_companies as mc, aggView7447143545696330271 where mc.company_type_id=aggView7447143545696330271.v1 and (note LIKE '%(theatrical)%') and (note LIKE '%(France)%');
create or replace TEMP view aggView6403111051636786280 as select id as v3 from info_type as it;
create or replace TEMP view aggJoin7307599571730239895 as select movie_id as v15, info as v13 from movie_info as mi, aggView6403111051636786280 where mi.info_type_id=aggView6403111051636786280.v3 and (info IN ('Sweden','Norway','Germany','Denmark','Swedish','Denish','Norwegian','German'));
create or replace TEMP view aggView6027404033221247015 as select v15, COUNT(*) as annot from aggJoin7307599571730239895 group by v15;
create or replace TEMP view aggJoin3212723140027240992 as select id as v15, title as v16, production_year as v19, annot from title as t, aggView6027404033221247015 where t.id=aggView6027404033221247015.v15 and (production_year > 2005);
create or replace TEMP view aggView7382011225666280529 as select v15, COUNT(*) as annot from aggJoin1273133828386318956 group by v15;
create or replace TEMP view aggJoin4893861723435531788 as select v16, v19, aggJoin3212723140027240992.annot * aggView7382011225666280529.annot as annot from aggJoin3212723140027240992 join aggView7382011225666280529 using(v15);
create or replace TEMP view res as select MIN(v16) as v27 from aggJoin4893861723435531788;
select sum(v27) from res;